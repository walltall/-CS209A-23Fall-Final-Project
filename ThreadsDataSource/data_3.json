{"items":[{"tags":["java","selenium-webdriver"],"comments":[{"score":0,"post_type":"question","creation_date":1699248601,"post_id":77428873,"comment_id":136502979,"body_markdown":"This error may occur when the ChromeDriver version is not compatible with the Chrome browser version, or when the JSON. please recheck and add fresh driver once again and configure once again.","link":"https://stackoverflow.com/questions/77428873/unknown-error-result-webdrivervalue-value-list-is-missing-or-empty-in-runtime-c#comment136502979_77428873","body":"This error may occur when the ChromeDriver version is not compatible with the Chrome browser version, or when the JSON. please recheck and add fresh driver once again and configure once again."},{"score":2,"post_type":"question","creation_date":1699263915,"post_id":77428873,"comment_id":136505007,"body_markdown":"Does this answer your question? [Selenium throws &quot;result.webdriverValue.value list is missing or empty in Runtime.callFunctionOn response&quot;exception after starting ChromeDriver](https://stackoverflow.com/questions/77424990/selenium-throws-result-webdrivervalue-value-list-is-missing-or-empty-in-runtime)","link":"https://stackoverflow.com/questions/77428873/unknown-error-result-webdrivervalue-value-list-is-missing-or-empty-in-runtime-c#comment136505007_77428873","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/77424990/selenium-throws-result-webdrivervalue-value-list-is-missing-or-empty-in-runtime\">Selenium throws &quot;result.webdriverValue.value list is missing or empty in Runtime.callFunctionOn response&quot;exception after starting ChromeDriver</a>"},{"score":0,"post_type":"question","creation_date":1701278884,"post_id":77428873,"comment_id":136757022,"body_markdown":"Could you please [edit] the testcase and the full error, including traceback, into your question? Without them, it might be hard to tell what exactly caused the error. Be sure to add a [mcve], containing the least possible code that raises your error.","link":"https://stackoverflow.com/questions/77428873/unknown-error-result-webdrivervalue-value-list-is-missing-or-empty-in-runtime-c#comment136757022_77428873","body":"Could you please <a href=\"https://stackoverflow.com/posts/77428873/edit\">edit</a> the testcase and the full error, including traceback, into your question? Without them, it might be hard to tell what exactly caused the error. Be sure to add a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, containing the least possible code that raises your error."}],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1699276857,"post_id":77429521,"comment_id":136507296,"body_markdown":"Edge works now following recent update","link":"https://stackoverflow.com/questions/77428873/unknown-error-result-webdrivervalue-value-list-is-missing-or-empty-in-runtime-c/77429521#comment136507296_77429521","body":"Edge works now following recent update"}],"comment_count":1,"score":4,"last_activity_date":1699435492,"last_edit_date":1699435492,"creation_date":1699256973,"answer_id":77429521,"question_id":77428873,"body_markdown":"I&#39;m still unsure of the issue, it&#39;s currently only happening in my Edge browser on version 119 due to previous usage. I have changed from EdgeDriver **to Chrome/ChromeDriver**, this might initalize new sessions or builds what helps:\r\n\r\n- Chrome v119\r\n- Selenium.WebDriver v4.12.4\r\n- WebDriverManager for automatic download of ChromeDriver\r\n\r\n**update**\r\n\r\nI&#39;ve updated my WebDriverManager to download the matching driver for v119 in Edge - now the problem is fixed:\r\n\r\n    new DriverManager().SetUpDriver(new EdgeConfig(), VersionResolveStrategy.MatchingBrowser);","link":"https://stackoverflow.com/questions/77428873/unknown-error-result-webdrivervalue-value-list-is-missing-or-empty-in-runtime-c/77429521#77429521","title":"unknown error: result.webdriverValue.value list is missing or empty in Runtime.callFunctionOn response","body":"<p>I'm still unsure of the issue, it's currently only happening in my Edge browser on version 119 due to previous usage. I have changed from EdgeDriver <strong>to Chrome/ChromeDriver</strong>, this might initalize new sessions or builds what helps:</p>\n<ul>\n<li>Chrome v119</li>\n<li>Selenium.WebDriver v4.12.4</li>\n<li>WebDriverManager for automatic download of ChromeDriver</li>\n</ul>\n<p><strong>update</strong></p>\n<p>I've updated my WebDriverManager to download the matching driver for v119 in Edge - now the problem is fixed:</p>\n<pre><code>new DriverManager().SetUpDriver(new EdgeConfig(), VersionResolveStrategy.MatchingBrowser);\n</code></pre>\n"},{"comments":[{"score":0,"post_type":"answer","creation_date":1699265446,"post_id":77429720,"comment_id":136505271,"body_markdown":"Seems to affect Edge as well. After updating the browser to version 119.0.2151.44 I needed to install a new Microsoft Edge WebDriver too.","link":"https://stackoverflow.com/questions/77428873/unknown-error-result-webdrivervalue-value-list-is-missing-or-empty-in-runtime-c/77429720#comment136505271_77429720","body":"Seems to affect Edge as well. After updating the browser to version 119.0.2151.44 I needed to install a new Microsoft Edge WebDriver too."},{"score":0,"post_type":"answer","creation_date":1699284912,"post_id":77429720,"comment_id":136509131,"body_markdown":"For me the issue was when we called driver.Title, caused this exception when we had Chrome 119 and Chromedriver 118.  Upgrading too 119 driver fixed it, but breaks our understanding that 1 version back was always acceptable with the driver.","link":"https://stackoverflow.com/questions/77428873/unknown-error-result-webdrivervalue-value-list-is-missing-or-empty-in-runtime-c/77429720#comment136509131_77429720","body":"For me the issue was when we called driver.Title, caused this exception when we had Chrome 119 and Chromedriver 118.  Upgrading too 119 driver fixed it, but breaks our understanding that 1 version back was always acceptable with the driver."}],"comment_count":2,"score":11,"last_activity_date":1699259273,"creation_date":1699259273,"answer_id":77429720,"question_id":77428873,"body_markdown":"I think this is a generic message that the session cannot be created, previously SessionNotCreated exception https://stackoverflow.com/questions/75140505/how-to-address-sessionnotcreatedexception-with-latest-chromedriver-exe.   \r\nI updated both the ChromeDriver and the Chrome on the machine with the latest versions available (119) and the issue is gone. Before the update I had Selenium.Webdriver.Chromedriver\\119.0.6045.10500 and chrome version 118.\r\n\r\nSelenium team has closed the connected issue.   \r\nhttps://github.com/SeleniumHQ/selenium/issues/13081","link":"https://stackoverflow.com/questions/77428873/unknown-error-result-webdrivervalue-value-list-is-missing-or-empty-in-runtime-c/77429720#77429720","title":"unknown error: result.webdriverValue.value list is missing or empty in Runtime.callFunctionOn response","body":"<p>I think this is a generic message that the session cannot be created, previously SessionNotCreated exception <a href=\"https://stackoverflow.com/questions/75140505/how-to-address-sessionnotcreatedexception-with-latest-chromedriver-exe\">How to address SessionNotCreatedException with latest chromedriver.exe?</a>.<br />\nI updated both the ChromeDriver and the Chrome on the machine with the latest versions available (119) and the issue is gone. Before the update I had Selenium.Webdriver.Chromedriver\\119.0.6045.10500 and chrome version 118.</p>\n<p>Selenium team has closed the connected issue.<br />\n<a href=\"https://github.com/SeleniumHQ/selenium/issues/13081\" rel=\"noreferrer\">https://github.com/SeleniumHQ/selenium/issues/13081</a></p>\n"},{"comment_count":0,"score":0,"last_activity_date":1699344183,"creation_date":1699344183,"answer_id":77436457,"question_id":77428873,"body_markdown":"I use the Webdriver manager Nuget packet to load the latest driver. When I started debugging I found out that Webdriver Manager loaded Edge Driver 118 version instead of 119 (so the latest version at the moment detected wrong with the manager), and I changed browserVersion Strategy from Latest to MatchingBrowser. And the problem was solved.\r\n\r\nstring browserVersion = VersionResolveStrategy.MatchingBrowser;","link":"https://stackoverflow.com/questions/77428873/unknown-error-result-webdrivervalue-value-list-is-missing-or-empty-in-runtime-c/77436457#77436457","title":"unknown error: result.webdriverValue.value list is missing or empty in Runtime.callFunctionOn response","body":"<p>I use the Webdriver manager Nuget packet to load the latest driver. When I started debugging I found out that Webdriver Manager loaded Edge Driver 118 version instead of 119 (so the latest version at the moment detected wrong with the manager), and I changed browserVersion Strategy from Latest to MatchingBrowser. And the problem was solved.</p>\n<p>string browserVersion = VersionResolveStrategy.MatchingBrowser;</p>\n"},{"comments":[{"score":1,"post_type":"answer","creation_date":1699423735,"post_id":77436721,"comment_id":136528079,"body_markdown":"Updating my Chrome Driver to the latest version fixed it for me too. Thanks.","link":"https://stackoverflow.com/questions/77428873/unknown-error-result-webdrivervalue-value-list-is-missing-or-empty-in-runtime-c/77436721#comment136528079_77436721","body":"Updating my Chrome Driver to the latest version fixed it for me too. Thanks."}],"comment_count":1,"score":2,"last_activity_date":1699347011,"creation_date":1699347011,"answer_id":77436721,"question_id":77428873,"body_markdown":"**I had the same problem**\r\n\r\n    src.exception.exceptions.ScraperException: Message: unknown error: result.webdriverValue.value list is missing or empty in Runtime.callFunctionOn response\r\n\r\nmy tools were:\r\n\r\n    Google Chrome version: 119.0.6045.105\r\n    Chromedriver version: 118.0.5993.70\r\n\r\n    Chip: Apple M1\r\n\r\n\r\n\r\nThe solution for this was:\r\n\r\nI had to upgrade `Chromedriver version` to `119.0.6045.105`(Current Stable Version)","link":"https://stackoverflow.com/questions/77428873/unknown-error-result-webdrivervalue-value-list-is-missing-or-empty-in-runtime-c/77436721#77436721","title":"unknown error: result.webdriverValue.value list is missing or empty in Runtime.callFunctionOn response","body":"<p><strong>I had the same problem</strong></p>\n<pre><code>src.exception.exceptions.ScraperException: Message: unknown error: result.webdriverValue.value list is missing or empty in Runtime.callFunctionOn response\n</code></pre>\n<p>my tools were:</p>\n<pre><code>Google Chrome version: 119.0.6045.105\nChromedriver version: 118.0.5993.70\n\nChip: Apple M1\n</code></pre>\n<p>The solution for this was:</p>\n<p>I had to upgrade <code>Chromedriver version</code> to <code>119.0.6045.105</code>(Current Stable Version)</p>\n"},{"comment_count":0,"score":0,"last_activity_date":1699470597,"creation_date":1699470597,"answer_id":77448309,"question_id":77428873,"body_markdown":"For those who are seeing this issue on Edge for a previously working code, it started happening with the release of MS Edge browser on 119.0.2151.44 on Nov 2, 2023. One of the easy fixes is update the edge driver to be on the same version. It worked for me.","link":"https://stackoverflow.com/questions/77428873/unknown-error-result-webdrivervalue-value-list-is-missing-or-empty-in-runtime-c/77448309#77448309","title":"unknown error: result.webdriverValue.value list is missing or empty in Runtime.callFunctionOn response","body":"<p>For those who are seeing this issue on Edge for a previously working code, it started happening with the release of MS Edge browser on 119.0.2151.44 on Nov 2, 2023. One of the easy fixes is update the edge driver to be on the same version. It worked for me.</p>\n"},{"comment_count":0,"score":1,"last_activity_date":1701571587,"last_edit_date":1701571587,"creation_date":1699696027,"answer_id":77464592,"question_id":77428873,"body_markdown":"The same problem. I have updated the chromedriver version: 119.0.6045.105. It was solved!","link":"https://stackoverflow.com/questions/77428873/unknown-error-result-webdrivervalue-value-list-is-missing-or-empty-in-runtime-c/77464592#77464592","title":"unknown error: result.webdriverValue.value list is missing or empty in Runtime.callFunctionOn response","body":"<p>The same problem. I have updated the chromedriver version: 119.0.6045.105. It was solved!</p>\n"},{"comment_count":0,"score":1,"last_activity_date":1699869316,"creation_date":1699869316,"answer_id":77473013,"question_id":77428873,"body_markdown":"Your chromedriver was not compatible with your actual browser. You can update your chromedriver.exe from https://chromedriver.chromium.org/downloads , and make sure you have the same chromedriver and actual browser version.\r\n\r\nIf you are using the chromedriver 115 or newer, you can update it from &quot;Chrome for Testing Availability&quot; page.","link":"https://stackoverflow.com/questions/77428873/unknown-error-result-webdrivervalue-value-list-is-missing-or-empty-in-runtime-c/77473013#77473013","title":"unknown error: result.webdriverValue.value list is missing or empty in Runtime.callFunctionOn response","body":"<p>Your chromedriver was not compatible with your actual browser. You can update your chromedriver.exe from <a href=\"https://chromedriver.chromium.org/downloads\" rel=\"nofollow noreferrer\">https://chromedriver.chromium.org/downloads</a> , and make sure you have the same chromedriver and actual browser version.</p>\n<p>If you are using the chromedriver 115 or newer, you can update it from &quot;Chrome for Testing Availability&quot; page.</p>\n"}],"comment_count":3,"is_answered":true,"view_count":24518,"answer_count":7,"score":13,"last_activity_date":1701875265,"creation_date":1699247559,"last_edit_date":1701434773,"question_id":77428873,"body_markdown":"When running my testcase, I get this unknown error: \r\n\r\n```\r\nresult.webdriverValue.value list is missing or empty in Runtime.callFunctionOn response\r\n```\r\nI tried to find the correct driver without changing my browser version. My browser version is 119 and I took the same for the driver.","link":"https://stackoverflow.com/questions/77428873/unknown-error-result-webdrivervalue-value-list-is-missing-or-empty-in-runtime-c","title":"unknown error: result.webdriverValue.value list is missing or empty in Runtime.callFunctionOn response","body":"<p>When running my testcase, I get this unknown error:</p>\n<pre><code>result.webdriverValue.value list is missing or empty in Runtime.callFunctionOn response\n</code></pre>\n<p>I tried to find the correct driver without changing my browser version. My browser version is 119 and I took the same for the driver.</p>\n"},{"tags":["java","microsoft-graph-api","outlook-graph-api"],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1676363982,"post_id":75421065,"comment_id":133117081,"body_markdown":"Thanks @Barry for your suggestion. \nWe also have this as an option but its not giving like real-time feel. \nIf we are in a loop and performing some update then its expected to reflect at server side.\n\nWe have other option to handle this by updating our query with since datetime. \nLet&#39;s see","link":"https://stackoverflow.com/questions/75418889/fetch-list-of-messages-using-message-id-of-500-mails-using-java/75421065#comment133117081_75421065","body":"Thanks @Barry for your suggestion.  We also have this as an option but its not giving like real-time feel.  If we are in a loop and performing some update then its expected to reflect at server side.  We have other option to handle this by updating our query with since datetime.  Let&#39;s see"}],"comment_count":1,"score":0,"last_activity_date":1676127914,"creation_date":1676127914,"answer_id":75421065,"question_id":75418889,"body_markdown":"Might be better to scan your list first (cache up your updates), and then batch the updates together after you&#39;ve iterated the list. Aside from fixing your problem, probably more efficient as well. \r\n\r\nBarry Gervin","link":"https://stackoverflow.com/questions/75418889/fetch-list-of-messages-using-message-id-of-500-mails-using-java/75421065#75421065","title":"Fetch List of messages using message id of 500 mails using java","body":"<p>Might be better to scan your list first (cache up your updates), and then batch the updates together after you've iterated the list. Aside from fixing your problem, probably more efficient as well.</p>\n<p>Barry Gervin</p>\n"},{"comment_count":0,"score":0,"last_activity_date":1701874506,"last_edit_date":1701874506,"creation_date":1701869599,"answer_id":77613501,"question_id":75418889,"body_markdown":"you get a list of IDs with for example \r\n    \r\n\r\n    final MessageCollectionPage messagePage = graphClient.users().byId(bal).messages().buildRequest().top(10).select(&quot;subject,sentDateTime,internetMessageHeaders,internetMessageId&quot;).expand(&quot;singleValueExtendedProperties($filter=Id eq &#39;LONG 0x0E08&#39;)&quot;).get();\r\n\r\nthen you get and process the mails contents in parallel :\r\n\r\n    for (Message msg : messagePage.getCurrentPage()) {\r\n\tgraphClient.users().byId(bal).messages(msg.id).content().buildRequest().getAsync()\r\n\t\t.thenApply(inputStream -&gt; {\r\n\t\t\t(...process...)\r\n\t\t})\r\n\t\t.thenApply(o -&gt; {\r\n\t\t\t//delete mail\r\n\t\t\tgraphClient.users().byId(bal).messages(msg.id).buildRequest().delete();\r\n\t});\r\n    }\r\n\r\nIt should be faster.\r\n\r\n","link":"https://stackoverflow.com/questions/75418889/fetch-list-of-messages-using-message-id-of-500-mails-using-java/77613501#77613501","title":"Fetch List of messages using message id of 500 mails using java","body":"<p>you get a list of IDs with for example</p>\n<pre><code>final MessageCollectionPage messagePage = graphClient.users().byId(bal).messages().buildRequest().top(10).select(&quot;subject,sentDateTime,internetMessageHeaders,internetMessageId&quot;).expand(&quot;singleValueExtendedProperties($filter=Id eq 'LONG 0x0E08')&quot;).get();\n</code></pre>\n<p>then you get and process the mails contents in parallel :</p>\n<pre><code>for (Message msg : messagePage.getCurrentPage()) {\ngraphClient.users().byId(bal).messages(msg.id).content().buildRequest().getAsync()\n    .thenApply(inputStream -&gt; {\n        (...process...)\n    })\n    .thenApply(o -&gt; {\n        //delete mail\n        graphClient.users().byId(bal).messages(msg.id).buildRequest().delete();\n});\n}\n</code></pre>\n<p>It should be faster.</p>\n"}],"comment_count":0,"is_answered":false,"view_count":77,"answer_count":2,"score":0,"last_activity_date":1701874506,"creation_date":1676103236,"last_edit_date":1676104868,"question_id":75418889,"body_markdown":"As per documentation we have two ways to fetch mails using Graph api.\r\n1) Using $filter with .top(int ) we can fetch list of messages.\r\n2) Using message id we can fetch a single mail.\r\n\r\nI have 50000 mails in my folder. I am using pageSize=500.Its working fine.\r\nNow I also want to move/delete/change status of a mail based on some criteria.\r\n\r\nAfter performing update operation(move/delete/change status) my next page is getting disturbed. Its skipping few mail because in next page top is used.\r\n\r\nFor example : I have 25 mails in folder, I am using $filter with page size=3, top(3) so that only 15 mails are eligible for filtration. Now in each page I am getting 3 mails.\r\n\r\nNow when I apply any update operation , after that I am not getting expected mails in next page. Some mails are getting skipped.\r\n\r\nAny idea how we can over come this?\r\n\r\nMY APPROACH: Fetch all message ids and keeping it in my cache.\r\nFrom next time onwards, I am using these message ids and fetching mails one by one.\r\n\r\nNow the issue is that fetching 500 mails one by one is hitting performance badly. \r\nDo we have any api where we can send list of message ids and get List of messages?\r\n\r\nOr\r\n\r\nDo we have any settings such that next page fetching query will start from exactly next item.\r\n\r\n\r\n \r\n\r\n\r\n\r\n\r\n","link":"https://stackoverflow.com/questions/75418889/fetch-list-of-messages-using-message-id-of-500-mails-using-java","title":"Fetch List of messages using message id of 500 mails using java","body":"<p>As per documentation we have two ways to fetch mails using Graph api.</p>\n<ol>\n<li>Using $filter with .top(int ) we can fetch list of messages.</li>\n<li>Using message id we can fetch a single mail.</li>\n</ol>\n<p>I have 50000 mails in my folder. I am using pageSize=500.Its working fine.\nNow I also want to move/delete/change status of a mail based on some criteria.</p>\n<p>After performing update operation(move/delete/change status) my next page is getting disturbed. Its skipping few mail because in next page top is used.</p>\n<p>For example : I have 25 mails in folder, I am using $filter with page size=3, top(3) so that only 15 mails are eligible for filtration. Now in each page I am getting 3 mails.</p>\n<p>Now when I apply any update operation , after that I am not getting expected mails in next page. Some mails are getting skipped.</p>\n<p>Any idea how we can over come this?</p>\n<p>MY APPROACH: Fetch all message ids and keeping it in my cache.\nFrom next time onwards, I am using these message ids and fetching mails one by one.</p>\n<p>Now the issue is that fetching 500 mails one by one is hitting performance badly.\nDo we have any api where we can send list of message ids and get List of messages?</p>\n<p>Or</p>\n<p>Do we have any settings such that next page fetching query will start from exactly next item.</p>\n"},{"tags":["java","amazon-web-services","amazon-s3","bouncycastle","java-17"],"answers":[{"comment_count":0,"score":0,"last_activity_date":1701871377,"creation_date":1701871377,"answer_id":77613731,"question_id":77499601,"body_markdown":"This seems related to spring fat jar and jdk 17\r\nhttps://bugs.java.com/bugdatabase/view_bug?bug_id=JDK-8313742","link":"https://stackoverflow.com/questions/77499601/most-recent-version-of-bouncy-castle-is-required-for-authentication-error/77613731#77613731","title":"most recent version of bouncy castle is required for Authentication error","body":"<p>This seems related to spring fat jar and jdk 17\n<a href=\"https://bugs.java.com/bugdatabase/view_bug?bug_id=JDK-8313742\" rel=\"nofollow noreferrer\">https://bugs.java.com/bugdatabase/view_bug?bug_id=JDK-8313742</a></p>\n"}],"comment_count":0,"is_answered":false,"view_count":65,"answer_count":1,"score":0,"last_activity_date":1701871377,"creation_date":1700200621,"question_id":77499601,"body_markdown":"\r\nEverything works fine on my local but when I deploy on AWS ECS fargate . I am getting this error while trying to migrate from JDK 11 to JDK 17 . I have updated to recenet versions of aws-java-sdk as well as bouncy castle. \r\nHow can I fix this issue?\r\n\r\n```\r\nException in thread &quot;main&quot; java.lang.UnsupportedOperationException: A more recent version of Bouncy castle is required for authenticated encryption.\r\nat com.amazonaws.services.s3.model.CryptoConfigurationV2.checkBountyCastle(CryptoConfigurationV2.java:379)\r\n\tat com.amazonaws.services.s3.model.CryptoConfigurationV2.checkCryptoMode(CryptoConfigurationV2.java:366)\r\n\tat com.amazonaws.services.s3.model.CryptoConfigurationV2.&lt;init&gt;(CryptoConfigurationV2.java:68)\r\n\tat com.amazonaws.services.s3.model.CryptoConfigurationV2.&lt;init&gt;(CryptoConfigurationV2.java:47)\r\n```\r\n\r\n\r\nI have tried updating all the maven libraries including onces involved here aws-java-sdk version 1.12.552\r\n\r\n and bouncy castle bcprov and bcpkix with versions bcpkix-jdk18on-177.jar and bcpkix-jdk15to18-177.jar.","link":"https://stackoverflow.com/questions/77499601/most-recent-version-of-bouncy-castle-is-required-for-authentication-error","title":"most recent version of bouncy castle is required for Authentication error","body":"<p>Everything works fine on my local but when I deploy on AWS ECS fargate . I am getting this error while trying to migrate from JDK 11 to JDK 17 . I have updated to recenet versions of aws-java-sdk as well as bouncy castle.\nHow can I fix this issue?</p>\n<pre><code>Exception in thread &quot;main&quot; java.lang.UnsupportedOperationException: A more recent version of Bouncy castle is required for authenticated encryption.\nat com.amazonaws.services.s3.model.CryptoConfigurationV2.checkBountyCastle(CryptoConfigurationV2.java:379)\n    at com.amazonaws.services.s3.model.CryptoConfigurationV2.checkCryptoMode(CryptoConfigurationV2.java:366)\n    at com.amazonaws.services.s3.model.CryptoConfigurationV2.&lt;init&gt;(CryptoConfigurationV2.java:68)\n    at com.amazonaws.services.s3.model.CryptoConfigurationV2.&lt;init&gt;(CryptoConfigurationV2.java:47)\n</code></pre>\n<p>I have tried updating all the maven libraries including onces involved here aws-java-sdk version 1.12.552</p>\n<p>and bouncy castle bcprov and bcpkix with versions bcpkix-jdk18on-177.jar and bcpkix-jdk15to18-177.jar.</p>\n"},{"tags":["java","minecraft"],"comments":[{"score":0,"post_type":"question","creation_date":1701790640,"post_id":77576598,"comment_id":136817611,"body_markdown":"Have you tried cancelling the event? This will remove the interaction animation, and destroy your block instantly. This might be a solution if you really just want it gone - and not get all that fancy animation stuff :)","link":"https://stackoverflow.com/questions/77576598/cant-destroy-oak-button#comment136817611_77576598","body":"Have you tried cancelling the event? This will remove the interaction animation, and destroy your block instantly. This might be a solution if you really just want it gone - and not get all that fancy animation stuff :)"},{"score":0,"post_type":"question","creation_date":1701890492,"post_id":77576598,"comment_id":136832186,"body_markdown":"how? I&#39;m very new to plugins and java","link":"https://stackoverflow.com/questions/77576598/cant-destroy-oak-button#comment136832186_77576598","body":"how? I&#39;m very new to plugins and java"},{"score":0,"post_type":"question","creation_date":1701890798,"post_id":77576598,"comment_id":136832248,"body_markdown":"Cancelling the event works with `event.setCancelled(true)`, then you can remove the block. Just do a quick google how that works :)","link":"https://stackoverflow.com/questions/77576598/cant-destroy-oak-button#comment136832248_77576598","body":"Cancelling the event works with <code>event.setCancelled(true)</code>, then you can remove the block. Just do a quick google how that works :)"}],"comment_count":3,"is_answered":false,"view_count":38,"answer_count":0,"score":0,"last_activity_date":1701870784,"creation_date":1701329385,"last_edit_date":1701870784,"question_id":77576598,"body_markdown":"When I click onto an oak button, it want to destroy the oak button and the coal block below. But instead, this happens:\r\n\r\n[![minecraft image][1]][1]\r\n\r\nAlso, `getDrops().clear()` doesn&#39;t work, as there still are drops.\r\n\r\nHere&#39;s my code:\r\n\r\n```\r\npackage me.doshicshow.mycustomitems;\r\n\r\nimport org.bukkit.Location;\r\nimport org.bukkit.Material;\r\nimport org.bukkit.event.EventHandler;\r\nimport org.bukkit.event.Listener;\r\nimport org.bukkit.event.player.PlayerInteractEvent;\r\nimport org.bukkit.plugin.java.JavaPlugin;\r\nimport org.bukkit.event.block.BlockPlaceEvent;\r\nimport org.bukkit.block.BlockFace;\r\nimport org.bukkit.block.Block;\r\nimport java.util.logging.Logger;\r\n\r\npublic class Customitems extends JavaPlugin implements Listener {\r\n    private static Logger log = Logger.getLogger(&quot;Minecraft&quot;);\r\n    @Override\r\n    public void onEnable() {\r\n        getServer().getPluginManager().registerEvents(this, this);\r\n    }\r\n\r\n    @EventHandler\r\n    public void onPlayerInteract(PlayerInteractEvent event) {\r\n        if (event.getClickedBlock() != null &amp;&amp; event.getClickedBlock().getType() == Material.OAK_BUTTON &amp;&amp; event.getClickedBlock().getRelative(BlockFace.DOWN).getType() == Material.COAL_BLOCK) {\r\n            log.info(String.format(&quot;Found object %s&quot;, event.getClickedBlock()));\r\n            event.getClickedBlock().breakNaturally();\r\n            event.getClickedBlock().getDrops().clear();\r\n            event.getClickedBlock().getRelative(BlockFace.DOWN).getDrops().clear();\r\n            event.getClickedBlock().getRelative(BlockFace.DOWN).breakNaturally();\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nIt should destroy the oak button and the coal (the coal doesn&#39;t need to drop anything). What could I do to achieve this?\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/IDI4E.jpg","link":"https://stackoverflow.com/questions/77576598/cant-destroy-oak-button","title":"Cant destroy oak button","body":"<p>When I click onto an oak button, it want to destroy the oak button and the coal block below. But instead, this happens:</p>\n<p><a href=\"https://i.stack.imgur.com/IDI4E.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IDI4E.jpg\" alt=\"minecraft image\" /></a></p>\n<p>Also, <code>getDrops().clear()</code> doesn't work, as there still are drops.</p>\n<p>Here's my code:</p>\n<pre><code>package me.doshicshow.mycustomitems;\n\nimport org.bukkit.Location;\nimport org.bukkit.Material;\nimport org.bukkit.event.EventHandler;\nimport org.bukkit.event.Listener;\nimport org.bukkit.event.player.PlayerInteractEvent;\nimport org.bukkit.plugin.java.JavaPlugin;\nimport org.bukkit.event.block.BlockPlaceEvent;\nimport org.bukkit.block.BlockFace;\nimport org.bukkit.block.Block;\nimport java.util.logging.Logger;\n\npublic class Customitems extends JavaPlugin implements Listener {\n    private static Logger log = Logger.getLogger(&quot;Minecraft&quot;);\n    @Override\n    public void onEnable() {\n        getServer().getPluginManager().registerEvents(this, this);\n    }\n\n    @EventHandler\n    public void onPlayerInteract(PlayerInteractEvent event) {\n        if (event.getClickedBlock() != null &amp;&amp; event.getClickedBlock().getType() == Material.OAK_BUTTON &amp;&amp; event.getClickedBlock().getRelative(BlockFace.DOWN).getType() == Material.COAL_BLOCK) {\n            log.info(String.format(&quot;Found object %s&quot;, event.getClickedBlock()));\n            event.getClickedBlock().breakNaturally();\n            event.getClickedBlock().getDrops().clear();\n            event.getClickedBlock().getRelative(BlockFace.DOWN).getDrops().clear();\n            event.getClickedBlock().getRelative(BlockFace.DOWN).breakNaturally();\n        }\n    }\n}\n</code></pre>\n<p>It should destroy the oak button and the coal (the coal doesn't need to drop anything). What could I do to achieve this?</p>\n"},{"tags":["java","elasticsearch","spring-data-elasticsearch"],"answers":[{"comment_count":0,"score":0,"last_activity_date":1689699128,"creation_date":1689699128,"answer_id":76715007,"question_id":76713614,"body_markdown":"You can find examples in the test code of Spring Data Elasticsearch, for example at https://github.com/spring-projects/spring-data-elasticsearch/blob/main/src/test/java/org/springframework/data/elasticsearch/client/elc/CriteriaQueryProcessorUnitTests.java#L167-L309\r\n\r\nFrom one of the tests which creates ((John or Jack) and Miller) or ((Emma or Lucy) and Smith):\r\n\r\n```java\r\n\t\tCriteria criteria = Criteria.or()\r\n\t\t\t\t.subCriteria(new Criteria(&quot;lastName&quot;).is(&quot;Miller&quot;)\r\n\t\t\t\t\t\t.subCriteria(new Criteria().or(&quot;firstName&quot;).is(&quot;John&quot;).or(&quot;firstName&quot;).is(&quot;Jack&quot;)))\r\n\t\t\t\t.subCriteria(new Criteria(&quot;lastName&quot;).is(&quot;Smith&quot;)\r\n\t\t\t\t\t\t.subCriteria(new Criteria().or(&quot;firstName&quot;).is(&quot;Emma&quot;).or(&quot;firstName&quot;).is(&quot;Lucy&quot;)));\r\n```","link":"https://stackoverflow.com/questions/76713614/spring-data-elasticsearch-how-to-combine-and-or-with-criteriaquery/76715007#76715007","title":"spring-data-elasticsearch: how to combine and &amp; or with CriteriaQuery","body":"<p>You can find examples in the test code of Spring Data Elasticsearch, for example at <a href=\"https://github.com/spring-projects/spring-data-elasticsearch/blob/main/src/test/java/org/springframework/data/elasticsearch/client/elc/CriteriaQueryProcessorUnitTests.java#L167-L309\" rel=\"nofollow noreferrer\">https://github.com/spring-projects/spring-data-elasticsearch/blob/main/src/test/java/org/springframework/data/elasticsearch/client/elc/CriteriaQueryProcessorUnitTests.java#L167-L309</a></p>\n<p>From one of the tests which creates ((John or Jack) and Miller) or ((Emma or Lucy) and Smith):</p>\n<pre class=\"lang-java prettyprint-override\"><code>        Criteria criteria = Criteria.or()\n                .subCriteria(new Criteria(&quot;lastName&quot;).is(&quot;Miller&quot;)\n                        .subCriteria(new Criteria().or(&quot;firstName&quot;).is(&quot;John&quot;).or(&quot;firstName&quot;).is(&quot;Jack&quot;)))\n                .subCriteria(new Criteria(&quot;lastName&quot;).is(&quot;Smith&quot;)\n                        .subCriteria(new Criteria().or(&quot;firstName&quot;).is(&quot;Emma&quot;).or(&quot;firstName&quot;).is(&quot;Lucy&quot;)));\n</code></pre>\n"},{"comment_count":0,"score":0,"last_activity_date":1701870419,"creation_date":1701870419,"answer_id":77613609,"question_id":76713614,"body_markdown":"You can use 3 subcriteria\r\n\r\n(a = 1 AND b = 2 ):\r\n\r\n    Criteria subcriteria_1_2 = new Criteria(&quot;a&quot;).is(&quot;1&quot;).and(&quot;b&quot;).is(&quot;2&quot; );\r\n\r\n(a = 3 AND b = 43)\r\n\r\n    Criteria subcriteria_3_43 = new Criteria(&quot;a&quot;).is(&quot;3&quot;).and(&quot;b&quot;).is(&quot;43&quot;);\r\nMerged (a = 1 AND b = 2 ) OR (a = 3 AND b = 43)\r\n\r\n    Criteria subcriteria_1_2_3_43 = new Criteria().or().subCriteria(subcriteria_1_2).subCriteria(subcriteria_3_43);\r\n\r\nFinal connect with AND D = &#39;4234234&#39;\r\n\r\n    Criteria finalCriteria = new Criteria(&quot;d&quot;).is(&quot;4234234&quot;).subCriteria(subcriteria_1_2_3_43);\r\n\r\nThis construction will generate JSON (very simplified)\r\n```\r\n{\r\n  &quot;bool&quot; : {\r\n    &quot;must&quot; : [\r\n      {\r\n        &quot;query_string&quot; : {\r\n          &quot;query&quot; : &quot;4234234&quot;,\r\n          &quot;fields&quot; : [\r\n            &quot;d&quot;\r\n          ]\r\n        }\r\n      },\r\n      {\r\n        &quot;bool&quot; : {\r\n          &quot;should&quot; : [\r\n            {\r\n              &quot;bool&quot; : {\r\n                &quot;must&quot; : [\r\n                  {\r\n                    &quot;query_string&quot; : {\r\n                      &quot;query&quot; : &quot;1&quot;,\r\n                      &quot;fields&quot; : [\r\n                        &quot;a&quot;\r\n                      ]\r\n                    }\r\n                  },\r\n                  {\r\n                    &quot;query_string&quot; : {\r\n                      &quot;query&quot; : &quot;2&quot;,\r\n                      &quot;fields&quot; : [\r\n                        &quot;b&quot;\r\n                      ]\r\n                    }\r\n                  }\r\n                ],\r\n                &quot;adjust_pure_negative&quot; : true,\r\n                &quot;boost&quot; : 1.0\r\n              }\r\n            },\r\n            {\r\n              &quot;bool&quot; : {\r\n                &quot;must&quot; : [\r\n                  {\r\n                    &quot;query_string&quot; : {\r\n                      &quot;query&quot; : &quot;3&quot;,\r\n                      &quot;fields&quot; : [\r\n                        &quot;a&quot;\r\n                      ]\r\n                    }\r\n                  },\r\n                  {\r\n                    &quot;query_string&quot; : {\r\n                      &quot;query&quot; : &quot;43&quot;,\r\n                      &quot;fields&quot; : [\r\n                        &quot;b&quot;\r\n                      ]\r\n                    }\r\n                  }\r\n                ],\r\n                &quot;adjust_pure_negative&quot; : true,\r\n                &quot;boost&quot; : 1.0\r\n              }\r\n            }\r\n          ],\r\n          &quot;adjust_pure_negative&quot; : true,\r\n          &quot;boost&quot; : 1.0\r\n        }\r\n      }\r\n    ],\r\n    &quot;adjust_pure_negative&quot; : true,\r\n    &quot;boost&quot; : 1.0\r\n  }\r\n}\r\n```\r\nI recommend to not mix and() with or() in one chain. Use subcriteria. If you need to use subcriteria in one chain with field check, always put subcriteria to the end of chain. For example this construction will not work (at final, subcriteria will be erased)\r\n```\r\nnew Criteria(&quot;test&quot;).is(&quot;test_value&quot;).subCriteria(subcriteria_1_2_3_43).and(&quot;d&quot;).is(&quot;4234234&quot;);\r\n```\r\nBut if you put subcriteria to the end of chain it will work \r\n```\r\nnew Criteria(&quot;test&quot;).is(&quot;test_value&quot;).and(&quot;d&quot;).is(&quot;4234234&quot;).subCriteria(subcriteria_1_2_3_43);\r\n```\r\n\r\nThis is solution which i used in my own project","link":"https://stackoverflow.com/questions/76713614/spring-data-elasticsearch-how-to-combine-and-or-with-criteriaquery/77613609#77613609","title":"spring-data-elasticsearch: how to combine and &amp; or with CriteriaQuery","body":"<p>You can use 3 subcriteria</p>\n<p>(a = 1 AND b = 2 ):</p>\n<pre><code>Criteria subcriteria_1_2 = new Criteria(&quot;a&quot;).is(&quot;1&quot;).and(&quot;b&quot;).is(&quot;2&quot; );\n</code></pre>\n<p>(a = 3 AND b = 43)</p>\n<pre><code>Criteria subcriteria_3_43 = new Criteria(&quot;a&quot;).is(&quot;3&quot;).and(&quot;b&quot;).is(&quot;43&quot;);\n</code></pre>\n<p>Merged (a = 1 AND b = 2 ) OR (a = 3 AND b = 43)</p>\n<pre><code>Criteria subcriteria_1_2_3_43 = new Criteria().or().subCriteria(subcriteria_1_2).subCriteria(subcriteria_3_43);\n</code></pre>\n<p>Final connect with AND D = '4234234'</p>\n<pre><code>Criteria finalCriteria = new Criteria(&quot;d&quot;).is(&quot;4234234&quot;).subCriteria(subcriteria_1_2_3_43);\n</code></pre>\n<p>This construction will generate JSON (very simplified)</p>\n<pre><code>{\n  &quot;bool&quot; : {\n    &quot;must&quot; : [\n      {\n        &quot;query_string&quot; : {\n          &quot;query&quot; : &quot;4234234&quot;,\n          &quot;fields&quot; : [\n            &quot;d&quot;\n          ]\n        }\n      },\n      {\n        &quot;bool&quot; : {\n          &quot;should&quot; : [\n            {\n              &quot;bool&quot; : {\n                &quot;must&quot; : [\n                  {\n                    &quot;query_string&quot; : {\n                      &quot;query&quot; : &quot;1&quot;,\n                      &quot;fields&quot; : [\n                        &quot;a&quot;\n                      ]\n                    }\n                  },\n                  {\n                    &quot;query_string&quot; : {\n                      &quot;query&quot; : &quot;2&quot;,\n                      &quot;fields&quot; : [\n                        &quot;b&quot;\n                      ]\n                    }\n                  }\n                ],\n                &quot;adjust_pure_negative&quot; : true,\n                &quot;boost&quot; : 1.0\n              }\n            },\n            {\n              &quot;bool&quot; : {\n                &quot;must&quot; : [\n                  {\n                    &quot;query_string&quot; : {\n                      &quot;query&quot; : &quot;3&quot;,\n                      &quot;fields&quot; : [\n                        &quot;a&quot;\n                      ]\n                    }\n                  },\n                  {\n                    &quot;query_string&quot; : {\n                      &quot;query&quot; : &quot;43&quot;,\n                      &quot;fields&quot; : [\n                        &quot;b&quot;\n                      ]\n                    }\n                  }\n                ],\n                &quot;adjust_pure_negative&quot; : true,\n                &quot;boost&quot; : 1.0\n              }\n            }\n          ],\n          &quot;adjust_pure_negative&quot; : true,\n          &quot;boost&quot; : 1.0\n        }\n      }\n    ],\n    &quot;adjust_pure_negative&quot; : true,\n    &quot;boost&quot; : 1.0\n  }\n}\n</code></pre>\n<p>I recommend to not mix and() with or() in one chain. Use subcriteria. If you need to use subcriteria in one chain with field check, always put subcriteria to the end of chain. For example this construction will not work (at final, subcriteria will be erased)</p>\n<pre><code>new Criteria(&quot;test&quot;).is(&quot;test_value&quot;).subCriteria(subcriteria_1_2_3_43).and(&quot;d&quot;).is(&quot;4234234&quot;);\n</code></pre>\n<p>But if you put subcriteria to the end of chain it will work</p>\n<pre><code>new Criteria(&quot;test&quot;).is(&quot;test_value&quot;).and(&quot;d&quot;).is(&quot;4234234&quot;).subCriteria(subcriteria_1_2_3_43);\n</code></pre>\n<p>This is solution which i used in my own project</p>\n"}],"comment_count":0,"is_answered":false,"view_count":108,"answer_count":2,"score":0,"last_activity_date":1701870419,"creation_date":1689688987,"question_id":76713614,"body_markdown":"I have a document with 4 fields, for simplicity sake A, B, C and D.\r\nNow I&#39;m trying to build a CriteriaQuery where\r\n\r\n`((a = 1 AND b = 2 ) OR (a = 3 AND b = 43)) AND D = &#39;4234234&#39;\r\n`\r\nThe basic flow using by creating\r\n\r\n`new Criteria(&quot;a&quot;).is(1).and(&quot;b&quot;).is(2).and(&quot;d&quot;).is(&quot;4234234&quot;)`\r\n\r\nWorks fine.\r\n\r\nBut I&#39;m having trouble getting it working fine with the OR aspect.\r\n\r\nI thought\r\n```\r\nnew Criteria(&quot;d&quot;).is(&quot;4234234&quot;).and(new Criteria(&quot;a&quot;).is(1).and(&quot;b&quot;).is(2)).or(new Criteria(&quot;a&quot;).is(1).and(&quot;b&quot;).is(2))\r\n```\r\n\r\nbut thats leading to sharding erros.\r\n\r\nAnyone that could point me in the right way?","link":"https://stackoverflow.com/questions/76713614/spring-data-elasticsearch-how-to-combine-and-or-with-criteriaquery","title":"spring-data-elasticsearch: how to combine and &amp; or with CriteriaQuery","body":"<p>I have a document with 4 fields, for simplicity sake A, B, C and D.\nNow I'm trying to build a CriteriaQuery where</p>\n<p><code>((a = 1 AND b = 2 ) OR (a = 3 AND b = 43)) AND D = '4234234' </code>\nThe basic flow using by creating</p>\n<p><code>new Criteria(&quot;a&quot;).is(1).and(&quot;b&quot;).is(2).and(&quot;d&quot;).is(&quot;4234234&quot;)</code></p>\n<p>Works fine.</p>\n<p>But I'm having trouble getting it working fine with the OR aspect.</p>\n<p>I thought</p>\n<pre><code>new Criteria(&quot;d&quot;).is(&quot;4234234&quot;).and(new Criteria(&quot;a&quot;).is(1).and(&quot;b&quot;).is(2)).or(new Criteria(&quot;a&quot;).is(1).and(&quot;b&quot;).is(2))\n</code></pre>\n<p>but thats leading to sharding erros.</p>\n<p>Anyone that could point me in the right way?</p>\n"},{"tags":["java","jetty","apache-nifi","minify"],"comments":[{"score":0,"post_type":"question","creation_date":1701463487,"post_id":77576455,"comment_id":136783165,"body_markdown":"&quot;bad SNI&quot; means that your client and your server do not agree on the hostname for that server.  Can you detail how you are accessing your server? and how your server is setup (pay attention to your TLS certificate details, do not use IP addresses or `localhost` or `localdomain` style host names, as those are unsupported by java&#39;s TLS implementation)","link":"https://stackoverflow.com/questions/77576455/apache-nifi-2-x-org-eclipse-jetty-http-badmessageexception-400-invalid-sni#comment136783165_77576455","body":"&quot;bad SNI&quot; means that your client and your server do not agree on the hostname for that server.  Can you detail how you are accessing your server? and how your server is setup (pay attention to your TLS certificate details, do not use IP addresses or <code>localhost</code> or <code>localdomain</code> style host names, as those are unsupported by java&#39;s TLS implementation)"},{"score":0,"post_type":"question","creation_date":1701587718,"post_id":77576455,"comment_id":136792903,"body_markdown":"I have the same problem","link":"https://stackoverflow.com/questions/77576455/apache-nifi-2-x-org-eclipse-jetty-http-badmessageexception-400-invalid-sni#comment136792903_77576455","body":"I have the same problem"}],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1701770181,"post_id":77598024,"comment_id":136813894,"body_markdown":"As it’s currently written, your answer is unclear. Please [edit] to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","link":"https://stackoverflow.com/questions/77576455/apache-nifi-2-x-org-eclipse-jetty-http-badmessageexception-400-invalid-sni/77598024#comment136813894_77598024","body":"As it’s currently written, your answer is unclear. Please <a href=\"https://stackoverflow.com/posts/77598024/edit\">edit</a> to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"comment_count":1,"score":0,"last_activity_date":1701860771,"last_edit_date":1701860771,"creation_date":1701677687,"answer_id":77598024,"question_id":77576455,"body_markdown":"Jetty 10, which is included with NiFi 2.0.0-M1, incorporates updates to the Server Name Indication processing during the TLS handshake. As a result of these changes, the default behavior does not support accessing NiFi using an IP address. Using a hostname or DNS name will avoid the SNI error and allow standard TLS negotiation to work.\r\n\r\nMy issue got fixed once i accessed nifi with FQDN\r\n\r\n","link":"https://stackoverflow.com/questions/77576455/apache-nifi-2-x-org-eclipse-jetty-http-badmessageexception-400-invalid-sni/77598024#77598024","title":"Apache Nifi 2.x - org.eclipse.jetty.http.BadMessageException: 400: Invalid SNI","body":"<p>Jetty 10, which is included with NiFi 2.0.0-M1, incorporates updates to the Server Name Indication processing during the TLS handshake. As a result of these changes, the default behavior does not support accessing NiFi using an IP address. Using a hostname or DNS name will avoid the SNI error and allow standard TLS negotiation to work.</p>\n<p>My issue got fixed once i accessed nifi with FQDN</p>\n"}],"comment_count":2,"is_answered":false,"view_count":191,"answer_count":1,"score":1,"last_activity_date":1701860771,"creation_date":1701327547,"question_id":77576455,"body_markdown":"i was trying to upgrade NiFi to 2 from 1.24. while starting Nifi, service started and port 8443 is listening.But i am getting error 400 on web page\r\n\r\nFrom the web:\r\n\r\n```\r\nHTTP ERROR 400 Invalid SNI\r\nURI:\t/nifi\r\nSTATUS:\t400\r\nMESSAGE:\tInvalid SNI\r\nSERVLET:\t-\r\nCAUSED BY:\torg.eclipse.jetty.http.BadMessageException: 400: Invalid SNI\r\n\r\n\r\norg.eclipse.jetty.http.BadMessageException: 400: Invalid SNI\r\nat org.eclipse.jetty.server.SecureRequestCustomizer.customize(SecureRequestCustomizer.java:266)\r\n\tat org.eclipse.jetty.server.SecureRequestCustomizer.customize(SecureRequestCustomizer.java:207)\r\n\tat org.eclipse.jetty.server.HttpChannel$RequestDispatchable.dispatch(HttpChannel.java:1594)\r\n\tat org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:753)\r\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:501)\r\n\tat org.eclipse.jetty.server.HttpChannel.run(HttpChannel.java:461)\r\n\tat org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421)\r\n\tat org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390)\r\n\tat org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277)\r\n\tat org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.produce(AdaptiveExecutionStrategy.java:193)\r\n\tat org.eclipse.jetty.http2.HTTP2Connection.produce(HTTP2Connection.java:208)\r\n\tat org.eclipse.jetty.http2.HTTP2Connection.onFillable(HTTP2Connection.java:155)\r\n\tat org.eclipse.jetty.http2.HTTP2Connection$FillableCallback.succeeded(HTTP2Connection.java:450)\r\n\tat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100)\r\n\tat org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint.onFillable(SslConnection.java:558)\r\n\tat org.eclipse.jetty.io.ssl.SslConnection.onFillable(SslConnection.java:379)\r\n\tat org.eclipse.jetty.io.ssl.SslConnection$2.succeeded(SslConnection.java:146)\r\n\tat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100)\r\n\tat org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53)\r\n\tat org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421)\r\n\tat org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390)\r\n\tat org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277)\r\n\tat org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.run(AdaptiveExecutionStrategy.java:199)\r\n\tat org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:411)\r\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969)\r\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194)\r\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149)\r\n\tat java.base/java.lang.Thread.run(Thread.java:1583)\r\n\r\n```\r\n\r\n\r\nand from app.log\r\n\r\n```\r\n2023-11-30 09:56:46,456 WARN [NiFi Web Server-32] org.eclipse.jetty.server.HttpChannel handleException /nifi org.eclipse.jetty.http.BadMessageException: 400: Invalid SNI\r\n2023-11-30 09:56:46,527 WARN [NiFi Web Server-36] org.eclipse.jetty.server.HttpChannel handleException /favicon.ico org.eclipse.jetty.http.BadMessageException: 400: Invalid SNI\r\n\r\n\r\n```","link":"https://stackoverflow.com/questions/77576455/apache-nifi-2-x-org-eclipse-jetty-http-badmessageexception-400-invalid-sni","title":"Apache Nifi 2.x - org.eclipse.jetty.http.BadMessageException: 400: Invalid SNI","body":"<p>i was trying to upgrade NiFi to 2 from 1.24. while starting Nifi, service started and port 8443 is listening.But i am getting error 400 on web page</p>\n<p>From the web:</p>\n<pre><code>HTTP ERROR 400 Invalid SNI\nURI:    /nifi\nSTATUS: 400\nMESSAGE:    Invalid SNI\nSERVLET:    -\nCAUSED BY:  org.eclipse.jetty.http.BadMessageException: 400: Invalid SNI\n\n\norg.eclipse.jetty.http.BadMessageException: 400: Invalid SNI\nat org.eclipse.jetty.server.SecureRequestCustomizer.customize(SecureRequestCustomizer.java:266)\n    at org.eclipse.jetty.server.SecureRequestCustomizer.customize(SecureRequestCustomizer.java:207)\n    at org.eclipse.jetty.server.HttpChannel$RequestDispatchable.dispatch(HttpChannel.java:1594)\n    at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:753)\n    at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:501)\n    at org.eclipse.jetty.server.HttpChannel.run(HttpChannel.java:461)\n    at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421)\n    at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390)\n    at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277)\n    at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.produce(AdaptiveExecutionStrategy.java:193)\n    at org.eclipse.jetty.http2.HTTP2Connection.produce(HTTP2Connection.java:208)\n    at org.eclipse.jetty.http2.HTTP2Connection.onFillable(HTTP2Connection.java:155)\n    at org.eclipse.jetty.http2.HTTP2Connection$FillableCallback.succeeded(HTTP2Connection.java:450)\n    at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100)\n    at org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint.onFillable(SslConnection.java:558)\n    at org.eclipse.jetty.io.ssl.SslConnection.onFillable(SslConnection.java:379)\n    at org.eclipse.jetty.io.ssl.SslConnection$2.succeeded(SslConnection.java:146)\n    at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100)\n    at org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53)\n    at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421)\n    at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390)\n    at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277)\n    at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.run(AdaptiveExecutionStrategy.java:199)\n    at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:411)\n    at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969)\n    at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194)\n    at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149)\n    at java.base/java.lang.Thread.run(Thread.java:1583)\n\n</code></pre>\n<p>and from app.log</p>\n<pre><code>2023-11-30 09:56:46,456 WARN [NiFi Web Server-32] org.eclipse.jetty.server.HttpChannel handleException /nifi org.eclipse.jetty.http.BadMessageException: 400: Invalid SNI\n2023-11-30 09:56:46,527 WARN [NiFi Web Server-36] org.eclipse.jetty.server.HttpChannel handleException /favicon.ico org.eclipse.jetty.http.BadMessageException: 400: Invalid SNI\n\n\n</code></pre>\n"},{"tags":["javascript","java","angularjs","msal.js"],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1701857985,"post_id":77586803,"comment_id":136826119,"body_markdown":"Hi Batata,\nThank you for response. \nI am facing redirection url\nBelow are the steps I have used in my application. Let me know your suggestion","link":"https://stackoverflow.com/questions/77515505/how-to-integrate-msal-library-from-scratch-with-angular-js-1-x-application/77586803#comment136826119_77586803","body":"Hi Batata, Thank you for response.  I am facing redirection url Below are the steps I have used in my application. Let me know your suggestion"},{"score":0,"post_type":"answer","creation_date":1701957415,"post_id":77586803,"comment_id":136840914,"body_markdown":"@RanjanSingh I can&#39;t comment on your reply. But I&#39;m assuming it&#39;s redirecting to your login page because of this config option? `navigateToLoginRequestUrl: true`","link":"https://stackoverflow.com/questions/77515505/how-to-integrate-msal-library-from-scratch-with-angular-js-1-x-application/77586803#comment136840914_77586803","body":"@RanjanSingh I can&#39;t comment on your reply. But I&#39;m assuming it&#39;s redirecting to your login page because of this config option? <code>navigateToLoginRequestUrl: true</code>"},{"score":0,"post_type":"answer","creation_date":1701957775,"post_id":77586803,"comment_id":136840978,"body_markdown":"Or is it redirecting to login before the tokens are set? In my case when I login, the callback uri is added /#/code=... and the `otherwise` was forcing navigation at that point before processing the uri and setting the tokens.","link":"https://stackoverflow.com/questions/77515505/how-to-integrate-msal-library-from-scratch-with-angular-js-1-x-application/77586803#comment136840978_77586803","body":"Or is it redirecting to login before the tokens are set? In my case when I login, the callback uri is added /#/code=... and the <code>otherwise</code> was forcing navigation at that point before processing the uri and setting the tokens."},{"score":0,"post_type":"answer","creation_date":1702010518,"post_id":77586803,"comment_id":136847946,"body_markdown":"Yes its redirect to login page. I have added this navigateToLoginRequestUrl to capture the accessToken in $rootScope variable. \nthe library is not storing the token automatically in browserLocalStorage/sessionStorage. \nLet me know if you will get the solution for it","link":"https://stackoverflow.com/questions/77515505/how-to-integrate-msal-library-from-scratch-with-angular-js-1-x-application/77586803#comment136847946_77586803","body":"Yes its redirect to login page. I have added this navigateToLoginRequestUrl to capture the accessToken in $rootScope variable.  the library is not storing the token automatically in browserLocalStorage/sessionStorage.  Let me know if you will get the solution for it"},{"score":0,"post_type":"answer","creation_date":1702307403,"post_id":77586803,"comment_id":136877039,"body_markdown":"I think I&#39;m having a similar issue actually. But I&#39;m still working on solving other issues with this upgrade and will get to this soon.","link":"https://stackoverflow.com/questions/77515505/how-to-integrate-msal-library-from-scratch-with-angular-js-1-x-application/77586803#comment136877039_77586803","body":"I think I&#39;m having a similar issue actually. But I&#39;m still working on solving other issues with this upgrade and will get to this soon."},{"score":0,"post_type":"answer","creation_date":1702308304,"post_id":77586803,"comment_id":136877211,"body_markdown":"Sorry i can&#39;t edit comments, I meant to continue my comment:\n...and update you. You let me know too if you figure something out. Also, your setup is interesting. What version of MSAL are you using? Are you calling the `initialize()` somewhere? And are you using the msalService in your code to determine if you&#39;re authenticated? and regarding the navigation to login page, I&#39;m triggering `loginRedirect()` on a button click. So if the acquireToken() is triggering any of the redirect methods,that could be a reason? I haven&#39;t used angularjs much before, so I&#39;ve had some issues using async/await","link":"https://stackoverflow.com/questions/77515505/how-to-integrate-msal-library-from-scratch-with-angular-js-1-x-application/77586803#comment136877211_77586803","body":"Sorry i can&#39;t edit comments, I meant to continue my comment: ...and update you. You let me know too if you figure something out. Also, your setup is interesting. What version of MSAL are you using? Are you calling the <code>initialize()</code> somewhere? And are you using the msalService in your code to determine if you&#39;re authenticated? and regarding the navigation to login page, I&#39;m triggering <code>loginRedirect()</code> on a button click. So if the acquireToken() is triggering any of the redirect methods,that could be a reason? I haven&#39;t used angularjs much before, so I&#39;ve had some issues using async/await"},{"score":0,"post_type":"answer","creation_date":1702308746,"post_id":77586803,"comment_id":136877310,"body_markdown":"until I figured out using $q instead in combination of .then(). I have a different angular structure and using the msalService in urlRouterProvider func on the main app module definition to navigate to the login state if not auth, and if I am, an api resp determines transitionTo states. That&#39;s the first point of contact, so `$rootScope` won&#39;t be available for me, so I have to call one of the msal methods getActiveAccount() or getAllAccounts() to determine authentication state. Open for feedback if this isn&#39;t a great method with MSAL. But I&#39;m just working with this already existing old code.","link":"https://stackoverflow.com/questions/77515505/how-to-integrate-msal-library-from-scratch-with-angular-js-1-x-application/77586803#comment136877310_77586803","body":"until I figured out using $q instead in combination of .then(). I have a different angular structure and using the msalService in urlRouterProvider func on the main app module definition to navigate to the login state if not auth, and if I am, an api resp determines transitionTo states. That&#39;s the first point of contact, so <code>$rootScope</code> won&#39;t be available for me, so I have to call one of the msal methods getActiveAccount() or getAllAccounts() to determine authentication state. Open for feedback if this isn&#39;t a great method with MSAL. But I&#39;m just working with this already existing old code."},{"score":0,"post_type":"answer","creation_date":1702520915,"post_id":77586803,"comment_id":136907672,"body_markdown":"I replaced the MSAL library with Keycloak Authentication and connected to Azure AD via Keycloak. This change was necessary as we use more than three identity providers (Azure AD, Okta, etc.) for different customers. Keycloak offers the flexibility to connect with various identity providers. Now, the system is working smoothly, and we can successfully obtain the token after authentication. The flow is as follows:\nUI -&gt; KeyCloak -&gt; Azure AD :--- receive the token back in UI\nThank you for your assistance.","link":"https://stackoverflow.com/questions/77515505/how-to-integrate-msal-library-from-scratch-with-angular-js-1-x-application/77586803#comment136907672_77586803","body":"I replaced the MSAL library with Keycloak Authentication and connected to Azure AD via Keycloak. This change was necessary as we use more than three identity providers (Azure AD, Okta, etc.) for different customers. Keycloak offers the flexibility to connect with various identity providers. Now, the system is working smoothly, and we can successfully obtain the token after authentication. The flow is as follows: UI -&gt; KeyCloak -&gt; Azure AD :--- receive the token back in UI Thank you for your assistance."}],"comment_count":8,"score":0,"last_activity_date":1701485076,"last_edit_date":1701485076,"creation_date":1701448857,"answer_id":77586803,"question_id":77515505,"body_markdown":"I am actually in the process of doing so, and I&#39;m running into some issues with the redirect methods. The callback url after authenticating doesn&#39;t get handled, and I&#39;m in the process of figuring out why. Since I&#39;m using msal-browser, there might not be a way to do so and I have to do that manually? The code samples from the git repo is great and helps you understand the flow for the JS implementations, but I suspect that either angularjs 1.8 is doing something that might be affecting the callback, or maybe the angularjs hash &quot;#&quot; could be doing something too. I&#39;m not too sure. But here&#39;s the link to the code samples and in there you see lots of documentations. The relevant ones are msal-browser and msal-common. The msal-angular does not support angularjs, the minimum is v2.\r\n\r\nI&#39;m currently trying to implement it as a service using a factory, then I&#39;m trying to use that service in the main module config where I use urlRouterProvider.when(&#39;/&#39;) and in the controller. I haven&#39;t massaged out the full process yet as I&#39;m still in having a few issues. So I&#39;ll try to update this when I do!\r\n\r\n\r\n**Links:**\r\n[msal-browser][1]\r\n[samples][2]\r\n\r\n\r\n  [1]: https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/lib/msal-browser\r\n  [2]: https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-browser-samples\r\n\r\n\r\n**Update:**\r\n\r\nI don&#39;t know how helpful this update is, but I got the callback url to be processed and the issue is resolved when using the `loginRedirect()` (other things still to handle like tokens). I&#39;m not exactly sure how I did it, it&#39;s possible to be one or the combination of these things:\r\n- I added `http://localhost:3000/#` to the azure AD redirect uri. So now I have both with and without the &quot;#&quot;. And in the MSAL config object, I don&#39;t specify the redirectUri. (I have html5mode(false) btw, so it might be different for you).\r\n- I added scopes to the azure AD and used them instead of just using arbitrary ones that I took from the sample code like `[User.Read]`. I don&#39;t think this made a big difference, because if the scopes were wrong, it wouldn&#39;t like it and it shows you a message about it.\r\n- I added handling the events that get emitted from MSAL, inside the app module definition `.run()`, which I thought that fixed it, but it still works without them.\r\n\r\nI will take another look later and hopefully see what I did to get it to work, but you also might not run into this issue at all.","link":"https://stackoverflow.com/questions/77515505/how-to-integrate-msal-library-from-scratch-with-angular-js-1-x-application/77586803#77586803","title":"How to integrate MSAL library from scratch with Angular js 1.x application","body":"<p>I am actually in the process of doing so, and I'm running into some issues with the redirect methods. The callback url after authenticating doesn't get handled, and I'm in the process of figuring out why. Since I'm using msal-browser, there might not be a way to do so and I have to do that manually? The code samples from the git repo is great and helps you understand the flow for the JS implementations, but I suspect that either angularjs 1.8 is doing something that might be affecting the callback, or maybe the angularjs hash &quot;#&quot; could be doing something too. I'm not too sure. But here's the link to the code samples and in there you see lots of documentations. The relevant ones are msal-browser and msal-common. The msal-angular does not support angularjs, the minimum is v2.</p>\n<p>I'm currently trying to implement it as a service using a factory, then I'm trying to use that service in the main module config where I use urlRouterProvider.when('/') and in the controller. I haven't massaged out the full process yet as I'm still in having a few issues. So I'll try to update this when I do!</p>\n<p><strong>Links:</strong>\n<a href=\"https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/lib/msal-browser\" rel=\"nofollow noreferrer\">msal-browser</a>\n<a href=\"https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/samples/msal-browser-samples\" rel=\"nofollow noreferrer\">samples</a></p>\n<p><strong>Update:</strong></p>\n<p>I don't know how helpful this update is, but I got the callback url to be processed and the issue is resolved when using the <code>loginRedirect()</code> (other things still to handle like tokens). I'm not exactly sure how I did it, it's possible to be one or the combination of these things:</p>\n<ul>\n<li>I added <code>http://localhost:3000/#</code> to the azure AD redirect uri. So now I have both with and without the &quot;#&quot;. And in the MSAL config object, I don't specify the redirectUri. (I have html5mode(false) btw, so it might be different for you).</li>\n<li>I added scopes to the azure AD and used them instead of just using arbitrary ones that I took from the sample code like <code>[User.Read]</code>. I don't think this made a big difference, because if the scopes were wrong, it wouldn't like it and it shows you a message about it.</li>\n<li>I added handling the events that get emitted from MSAL, inside the app module definition <code>.run()</code>, which I thought that fixed it, but it still works without them.</li>\n</ul>\n<p>I will take another look later and hopefully see what I did to get it to work, but you also might not run into this issue at all.</p>\n"},{"comment_count":0,"score":0,"last_activity_date":1701859177,"creation_date":1701859177,"answer_id":77612346,"question_id":77515505,"body_markdown":"Thank you for response.\r\n\r\nI have to use MSAL Library with Multiple Identity Providers (Azure AD, Keycloak, Okta, DB Login)\r\n\r\nI&#39;m working on implementing authentication with multiple identity providers using the MSAL library in an AngularJS application. Currently, I&#39;m focusing on Azure AD. Here&#39;s an overview of the steps I&#39;ve taken and the issue I&#39;m facing:\r\n\r\n**Step 1: Route Configuration**\r\n\r\nI have set up a route configuration using $routeProvider.when(&#39;/&#39;) in my AngularJS application. When I access localhost:8080/abc, it correctly redirects to the login page.\r\n\r\n    mainApp.config(function($routeProvider) {\r\n    $routeProvider\r\n        .when(&quot;/login/&quot;, {\r\n            templateUrl: &quot;views/login.html&quot;,\r\n            controller: &quot;LoginController&quot;\r\n        })\r\n        .when(&quot;/logout/&quot;, {\r\n            templateUrl: &quot;views/logout.html&quot;,\r\n            controller: &quot;LogoutController&quot;\r\n        })\r\n        .when(&quot;/workbench/&quot;, {\r\n            templateUrl: &quot;views/workbench.html&quot;,\r\n            controller: &quot;WorkbenchController&quot;\r\n        })\r\n        .otherwise({\r\n            redirectTo: &quot;/login/&quot;\r\n        });\r\n    )}\r\n\r\n**Step 2: Redirect to Azure AD Login Page**\r\nUpon accessing localhost:8080/abc, there is a brief redirection to the login page, and then it automatically redirects to the Azure AD login page.\r\n\r\n    mainApp.service(&quot;msalService&quot;, [&quot;$q&quot;, function ($q) {\r\n    var msalConfig = {\r\n        auth: {\r\n            clientId: &quot;4bhy65sv-cde1-3939-rtfhf9-a2b7356789327645&quot;,\r\n            authority: &quot;https://login.microsoftonline.com/47582628-45982-4bb1-a3e5-583446725dsfdtjfdsbf&quot;,\r\n            redirectUri: &quot;http://localhost:8080/abc&quot;,\r\n            navigateToLoginRequestUrl: true,\r\n        },\r\n        cache: {\r\n            cacheLocation: &quot;localStorage&quot;,\r\n            storeAuthStateInCookie: true,\r\n        },\r\n    };\r\n\r\n    var myMSALObj = new msal.PublicClientApplication(msalConfig);\r\n\r\n    return {\r\n        acquireToken: function () {\r\n            var deferred = $q.defer();\r\n\r\n            myMSALObj.acquireTokenSilent({})\r\n                .then(function (tokenResponse) {\r\n                    deferred.resolve(tokenResponse);\r\n                })\r\n                .catch(function (error) {\r\n                    myMSALObj.acquireTokenRedirect({});\r\n                });\r\n\r\n                return deferred.promise;\r\n        },\r\n\r\n        logout: function () {\r\n            myMSALObj.logout();\r\n        },\r\n\r\n        handleRedirectPromise: function () {\r\n            return myMSALObj.handleRedirectPromise();\r\n        },\r\n    };\r\n    },]);\r\n\r\nHandle Redirect promise :-\r\n\r\n    mainApp.run(function (msalService, $location, $rootScope) {\r\n    msalService.handleRedirectPromise().then(function (response) {\r\n        if (response) {\r\n            console.log(&quot;Access token ---  &quot;, response.accessToken);\r\n            $rootScope.msalAccessToken = response.accessToken;\r\n        }\r\n    })\r\n    .catch(function (error) {\r\n        console.error(&quot;Redirect handling failed&quot;, error);\r\n    });\r\n    });\r\n\r\nMainController.js\r\n\r\n   \r\n\r\n     mainApp.controller(&quot;MainController&quot;, function ($scope, $rootScope, msalService, ) {\r\n        $scope.doApiRequest = function(){\r\n            msalService.acquireToken().then(function(tokenResponse){\r\n                console.log(&quot;Token acquired&quot;, token);\r\n            })\r\n            .catch(function(error){\r\n                console.error(&quot;Token acquisition failed&quot;, error);\r\n            });\r\n        }\r\n    \t\r\n    \t $scope.doApiRequest();\r\n    });\r\n\r\n**Step 3: Obtain Azure AD Token**\r\n\r\nI&#39;ve successfully used my Azure AD credentials to log in, obtained the token, and stored it in $rootScope. I&#39;ve set this token in the request header for subsequent requests.\r\n\r\nAuthentication Interceptor is also on the page where I definde the $routeProvider\r\n\r\n    mainApp.service(&#39;authenticationInterceptor&#39;, function($q, $rootScope, $location, $cookies, $injector) {\r\n        var service = this;\r\n        var msalAccessTokenPromise = $injector.get(&quot;msalService&quot;).handleRedirectPromise();\r\n    \r\n        service.responseError = function(response, status) {\r\n            if(!response.headers){\r\n                return $q.reject(response);\r\n            }\r\n    \r\n            // authorization.\r\n            if (response.headers(&#39;Reason-Code&#39;) == 401) {\r\n                $location.path(&#39;/unauthorized&#39;);\r\n                return;\r\n            } else if (response.config.url.indexOf(&#39;loginAuth&#39;) == -1 &amp;&amp; response.status == 401) {\r\n    \r\n                if (!$rootScope.loggedOutProcessed) {\r\n                    $rootScope.logoutApp();\r\n                    RemoveUser();\r\n                    RemoveUserImage();\r\n                    $rootScope.showMessage(&#39;Your current session has expired.. Please login again..!!&#39;, &#39;User Session Expired&#39;, false);\r\n                    $rootScope.loggedOutProcessed = true;\r\n                }\r\n                return;\r\n            }\r\n    \r\n    \r\n            return $q.reject(response);\r\n        };\r\n    \r\n        service.response = function(response) {\r\n            if (response != undefined &amp;&amp; response.headers != undefined &amp;&amp; response.headers(&#39;RedirectToSSOLogin&#39;) === &quot;true&quot;) {\r\n                //redirect to login page\r\n                window.location.href = appBaseUrl;\r\n            } else if (response != undefined &amp;&amp; response.headers != undefined &amp;&amp; response.headers(&#39;RedirectToDblogin&#39;) === &quot;true&quot;) {\r\n                    //redirect to login page\r\n                    $window.location.href = window.location.protocol + &quot;//&quot; + window.location.host + &quot;/abc/login/dblogin&quot;;\r\n            }  else {\r\n                return response;\r\n            }\r\n        };\r\n    \r\n        service.request = function(request) {\r\n            var ssoLoginEnabled = $rootScope.ssoLoginEnabled;\r\n            var dbLogin = $rootScope.dbLogin;\r\n            var authToken = $cookies.get(&quot;X-Auth-Token&quot;);\r\n            if (false &amp;&amp; ssoLoginEnabled &amp;&amp; !dbLogin &amp;&amp; !authToken) {\r\n    \r\n                window.location.href = appBaseUrl;\r\n                return request;\r\n                \r\n            } else {\r\n                return $q.when(msalAccessTokenPromise).then(function (response) {\r\n                    var msalAccessToken = response ? response.accessToken : $rootScope.msalAccessToken;\r\n                    if (msalAccessToken) {\r\n                        request.headers.Authorization = &quot;Bearer &quot; + msalAccessToken;\r\n                    }\r\n                    return request;\r\n                });\r\n            }\r\n        };\r\n    })\r\n    .config([&#39;$httpProvider&#39;, function($httpProvider) {\r\n        $httpProvider.interceptors.push(&#39;authenticationInterceptor&#39;);\r\n    }])\r\n        \r\n**Issue: Redirection to Application Login Page**\r\n\r\nAfter completing the login steps, the application redirects back to the login page. I&#39;m unsure why this is happening.\r\n\r\nI&#39;d appreciate any insights or suggestions on how to resolve this issue. Additionally, if you need more details or specific code snippets, please let me know.\r\n","link":"https://stackoverflow.com/questions/77515505/how-to-integrate-msal-library-from-scratch-with-angular-js-1-x-application/77612346#77612346","title":"How to integrate MSAL library from scratch with Angular js 1.x application","body":"<p>Thank you for response.</p>\n<p>I have to use MSAL Library with Multiple Identity Providers (Azure AD, Keycloak, Okta, DB Login)</p>\n<p>I'm working on implementing authentication with multiple identity providers using the MSAL library in an AngularJS application. Currently, I'm focusing on Azure AD. Here's an overview of the steps I've taken and the issue I'm facing:</p>\n<p><strong>Step 1: Route Configuration</strong></p>\n<p>I have set up a route configuration using $routeProvider.when('/') in my AngularJS application. When I access localhost:8080/abc, it correctly redirects to the login page.</p>\n<pre><code>mainApp.config(function($routeProvider) {\n$routeProvider\n    .when(&quot;/login/&quot;, {\n        templateUrl: &quot;views/login.html&quot;,\n        controller: &quot;LoginController&quot;\n    })\n    .when(&quot;/logout/&quot;, {\n        templateUrl: &quot;views/logout.html&quot;,\n        controller: &quot;LogoutController&quot;\n    })\n    .when(&quot;/workbench/&quot;, {\n        templateUrl: &quot;views/workbench.html&quot;,\n        controller: &quot;WorkbenchController&quot;\n    })\n    .otherwise({\n        redirectTo: &quot;/login/&quot;\n    });\n)}\n</code></pre>\n<p><strong>Step 2: Redirect to Azure AD Login Page</strong>\nUpon accessing localhost:8080/abc, there is a brief redirection to the login page, and then it automatically redirects to the Azure AD login page.</p>\n<pre><code>mainApp.service(&quot;msalService&quot;, [&quot;$q&quot;, function ($q) {\nvar msalConfig = {\n    auth: {\n        clientId: &quot;4bhy65sv-cde1-3939-rtfhf9-a2b7356789327645&quot;,\n        authority: &quot;https://login.microsoftonline.com/47582628-45982-4bb1-a3e5-583446725dsfdtjfdsbf&quot;,\n        redirectUri: &quot;http://localhost:8080/abc&quot;,\n        navigateToLoginRequestUrl: true,\n    },\n    cache: {\n        cacheLocation: &quot;localStorage&quot;,\n        storeAuthStateInCookie: true,\n    },\n};\n\nvar myMSALObj = new msal.PublicClientApplication(msalConfig);\n\nreturn {\n    acquireToken: function () {\n        var deferred = $q.defer();\n\n        myMSALObj.acquireTokenSilent({})\n            .then(function (tokenResponse) {\n                deferred.resolve(tokenResponse);\n            })\n            .catch(function (error) {\n                myMSALObj.acquireTokenRedirect({});\n            });\n\n            return deferred.promise;\n    },\n\n    logout: function () {\n        myMSALObj.logout();\n    },\n\n    handleRedirectPromise: function () {\n        return myMSALObj.handleRedirectPromise();\n    },\n};\n},]);\n</code></pre>\n<p>Handle Redirect promise :-</p>\n<pre><code>mainApp.run(function (msalService, $location, $rootScope) {\nmsalService.handleRedirectPromise().then(function (response) {\n    if (response) {\n        console.log(&quot;Access token ---  &quot;, response.accessToken);\n        $rootScope.msalAccessToken = response.accessToken;\n    }\n})\n.catch(function (error) {\n    console.error(&quot;Redirect handling failed&quot;, error);\n});\n});\n</code></pre>\n<p>MainController.js</p>\n<pre><code> mainApp.controller(&quot;MainController&quot;, function ($scope, $rootScope, msalService, ) {\n    $scope.doApiRequest = function(){\n        msalService.acquireToken().then(function(tokenResponse){\n            console.log(&quot;Token acquired&quot;, token);\n        })\n        .catch(function(error){\n            console.error(&quot;Token acquisition failed&quot;, error);\n        });\n    }\n    \n     $scope.doApiRequest();\n});\n</code></pre>\n<p><strong>Step 3: Obtain Azure AD Token</strong></p>\n<p>I've successfully used my Azure AD credentials to log in, obtained the token, and stored it in $rootScope. I've set this token in the request header for subsequent requests.</p>\n<p>Authentication Interceptor is also on the page where I definde the $routeProvider</p>\n<pre><code>mainApp.service('authenticationInterceptor', function($q, $rootScope, $location, $cookies, $injector) {\n    var service = this;\n    var msalAccessTokenPromise = $injector.get(&quot;msalService&quot;).handleRedirectPromise();\n\n    service.responseError = function(response, status) {\n        if(!response.headers){\n            return $q.reject(response);\n        }\n\n        // authorization.\n        if (response.headers('Reason-Code') == 401) {\n            $location.path('/unauthorized');\n            return;\n        } else if (response.config.url.indexOf('loginAuth') == -1 &amp;&amp; response.status == 401) {\n\n            if (!$rootScope.loggedOutProcessed) {\n                $rootScope.logoutApp();\n                RemoveUser();\n                RemoveUserImage();\n                $rootScope.showMessage('Your current session has expired.. Please login again..!!', 'User Session Expired', false);\n                $rootScope.loggedOutProcessed = true;\n            }\n            return;\n        }\n\n\n        return $q.reject(response);\n    };\n\n    service.response = function(response) {\n        if (response != undefined &amp;&amp; response.headers != undefined &amp;&amp; response.headers('RedirectToSSOLogin') === &quot;true&quot;) {\n            //redirect to login page\n            window.location.href = appBaseUrl;\n        } else if (response != undefined &amp;&amp; response.headers != undefined &amp;&amp; response.headers('RedirectToDblogin') === &quot;true&quot;) {\n                //redirect to login page\n                $window.location.href = window.location.protocol + &quot;//&quot; + window.location.host + &quot;/abc/login/dblogin&quot;;\n        }  else {\n            return response;\n        }\n    };\n\n    service.request = function(request) {\n        var ssoLoginEnabled = $rootScope.ssoLoginEnabled;\n        var dbLogin = $rootScope.dbLogin;\n        var authToken = $cookies.get(&quot;X-Auth-Token&quot;);\n        if (false &amp;&amp; ssoLoginEnabled &amp;&amp; !dbLogin &amp;&amp; !authToken) {\n\n            window.location.href = appBaseUrl;\n            return request;\n            \n        } else {\n            return $q.when(msalAccessTokenPromise).then(function (response) {\n                var msalAccessToken = response ? response.accessToken : $rootScope.msalAccessToken;\n                if (msalAccessToken) {\n                    request.headers.Authorization = &quot;Bearer &quot; + msalAccessToken;\n                }\n                return request;\n            });\n        }\n    };\n})\n.config(['$httpProvider', function($httpProvider) {\n    $httpProvider.interceptors.push('authenticationInterceptor');\n}])\n    \n</code></pre>\n<p><strong>Issue: Redirection to Application Login Page</strong></p>\n<p>After completing the login steps, the application redirects back to the login page. I'm unsure why this is happening.</p>\n<p>I'd appreciate any insights or suggestions on how to resolve this issue. Additionally, if you need more details or specific code snippets, please let me know.</p>\n"}],"comment_count":0,"is_answered":false,"view_count":67,"answer_count":2,"score":0,"last_activity_date":1701859177,"creation_date":1700479554,"last_edit_date":1701114397,"question_id":77515505,"body_markdown":"We build our application based on AngularJS v1.8.2 and Java as a backend. Currently we have used keyclock for MFA. We have implemented everything from the backend. \r\n\r\nNow we have to replace keycloak with MSAL. MSAL library does not support the Angular JS 1.x version. \r\n\r\nKindly help me to integrate MSAL into my application.\r\n\r\nI have already registered our application in Azure.\r\n\r\nThanks &amp; regards,\r\nRanjan Kumar Singh\r\n","link":"https://stackoverflow.com/questions/77515505/how-to-integrate-msal-library-from-scratch-with-angular-js-1-x-application","title":"How to integrate MSAL library from scratch with Angular js 1.x application","body":"<p>We build our application based on AngularJS v1.8.2 and Java as a backend. Currently we have used keyclock for MFA. We have implemented everything from the backend.</p>\n<p>Now we have to replace keycloak with MSAL. MSAL library does not support the Angular JS 1.x version.</p>\n<p>Kindly help me to integrate MSAL into my application.</p>\n<p>I have already registered our application in Azure.</p>\n<p>Thanks &amp; regards,\nRanjan Kumar Singh</p>\n"},{"tags":["java","postgresql","hibernate","jpa","liquibase"],"comments":[{"score":1,"post_type":"question","creation_date":1701337058,"post_id":77577333,"comment_id":136763941,"body_markdown":"You have both `@Enumerated` and a type. Which is it? Either use `@Enumerated` and make the value a `varchar` in the database. Or use a db enum and use the type. You are now mixing 2 strategies.","link":"https://stackoverflow.com/questions/77577333/springboot-failed-to-initialize-jpa-entitymanagerfactory-persistenceunit-def#comment136763941_77577333","body":"You have both <code>@Enumerated</code> and a type. Which is it? Either use <code>@Enumerated</code> and make the value a <code>varchar</code> in the database. Or use a db enum and use the type. You are now mixing 2 strategies."},{"score":0,"post_type":"question","creation_date":1701345587,"post_id":77577333,"comment_id":136765460,"body_markdown":"Tried removing the @Enumerated as well. Same issue is still coming. I noticed that in the error it says found [&quot;pet&quot;.&quot;pet_type&quot; (Types#VARCHAR)] but expecting [pet_type (Types#OTHER)] notice the in found it has pet schema but in expecteing schema is not. Does it have something to do with the issue.","link":"https://stackoverflow.com/questions/77577333/springboot-failed-to-initialize-jpa-entitymanagerfactory-persistenceunit-def#comment136765460_77577333","body":"Tried removing the @Enumerated as well. Same issue is still coming. I noticed that in the error it says found [&quot;pet&quot;.&quot;pet_type&quot; (Types#VARCHAR)] but expecting [pet_type (Types#OTHER)] notice the in found it has pet schema but in expecteing schema is not. Does it have something to do with the issue."},{"score":0,"post_type":"question","creation_date":1701445524,"post_id":77577333,"comment_id":136780262,"body_markdown":"what about `@ColumnTransformer(write = &quot;?::yours_enum_type&quot;)` on `PetType` have you tried yet ?","link":"https://stackoverflow.com/questions/77577333/springboot-failed-to-initialize-jpa-entitymanagerfactory-persistenceunit-def#comment136780262_77577333","body":"what about <code>@ColumnTransformer(write = &quot;?::yours_enum_type&quot;)</code> on <code>PetType</code> have you tried yet ?"}],"answers":[{"comment_count":0,"score":0,"last_activity_date":1701858340,"creation_date":1701858340,"answer_id":77612254,"question_id":77577333,"body_markdown":"The issue was missing privilege for the database user for `pet` schema.  ","link":"https://stackoverflow.com/questions/77577333/springboot-failed-to-initialize-jpa-entitymanagerfactory-persistenceunit-def/77612254#77612254","title":"SpringBoot: Failed to initialize JPA EntityManagerFactory: [PersistenceUnit: default] Unable to build Hibernate SessionFactory","body":"<p>The issue was missing privilege for the database user for <code>pet</code> schema.</p>\n"}],"comment_count":3,"is_answered":true,"view_count":51,"answer_count":1,"score":0,"last_activity_date":1701858340,"creation_date":1701336985,"question_id":77577333,"body_markdown":"In my Postgres database i have created the schema named pet and ran liquibase migration to create schema, tables and types but while starting my spring boot application.\r\n \r\n`Failed to initialize JPA EntityManagerFactory: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.tool.schema.spi.SchemaManagementException: Schema-validation: wrong column type encountered in column [pet_type] in table [pets]; found [&quot;pet&quot;.&quot;pet_type&quot; (Types#VARCHAR)], but expecting [pet_type (Types#OTHER)]`\r\n\r\n**PetEntity.java**\r\n```\r\n\t@Enumerated(EnumType.STRING)\r\n\t@Type(PostgreSQLEnumType.class)\r\n\t@Column(name = &quot;pet_type&quot;, nullable = false, columnDefinition = &quot;pet_type&quot;)\r\n\tprivate PetType petType;\r\n```\r\n\r\n**SQL**\r\n```\r\nCREATE TYPE pet_type AS ENUM (&#39;REPTILES&#39;, &#39;FERRETS&#39;);\r\n\r\nCREATE TABLE pets\r\n(\r\n    id                       UUID           NOT NULL,\r\n    pet_type                 PET_TYPE NOT NULL,\r\n);\r\n```\r\n\r\nin my spring boot this is the jpa configurations.\r\n```\r\n  jpa:\r\n    generate-ddl: true\r\n    hibernate:\r\n      ddl-auto: validate\r\n    properties:\r\n      hibernate:\r\n        dialect: org.hibernate.dialect.PostgreSQLDialect\r\n        default_schema: pet\r\n```\r\n\r\nurl: jdbc:postgresql://localhost:5432/postgres?currentSchema=pet&amp;stringtype=unspecified\r\n\r\nother information.\r\n**Postgres Version:** PostgreSQL 14.6 on aarch64-unknown-linux-gnu, compiled by aarch64-unknown-linux-gnu-gcc (GCC) 7.4.0, 64-bit\r\n**Java Version:** 17\r\n**Hibernate:** hypersistence-utils-hibernate-62 3.6.1\r\n\r\nHas anyone encountered this error before?\r\n\r\nTried changing @Column(name = &quot;pet_type&quot;, nullable = false, columnDefinition = &quot;pet_type&quot;) to @Column(name = &quot;pet_type&quot;, nullable = false, columnDefinition = &quot;pet.pet_type&quot;)","link":"https://stackoverflow.com/questions/77577333/springboot-failed-to-initialize-jpa-entitymanagerfactory-persistenceunit-def","title":"SpringBoot: Failed to initialize JPA EntityManagerFactory: [PersistenceUnit: default] Unable to build Hibernate SessionFactory","body":"<p>In my Postgres database i have created the schema named pet and ran liquibase migration to create schema, tables and types but while starting my spring boot application.</p>\n<p><code>Failed to initialize JPA EntityManagerFactory: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.tool.schema.spi.SchemaManagementException: Schema-validation: wrong column type encountered in column [pet_type] in table [pets]; found [&quot;pet&quot;.&quot;pet_type&quot; (Types#VARCHAR)], but expecting [pet_type (Types#OTHER)]</code></p>\n<p><strong>PetEntity.java</strong></p>\n<pre><code>    @Enumerated(EnumType.STRING)\n    @Type(PostgreSQLEnumType.class)\n    @Column(name = &quot;pet_type&quot;, nullable = false, columnDefinition = &quot;pet_type&quot;)\n    private PetType petType;\n</code></pre>\n<p><strong>SQL</strong></p>\n<pre><code>CREATE TYPE pet_type AS ENUM ('REPTILES', 'FERRETS');\n\nCREATE TABLE pets\n(\n    id                       UUID           NOT NULL,\n    pet_type                 PET_TYPE NOT NULL,\n);\n</code></pre>\n<p>in my spring boot this is the jpa configurations.</p>\n<pre><code>  jpa:\n    generate-ddl: true\n    hibernate:\n      ddl-auto: validate\n    properties:\n      hibernate:\n        dialect: org.hibernate.dialect.PostgreSQLDialect\n        default_schema: pet\n</code></pre>\n<p>url: jdbc:postgresql://localhost:5432/postgres?currentSchema=pet&amp;stringtype=unspecified</p>\n<p>other information.\n<strong>Postgres Version:</strong> PostgreSQL 14.6 on aarch64-unknown-linux-gnu, compiled by aarch64-unknown-linux-gnu-gcc (GCC) 7.4.0, 64-bit\n<strong>Java Version:</strong> 17\n<strong>Hibernate:</strong> hypersistence-utils-hibernate-62 3.6.1</p>\n<p>Has anyone encountered this error before?</p>\n<p>Tried changing @Column(name = &quot;pet_type&quot;, nullable = false, columnDefinition = &quot;pet_type&quot;) to @Column(name = &quot;pet_type&quot;, nullable = false, columnDefinition = &quot;pet.pet_type&quot;)</p>\n"},{"tags":["java","spring","spring-boot","spring-data-jpa","jackson"],"comments":[{"score":1,"post_type":"question","creation_date":1681829075,"post_id":76045913,"comment_id":134117828,"body_markdown":"@JsonIgnore is the correct one. I&#39;m using it too. What is wrong with it? The third one should also have the same effect.","link":"https://stackoverflow.com/questions/76045913/ignore-returned-fields-in-spring-boot-data-jpa-without-using-dtos-with-annotat#comment134117828_76045913","body":"@JsonIgnore is the correct one. I&#39;m using it too. What is wrong with it? The third one should also have the same effect."},{"score":0,"post_type":"question","creation_date":1681894841,"post_id":76045913,"comment_id":134129124,"body_markdown":"Both do not have any effect. Fields are still present in the response JSON. I&#39;m using Spring 3 but that shouldn&#39;t have changed anything?","link":"https://stackoverflow.com/questions/76045913/ignore-returned-fields-in-spring-boot-data-jpa-without-using-dtos-with-annotat#comment134129124_76045913","body":"Both do not have any effect. Fields are still present in the response JSON. I&#39;m using Spring 3 but that shouldn&#39;t have changed anything?"},{"score":0,"post_type":"question","creation_date":1681895991,"post_id":76045913,"comment_id":134129405,"body_markdown":"Nevermind... I send all request to the DEV server. Oh lord.","link":"https://stackoverflow.com/questions/76045913/ignore-returned-fields-in-spring-boot-data-jpa-without-using-dtos-with-annotat#comment134129405_76045913","body":"Nevermind... I send all request to the DEV server. Oh lord."}],"answers":[{"comment_count":0,"score":1,"last_activity_date":1681831305,"creation_date":1681831305,"answer_id":76046377,"question_id":76045913,"body_markdown":"To exclude the timestamp fields (createdAt, updatedAt, and deletedAt) from being returned, you can use the @JsonIgnoreProperties annotation at the class level.\r\n\r\nThat should work.\r\n\r\n    @JsonIgnoreProperties({&quot;createdAt&quot;, &quot;updatedAt&quot;, &quot;deletedAt&quot;})\r\n    public abstract class BaseEntity {\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.AUTO)\r\n    @Column(name = &quot;id&quot;, updatable = false, nullable = false)\r\n    private UUID id;\r\n\r\n    @CreatedDate\r\n    @Column(name = &quot;created_at&quot;, updatable = false)\r\n    private Date createdAt;\r\n\r\n    @LastModifiedDate\r\n    @Column(name = &quot;updated_at&quot;)\r\n    private Date updatedAt;\r\n\r\n    @Column(name = &quot;deleted_at&quot;)\r\n    private Date deletedAt;}","link":"https://stackoverflow.com/questions/76045913/ignore-returned-fields-in-spring-boot-data-jpa-without-using-dtos-with-annotat/76046377#76046377","title":"Ignore returned Fields in Spring Boot Data JPA without using DTOs / with annotations","body":"<p>To exclude the timestamp fields (createdAt, updatedAt, and deletedAt) from being returned, you can use the @JsonIgnoreProperties annotation at the class level.</p>\n<p>That should work.</p>\n<pre><code>@JsonIgnoreProperties({&quot;createdAt&quot;, &quot;updatedAt&quot;, &quot;deletedAt&quot;})\npublic abstract class BaseEntity {\n\n@Id\n@GeneratedValue(strategy = GenerationType.AUTO)\n@Column(name = &quot;id&quot;, updatable = false, nullable = false)\nprivate UUID id;\n\n@CreatedDate\n@Column(name = &quot;created_at&quot;, updatable = false)\nprivate Date createdAt;\n\n@LastModifiedDate\n@Column(name = &quot;updated_at&quot;)\nprivate Date updatedAt;\n\n@Column(name = &quot;deleted_at&quot;)\nprivate Date deletedAt;}\n</code></pre>\n"},{"comment_count":0,"score":1,"last_activity_date":1681843561,"creation_date":1681843561,"answer_id":76048079,"question_id":76045913,"body_markdown":"@JsonIgnoreProperties should work but you should use this annotation on subclass not base.\r\n\r\n    @JsonIgnoreProperties({&quot;createdAt&quot;, &quot;updatedAt&quot;, &quot;deletedAt&quot;})\r\n    public class SubClass extends BaseEntity\r\n    {\r\n     // const, set, get etc.\r\n    }\r\nAlso you can use Mix-ins with object mapper as described here -&gt;\r\n[Inheritance in Jackson][1]\r\n\r\n\r\n\r\n  [1]: https://www.baeldung.com/jackson-inheritance","link":"https://stackoverflow.com/questions/76045913/ignore-returned-fields-in-spring-boot-data-jpa-without-using-dtos-with-annotat/76048079#76048079","title":"Ignore returned Fields in Spring Boot Data JPA without using DTOs / with annotations","body":"<p>@JsonIgnoreProperties should work but you should use this annotation on subclass not base.</p>\n<pre><code>@JsonIgnoreProperties({&quot;createdAt&quot;, &quot;updatedAt&quot;, &quot;deletedAt&quot;})\npublic class SubClass extends BaseEntity\n{\n // const, set, get etc.\n}\n</code></pre>\n<p>Also you can use Mix-ins with object mapper as described here -&gt;\n<a href=\"https://www.baeldung.com/jackson-inheritance\" rel=\"nofollow noreferrer\">Inheritance in Jackson</a></p>\n"}],"comment_count":3,"is_answered":true,"view_count":1063,"answer_count":2,"score":0,"last_activity_date":1701856722,"creation_date":1681828598,"last_edit_date":1701856722,"question_id":76045913,"body_markdown":"How to ignore the 3 timestamp fields in my `BaseEntity` class used for inheritance from being returned by the controller.\r\n\r\n*Not returning them from the DB entirely would also be an option.\r\n\r\n```java\r\npublic abstract class BaseEntity {\r\n\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.AUTO)\r\n    @Column(name = &quot;id&quot;, updatable = false, nullable = false)\r\n    private UUID id;\r\n\r\n    @JsonIgnore\r\n    @CreatedDate\r\n    @Column(name = &quot;created_at&quot;, updatable = false)\r\n    private Date createdAt;\r\n\r\n    @JsonIgnore\r\n    @LastModifiedDate\r\n    @Column(name = &quot;updated_at&quot;)\r\n    private Date updatedAt;\r\n\r\n    @JsonIgnore\r\n    @JsonIgnore\r\n    @Column(name = &quot;deleted_at&quot;)\r\n    private Date deletedAt;\r\n\r\n}\r\n\r\n```\r\n\r\nAs you see, I tried using:\r\n\r\n - `@JsonIgnore` as field annotation (com.fasterxml.jackson.annotation.JsonIgnore)\r\n - `@JsonIgnoreProperties` as field annotation\r\n - `@JsonIgnoreProperties({&quot;createdAt&quot;, &quot;updatedAt&quot;, &quot;deletedAt&quot;})` as class annotation\r\n \r\n - Disabling `spring.jackson.serialization.FAIL_ON_EMPTY_BEANS`\r\n\r\n`@Transient` seems to be the wrong option for &quot;createdAt&quot; as this needs to be persistet.\r\n\r\n***edit***: I&#39;m using Spring 3 (spring-boot-starter-data-jpa:3.0.5)","link":"https://stackoverflow.com/questions/76045913/ignore-returned-fields-in-spring-boot-data-jpa-without-using-dtos-with-annotat","title":"Ignore returned Fields in Spring Boot Data JPA without using DTOs / with annotations","body":"<p>How to ignore the 3 timestamp fields in my <code>BaseEntity</code> class used for inheritance from being returned by the controller.</p>\n<p>*Not returning them from the DB entirely would also be an option.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public abstract class BaseEntity {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.AUTO)\n    @Column(name = &quot;id&quot;, updatable = false, nullable = false)\n    private UUID id;\n\n    @JsonIgnore\n    @CreatedDate\n    @Column(name = &quot;created_at&quot;, updatable = false)\n    private Date createdAt;\n\n    @JsonIgnore\n    @LastModifiedDate\n    @Column(name = &quot;updated_at&quot;)\n    private Date updatedAt;\n\n    @JsonIgnore\n    @JsonIgnore\n    @Column(name = &quot;deleted_at&quot;)\n    private Date deletedAt;\n\n}\n\n</code></pre>\n<p>As you see, I tried using:</p>\n<ul>\n<li><p><code>@JsonIgnore</code> as field annotation (com.fasterxml.jackson.annotation.JsonIgnore)</p>\n</li>\n<li><p><code>@JsonIgnoreProperties</code> as field annotation</p>\n</li>\n<li><p><code>@JsonIgnoreProperties({&quot;createdAt&quot;, &quot;updatedAt&quot;, &quot;deletedAt&quot;})</code> as class annotation</p>\n</li>\n<li><p>Disabling <code>spring.jackson.serialization.FAIL_ON_EMPTY_BEANS</code></p>\n</li>\n</ul>\n<p><code>@Transient</code> seems to be the wrong option for &quot;createdAt&quot; as this needs to be persistet.</p>\n<p><em><strong>edit</strong></em>: I'm using Spring 3 (spring-boot-starter-data-jpa:3.0.5)</p>\n"},{"tags":["java","maven","drools","kie"],"comments":[{"score":1,"post_type":"question","creation_date":1692710179,"post_id":76945330,"comment_id":135659038,"body_markdown":"DrlDumper was deprecated in 7.45.0, but the [javadocs](https://javadoc.io/doc/org.drools/drools-compiler/7.45.0.Final/index.html) don&#39;t indicate a substitute","link":"https://stackoverflow.com/questions/76945330/drldumper-not-found-on-upgrading-drools-compiler-version#comment135659038_76945330","body":"DrlDumper was deprecated in 7.45.0, but the <a href=\"https://javadoc.io/doc/org.drools/drools-compiler/7.45.0.Final/index.html\" rel=\"nofollow noreferrer\">javadocs</a> don&#39;t indicate a substitute"},{"score":0,"post_type":"question","creation_date":1692937129,"post_id":76945330,"comment_id":135695099,"body_markdown":"Is there any way I can generate a drl file with a similar method like drlDumper?","link":"https://stackoverflow.com/questions/76945330/drldumper-not-found-on-upgrading-drools-compiler-version#comment135695099_76945330","body":"Is there any way I can generate a drl file with a similar method like drlDumper?"}],"answers":[{"comment_count":0,"score":0,"last_activity_date":1701855444,"last_edit_date":1701855444,"creation_date":1701854580,"answer_id":77611837,"question_id":76945330,"body_markdown":"In 7.60+ `DrlDumper` is no longer part of the `drools-compiler` artifact and instead can be found in `drools-mvel`.\r\n\r\nThe java package has also moved to `org.drools.mvel`","link":"https://stackoverflow.com/questions/76945330/drldumper-not-found-on-upgrading-drools-compiler-version/77611837#77611837","title":"DrlDumper not found on upgrading drools-compiler version","body":"<p>In 7.60+ <code>DrlDumper</code> is no longer part of the <code>drools-compiler</code> artifact and instead can be found in <code>drools-mvel</code>.</p>\n<p>The java package has also moved to <code>org.drools.mvel</code></p>\n"}],"comment_count":2,"is_answered":false,"view_count":80,"answer_count":1,"score":0,"last_activity_date":1701855444,"creation_date":1692621393,"last_edit_date":1692622685,"question_id":76945330,"body_markdown":"I am changing my drools-compiler version from 7.40.0 to 7.60.0 but I am getting error that DrlDumper class not found.\r\nI am unable to use dump method which is used to generate the drl files as DrlDumper.dump() method is used to do that.\r\n\r\n\r\nHere is the code which used to create drl but not working on upgrading the drools-compiler and drools-core version:\r\n\r\n```\r\nString parsedRule = new DrlDumper().dump(packageDescrBuilder.getDescr());\r\n```\r\n","link":"https://stackoverflow.com/questions/76945330/drldumper-not-found-on-upgrading-drools-compiler-version","title":"DrlDumper not found on upgrading drools-compiler version","body":"<p>I am changing my drools-compiler version from 7.40.0 to 7.60.0 but I am getting error that DrlDumper class not found.\nI am unable to use dump method which is used to generate the drl files as DrlDumper.dump() method is used to do that.</p>\n<p>Here is the code which used to create drl but not working on upgrading the drools-compiler and drools-core version:</p>\n<pre><code>String parsedRule = new DrlDumper().dump(packageDescrBuilder.getDescr());\n</code></pre>\n"},{"tags":["java","archunit"],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1701837433,"post_id":77458434,"comment_id":136823525,"body_markdown":"I was aware of the freezing when writing this question but I thought it was needed to set up some external store. Turns out you can have a plaintext store checked in with your repo. This low setup is what I was searching for. Would you mind updating your answer to point this out?","link":"https://stackoverflow.com/questions/77458360/archunit-allow-limited-number-of-violations-for-ratcheting/77458434#comment136823525_77458434","body":"I was aware of the freezing when writing this question but I thought it was needed to set up some external store. Turns out you can have a plaintext store checked in with your repo. This low setup is what I was searching for. Would you mind updating your answer to point this out?"},{"score":0,"post_type":"answer","creation_date":1701848105,"post_id":77458434,"comment_id":136824500,"body_markdown":"I usually prefer to link information rather than duplicating it, as the redundant copy can get outdated, but well, if it helps the users... &#129335;‍♂️","link":"https://stackoverflow.com/questions/77458360/archunit-allow-limited-number-of-violations-for-ratcheting/77458434#comment136824500_77458434","body":"I usually prefer to link information rather than duplicating it, as the redundant copy can get outdated, but well, if it helps the users... 🤷‍♂️"}],"comment_count":2,"score":3,"last_activity_date":1701848027,"last_edit_date":1701848027,"creation_date":1699602979,"answer_id":77458434,"question_id":77458360,"body_markdown":"You can [freeze the existing violations](https://www.archunit.org/userguide/html/000_Index.html#_freezing_arch_rules) and have only new violations reported.\r\n\r\n&gt; By default `FreezingArchRule` will use a simple `ViolationStore` based on plain text files. This is sufficient to add these files to any version control system to continuously track the progress.\r\n\r\nFor more details, please have a look at the user guide.","link":"https://stackoverflow.com/questions/77458360/archunit-allow-limited-number-of-violations-for-ratcheting/77458434#77458434","title":"ArchUnit allow limited number of violations for ratcheting","body":"<p>You can <a href=\"https://www.archunit.org/userguide/html/000_Index.html#_freezing_arch_rules\" rel=\"nofollow noreferrer\">freeze the existing violations</a> and have only new violations reported.</p>\n<blockquote>\n<p>By default <code>FreezingArchRule</code> will use a simple <code>ViolationStore</code> based on plain text files. This is sufficient to add these files to any version control system to continuously track the progress.</p>\n</blockquote>\n<p>For more details, please have a look at the user guide.</p>\n"}],"comment_count":0,"is_answered":true,"view_count":50,"answer_count":1,"score":1,"last_activity_date":1701848027,"creation_date":1699601907,"last_edit_date":1701837477,"question_id":77458360,"body_markdown":"I am currently thinking about using archunit for a project.\r\nThe project has grown over many years and now I would face a lot of violations if I would proceed.\r\n\r\nIs there a way to make a rue not fail if the number of violations is below a certain threshold?\r\n\r\nSomething like\r\n\r\n    private static final ArchRule limit_something = classes().should([...]).failThreshold(10);\r\n\r\nThis would prevent new code from doing unwanted things and allow me to fix this without a big bang change.\r\n\r\nEdit: I do not want to have extra setup for a Freeze-Store.\r\n","link":"https://stackoverflow.com/questions/77458360/archunit-allow-limited-number-of-violations-for-ratcheting","title":"ArchUnit allow limited number of violations for ratcheting","body":"<p>I am currently thinking about using archunit for a project.\nThe project has grown over many years and now I would face a lot of violations if I would proceed.</p>\n<p>Is there a way to make a rue not fail if the number of violations is below a certain threshold?</p>\n<p>Something like</p>\n<pre><code>private static final ArchRule limit_something = classes().should([...]).failThreshold(10);\n</code></pre>\n<p>This would prevent new code from doing unwanted things and allow me to fix this without a big bang change.</p>\n<p>Edit: I do not want to have extra setup for a Freeze-Store.</p>\n"},{"tags":["java","eclipse","selenium-webdriver"],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1700708211,"post_id":77534060,"comment_id":136688568,"body_markdown":"If I open project properties and go to Build Path I can see the various Selenium jar files listed under Classpath. Java is listed under Modulepath. I can also see them in the tree view under Referenced libraries. Hover is on. If I enter the import command manually it tells me that the package is not accessible.","link":"https://stackoverflow.com/questions/77533874/eclipse-not-giving-import-option-to-resolve-an-unknown-reference/77534060#comment136688568_77534060","body":"If I open project properties and go to Build Path I can see the various Selenium jar files listed under Classpath. Java is listed under Modulepath. I can also see them in the tree view under Referenced libraries. Hover is on. If I enter the import command manually it tells me that the package is not accessible."},{"score":0,"post_type":"answer","creation_date":1700710203,"post_id":77534060,"comment_id":136688719,"body_markdown":"Also this may have something to do with running on a VMware session. I&#39;m going to try this on my personal desktop and see if there&#39;s a difference.","link":"https://stackoverflow.com/questions/77533874/eclipse-not-giving-import-option-to-resolve-an-unknown-reference/77534060#comment136688719_77534060","body":"Also this may have something to do with running on a VMware session. I&#39;m going to try this on my personal desktop and see if there&#39;s a difference."},{"score":0,"post_type":"answer","creation_date":1700710351,"post_id":77534060,"comment_id":136688731,"body_markdown":"Just double checking: Its `WebDriver driver = new ChromeDriver();` - note the parentheses. You did that, right?","link":"https://stackoverflow.com/questions/77533874/eclipse-not-giving-import-option-to-resolve-an-unknown-reference/77534060#comment136688731_77534060","body":"Just double checking: Its <code>WebDriver driver = new ChromeDriver();</code> - note the parentheses. You did that, right?"},{"score":0,"post_type":"answer","creation_date":1700711402,"post_id":77534060,"comment_id":136688797,"body_markdown":"Yes, I did, sorry I didn&#39;t include that here. It&#39;s not the VM either. I have the same issue on my personal desktop. I also have my CLASSPATH system environment variable set and it includes where the Selenium jar files are located. I should honestly just download IntelliJ, it was SO much easier. I&#39;ve followed a few tutorials and they&#39;re doing the exact same thing I am but I don&#39;t get option to import the selenium library that they get on the hover.","link":"https://stackoverflow.com/questions/77533874/eclipse-not-giving-import-option-to-resolve-an-unknown-reference/77534060#comment136688797_77534060","body":"Yes, I did, sorry I didn&#39;t include that here. It&#39;s not the VM either. I have the same issue on my personal desktop. I also have my CLASSPATH system environment variable set and it includes where the Selenium jar files are located. I should honestly just download IntelliJ, it was SO much easier. I&#39;ve followed a few tutorials and they&#39;re doing the exact same thing I am but I don&#39;t get option to import the selenium library that they get on the hover."},{"score":0,"post_type":"answer","creation_date":1700747242,"post_id":77534060,"comment_id":136694211,"body_markdown":"The `CLASSPATH` sys env variable is obsolete and has no effect here in any case (conceptually it&#39;s completely broken: You can run more than one java app on a single computer, hence the idea of a global classpath variable is just wrong). You&#39;ve misconfigured something, but you aren&#39;t giving us the details we need to help you.","link":"https://stackoverflow.com/questions/77533874/eclipse-not-giving-import-option-to-resolve-an-unknown-reference/77534060#comment136694211_77534060","body":"The <code>CLASSPATH</code> sys env variable is obsolete and has no effect here in any case (conceptually it&#39;s completely broken: You can run more than one java app on a single computer, hence the idea of a global classpath variable is just wrong). You&#39;ve misconfigured something, but you aren&#39;t giving us the details we need to help you."}],"comment_count":5,"score":0,"last_activity_date":1700706785,"creation_date":1700706785,"answer_id":77534060,"question_id":77533874,"body_markdown":"&gt; The selenium libraries are in my build path.\r\n\r\nYou haven&#39;t given enough information to know which of a few problems you&#39;re dealing with.\r\n\r\n### 90%+ odds: No, they aren&#39;t.\r\n\r\nSelenium isn&#39;t in your build path. Something else is, or it&#39;s not in there at all. If you have no idea how to proceed, write out the fully qualified package name or write the import by hand, and if it&#39;s still an error, it&#39;s definitely this.\r\n\r\n### Other option - hover isn&#39;t on\r\n\r\nIn the &#39;source&#39; menu you&#39;ll find &#39;Organize Imports&#39;. Have java code that is, other than missing `import` statements, completely valid, then pick that option. It&#39;ll appear. If it doesn&#39;t, it&#39;s the first thing (no, you don&#39;t have selenium on the project&#39;s classpath).\r\n\r\nAlternatively, hit CTRL+1 or CMD+1 depending on OS (or if that is not working, open the preferences, type `keys` in the pref filter box, then in the key shortcut settings, type `quick fix`, and check out what it is. You may have changed it; CTRL+1/CMD+1 are merely defaults). This is more or less what the hover thing does. If this _does not_ pop up a box that offers to import it, it&#39;s probably back to the first door.\r\n\r\n### Other option - you&#39;re editing a projectless java file\r\n\r\nIn eclipse you can create scratchpads or just open a random java file straight from disk. However, such files need to be self contained; they don&#39;t _have_ a classpath and can&#39;t get one either. You&#39;ll know if the editor&#39;s icon is a document thingie with a J as usual, but the J is an outline (with white in the middle), instead of solid blue. If this is the case, open (or create) a source file inside a project.","link":"https://stackoverflow.com/questions/77533874/eclipse-not-giving-import-option-to-resolve-an-unknown-reference/77534060#77534060","title":"Eclipse not giving Import option to resolve an unknown reference","body":"<blockquote>\n<p>The selenium libraries are in my build path.</p>\n</blockquote>\n<p>You haven't given enough information to know which of a few problems you're dealing with.</p>\n<h3>90%+ odds: No, they aren't.</h3>\n<p>Selenium isn't in your build path. Something else is, or it's not in there at all. If you have no idea how to proceed, write out the fully qualified package name or write the import by hand, and if it's still an error, it's definitely this.</p>\n<h3>Other option - hover isn't on</h3>\n<p>In the 'source' menu you'll find 'Organize Imports'. Have java code that is, other than missing <code>import</code> statements, completely valid, then pick that option. It'll appear. If it doesn't, it's the first thing (no, you don't have selenium on the project's classpath).</p>\n<p>Alternatively, hit CTRL+1 or CMD+1 depending on OS (or if that is not working, open the preferences, type <code>keys</code> in the pref filter box, then in the key shortcut settings, type <code>quick fix</code>, and check out what it is. You may have changed it; CTRL+1/CMD+1 are merely defaults). This is more or less what the hover thing does. If this <em>does not</em> pop up a box that offers to import it, it's probably back to the first door.</p>\n<h3>Other option - you're editing a projectless java file</h3>\n<p>In eclipse you can create scratchpads or just open a random java file straight from disk. However, such files need to be self contained; they don't <em>have</em> a classpath and can't get one either. You'll know if the editor's icon is a document thingie with a J as usual, but the J is an outline (with white in the middle), instead of solid blue. If this is the case, open (or create) a source file inside a project.</p>\n"},{"comment_count":0,"score":0,"last_activity_date":1701825632,"creation_date":1701825632,"answer_id":77610082,"question_id":77533874,"body_markdown":"I fixed the problem. I switched to Visual Studio and C#. No more issues.","link":"https://stackoverflow.com/questions/77533874/eclipse-not-giving-import-option-to-resolve-an-unknown-reference/77610082#77610082","title":"Eclipse not giving Import option to resolve an unknown reference","body":"<p>I fixed the problem. I switched to Visual Studio and C#. No more issues.</p>\n"}],"comment_count":0,"is_answered":false,"view_count":58,"answer_count":2,"score":1,"last_activity_date":1701825632,"creation_date":1700702008,"question_id":77533874,"body_markdown":"I&#39;ve been away from Eclipse for a long time and am having an issue getting a basic Selenium program working. Inside my main() I&#39;m trying to declare a new Webdriver.\r\n\r\n     WebDriver driver = new ChromeDriver;\r\n\r\nOf course this gives an error as I have not imported org.openqa.selenium.* yet. If I hovered over WebDriver in the past it used to give me the option of importing the required library. It&#39;s not doing so. I have no idea why. The selenium libraries are in my build path. I&#39;m using Eclipse 2023 09.\r\n\r\nAny help at resolving this would be greatly appreciated.","link":"https://stackoverflow.com/questions/77533874/eclipse-not-giving-import-option-to-resolve-an-unknown-reference","title":"Eclipse not giving Import option to resolve an unknown reference","body":"<p>I've been away from Eclipse for a long time and am having an issue getting a basic Selenium program working. Inside my main() I'm trying to declare a new Webdriver.</p>\n<pre><code> WebDriver driver = new ChromeDriver;\n</code></pre>\n<p>Of course this gives an error as I have not imported org.openqa.selenium.* yet. If I hovered over WebDriver in the past it used to give me the option of importing the required library. It's not doing so. I have no idea why. The selenium libraries are in my build path. I'm using Eclipse 2023 09.</p>\n<p>Any help at resolving this would be greatly appreciated.</p>\n"},{"tags":["java","spring","spring-security"],"comments":[{"score":0,"post_type":"question","creation_date":1700265669,"post_id":77504542,"comment_id":136637424,"body_markdown":"if you have already defined what authentication you are using there is no need to set this and it can all be removed because spring security will already supply you with a predefined AuthenticationManager unless you have built a custom security solution which is in general bad practice and not recommended, and thats also the reason as to why there is no direct docs for it. As it is once again, not best practice to build custom security solutions.","link":"https://stackoverflow.com/questions/77504542/rewriting-a-spring-security-deprecated-authenticationmanager-httpsecurity#comment136637424_77504542","body":"if you have already defined what authentication you are using there is no need to set this and it can all be removed because spring security will already supply you with a predefined AuthenticationManager unless you have built a custom security solution which is in general bad practice and not recommended, and thats also the reason as to why there is no direct docs for it. As it is once again, not best practice to build custom security solutions."}],"answers":[{"comment_count":0,"score":0,"last_activity_date":1700315031,"creation_date":1700315031,"answer_id":77507143,"question_id":77504542,"body_markdown":"You could rewrite `AuthenticationManager` Bean as next one it is going to work as expected.\r\n\r\n      @Bean\r\n      public AuthenticationManager authenticationManager(HttpSecurity http) throws Exception {\r\n    \r\n            AuthenticationManagerBuilder authManagerBuilder =  http.getSharedObject(AuthenticationManagerBuilder.class);\r\n            authManagerBuilder.userDetailsService(customUserDetailService)\r\n                .passwordEncoder(passwordEncoder());\r\n            return authManagerBuilder.build();        \r\n          }\r\n\r\nMore details about it and some references you will be able to find [spring-security-without-the-websecurityconfigureradapter][1] post.\r\n\r\n  [1]: https://spring.io/blog/2022/02/21/spring-security-without-the-websecurityconfigureradapter","link":"https://stackoverflow.com/questions/77504542/rewriting-a-spring-security-deprecated-authenticationmanager-httpsecurity/77507143#77507143","title":"Rewriting a Spring security deprecated, AuthenticationManager / HttpSecurity","body":"<p>You could rewrite <code>AuthenticationManager</code> Bean as next one it is going to work as expected.</p>\n<pre><code>  @Bean\n  public AuthenticationManager authenticationManager(HttpSecurity http) throws Exception {\n\n        AuthenticationManagerBuilder authManagerBuilder =  http.getSharedObject(AuthenticationManagerBuilder.class);\n        authManagerBuilder.userDetailsService(customUserDetailService)\n            .passwordEncoder(passwordEncoder());\n        return authManagerBuilder.build();        \n      }\n</code></pre>\n<p>More details about it and some references you will be able to find <a href=\"https://spring.io/blog/2022/02/21/spring-security-without-the-websecurityconfigureradapter\" rel=\"nofollow noreferrer\">spring-security-without-the-websecurityconfigureradapter</a> post.</p>\n"},{"comment_count":0,"score":1,"last_activity_date":1701823540,"creation_date":1701823540,"answer_id":77610001,"question_id":77504542,"body_markdown":"Instead of using `AuthenticationManagerBuilder`, please publish the `UserDetailsService` and `PasswordEncoder` beans separately like so:\r\n\r\n```java\r\n@Bean\r\nUserDetailsService customUserDetailsService() {\r\n    // ... construct\r\n}\r\n\r\n@Bean\r\nPasswordEncoder passwordEncoder() {\r\n    // ... construct\r\n}\r\n```\r\n\r\nIn your case, given that you are fine with the `AuthenticationProvider` defaults in `AuthenticationManager`, there is no need to construct one directly as you are doing.","link":"https://stackoverflow.com/questions/77504542/rewriting-a-spring-security-deprecated-authenticationmanager-httpsecurity/77610001#77610001","title":"Rewriting a Spring security deprecated, AuthenticationManager / HttpSecurity","body":"<p>Instead of using <code>AuthenticationManagerBuilder</code>, please publish the <code>UserDetailsService</code> and <code>PasswordEncoder</code> beans separately like so:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Bean\nUserDetailsService customUserDetailsService() {\n    // ... construct\n}\n\n@Bean\nPasswordEncoder passwordEncoder() {\n    // ... construct\n}\n</code></pre>\n<p>In your case, given that you are fine with the <code>AuthenticationProvider</code> defaults in <code>AuthenticationManager</code>, there is no need to construct one directly as you are doing.</p>\n"}],"comment_count":1,"is_answered":true,"view_count":133,"answer_count":2,"score":2,"last_activity_date":1701823540,"creation_date":1700253950,"question_id":77504542,"body_markdown":"I&#39;ve read some examples and docs on Spring security which i managed to rewrite a deprecated function on the SecurityFilterchain.\r\n\r\nhttps://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/config/annotation/SecurityConfigurerAdapter.html#and()\r\n\r\nHowever in another function below im facing issue on not knowing how i can rewrite it in a lambda based configuration and would need help to rewrite this.\r\n\r\n\r\n\r\n\r\n      @Bean\r\n        public AuthenticationManager authenticationManager(HttpSecurity http) throws Exception {\r\n        \r\n           return http.getSharedObject(AuthenticationManagerBuilder.class)\r\n                   .userDetailsService(customUserDetailService)\r\n                   .passwordEncoder(passwordEncoder())\r\n                   .and().build();\r\n        \r\n        }","link":"https://stackoverflow.com/questions/77504542/rewriting-a-spring-security-deprecated-authenticationmanager-httpsecurity","title":"Rewriting a Spring security deprecated, AuthenticationManager / HttpSecurity","body":"<p>I've read some examples and docs on Spring security which i managed to rewrite a deprecated function on the SecurityFilterchain.</p>\n<p><a href=\"https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/config/annotation/SecurityConfigurerAdapter.html#and()\" rel=\"nofollow noreferrer\">https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/config/annotation/SecurityConfigurerAdapter.html#and()</a></p>\n<p>However in another function below im facing issue on not knowing how i can rewrite it in a lambda based configuration and would need help to rewrite this.</p>\n<pre><code>  @Bean\n    public AuthenticationManager authenticationManager(HttpSecurity http) throws Exception {\n    \n       return http.getSharedObject(AuthenticationManagerBuilder.class)\n               .userDetailsService(customUserDetailService)\n               .passwordEncoder(passwordEncoder())\n               .and().build();\n    \n    }\n</code></pre>\n"},{"tags":["java","netty"],"comments":[{"score":1,"post_type":"question","creation_date":1701259696,"post_id":77570957,"comment_id":136752984,"body_markdown":"It specifies you should use the SslContextBuilder (see [here](https://netty.io/4.1/api/io/netty/handler/ssl/SslContext.html#newClientContext--) ; the intro of the page gives of code example)","link":"https://stackoverflow.com/questions/77570957/io-netty-handler-ssl-sslcontext-newclientcontext-deprecated-in-favor-of#comment136752984_77570957","body":"It specifies you should use the SslContextBuilder (see <a href=\"https://netty.io/4.1/api/io/netty/handler/ssl/SslContext.html#newClientContext--\" rel=\"nofollow noreferrer\">here</a> ; the intro of the page gives of code example)"},{"score":0,"post_type":"question","creation_date":1701259954,"post_id":77570957,"comment_id":136753024,"body_markdown":"This is correct, thanks, upvoted (if you want to make it an answer, up to you)","link":"https://stackoverflow.com/questions/77570957/io-netty-handler-ssl-sslcontext-newclientcontext-deprecated-in-favor-of#comment136753024_77570957","body":"This is correct, thanks, upvoted (if you want to make it an answer, up to you)"},{"score":0,"post_type":"question","creation_date":1701284891,"post_id":77570957,"comment_id":136757980,"body_markdown":"I&#39;m good thanks :)","link":"https://stackoverflow.com/questions/77570957/io-netty-handler-ssl-sslcontext-newclientcontext-deprecated-in-favor-of#comment136757980_77570957","body":"I&#39;m good thanks :)"}],"answers":[{"comment_count":0,"score":0,"last_activity_date":1701818752,"creation_date":1701818752,"answer_id":77609769,"question_id":77570957,"body_markdown":"As Aaron said (credits to him), we can use ```SslContextBuilder.forClient().build()```","link":"https://stackoverflow.com/questions/77570957/io-netty-handler-ssl-sslcontext-newclientcontext-deprecated-in-favor-of/77609769#77609769","title":"io.netty.handler.ssl.SslContext.newClientContext() deprecated in favor of?","body":"<p>As Aaron said (credits to him), we can use <code>SslContextBuilder.forClient().build()</code></p>\n"}],"comment_count":3,"is_answered":true,"view_count":32,"answer_count":1,"score":0,"last_activity_date":1701818752,"creation_date":1701259122,"question_id":77570957,"body_markdown":"- What I am trying to achieve:\r\n\r\nI would like to create a dummy SslContext (the one from io.netty.handler.ssl.SslContext, not SSLContext) during my testing.\r\n\r\n- What did I try:\r\n\r\nSince it is a dummy and it is for testing only, I used ```io.netty.handler.ssl.SslContext.newClientContext() ```, which creates a SslContext object, probably not secure, but good enough for my tests.\r\n\r\n- Issue:\r\n\r\nUnfortunately, now using ```netty-handler-4.1.100.Final.jar```, ```SslContext.newClientContext()``` seems to be deprecated.\r\n\r\nHowever, the doc does not mention what is the replacement.\r\n\r\n```\r\n    /** @deprecated */\r\n    @Deprecated\r\n    public static SslContext newClientContext() throws SSLException {\r\n        return newClientContext((SslProvider)null, (File)null, (TrustManagerFactory)null);\r\n    }\r\n```\r\n\r\n- Question:\r\n\r\nI do not have certificates, keys, or any other security related material, and would like to avoid creating some just for the sake of the test if possible.\r\nWhat is the non deprecated alternative to ```SslContext.newClientContext()```? \r\n","link":"https://stackoverflow.com/questions/77570957/io-netty-handler-ssl-sslcontext-newclientcontext-deprecated-in-favor-of","title":"io.netty.handler.ssl.SslContext.newClientContext() deprecated in favor of?","body":"<ul>\n<li>What I am trying to achieve:</li>\n</ul>\n<p>I would like to create a dummy SslContext (the one from io.netty.handler.ssl.SslContext, not SSLContext) during my testing.</p>\n<ul>\n<li>What did I try:</li>\n</ul>\n<p>Since it is a dummy and it is for testing only, I used <code>io.netty.handler.ssl.SslContext.newClientContext() </code>, which creates a SslContext object, probably not secure, but good enough for my tests.</p>\n<ul>\n<li>Issue:</li>\n</ul>\n<p>Unfortunately, now using <code>netty-handler-4.1.100.Final.jar</code>, <code>SslContext.newClientContext()</code> seems to be deprecated.</p>\n<p>However, the doc does not mention what is the replacement.</p>\n<pre><code>    /** @deprecated */\n    @Deprecated\n    public static SslContext newClientContext() throws SSLException {\n        return newClientContext((SslProvider)null, (File)null, (TrustManagerFactory)null);\n    }\n</code></pre>\n<ul>\n<li>Question:</li>\n</ul>\n<p>I do not have certificates, keys, or any other security related material, and would like to avoid creating some just for the sake of the test if possible.\nWhat is the non deprecated alternative to <code>SslContext.newClientContext()</code>?</p>\n"},{"tags":["java","android","kotlin","dependencies"],"comments":[{"score":56,"post_type":"question","creation_date":1678119066,"post_id":75263047,"comment_id":133467228,"body_markdown":"I thought I was the only one who got this error while having had no use of Kotlin anywhere in my large project.. Then I came across this very-obvious-to-me-now answer and it solved it very simply for me...\nhttps://stackoverflow.com/a/75315276/4355877","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android#comment133467228_75263047","body":"I thought I was the only one who got this error while having had no use of Kotlin anywhere in my large project.. Then I came across this very-obvious-to-me-now answer and it solved it very simply for me... <a href=\"https://stackoverflow.com/a/75315276/4355877\">stackoverflow.com/a/75315276/4355877</a>"},{"score":2,"post_type":"question","creation_date":1680019103,"post_id":75263047,"comment_id":133823622,"body_markdown":"@Mick Thank you so much for the tip, a lifesaver for those shunning Kotlin.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android#comment133823622_75263047","body":"@Mick Thank you so much for the tip, a lifesaver for those shunning Kotlin."},{"score":0,"post_type":"question","creation_date":1681109963,"post_id":75263047,"comment_id":133999648,"body_markdown":"@midnighthowlers Try this solution once: https://stackoverflow.com/a/75974885/16765223","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android#comment133999648_75263047","body":"@midnighthowlers Try this solution once: <a href=\"https://stackoverflow.com/a/75974885/16765223\">stackoverflow.com/a/75974885/16765223</a>"},{"score":0,"post_type":"question","creation_date":1690367865,"post_id":75263047,"comment_id":135342688,"body_markdown":"This answer worked for me. It&#39;s on page 2, that&#39;s why I&#39;m adding this as a comment here: https://stackoverflow.com/a/75550269/4833705","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android#comment135342688_75263047","body":"This answer worked for me. It&#39;s on page 2, that&#39;s why I&#39;m adding this as a comment here: <a href=\"https://stackoverflow.com/a/75550269/4833705\">stackoverflow.com/a/75550269/4833705</a>"},{"score":0,"post_type":"question","creation_date":1701574262,"post_id":75263047,"comment_id":136792244,"body_markdown":"Why do we need 62 answers to this question?","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android#comment136792244_75263047","body":"Why do we need 62 answers to this question?"}],"answers":[{"comment_count":0,"score":4,"last_activity_date":1674878616,"creation_date":1674878616,"answer_id":75265284,"question_id":75263047,"body_markdown":"According to the release notes of Kotlin 1.8.0 (https://kotlinlang.org/docs/whatsnew18.html#updated-jvm-compilation-target), you shouldn&#39;t specify `kotlin-stdlib-jdk7` nor `kotlin-stdlib-jdk8` as dependencies anymore and, instead, just use `kotlin-stdlib`.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75265284#75265284","title":"Duplicate class in Kotlin Android","body":"<p>According to the release notes of Kotlin 1.8.0 (<a href=\"https://kotlinlang.org/docs/whatsnew18.html#updated-jvm-compilation-target\" rel=\"nofollow noreferrer\">https://kotlinlang.org/docs/whatsnew18.html#updated-jvm-compilation-target</a>), you shouldn't specify <code>kotlin-stdlib-jdk7</code> nor <code>kotlin-stdlib-jdk8</code> as dependencies anymore and, instead, just use <code>kotlin-stdlib</code>.</p>\n"},{"comments":[{"score":66,"post_type":"answer","creation_date":1675552925,"post_id":75268089,"comment_id":132954784,"body_markdown":"Note: After updating to &#39;1.8.0&#39;, do not forget to update kotlinCompilerExtensionVersion as &#39;1.4.0&#39; .","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75268089#comment132954784_75268089","body":"Note: After updating to &#39;1.8.0&#39;, do not forget to update kotlinCompilerExtensionVersion as &#39;1.4.0&#39; ."},{"score":14,"post_type":"answer","creation_date":1676031338,"post_id":75268089,"comment_id":133060150,"body_markdown":"I get a compilation error: \n**This version (1.3.2) of the Compose Compiler requires Kotlin version 1.7.20 but you appear to be using Kotlin version 1.8.0 which is not known to be compatible.  Please fix your configuration (or `suppressKotlinVersionCompatibilityCheck` but don&#39;t say I didn&#39;t warn you!).**","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75268089#comment133060150_75268089","body":"I get a compilation error:  <b>This version (1.3.2) of the Compose Compiler requires Kotlin version 1.7.20 but you appear to be using Kotlin version 1.8.0 which is not known to be compatible.  Please fix your configuration (or <code>suppressKotlinVersionCompatibilityCheck</code> but don&#39;t say I didn&#39;t warn you!).</b>"},{"score":1,"post_type":"answer","creation_date":1676239359,"post_id":75268089,"comment_id":133092822,"body_markdown":"Question as a noob: Where should I add the above?","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75268089#comment133092822_75268089","body":"Question as a noob: Where should I add the above?"},{"score":0,"post_type":"answer","creation_date":1676719567,"post_id":75268089,"comment_id":133196565,"body_markdown":"If you are using ksp, do not forget to update it too. https://github.com/google/ksp/releases. For kotlin version 1.8.0 ksp must be 1.8.0","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75268089#comment133196565_75268089","body":"If you are using ksp, do not forget to update it too. <a href=\"https://github.com/google/ksp/releases\" rel=\"nofollow noreferrer\">github.com/google/ksp/releases</a>. For kotlin version 1.8.0 ksp must be 1.8.0"},{"score":0,"post_type":"answer","creation_date":1678141217,"post_id":75268089,"comment_id":133472887,"body_markdown":"got this error:The &#39;kotlin-android-extensions&#39; Gradle plugin is no longer supported. Please use this migration guide (https://goo.gle/kotlin-android-extensions-deprecation) to start working with View Binding (https://developer.android.com/topic/libraries/view-binding) and the &#39;kotlin-parcelize&#39; plugin.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75268089#comment133472887_75268089","body":"got this error:The &#39;kotlin-android-extensions&#39; Gradle plugin is no longer supported. Please use this migration guide (<a href=\"https://goo.gle/kotlin-android-extensions-deprecation\" rel=\"nofollow noreferrer\">goo.gle/kotlin-android-extensions-deprecation</a>) to start working with View Binding (<a href=\"https://developer.android.com/topic/libraries/view-binding\" rel=\"nofollow noreferrer\">developer.android.com/topic/libraries/view-binding</a>) and the &#39;kotlin-parcelize&#39; plugin."},{"score":3,"post_type":"answer","creation_date":1679732648,"post_id":75268089,"comment_id":133776516,"body_markdown":"@PrasannjeetSingh It is `build.gradle` file","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75268089#comment133776516_75268089","body":"@PrasannjeetSingh It is <code>build.gradle</code> file"},{"score":5,"post_type":"answer","creation_date":1683299932,"post_id":75268089,"comment_id":134350601,"body_markdown":"@IgorGanapolsky - You can update the kotlinCompilerExtensionVersion to 1.4.4 in app level build.gradle. You can find this in ComposeOptions {} block. Check the link below to find the correctly mapped version (https://developer.android.com/jetpack/androidx/releases/compose-kotlin)","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75268089#comment134350601_75268089","body":"@IgorGanapolsky - You can update the kotlinCompilerExtensionVersion to 1.4.4 in app level build.gradle. You can find this in ComposeOptions {} block. Check the link below to find the correctly mapped version (<a href=\"https://developer.android.com/jetpack/androidx/releases/compose-kotlin\" rel=\"nofollow noreferrer\">developer.android.com/jetpack/androidx/releases/compose-kot&zwnj;&#8203;lin</a>)"},{"score":0,"post_type":"answer","creation_date":1684053805,"post_id":75268089,"comment_id":134458016,"body_markdown":"This is useful but you also need edit kotlinCompilerExtensionVersion= &quot;1.4.3&quot;.  https://developer.android.com/jetpack/androidx/releases/compose-kotlin?hl=zh-cn","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75268089#comment134458016_75268089","body":"This is useful but you also need edit kotlinCompilerExtensionVersion= &quot;1.4.3&quot;.  <a href=\"https://developer.android.com/jetpack/androidx/releases/compose-kotlin?hl=zh-cn\" rel=\"nofollow noreferrer\">developer.android.com/jetpack/androidx/releases/&hellip;</a>"},{"score":0,"post_type":"answer","creation_date":1686622304,"post_id":75268089,"comment_id":134820958,"body_markdown":"I had the same issue. By default Android Studio creates a project with `kotlinCompilerExtensionVersion &#39;1.3.2&#39;` (**Compose Compiler Version**) and `id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.7.20&#39; apply false` (**Kotlin Version**). And the problem comes when you try to use/update library versions: For example `implementation &#39;androidx.core:core-ktx:1.8.0&#39;` to 1.10.1 , result in that error(you&#39;ll have to look for the right version). **To avoid this use the latest version of Compose Compiler Version and Kotlin version** (https://developer.android.com/jetpack/androidx/releases/compose-kotlin)","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75268089#comment134820958_75268089","body":"I had the same issue. By default Android Studio creates a project with <code>kotlinCompilerExtensionVersion &#39;1.3.2&#39;</code> (<b>Compose Compiler Version</b>) and <code>id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.7.20&#39; apply false</code> (<b>Kotlin Version</b>). And the problem comes when you try to use/update library versions: For example <code>implementation &#39;androidx.core:core-ktx:1.8.0&#39;</code> to 1.10.1 , result in that error(you&#39;ll have to look for the right version). <b>To avoid this use the latest version of Compose Compiler Version and Kotlin version</b> (<a href=\"https://developer.android.com/jetpack/androidx/releases/compose-kotlin\" rel=\"nofollow noreferrer\">developer.android.com/jetpack/androidx/releases/compose-kot&zwnj;&#8203;lin</a>)"},{"score":0,"post_type":"answer","creation_date":1688062093,"post_id":75268089,"comment_id":135026890,"body_markdown":"I replaced: \n- apply plugin: &#39;com.android.application&#39;\n\nwith :\n\nplugins {\n    id &#39;com.android.application&#39;\n    id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.8.0&#39; apply false\n}\n\nAnd it works.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75268089#comment135026890_75268089","body":"I replaced:  - apply plugin: &#39;com.android.application&#39;  with :  plugins {     id &#39;com.android.application&#39;     id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.8.0&#39; apply false }  And it works."},{"score":0,"post_type":"answer","creation_date":1697788080,"post_id":75268089,"comment_id":136326176,"body_markdown":"When updating `org.jetbrains.kotlin.android` to `1.8.0` add `android`&gt;`composeOptions` &gt; `kotlinCompilerExtensionVersion = &quot;1.4.0&quot;` in your app level `build.gradle` file","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75268089#comment136326176_75268089","body":"When updating <code>org.jetbrains.kotlin.android</code> to <code>1.8.0</code> add <code>android</code>&gt;<code>composeOptions</code> &gt; <code>kotlinCompilerExtensionVersion = &quot;1.4.0&quot;</code> in your app level <code>build.gradle</code> file"}],"comment_count":11,"score":293,"last_activity_date":1701573675,"last_edit_date":1701573675,"creation_date":1674913560,"answer_id":75268089,"question_id":75263047,"body_markdown":"Simply. For me, just change this Gradle plugin from 1.7.10 to 1.8.0 Then synchronise &amp;rarr; invalidate caches &amp;rarr; build\r\n\r\nFrom:\r\n\r\n    plugins {\r\n        ....\r\n        id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.7.10&#39; apply false\r\n    }\r\n\r\n\r\n\r\nTo:\r\n\r\n    plugins {\r\n        ....\r\n        id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.8.0&#39; apply false\r\n    }\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75268089#75268089","title":"Duplicate class in Kotlin Android","body":"<p>Simply. For me, just change this Gradle plugin from 1.7.10 to 1.8.0 Then synchronise → invalidate caches → build</p>\n<p>From:</p>\n<pre><code>plugins {\n    ....\n    id 'org.jetbrains.kotlin.android' version '1.7.10' apply false\n}\n</code></pre>\n<p>To:</p>\n<pre><code>plugins {\n    ....\n    id 'org.jetbrains.kotlin.android' version '1.8.0' apply false\n}\n</code></pre>\n"},{"comment_count":0,"score":23,"last_activity_date":1701573779,"last_edit_date":1701573779,"creation_date":1674914557,"answer_id":75268204,"question_id":75263047,"body_markdown":"I solved the problem by changing the Kotlin class path dependency in the root *[build.gradle][1]* file from\r\n\r\n```\r\nclasspath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.7.20-RC&quot;\r\n```\r\n\r\nto\r\n\r\n```\r\nclasspath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.8.0&quot;\r\n```\r\n\r\n  [1]: https://docs.gradle.org/current/userguide/tutorial_using_tasks.html\r\n\r\n\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75268204#75268204","title":"Duplicate class in Kotlin Android","body":"<p>I solved the problem by changing the Kotlin class path dependency in the root <em><a href=\"https://docs.gradle.org/current/userguide/tutorial_using_tasks.html\" rel=\"nofollow noreferrer\">build.gradle</a></em> file from</p>\n<pre><code>classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.7.20-RC&quot;\n</code></pre>\n<p>to</p>\n<pre><code>classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.8.0&quot;\n</code></pre>\n"},{"comments":[{"score":0,"post_type":"answer","creation_date":1677140024,"post_id":75276293,"comment_id":133279784,"body_markdown":"Same here. Had to downgrade material3 version to ```&#39;1.1.0-alpha04&#39;```","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75276293#comment133279784_75276293","body":"Same here. Had to downgrade material3 version to <code>&#39;1.1.0-alpha04&#39;</code>"}],"comment_count":1,"score":4,"last_activity_date":1701573846,"last_edit_date":1701573846,"creation_date":1675008057,"answer_id":75276293,"question_id":75263047,"body_markdown":"It is maybe some updated version dependency. In my new compose app, when I updated\r\n\r\n&gt; implementation &#39;androidx.compose.material3:material3:*&#39;(new version)\r\n&gt; from 1.0.0-alpha11\r\n\r\nI will got this error. Try revert updated dependency.\r\n\r\nAlso, I was getting this error when `android studio` was added in my Gradle modules `ktx:+` dependency.\r\n\r\n\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75276293#75276293","title":"Duplicate class in Kotlin Android","body":"<p>It is maybe some updated version dependency. In my new compose app, when I updated</p>\n<blockquote>\n<p>implementation 'androidx.compose.material3:material3:*'(new version)\nfrom 1.0.0-alpha11</p>\n</blockquote>\n<p>I will got this error. Try revert updated dependency.</p>\n<p>Also, I was getting this error when <code>android studio</code> was added in my Gradle modules <code>ktx:+</code> dependency.</p>\n"},{"comment_count":0,"score":1,"last_activity_date":1701573900,"last_edit_date":1701573900,"creation_date":1675055848,"answer_id":75280491,"question_id":75263047,"body_markdown":"For compose, use stable-version of material3:\r\n\r\n`androidx.compose.material3:material3:1.0.1`\r\n\r\nAnd then:\r\n\r\n`id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.7.0&#39; apply false`\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75280491#75280491","title":"Duplicate class in Kotlin Android","body":"<p>For compose, use stable-version of material3:</p>\n<p><code>androidx.compose.material3:material3:1.0.1</code></p>\n<p>And then:</p>\n<p><code>id 'org.jetbrains.kotlin.android' version '1.7.0' apply false</code></p>\n"},{"comment_count":0,"score":0,"last_activity_date":1701573935,"last_edit_date":1701573935,"creation_date":1675083559,"answer_id":75284751,"question_id":75263047,"body_markdown":"I had the same issue while it was working two days ago...\r\n\r\nI changed to\r\n\r\n    composeOptions {\r\n            kotlinCompilerExtensionVersion &#39;1.3.2&#39;\r\n    }\r\n\r\nand\r\n`id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.7.20&#39; apply false` \r\nin build.gradle (Project).\r\n\r\nThen clean and rebuild the project.\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75284751#75284751","title":"Duplicate class in Kotlin Android","body":"<p>I had the same issue while it was working two days ago...</p>\n<p>I changed to</p>\n<pre><code>composeOptions {\n        kotlinCompilerExtensionVersion '1.3.2'\n}\n</code></pre>\n<p>and\n<code>id 'org.jetbrains.kotlin.android' version '1.7.20' apply false</code>\nin build.gradle (Project).</p>\n<p>Then clean and rebuild the project.</p>\n"},{"comments":[{"score":7,"post_type":"answer","creation_date":1678320608,"post_id":75298544,"comment_id":133511815,"body_markdown":"I have a project where the build failed for the same reason as above.  And I am not using any kotlin code in my project.  Is there a way to disable any and all kotlin dependencies so that I can&#39;t possibly get a &quot;duplicate classes&quot; for kotlin dependencies?","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75298544#comment133511815_75298544","body":"I have a project where the build failed for the same reason as above.  And I am not using any kotlin code in my project.  Is there a way to disable any and all kotlin dependencies so that I can&#39;t possibly get a &quot;duplicate classes&quot; for kotlin dependencies?"},{"score":1,"post_type":"answer","creation_date":1678458141,"post_id":75298544,"comment_id":133541457,"body_markdown":"If you&#39;re not using any kotlin code, it sounds like a very different problem even if it has the same error message... probably worth posting as a separate question","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75298544#comment133541457_75298544","body":"If you&#39;re not using any kotlin code, it sounds like a very different problem even if it has the same error message... probably worth posting as a separate question"},{"score":5,"post_type":"answer","creation_date":1679050821,"post_id":75298544,"comment_id":133655457,"body_markdown":"@AJW You may think that you don&#39;t use any Kotlin code in your project, but the dependencies you use can use Kotlin code inside them (for example various AndroidX libraries are written in Kotlin).","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75298544#comment133655457_75298544","body":"@AJW You may think that you don&#39;t use any Kotlin code in your project, but the dependencies you use can use Kotlin code inside them (for example various AndroidX libraries are written in Kotlin)."},{"score":2,"post_type":"answer","creation_date":1679566970,"post_id":75298544,"comment_id":133746002,"body_markdown":"It works now. You can also find information in [youtrack.jetbrains.com](https://youtrack.jetbrains.com/issue/KT-54136/Duplicated-classes-cause-build-failure-if-a-dependency-to-kotlin-stdlib-specified-in-an-android-project).","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75298544#comment133746002_75298544","body":"It works now. You can also find information in <a href=\"https://youtrack.jetbrains.com/issue/KT-54136/Duplicated-classes-cause-build-failure-if-a-dependency-to-kotlin-stdlib-specified-in-an-android-project\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com</a>."},{"score":0,"post_type":"answer","creation_date":1682498374,"post_id":75298544,"comment_id":134223966,"body_markdown":"With Android Studio Giraffe (2022.3.1 Beta 1), I get a warning in the IDE: `&#39;implementation&#39; is defined by &#39;dependencies&#39; but used within &#39;constraints&#39;`. Any idea why, and how to get rid of it?","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75298544#comment134223966_75298544","body":"With Android Studio Giraffe (2022.3.1 Beta 1), I get a warning in the IDE: <code>&#39;implementation&#39; is defined by &#39;dependencies&#39; but used within &#39;constraints&#39;</code>. Any idea why, and how to get rid of it?"},{"score":0,"post_type":"answer","creation_date":1682966610,"post_id":75298544,"comment_id":134292034,"body_markdown":"This solution worked for me but I also tried out a much cleaner approach from the official kotlin docs. Here is the link: https://kotlinlang.org/docs/whatsnew18.html#usage-of-the-latest-kotlin-stdlib-version-in-transitive-dependencies.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75298544#comment134292034_75298544","body":"This solution worked for me but I also tried out a much cleaner approach from the official kotlin docs. Here is the link: <a href=\"https://kotlinlang.org/docs/whatsnew18.html#usage-of-the-latest-kotlin-stdlib-version-in-transitive-dependencies\" rel=\"nofollow noreferrer\">kotlinlang.org/docs/&hellip;</a>."},{"score":1,"post_type":"answer","creation_date":1688345752,"post_id":75298544,"comment_id":135057622,"body_markdown":"Thanks for the solution. Wish `gradle` can&#39;t be little smart to detect and fix this type of issues.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75298544#comment135057622_75298544","body":"Thanks for the solution. Wish <code>gradle</code> can&#39;t be little smart to detect and fix this type of issues."},{"score":0,"post_type":"answer","creation_date":1697727695,"post_id":75298544,"comment_id":136318747,"body_markdown":"I&#39;ve updated my build.gradle with this &amp; it still does not work.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75298544#comment136318747_75298544","body":"I&#39;ve updated my build.gradle with this &amp; it still does not work."},{"score":0,"post_type":"answer","creation_date":1698662438,"post_id":75298544,"comment_id":136429353,"body_markdown":"For more recent versions of kotlin, this solution should not be needed...; using the `kotlin-stdlib` declaration instead is probably what you need to do (as hinted at in the first two paragraphs)... but if you find another scenario you could share the details?","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75298544#comment136429353_75298544","body":"For more recent versions of kotlin, this solution should not be needed...; using the <code>kotlin-stdlib</code> declaration instead is probably what you need to do (as hinted at in the first two paragraphs)... but if you find another scenario you could share the details?"}],"comment_count":9,"score":208,"last_activity_date":1701574034,"last_edit_date":1701574034,"creation_date":1675174777,"answer_id":75298544,"question_id":75263047,"body_markdown":"*See [this note](https://kotlinlang.org/docs/whatsnew18.html#obligatory-check-for-jvm-targets-of-related-kotlin-and-java-compile-tasks) in the official Kotlin documentation for an explanation of how alignment works with these dependencies and build flags. The below original answer is an alternative approach which doesn&#39;t take this into account.*\r\n\r\nThis is because `kotlin-stdlib-jdk7` and `kotlin-stdlib-jdk8` are older dependencies that should be replaced by `kotlin-stdlib` (As @MrPNG pointed out from [the what&#39;s new docs for Kotlin 1.8](https://kotlinlang.org/docs/whatsnew18.html#updated-jvm-compilation-target)). However, other libraries may still declare a dependency on them, which needs to be replaced with a dependency on `kotlin-stdlib`.\r\n\r\nYou can override how the jdk7 and jdk8 versions are resolved like this (in your `app/build.gradle`):\r\n\r\n```\r\ndependencies {\r\n    constraints {\r\n        implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.8.0&quot;) {\r\n            because(&quot;kotlin-stdlib-jdk7 is now a part of kotlin-stdlib&quot;)\r\n        }\r\n        implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.0&quot;) {\r\n            because(&quot;kotlin-stdlib-jdk8 is now a part of kotlin-stdlib&quot;)\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nThe `constraints` section above can be added in alongside your other dependencies. Choose the version (here `1.8.0`) to match the one you actually want to be used, which should be the one that your non-jdkN-named version is in the duplicate class error (e.g., `(org.jetbrains.kotlin:kotlin-stdlib:1.8.0)`)\r\n\r\nIf you have `apply plugin: &#39;kotlin-android&#39;` in this file, then it doesn&#39;t need to separately also say to depend on the stdlib in dependencies, so remove any lines that look like this:\r\n\r\n```\r\n    implementation &quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlin_version&quot;\r\n```\r\n\r\n(thanks to [this blog](https://dev.to/retyui/fix-react-native-android-builds-duplicate-class-kotlincollections-found-in-modules-jetified-kotlin-stdlib-180-2ca7))\r\n\r\n\r\n\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75298544#75298544","title":"Duplicate class in Kotlin Android","body":"<p><em>See <a href=\"https://kotlinlang.org/docs/whatsnew18.html#obligatory-check-for-jvm-targets-of-related-kotlin-and-java-compile-tasks\" rel=\"nofollow noreferrer\">this note</a> in the official Kotlin documentation for an explanation of how alignment works with these dependencies and build flags. The below original answer is an alternative approach which doesn't take this into account.</em></p>\n<p>This is because <code>kotlin-stdlib-jdk7</code> and <code>kotlin-stdlib-jdk8</code> are older dependencies that should be replaced by <code>kotlin-stdlib</code> (As @MrPNG pointed out from <a href=\"https://kotlinlang.org/docs/whatsnew18.html#updated-jvm-compilation-target\" rel=\"nofollow noreferrer\">the what's new docs for Kotlin 1.8</a>). However, other libraries may still declare a dependency on them, which needs to be replaced with a dependency on <code>kotlin-stdlib</code>.</p>\n<p>You can override how the jdk7 and jdk8 versions are resolved like this (in your <code>app/build.gradle</code>):</p>\n<pre><code>dependencies {\n    constraints {\n        implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.8.0&quot;) {\n            because(&quot;kotlin-stdlib-jdk7 is now a part of kotlin-stdlib&quot;)\n        }\n        implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.0&quot;) {\n            because(&quot;kotlin-stdlib-jdk8 is now a part of kotlin-stdlib&quot;)\n        }\n    }\n}\n</code></pre>\n<p>The <code>constraints</code> section above can be added in alongside your other dependencies. Choose the version (here <code>1.8.0</code>) to match the one you actually want to be used, which should be the one that your non-jdkN-named version is in the duplicate class error (e.g., <code>(org.jetbrains.kotlin:kotlin-stdlib:1.8.0)</code>)</p>\n<p>If you have <code>apply plugin: 'kotlin-android'</code> in this file, then it doesn't need to separately also say to depend on the stdlib in dependencies, so remove any lines that look like this:</p>\n<pre><code>    implementation &quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlin_version&quot;\n</code></pre>\n<p>(thanks to <a href=\"https://dev.to/retyui/fix-react-native-android-builds-duplicate-class-kotlincollections-found-in-modules-jetified-kotlin-stdlib-180-2ca7\" rel=\"nofollow noreferrer\">this blog</a>)</p>\n"},{"comment_count":0,"score":9,"last_activity_date":1676031542,"last_edit_date":1676031542,"creation_date":1675254676,"answer_id":75310229,"question_id":75263047,"body_markdown":"If you are using Compose you need to update the Compose Compiler (https://developer.android.com/jetpack/androidx/releases/compose-compiler) to 1.4.2 and Kotlin to 1.8.10 at the same time.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75310229#75310229","title":"Duplicate class in Kotlin Android","body":"<p>If you are using Compose you need to update the Compose Compiler (<a href=\"https://developer.android.com/jetpack/androidx/releases/compose-compiler\" rel=\"noreferrer\">https://developer.android.com/jetpack/androidx/releases/compose-compiler</a>) to 1.4.2 and Kotlin to 1.8.10 at the same time.</p>\n"},{"comment_count":0,"score":0,"last_activity_date":1675365957,"creation_date":1675365957,"answer_id":75328068,"question_id":75263047,"body_markdown":"I had the same error in my project but mine was caused by different jetpack compose libraries having different versions and I put the specific version number `&quot;1.3.3&quot;` which caused other libraries that have later version numbers to not be found. I fix this by using compose BOM which provides the latest version to each library","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75328068#75328068","title":"Duplicate class in Kotlin Android","body":"<p>I had the same error in my project but mine was caused by different jetpack compose libraries having different versions and I put the specific version number <code>&quot;1.3.3&quot;</code> which caused other libraries that have later version numbers to not be found. I fix this by using compose BOM which provides the latest version to each library</p>\n"},{"comment_count":0,"score":1,"last_activity_date":1676195613,"creation_date":1676195613,"answer_id":75426135,"question_id":75263047,"body_markdown":"I noted the issue specifically after upgrading to these 2 libraries:\r\n\r\n - **`Material3`** version **`1.1.0-alpha05`**\r\n \r\n - **`Runtime-livedata`** version **`1.4.0-beta01`**\r\n\r\nThis is are full dependencies:\r\n\r\n    implementation &#39;androidx.compose.runtime:runtime-livedata:1.4.0-beta01&#39;\r\n    implementation &#39;androidx.compose.material3:material3:1.1.0-alpha04&#39;\r\nThis is the error I was getting with **`Jdk-18.0.2`**\r\n\r\n&gt; Duplicate class kotlin.collections.jdk8.CollectionsJDK8Kt found in\r\n&gt; modules kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0)\r\n&gt; and kotlin-stdlib-jdk8-1.7.20\r\n\r\nThe way around it for the time being is to downgrade these 2 libraries until the bug is corrected or updates are made.\r\n\r\n    implementation &#39;androidx.compose.material3:material3:1.1.0-alpha04&#39;\r\n    implementation &#39;androidx.compose.runtime:runtime-livedata:1.4.0-alpha01&#39;\r\n\r\nMind you there may be other dependencies that are affected and if you have recently upgraded the dependencies, you may need to rollback the updates and eliminate the library one by one to identify the troublesome one.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75426135#75426135","title":"Duplicate class in Kotlin Android","body":"<p>I noted the issue specifically after upgrading to these 2 libraries:</p>\n<ul>\n<li><p><strong><code>Material3</code></strong> version <strong><code>1.1.0-alpha05</code></strong></p>\n</li>\n<li><p><strong><code>Runtime-livedata</code></strong> version <strong><code>1.4.0-beta01</code></strong></p>\n</li>\n</ul>\n<p>This is are full dependencies:</p>\n<pre><code>implementation 'androidx.compose.runtime:runtime-livedata:1.4.0-beta01'\nimplementation 'androidx.compose.material3:material3:1.1.0-alpha04'\n</code></pre>\n<p>This is the error I was getting with <strong><code>Jdk-18.0.2</code></strong></p>\n<blockquote>\n<p>Duplicate class kotlin.collections.jdk8.CollectionsJDK8Kt found in\nmodules kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0)\nand kotlin-stdlib-jdk8-1.7.20</p>\n</blockquote>\n<p>The way around it for the time being is to downgrade these 2 libraries until the bug is corrected or updates are made.</p>\n<pre><code>implementation 'androidx.compose.material3:material3:1.1.0-alpha04'\nimplementation 'androidx.compose.runtime:runtime-livedata:1.4.0-alpha01'\n</code></pre>\n<p>Mind you there may be other dependencies that are affected and if you have recently upgraded the dependencies, you may need to rollback the updates and eliminate the library one by one to identify the troublesome one.</p>\n"},{"comment_count":0,"score":2,"last_activity_date":1676245174,"creation_date":1676245174,"answer_id":75430864,"question_id":75263047,"body_markdown":"### Update 2023\r\n\r\nRecently, I had the same issue where most of the duplicate classes belonged to Kotlin. One of the errors was something like this:\r\n\r\n```\r\nDuplicate class kotlin.collections.jdk8.CollectionsJDK8Kt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.21 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.21)\r\n```\r\n\r\nI had this issue because I was using a buggy kotlin version. Upgrade your kotlin version to `1.8.0-Beta`. Follow this:\r\n\r\nin your `android/build.gradle`, first add this in the `ext` section:\r\n\r\n```\r\nkotlinVersion = &quot;1.8.0-Beta&quot;\r\n```\r\n\r\nNow, go down to the dependencies section and add this:\r\n\r\n```\r\nclasspath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlinVersion&quot;\r\n```\r\n\r\nFinally, make sure your `JAVA_HOME` points to a JDK11.\r\n\r\nDoing these fixed my problem. Hope it helps!","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75430864#75430864","title":"Duplicate class in Kotlin Android","body":"<h3>Update 2023</h3>\n<p>Recently, I had the same issue where most of the duplicate classes belonged to Kotlin. One of the errors was something like this:</p>\n<pre><code>Duplicate class kotlin.collections.jdk8.CollectionsJDK8Kt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.21 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.21)\n</code></pre>\n<p>I had this issue because I was using a buggy kotlin version. Upgrade your kotlin version to <code>1.8.0-Beta</code>. Follow this:</p>\n<p>in your <code>android/build.gradle</code>, first add this in the <code>ext</code> section:</p>\n<pre><code>kotlinVersion = &quot;1.8.0-Beta&quot;\n</code></pre>\n<p>Now, go down to the dependencies section and add this:</p>\n<pre><code>classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlinVersion&quot;\n</code></pre>\n<p>Finally, make sure your <code>JAVA_HOME</code> points to a JDK11.</p>\n<p>Doing these fixed my problem. Hope it helps!</p>\n"},{"comments":[{"score":3,"post_type":"answer","creation_date":1681157516,"post_id":75550269,"comment_id":134008430,"body_markdown":"This worked for me. Although I only needed to upgrade the kotlin android plugin. Thanks!","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75550269#comment134008430_75550269","body":"This worked for me. Although I only needed to upgrade the kotlin android plugin. Thanks!"},{"score":4,"post_type":"answer","creation_date":1681221452,"post_id":75550269,"comment_id":134019109,"body_markdown":"Adding the plugin worked for me, although my project is only Java and I don&#39;t use Kotlin at all. This really looks to me like a flaw in Android Studio, if not completely a bug.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75550269#comment134019109_75550269","body":"Adding the plugin worked for me, although my project is only Java and I don&#39;t use Kotlin at all. This really looks to me like a flaw in Android Studio, if not completely a bug."},{"score":0,"post_type":"answer","creation_date":1687170280,"post_id":75550269,"comment_id":134894667,"body_markdown":"same here; adding &quot;implementation (platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))&quot; fixed the issue, EVEN if I have no kotlin code.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75550269#comment134894667_75550269","body":"same here; adding &quot;implementation (platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))&quot; fixed the issue, EVEN if I have no kotlin code."}],"comment_count":3,"score":39,"last_activity_date":1677185936,"creation_date":1677185936,"answer_id":75550269,"question_id":75263047,"body_markdown":"Upgrade kotlin android plugin and kotlin compiler\r\n```groovy\r\nplugins {\r\n    id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.8.10&#39;\r\n}\r\nandroid {\r\n    composeOptions {\r\n        kotlinCompilerExtensionVersion = &quot;1.4.3&quot;\r\n    }\r\n}\r\n```","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75550269#75550269","title":"Duplicate class in Kotlin Android","body":"<p>Upgrade kotlin android plugin and kotlin compiler</p>\n<pre><code>plugins {\n    id 'org.jetbrains.kotlin.android' version '1.8.10'\n}\nandroid {\n    composeOptions {\n        kotlinCompilerExtensionVersion = &quot;1.4.3&quot;\n    }\n}\n</code></pre>\n"},{"comments":[{"score":9,"post_type":"answer","creation_date":1679571977,"post_id":75567658,"comment_id":133747160,"body_markdown":"I&#39;m not using kotlin in a project and this solved my problem.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75567658#comment133747160_75567658","body":"I&#39;m not using kotlin in a project and this solved my problem."},{"score":1,"post_type":"answer","creation_date":1686538855,"post_id":75567658,"comment_id":134807176,"body_markdown":"Unfortunately Kotlin is now a dependency for many of the Android core libraries, so now you are using Kotlin indirectly whether you want it or not.  Unfortunately, that means we get the build problems that come with it.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75567658#comment134807176_75567658","body":"Unfortunately Kotlin is now a dependency for many of the Android core libraries, so now you are using Kotlin indirectly whether you want it or not.  Unfortunately, that means we get the build problems that come with it."}],"comment_count":2,"score":59,"last_activity_date":1701574132,"last_edit_date":1701574132,"creation_date":1677350919,"answer_id":75567658,"question_id":75263047,"body_markdown":"I was getting the same error after upgrading the Android annotation library from version 1.4.0 to 1.6.0,\r\n\r\n    implementation &#39;androidx.annotation:annotation:1.6.0&#39;\r\n\r\nSo I downgraded to 1.5.0 and the error was gone:\r\n\r\n    implementation &#39;androidx.annotation:annotation:1.5.0&#39;\r\n\r\n\r\n\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75567658#75567658","title":"Duplicate class in Kotlin Android","body":"<p>I was getting the same error after upgrading the Android annotation library from version 1.4.0 to 1.6.0,</p>\n<pre><code>implementation 'androidx.annotation:annotation:1.6.0'\n</code></pre>\n<p>So I downgraded to 1.5.0 and the error was gone:</p>\n<pre><code>implementation 'androidx.annotation:annotation:1.5.0'\n</code></pre>\n"},{"comment_count":0,"score":1,"last_activity_date":1677532112,"creation_date":1677532112,"answer_id":75585591,"question_id":75263047,"body_markdown":"The accepted answer worked for me, but the Kotlin DSL syntax is:\r\n```kt\r\nkotlin(&quot;android&quot;).version(&quot;1.8.10&quot;).apply(false)\r\n```","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75585591#75585591","title":"Duplicate class in Kotlin Android","body":"<p>The accepted answer worked for me, but the Kotlin DSL syntax is:</p>\n<pre><code>kotlin(&quot;android&quot;).version(&quot;1.8.10&quot;).apply(false)\n</code></pre>\n"},{"comment_count":0,"score":1,"last_activity_date":1677834638,"creation_date":1677834638,"answer_id":75625126,"question_id":75263047,"body_markdown":"I first tried David Fraser&#39;s solution (constraints {...}) and it worked fine, but I found it strange and discarded it.\r\nInstead I changed the plugins as follows:\r\n\r\n    id &#39;org.jetbrains.kotlin.multiplatform&#39; version &#39;1.8.0&#39; apply false // before 1.7.10\r\n\r\nThis also fixed the error.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75625126#75625126","title":"Duplicate class in Kotlin Android","body":"<p>I first tried David Fraser's solution (constraints {...}) and it worked fine, but I found it strange and discarded it.\nInstead I changed the plugins as follows:</p>\n<pre><code>id 'org.jetbrains.kotlin.multiplatform' version '1.8.0' apply false // before 1.7.10\n</code></pre>\n<p>This also fixed the error.</p>\n"},{"comment_count":0,"score":3,"last_activity_date":1678479368,"last_edit_date":1678479368,"creation_date":1678016575,"answer_id":75641974,"question_id":75263047,"body_markdown":"I had the same errors in my project. What finally helped me was the following steps\r\n    \r\n1-I have updated the buildScript: as below\r\n    \r\n    buildscript {\r\n        ext {\r\n            compose_ui_version = &#39;1.3.3&#39;\r\n        }\r\n    }\r\n    then change pluggin \r\n    From\r\n    \r\n    plugins {\r\n    ....\r\n    id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.7.10&#39; apply false\r\n    \r\n    }\r\n    \r\n    To\r\n    \r\n    plugins {\r\n    ....\r\n    id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.8.10&#39; apply false\r\n    }\r\n    \r\nlastly updated in build.grade(app)\r\n    \r\n   Change in android scope {}\r\n```\r\n    android {\r\n    ......\r\n    composeOptions {\r\n            kotlinCompilerExtensionVersion &#39;1.2.0&#39;\r\n        }\r\n    .......\r\n    }\r\n ```   \r\nTo the following and the errors were gone\r\n    \r\n     composeOptions {\r\n            kotlinCompilerExtensionVersion = &quot;1.4.3&quot;\r\n        }\r\n    \r\n    Hope it helps someone else ","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75641974#75641974","title":"Duplicate class in Kotlin Android","body":"<p>I had the same errors in my project. What finally helped me was the following steps</p>\n<p>1-I have updated the buildScript: as below</p>\n<pre><code>buildscript {\n    ext {\n        compose_ui_version = '1.3.3'\n    }\n}\nthen change pluggin \nFrom\n\nplugins {\n....\nid 'org.jetbrains.kotlin.android' version '1.7.10' apply false\n\n}\n\nTo\n\nplugins {\n....\nid 'org.jetbrains.kotlin.android' version '1.8.10' apply false\n}\n</code></pre>\n<p>lastly updated in build.grade(app)</p>\n<p>Change in android scope {}</p>\n<pre><code>    android {\n    ......\n    composeOptions {\n            kotlinCompilerExtensionVersion '1.2.0'\n        }\n    .......\n    }\n</code></pre>\n<p>To the following and the errors were gone</p>\n<pre><code> composeOptions {\n        kotlinCompilerExtensionVersion = &quot;1.4.3&quot;\n    }\n\nHope it helps someone else \n</code></pre>\n"},{"comments":[{"score":0,"post_type":"answer","creation_date":1678595959,"post_id":75663164,"comment_id":133562820,"body_markdown":"Your answer could be improved with additional supporting information. Please [edit] to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75663164#comment133562820_75663164","body":"Your answer could be improved with additional supporting information. Please <a href=\"https://stackoverflow.com/posts/75663164/edit\">edit</a> to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"comment_count":1,"score":0,"last_activity_date":1678198741,"creation_date":1678198741,"answer_id":75663164,"question_id":75263047,"body_markdown":"Replace this\r\n\r\n    implementation(&quot;androidx.navigation:navigation-compose:2.6.0-alpha06&quot;)\r\n\r\nWith\r\n\r\n    implementation(&quot;androidx.navigation:navigation-compose:2.6.0-alpha04&quot;)","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75663164#75663164","title":"Duplicate class in Kotlin Android","body":"<p>Replace this</p>\n<pre><code>implementation(&quot;androidx.navigation:navigation-compose:2.6.0-alpha06&quot;)\n</code></pre>\n<p>With</p>\n<pre><code>implementation(&quot;androidx.navigation:navigation-compose:2.6.0-alpha04&quot;)\n</code></pre>\n"},{"comment_count":0,"score":13,"last_activity_date":1678207468,"creation_date":1678207468,"answer_id":75664860,"question_id":75263047,"body_markdown":"I was using `org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.10` before in our SDK and then I updated kotlin to v1.8.0 and that&#39;s when I started getting the above error in our Android Java front end application.\r\nUsing `org.jetbrains.kotlin:kotlin-bom` resolved the issue with transitive dependencies and might be a cleaner approach since it doesn&#39;t leak Kotlin details into the Java application.\r\n\r\nso I just replaced \r\n```\r\nimplementation &quot;org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.10&quot;\r\n```\r\n\r\nwith below which solved the problem for me.\r\n\r\n```\r\n// Align versions of all Kotlin components\r\nimplementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\r\nimplementation &quot;org.jetbrains.kotlin:kotlin-stdlib:1.8.0&quot;\r\n``` ","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75664860#75664860","title":"Duplicate class in Kotlin Android","body":"<p>I was using <code>org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.10</code> before in our SDK and then I updated kotlin to v1.8.0 and that's when I started getting the above error in our Android Java front end application.\nUsing <code>org.jetbrains.kotlin:kotlin-bom</code> resolved the issue with transitive dependencies and might be a cleaner approach since it doesn't leak Kotlin details into the Java application.</p>\n<p>so I just replaced</p>\n<pre><code>implementation &quot;org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.10&quot;\n</code></pre>\n<p>with below which solved the problem for me.</p>\n<pre><code>// Align versions of all Kotlin components\nimplementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\nimplementation &quot;org.jetbrains.kotlin:kotlin-stdlib:1.8.0&quot;\n</code></pre>\n"},{"comments":[{"score":6,"post_type":"answer","creation_date":1682089173,"post_id":75719642,"comment_id":134165629,"body_markdown":"This worked for me even though our project is a pure Java project without any Kotlin code. The clue that it would came from here: https://youtrack.jetbrains.com/issue/KT-55297/kotlin-stdlib-should-declare-constraints-on-kotlin-stdlib-jdk8-and-kotlin-stdlib-jdk7","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75719642#comment134165629_75719642","body":"This worked for me even though our project is a pure Java project without any Kotlin code. The clue that it would came from here: <a href=\"https://youtrack.jetbrains.com/issue/KT-55297/kotlin-stdlib-should-declare-constraints-on-kotlin-stdlib-jdk8-and-kotlin-stdlib-jdk7\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com/issue/KT-55297/&hellip;</a>"},{"score":2,"post_type":"answer","creation_date":1683218899,"post_id":75719642,"comment_id":134336753,"body_markdown":"This fixed my issue as well","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75719642#comment134336753_75719642","body":"This fixed my issue as well"},{"score":1,"post_type":"answer","creation_date":1685940562,"post_id":75719642,"comment_id":134725645,"body_markdown":"This also worked for me. I think this is sufficient if you are not using Kotlin directly.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75719642#comment134725645_75719642","body":"This also worked for me. I think this is sufficient if you are not using Kotlin directly."},{"score":0,"post_type":"answer","creation_date":1687361557,"post_id":75719642,"comment_id":134926990,"body_markdown":"This also worked for me","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75719642#comment134926990_75719642","body":"This also worked for me"},{"score":1,"post_type":"answer","creation_date":1687521525,"post_id":75719642,"comment_id":134952268,"body_markdown":"Fixed it for me as well: project is pure Java (no Kotlin).","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75719642#comment134952268_75719642","body":"Fixed it for me as well: project is pure Java (no Kotlin)."},{"score":0,"post_type":"answer","creation_date":1688060778,"post_id":75719642,"comment_id":135026649,"body_markdown":"I logged in just to upvote this","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75719642#comment135026649_75719642","body":"I logged in just to upvote this"},{"score":0,"post_type":"answer","creation_date":1688647151,"post_id":75719642,"comment_id":135103887,"body_markdown":"Bravo... You saved my life bro... Thanks..","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75719642#comment135103887_75719642","body":"Bravo... You saved my life bro... Thanks.."},{"score":0,"post_type":"answer","creation_date":1689009017,"post_id":75719642,"comment_id":135149503,"body_markdown":"This should be marked as correct answer (y)","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75719642#comment135149503_75719642","body":"This should be marked as correct answer (y)"},{"score":0,"post_type":"answer","creation_date":1695196533,"post_id":75719642,"comment_id":135990241,"body_markdown":"Hello!\n\nThis worked for me. Thank you.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75719642#comment135990241_75719642","body":"Hello!  This worked for me. Thank you."}],"comment_count":9,"score":141,"last_activity_date":1678698943,"last_edit_date":1678698943,"creation_date":1678697339,"answer_id":75719642,"question_id":75263047,"body_markdown":"I have tried all the previous solutions but after adding the below code it was working.\r\n\r\n    dependencies {\r\n       ... ... ...\r\n       implementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\r\n       ... ... ...\r\n    }\r\n\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75719642#75719642","title":"Duplicate class in Kotlin Android","body":"<p>I have tried all the previous solutions but after adding the below code it was working.</p>\n<pre><code>dependencies {\n   ... ... ...\n   implementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\n   ... ... ...\n}\n</code></pre>\n"},{"comment_count":0,"score":0,"last_activity_date":1678881039,"creation_date":1678881039,"answer_id":75744310,"question_id":75263047,"body_markdown":"Replace \r\n\r\n`classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.7.20&quot;` \r\n\r\nWith \r\n\r\n`classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.8.10&quot;`\r\n\r\nAnd then If you used `kotlin-android-extensions` plugin, then remove this line. And use `View binding` to whole project.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75744310#75744310","title":"Duplicate class in Kotlin Android","body":"<p>Replace</p>\n<p><code>classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.7.20&quot;</code></p>\n<p>With</p>\n<p><code>classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.8.10&quot;</code></p>\n<p>And then If you used <code>kotlin-android-extensions</code> plugin, then remove this line. And use <code>View binding</code> to whole project.</p>\n"},{"comment_count":0,"score":0,"last_activity_date":1679100401,"creation_date":1679100401,"answer_id":75773243,"question_id":75263047,"body_markdown":"Duplicate id detected is because there is a duplicate id you defined. For example, you defined the id in project level build.gradle file and if you define the same id in your module-level build.gradle file then it is simply a duplicate id problem. ","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75773243#75773243","title":"Duplicate class in Kotlin Android","body":"<p>Duplicate id detected is because there is a duplicate id you defined. For example, you defined the id in project level build.gradle file and if you define the same id in your module-level build.gradle file then it is simply a duplicate id problem.</p>\n"},{"comment_count":0,"score":4,"last_activity_date":1679350673,"creation_date":1679350673,"answer_id":75795808,"question_id":75263047,"body_markdown":"I ran into this issue today and I fixed it by upgrading both `Kotlin` `std-lib` for android and the `std-lib` itself.\r\nAlso it&#39;s worth mentioning that if you&#39;re using compose, you have upgrade the  `kotlinCompilerExtensionVersion`\r\n\r\nHere is the final setup\r\n\r\n- gradle file at Module level\r\n```groovy\r\ncomposeOptions {\r\n    kotlinCompilerExtensionVersion &#39;1.4.3&#39;\r\n}\r\n```\r\n\r\n- root project gradle file\r\n```groovy\r\nplugins {\r\n    id &#39;com.android.application&#39; version &#39;7.3.1&#39; apply false\r\n    id &#39;com.android.library&#39; version &#39;7.3.1&#39; apply false\r\n    id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.8.10&#39; apply false\r\n    id &#39;org.jetbrains.kotlin.jvm&#39; version &#39;1.8.10&#39; apply false\r\n}\r\n```\r\n\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75795808#75795808","title":"Duplicate class in Kotlin Android","body":"<p>I ran into this issue today and I fixed it by upgrading both <code>Kotlin</code> <code>std-lib</code> for android and the <code>std-lib</code> itself.\nAlso it's worth mentioning that if you're using compose, you have upgrade the  <code>kotlinCompilerExtensionVersion</code></p>\n<p>Here is the final setup</p>\n<ul>\n<li>gradle file at Module level</li>\n</ul>\n<pre><code>composeOptions {\n    kotlinCompilerExtensionVersion '1.4.3'\n}\n</code></pre>\n<ul>\n<li>root project gradle file</li>\n</ul>\n<pre><code>plugins {\n    id 'com.android.application' version '7.3.1' apply false\n    id 'com.android.library' version '7.3.1' apply false\n    id 'org.jetbrains.kotlin.android' version '1.8.10' apply false\n    id 'org.jetbrains.kotlin.jvm' version '1.8.10' apply false\n}\n</code></pre>\n"},{"comment_count":0,"score":0,"last_activity_date":1680173792,"creation_date":1680173792,"answer_id":75887353,"question_id":75263047,"body_markdown":"If you are upgrading to 1.8.0\r\nthen you should add\r\n\r\n        implementation &quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlin_version&quot;\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75887353#75887353","title":"Duplicate class in Kotlin Android","body":"<p>If you are upgrading to 1.8.0\nthen you should add</p>\n<pre><code>    implementation &quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlin_version&quot;\n</code></pre>\n"},{"comments":[{"score":1,"post_type":"answer","creation_date":1680503208,"post_id":75898804,"comment_id":133903249,"body_markdown":"it just can be a temporary solution, but it helped me a lot !","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75898804#comment133903249_75898804","body":"it just can be a temporary solution, but it helped me a lot !"}],"comment_count":1,"score":2,"last_activity_date":1680267400,"creation_date":1680267400,"answer_id":75898804,"question_id":75263047,"body_markdown":"Downgrade these deps to\r\n\r\n    implementation &#39;androidx.lifecycle:lifecycle-runtime-ktx:2.3.1&#39;\r\n    implementation &#39;androidx.activity:activity-compose:1.5.1&#39;","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75898804#75898804","title":"Duplicate class in Kotlin Android","body":"<p>Downgrade these deps to</p>\n<pre><code>implementation 'androidx.lifecycle:lifecycle-runtime-ktx:2.3.1'\nimplementation 'androidx.activity:activity-compose:1.5.1'\n</code></pre>\n"},{"comment_count":0,"score":1,"last_activity_date":1680507844,"last_edit_date":1680507844,"creation_date":1680507400,"answer_id":75917014,"question_id":75263047,"body_markdown":"Such problem occurred after upgrading jetpack compose from `1.3.0` to `1.4.0`.\r\n\r\nIf you find this problem, please refer to the [Kotlin Compose compatibility map][1] in order to find **matching Kotlin/Compose Compiler** versions.\r\n\r\nWhen you have found them, you need to make sure that:\r\n- Gradle plugin has the right version (in `buildSrc`: `build.gradle.kts` for KTX gradle or in regular Gradle the root `build.gradle` one: `implementation(&quot;org.jetbrains.kotlin:kotlin-gradle-plugin:&lt;KOTLIN_VERSION&gt;&quot;)`)\r\n- Kotlin dependency has right version (if you use multi-module app and use Kotlin directly (`implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib:&lt;KOTLIN_VERSION&gt;&quot;)`)\r\n- `kotlinCompilerExtensionVersion = &lt;COMPOSE_VERSION&gt;` is matching\r\n\r\n\r\n  [1]: https://developer.android.com/jetpack/androidx/releases/compose-kotlin","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75917014#75917014","title":"Duplicate class in Kotlin Android","body":"<p>Such problem occurred after upgrading jetpack compose from <code>1.3.0</code> to <code>1.4.0</code>.</p>\n<p>If you find this problem, please refer to the <a href=\"https://developer.android.com/jetpack/androidx/releases/compose-kotlin\" rel=\"nofollow noreferrer\">Kotlin Compose compatibility map</a> in order to find <strong>matching Kotlin/Compose Compiler</strong> versions.</p>\n<p>When you have found them, you need to make sure that:</p>\n<ul>\n<li>Gradle plugin has the right version (in <code>buildSrc</code>: <code>build.gradle.kts</code> for KTX gradle or in regular Gradle the root <code>build.gradle</code> one: <code>implementation(&quot;org.jetbrains.kotlin:kotlin-gradle-plugin:&lt;KOTLIN_VERSION&gt;&quot;)</code>)</li>\n<li>Kotlin dependency has right version (if you use multi-module app and use Kotlin directly (<code>implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib:&lt;KOTLIN_VERSION&gt;&quot;)</code>)</li>\n<li><code>kotlinCompilerExtensionVersion = &lt;COMPOSE_VERSION&gt;</code> is matching</li>\n</ul>\n"},{"comment_count":0,"score":6,"last_activity_date":1680805229,"creation_date":1680805229,"answer_id":75952607,"question_id":75263047,"body_markdown":"I had the same error on my Kotlin project. When I add Ktor to my project and upgraded the library versions, and then I got the wired long error. This is how I fixed it.\r\n\r\nI used compose version 1.4.0\r\n\r\n    ext {\r\n        compose_ui_version = &#39;1.4.0&#39;\r\n    }\r\nkotlin version `1.8.0`, the latest one `1.8.10` not compatible with compose `1.4.0` So I used,\r\n\r\n    id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.8.0&#39; apply false\r\nThen, adjust the `composeOptions` on app level build.gradle file, like\r\n\r\n    composeOptions {\r\n        kotlinCompilerExtensionVersion &#39;1.4.0&#39;\r\n    }\r\nThese are the three changes that I have done and I got escaped from the wired error. Hope this will help someone.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75952607#75952607","title":"Duplicate class in Kotlin Android","body":"<p>I had the same error on my Kotlin project. When I add Ktor to my project and upgraded the library versions, and then I got the wired long error. This is how I fixed it.</p>\n<p>I used compose version 1.4.0</p>\n<pre><code>ext {\n    compose_ui_version = '1.4.0'\n}\n</code></pre>\n<p>kotlin version <code>1.8.0</code>, the latest one <code>1.8.10</code> not compatible with compose <code>1.4.0</code> So I used,</p>\n<pre><code>id 'org.jetbrains.kotlin.android' version '1.8.0' apply false\n</code></pre>\n<p>Then, adjust the <code>composeOptions</code> on app level build.gradle file, like</p>\n<pre><code>composeOptions {\n    kotlinCompilerExtensionVersion '1.4.0'\n}\n</code></pre>\n<p>These are the three changes that I have done and I got escaped from the wired error. Hope this will help someone.</p>\n"},{"comment_count":0,"score":3,"last_activity_date":1681231991,"creation_date":1681231991,"answer_id":75988375,"question_id":75263047,"body_markdown":"kotlinCompilerExtensionVersion(compose) -&gt; kotlin_version  \r\n\r\n1.4.4 -&gt; 1.8.10\r\n\r\n1.4.3 -&gt; 1.8.10\r\n\r\n1.4.2 -&gt; 1.8.10\r\n\r\n1.4.1 -&gt; 1.8.0\r\n\r\n1.4.0 -&gt; 1.8.0\r\n\r\n1.4.0-alpha02 -&gt; 1.7.21\r\n\r\n1.4.0-alpha01 -&gt; 1.7.20\r\n\r\n1.3.2 -&gt;1.7.20\r\n\r\n...\r\n\r\nOther versions: https://developer.android.com/jetpack/androidx/releases/compose-kotlin","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/75988375#75988375","title":"Duplicate class in Kotlin Android","body":"<p>kotlinCompilerExtensionVersion(compose) -&gt; kotlin_version</p>\n<p>1.4.4 -&gt; 1.8.10</p>\n<p>1.4.3 -&gt; 1.8.10</p>\n<p>1.4.2 -&gt; 1.8.10</p>\n<p>1.4.1 -&gt; 1.8.0</p>\n<p>1.4.0 -&gt; 1.8.0</p>\n<p>1.4.0-alpha02 -&gt; 1.7.21</p>\n<p>1.4.0-alpha01 -&gt; 1.7.20</p>\n<p>1.3.2 -&gt;1.7.20</p>\n<p>...</p>\n<p>Other versions: <a href=\"https://developer.android.com/jetpack/androidx/releases/compose-kotlin\" rel=\"nofollow noreferrer\">https://developer.android.com/jetpack/androidx/releases/compose-kotlin</a></p>\n"},{"comment_count":0,"score":2,"last_activity_date":1681375297,"creation_date":1681375297,"answer_id":76003404,"question_id":75263047,"body_markdown":"As I checked all ways, if there is a alpha version like this :\r\n\r\n     implementation &#39;androidx.appcompat:appcompat:1.7.0-alpha02&#39;\r\n**change it to**\r\n\r\n    implementation &#39;androidx.appcompat:appcompat:1.6.1&#39;\r\n\r\n\r\nthen **Add** class path in `build.gradle()`\r\n\r\n     dependencies {\r\n         \r\n            classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.8.0&quot;\r\n    ...\r\n        }","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76003404#76003404","title":"Duplicate class in Kotlin Android","body":"<p>As I checked all ways, if there is a alpha version like this :</p>\n<pre><code> implementation 'androidx.appcompat:appcompat:1.7.0-alpha02'\n</code></pre>\n<p><strong>change it to</strong></p>\n<pre><code>implementation 'androidx.appcompat:appcompat:1.6.1'\n</code></pre>\n<p>then <strong>Add</strong> class path in <code>build.gradle()</code></p>\n<pre><code> dependencies {\n     \n        classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.8.0&quot;\n...\n    }\n</code></pre>\n"},{"comment_count":0,"score":6,"last_activity_date":1681907256,"creation_date":1681907256,"answer_id":76054519,"question_id":75263047,"body_markdown":"    lifecycle-viewmodel-ktx-2.6.1\r\n\r\ndown \r\n\r\n    lifecycle-viewmodel-ktx-2.5.1\r\n\r\nI managed to get it working by lowering the dependency values.\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76054519#76054519","title":"Duplicate class in Kotlin Android","body":"<pre><code>lifecycle-viewmodel-ktx-2.6.1\n</code></pre>\n<p>down</p>\n<pre><code>lifecycle-viewmodel-ktx-2.5.1\n</code></pre>\n<p>I managed to get it working by lowering the dependency values.</p>\n"},{"comment_count":0,"score":0,"last_activity_date":1682071192,"creation_date":1682071192,"answer_id":76072071,"question_id":75263047,"body_markdown":"By [@ArdaKazancı answer][1], I did a similar change: (agp:7.4.2, gradle: 7.5)\r\n\r\n    implementation &#39;androidx.recyclerview:recyclerview:1.3.1&#39;\r\n    implementation &#39;androidx.core:core:1.10.0&#39;\r\n\r\nto\r\n\r\n    implementation &#39;androidx.recyclerview:recyclerview:1.2.1&#39;\r\n    implementation &#39;androidx.core:core:1.9.0&#39; \r\n\r\n\r\n  [1]: https://stackoverflow.com/a/76054519/6576302","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76072071#76072071","title":"Duplicate class in Kotlin Android","body":"<p>By <a href=\"https://stackoverflow.com/a/76054519/6576302\">@ArdaKazancı answer</a>, I did a similar change: (agp:7.4.2, gradle: 7.5)</p>\n<pre><code>implementation 'androidx.recyclerview:recyclerview:1.3.1'\nimplementation 'androidx.core:core:1.10.0'\n</code></pre>\n<p>to</p>\n<pre><code>implementation 'androidx.recyclerview:recyclerview:1.2.1'\nimplementation 'androidx.core:core:1.9.0' \n</code></pre>\n"},{"comment_count":0,"score":2,"last_activity_date":1701574464,"last_edit_date":1701574464,"creation_date":1682452649,"answer_id":76104959,"question_id":75263047,"body_markdown":"It is because of a Compose compiler version and Kotlin version incompatibility. when I posting this answer, most updated compatible versions were:\r\n\r\n * Compose compiler version: 1.4.6\r\n * Kotlin Version: 1.8.20\r\n\r\nYou can always find most updated compatible versions on this page: *[Compose to Kotlin Compatibility Map][1]* \r\n\r\nYou can set this versions in app-level Gradle file like this:\r\n\r\n```\r\ncomposeOptions {\r\n    kotlinCompilerExtensionVersion = &quot;1.4.3&quot;\r\n}\r\n```\r\nand\r\n\r\n```\r\nplugins {\r\n    id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.8.10&#39;\r\n}\r\n```\r\n\r\n\r\n  [1]: https://developer.android.com/jetpack/androidx/releases/compose-kotlin","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76104959#76104959","title":"Duplicate class in Kotlin Android","body":"<p>It is because of a Compose compiler version and Kotlin version incompatibility. when I posting this answer, most updated compatible versions were:</p>\n<ul>\n<li>Compose compiler version: 1.4.6</li>\n<li>Kotlin Version: 1.8.20</li>\n</ul>\n<p>You can always find most updated compatible versions on this page: <em><a href=\"https://developer.android.com/jetpack/androidx/releases/compose-kotlin\" rel=\"nofollow noreferrer\">Compose to Kotlin Compatibility Map</a></em></p>\n<p>You can set this versions in app-level Gradle file like this:</p>\n<pre><code>composeOptions {\n    kotlinCompilerExtensionVersion = &quot;1.4.3&quot;\n}\n</code></pre>\n<p>and</p>\n<pre><code>plugins {\n    id 'org.jetbrains.kotlin.android' version '1.8.10'\n}\n</code></pre>\n"},{"comment_count":0,"score":3,"last_activity_date":1682709489,"creation_date":1682709489,"answer_id":76132651,"question_id":75263047,"body_markdown":"I&#39;m getting similar error. These settings worked for me.\r\n\r\nNote: I&#39;m using `Android Studio Flamingo | 2022.2.1`\r\n\r\n`build.gradle(:project)` settings\r\n\r\nOld use:\r\n\r\n```gradle\r\nbuildscript {\r\n    ext.kotlin_version = &quot;1.7.20&quot;\r\n    repositories {\r\n        google()\r\n        mavenCentral()\r\n    }\r\n    dependencies {\r\n        classpath &#39;com.android.tools.build:gradle:7.4.2&#39;\r\n        classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version&quot;\r\n    }\r\n}\r\n...\r\n```\r\n\r\nNew use:\r\n\r\n```gradle\r\nbuildscript {\r\n    ext.kotlin_version = &quot;1.8.0&quot;\r\n    repositories {\r\n        google()\r\n        mavenCentral()\r\n    }\r\n    dependencies {\r\n        classpath &#39;com.android.tools.build:gradle:8.0.2&#39;\r\n        classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version&quot;\r\n    }\r\n}\r\n...\r\n```\r\n\r\n`build.gradle(:app)` settings\r\n\r\nOld use:\r\n\r\n```gradle\r\n...\r\ncompileOptions {\r\n        sourceCompatibility JavaVersion.VERSION_1_8\r\n        targetCompatibility JavaVersion.VERSION_1_8\r\n    }\r\n    kotlinOptions {\r\n        jvmTarget = &#39;1.8&#39;\r\n    }\r\n...\r\n```\r\n\r\nNew use:\r\n\r\n```gradle\r\n...\r\ncompileOptions {\r\n        sourceCompatibility JavaVersion.VERSION_17\r\n        targetCompatibility JavaVersion.VERSION_17\r\n    }\r\n    kotlinOptions {\r\n        jvmTarget = &#39;17&#39;\r\n    }\r\n...\r\n```\r\n\r\nGradle Projects Settings\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/427JG.png\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76132651#76132651","title":"Duplicate class in Kotlin Android","body":"<p>I'm getting similar error. These settings worked for me.</p>\n<p>Note: I'm using <code>Android Studio Flamingo | 2022.2.1</code></p>\n<p><code>build.gradle(:project)</code> settings</p>\n<p>Old use:</p>\n<pre><code>buildscript {\n    ext.kotlin_version = &quot;1.7.20&quot;\n    repositories {\n        google()\n        mavenCentral()\n    }\n    dependencies {\n        classpath 'com.android.tools.build:gradle:7.4.2'\n        classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version&quot;\n    }\n}\n...\n</code></pre>\n<p>New use:</p>\n<pre><code>buildscript {\n    ext.kotlin_version = &quot;1.8.0&quot;\n    repositories {\n        google()\n        mavenCentral()\n    }\n    dependencies {\n        classpath 'com.android.tools.build:gradle:8.0.2'\n        classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version&quot;\n    }\n}\n...\n</code></pre>\n<p><code>build.gradle(:app)</code> settings</p>\n<p>Old use:</p>\n<pre><code>...\ncompileOptions {\n        sourceCompatibility JavaVersion.VERSION_1_8\n        targetCompatibility JavaVersion.VERSION_1_8\n    }\n    kotlinOptions {\n        jvmTarget = '1.8'\n    }\n...\n</code></pre>\n<p>New use:</p>\n<pre><code>...\ncompileOptions {\n        sourceCompatibility JavaVersion.VERSION_17\n        targetCompatibility JavaVersion.VERSION_17\n    }\n    kotlinOptions {\n        jvmTarget = '17'\n    }\n...\n</code></pre>\n<p>Gradle Projects Settings</p>\n<p><a href=\"https://i.stack.imgur.com/427JG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/427JG.png\" alt=\"enter image description here\" /></a></p>\n"},{"comment_count":0,"score":1,"last_activity_date":1683060513,"creation_date":1683060513,"answer_id":76158759,"question_id":75263047,"body_markdown":"On my Mac.  I hadn&#39;t worked on my app in a while 6-12 months maybe.  I was just checking in to make sure that Android Studio and the dependencies weren&#39;t too out of date.  I received the same error as noted in the question.\r\n\r\n1) When I tried to change my `ext.kotlin_version = &quot;1.7.20&quot;` to 1.8.x, I received a warning about `classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version&quot;` being inconsistent with my Kotlin version.\r\n\r\n2) When I went into `Tools`-&gt;`Kotlin`-&gt;`Configure Kotlin Updates` and noticed that I couldn&#39;t get the the recent 1.8.20 version.\r\n\r\n[![Tool Menu][1]][1]\r\n[![Kotlin Config Window][2]][2]\r\n\r\n3) Then went to see if I needed an `Android Studio`-&gt;`Check for updates...` \r\n[![enter image description here][3]][3]\r\n\r\n4) I in fact did need a major release update arctic fox to flamingo.\r\nAfter upgrading to Flamingo, I was able to update both locations of Kotlin Version to 1.8.20.  `Tools`-&gt;`Kotlin`-&gt;`Configure Kotlin Updates` and `ext.kotlin_version = &quot;1.8.20&quot;`\r\n\r\n5) Did `File`-&gt;`Invalidate Cache` and reboot\r\n6) Did `Build`-&gt;`Clean Project`\r\n7) I updated whatever else needed to be updated with Flamingo\r\n8) Built and ran -&gt; and ...\r\n`BUILD SUCCESSFUL in 1m 6s`\r\n`38 actionable tasks: 38 executed`\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/fpcHb.png\r\n  [2]: https://i.stack.imgur.com/2um1v.png\r\n  [3]: https://i.stack.imgur.com/IZzPQ.png","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76158759#76158759","title":"Duplicate class in Kotlin Android","body":"<p>On my Mac.  I hadn't worked on my app in a while 6-12 months maybe.  I was just checking in to make sure that Android Studio and the dependencies weren't too out of date.  I received the same error as noted in the question.</p>\n<ol>\n<li><p>When I tried to change my <code>ext.kotlin_version = &quot;1.7.20&quot;</code> to 1.8.x, I received a warning about <code>classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version&quot;</code> being inconsistent with my Kotlin version.</p>\n</li>\n<li><p>When I went into <code>Tools</code>-&gt;<code>Kotlin</code>-&gt;<code>Configure Kotlin Updates</code> and noticed that I couldn't get the the recent 1.8.20 version.</p>\n</li>\n</ol>\n<p><a href=\"https://i.stack.imgur.com/fpcHb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fpcHb.png\" alt=\"Tool Menu\" /></a>\n<a href=\"https://i.stack.imgur.com/2um1v.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2um1v.png\" alt=\"Kotlin Config Window\" /></a></p>\n<ol start=\"3\">\n<li><p>Then went to see if I needed an <code>Android Studio</code>-&gt;<code>Check for updates...</code>\n<a href=\"https://i.stack.imgur.com/IZzPQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IZzPQ.png\" alt=\"enter image description here\" /></a></p>\n</li>\n<li><p>I in fact did need a major release update arctic fox to flamingo.\nAfter upgrading to Flamingo, I was able to update both locations of Kotlin Version to 1.8.20.  <code>Tools</code>-&gt;<code>Kotlin</code>-&gt;<code>Configure Kotlin Updates</code> and <code>ext.kotlin_version = &quot;1.8.20&quot;</code></p>\n</li>\n<li><p>Did <code>File</code>-&gt;<code>Invalidate Cache</code> and reboot</p>\n</li>\n<li><p>Did <code>Build</code>-&gt;<code>Clean Project</code></p>\n</li>\n<li><p>I updated whatever else needed to be updated with Flamingo</p>\n</li>\n<li><p>Built and ran -&gt; and ...\n<code>BUILD SUCCESSFUL in 1m 6s</code>\n<code>38 actionable tasks: 38 executed</code></p>\n</li>\n</ol>\n"},{"comment_count":0,"score":5,"last_activity_date":1701574519,"last_edit_date":1701574519,"creation_date":1683361856,"answer_id":76187916,"question_id":75263047,"body_markdown":"Workaround for earlier KGP versions now is:\r\n\r\n### File *app/build.gradle*\r\n\r\n    dependencies {\r\n        constraints {\r\n            implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.8.0&quot;) {\r\n                because(&quot;kotlin-stdlib-jdk7 is now a part of kotlin-stdlib&quot;)\r\n            }\r\n            implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.0&quot;) {\r\n                because(&quot;kotlin-stdlib-jdk8 is now a part of kotlin-stdlib&quot;)\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76187916#76187916","title":"Duplicate class in Kotlin Android","body":"<p>Workaround for earlier KGP versions now is:</p>\n<h3>File <em>app/build.gradle</em></h3>\n<pre><code>dependencies {\n    constraints {\n        implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.8.0&quot;) {\n            because(&quot;kotlin-stdlib-jdk7 is now a part of kotlin-stdlib&quot;)\n        }\n        implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.0&quot;) {\n            because(&quot;kotlin-stdlib-jdk8 is now a part of kotlin-stdlib&quot;)\n        }\n    }\n}\n</code></pre>\n"},{"comment_count":0,"score":6,"last_activity_date":1684068968,"creation_date":1684068968,"answer_id":76247603,"question_id":75263047,"body_markdown":"I fixed it by making Compose Compiler and JetBrains Kotlin plugins compatible\r\n\r\nFirst, make sure are you using **org.jetbrains.kotlin.android** plugin version above 1.8.0.  \r\n\r\n**build.gradle(Project)**\r\n```\r\nplugins {\r\n  ...\r\n  id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.8.21&#39; apply false\r\n}\r\n```\r\n\r\n\r\nThen check compatible version of Compose Compiler from below link and update **build.gradle(app)**:  \r\nhttps://developer.android.com/jetpack/androidx/releases/compose-kotlin#pre-release_kotlin_compatibility\r\n\r\n\r\n```\r\nandroid {\r\n  ...\r\n  composeOptions {\r\n    kotlinCompilerExtensionVersion &#39;1.4.7&#39;\r\n  }\r\n}\r\n```\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76247603#76247603","title":"Duplicate class in Kotlin Android","body":"<p>I fixed it by making Compose Compiler and JetBrains Kotlin plugins compatible</p>\n<p>First, make sure are you using <strong>org.jetbrains.kotlin.android</strong> plugin version above 1.8.0.</p>\n<p><strong>build.gradle(Project)</strong></p>\n<pre><code>plugins {\n  ...\n  id 'org.jetbrains.kotlin.android' version '1.8.21' apply false\n}\n</code></pre>\n<p>Then check compatible version of Compose Compiler from below link and update <strong>build.gradle(app)</strong>:<br />\n<a href=\"https://developer.android.com/jetpack/androidx/releases/compose-kotlin#pre-release_kotlin_compatibility\" rel=\"noreferrer\">https://developer.android.com/jetpack/androidx/releases/compose-kotlin#pre-release_kotlin_compatibility</a></p>\n<pre><code>android {\n  ...\n  composeOptions {\n    kotlinCompilerExtensionVersion '1.4.7'\n  }\n}\n</code></pre>\n"},{"comment_count":0,"score":0,"last_activity_date":1684404183,"creation_date":1684404183,"answer_id":76279693,"question_id":75263047,"body_markdown":"This duplication happens because some of the libraries still use module `org.jetbrains.kotlin:kotlin-stdlib-jdk8` or `org.jetbrains.kotlin:kotlin-stdlib-jdk7` instead of the new module `org.jetbrains.kotlin:kotlin-stdlib`, therefore the class duplication accure.\r\n\r\nTo fix this we need to replace this module by ourselves:\r\n\r\n```` \r\nmodules {\r\n        module(&#39;org.jetbrains.kotlin:kotlin-stdlib-jdk8&#39;)\r\n                { replacedBy &#39;org.jetbrains.kotlin:kotlin-stdlib&#39;, &#39;kotlin fixes&#39; }\r\n        module(&#39;org.jetbrains.kotlin:kotlin-stdlib-jdk7&#39;)\r\n                { replacedBy &#39;org.jetbrains.kotlin:kotlin-stdlib&#39;, &#39;kotlin fixes&#39; }\r\n    }\r\n````","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76279693#76279693","title":"Duplicate class in Kotlin Android","body":"<p>This duplication happens because some of the libraries still use module <code>org.jetbrains.kotlin:kotlin-stdlib-jdk8</code> or <code>org.jetbrains.kotlin:kotlin-stdlib-jdk7</code> instead of the new module <code>org.jetbrains.kotlin:kotlin-stdlib</code>, therefore the class duplication accure.</p>\n<p>To fix this we need to replace this module by ourselves:</p>\n<pre><code>modules {\n        module('org.jetbrains.kotlin:kotlin-stdlib-jdk8')\n                { replacedBy 'org.jetbrains.kotlin:kotlin-stdlib', 'kotlin fixes' }\n        module('org.jetbrains.kotlin:kotlin-stdlib-jdk7')\n                { replacedBy 'org.jetbrains.kotlin:kotlin-stdlib', 'kotlin fixes' }\n    }\n</code></pre>\n"},{"comments":[{"score":2,"post_type":"answer","creation_date":1686831726,"post_id":76288629,"comment_id":134855309,"body_markdown":"Everything complied fine. Then I updated androidx fragments from 1.5.7 to 1.6 and about 100 kotlin duplicate class errors occurred. What worries me is that they did not vanish when I got back to 1.5.7 and deleted build and invalidate cache.\nIts like black magic - it messes you up and sticks with you even if you revert back to older version!\nStill this implementation fixes those duplicate classes thank you","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76288629#comment134855309_76288629","body":"Everything complied fine. Then I updated androidx fragments from 1.5.7 to 1.6 and about 100 kotlin duplicate class errors occurred. What worries me is that they did not vanish when I got back to 1.5.7 and deleted build and invalidate cache. Its like black magic - it messes you up and sticks with you even if you revert back to older version! Still this implementation fixes those duplicate classes thank you"},{"score":0,"post_type":"answer","creation_date":1689402946,"post_id":76288629,"comment_id":135211357,"body_markdown":"Can anyone please elaborate on why this works? I have no clue how it fixed my issue of duplicate classes.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76288629#comment135211357_76288629","body":"Can anyone please elaborate on why this works? I have no clue how it fixed my issue of duplicate classes."},{"score":0,"post_type":"answer","creation_date":1690549983,"post_id":76288629,"comment_id":135373361,"body_markdown":"the only fix that worked for me is this, thanks!","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76288629#comment135373361_76288629","body":"the only fix that worked for me is this, thanks!"},{"score":1,"post_type":"answer","creation_date":1690550194,"post_id":76288629,"comment_id":135373407,"body_markdown":"@WahajMubeen apparently we are using mutliple dependencies in pubsec.yaml file, and they all need the kotlin versions to be aligned, but each uses a diff version, which causes this issue, the fix mentioned above , is a solution to fix the duplicate class error. It resolves the conflict by using the Kotlin Bill of Materials (BOM) to ensure that all Kotlin dependencies in your project use the same version.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76288629#comment135373407_76288629","body":"@WahajMubeen apparently we are using mutliple dependencies in pubsec.yaml file, and they all need the kotlin versions to be aligned, but each uses a diff version, which causes this issue, the fix mentioned above , is a solution to fix the duplicate class error. It resolves the conflict by using the Kotlin Bill of Materials (BOM) to ensure that all Kotlin dependencies in your project use the same version."}],"comment_count":4,"score":28,"last_activity_date":1684608863,"last_edit_date":1684608863,"creation_date":1684495815,"answer_id":76288629,"question_id":75263047,"body_markdown":"You can now update the lifecycle dependencies to the most up-to-date versions, and simply add the following line in your build.gradle\r\n\r\n    dependencies {\r\n    \r\n        (...)\r\n    \r\n        // Fix Duplicate class\r\n        implementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\r\n    \r\n    }","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76288629#76288629","title":"Duplicate class in Kotlin Android","body":"<p>You can now update the lifecycle dependencies to the most up-to-date versions, and simply add the following line in your build.gradle</p>\n<pre><code>dependencies {\n\n    (...)\n\n    // Fix Duplicate class\n    implementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\n\n}\n</code></pre>\n"},{"comments":[{"score":2,"post_type":"answer","creation_date":1687341330,"post_id":76296390,"comment_id":134922198,"body_markdown":"Thanks a lot. This saved the day. I recommend everyone to try this first.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76296390#comment134922198_76296390","body":"Thanks a lot. This saved the day. I recommend everyone to try this first."}],"comment_count":1,"score":25,"last_activity_date":1684602098,"creation_date":1684602098,"answer_id":76296390,"question_id":75263047,"body_markdown":"I tried many ways to solve this same prolem but didnt work\r\nI tried to add this dependencies below in my &quot;**build.gradle(module:app)**&quot;..\r\n\r\n    implementation (platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\r\n\r\nand then synce now, it will resolve this error.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76296390#76296390","title":"Duplicate class in Kotlin Android","body":"<p>I tried many ways to solve this same prolem but didnt work\nI tried to add this dependencies below in my &quot;<strong>build.gradle(module:app)</strong>&quot;..</p>\n<pre><code>implementation (platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\n</code></pre>\n<p>and then synce now, it will resolve this error.</p>\n"},{"comment_count":0,"score":6,"last_activity_date":1701574621,"last_edit_date":1701574621,"creation_date":1684656409,"answer_id":76298880,"question_id":75263047,"body_markdown":"Step 1: Add this\r\n\r\n    plugins {\r\n            id &#39;com.android.application&#39;\r\n            id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.8.10&#39; apply false\r\n        }\r\n\r\nStep 2: Add this on the dependencies\r\n\r\n    dependencies {\r\n\r\n    .....\r\n\r\n      constraints{\r\n            implementation &#39;org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.8.10&#39;\r\n            implementation &#39;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.10&#39;\r\n        }\r\n    }\r\n\r\n***Note***: version &#39;1.8.10&#39;, jdk7:1.8.10 and jdk7:1.8.10 are the same...\r\n\r\n\r\n\r\n\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76298880#76298880","title":"Duplicate class in Kotlin Android","body":"<p>Step 1: Add this</p>\n<pre><code>plugins {\n        id 'com.android.application'\n        id 'org.jetbrains.kotlin.android' version '1.8.10' apply false\n    }\n</code></pre>\n<p>Step 2: Add this on the dependencies</p>\n<pre><code>dependencies {\n\n.....\n\n  constraints{\n        implementation 'org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.8.10'\n        implementation 'org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.10'\n    }\n}\n</code></pre>\n<p><em><strong>Note</strong></em>: version '1.8.10', jdk7:1.8.10 and jdk7:1.8.10 are the same...</p>\n"},{"comment_count":0,"score":1,"last_activity_date":1686048179,"creation_date":1686048179,"answer_id":76413808,"question_id":75263047,"body_markdown":"(gradle.properties)\r\n\r\n\r\n\r\n\r\n    org.gradle.jvmargs=-Xmx4608m\r\n    android.useAndroidX=true\r\n    android.enableJetifier=true\r\n    android.enableR8=true\r\n\r\nand app (build.gradle)\r\n\r\n    constraints {\r\n            implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.8.0&quot;) {\r\n                because(&quot;kotlin-stdlib-jdk7 is now a part of kotlin-stdlib&quot;)\r\n            }\r\n            implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.0&quot;) {\r\n                because(&quot;kotlin-stdlib-jdk8 is now a part of kotlin-stdlib&quot;)\r\n            }\r\n        }\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76413808#76413808","title":"Duplicate class in Kotlin Android","body":"<p>(gradle.properties)</p>\n<pre><code>org.gradle.jvmargs=-Xmx4608m\nandroid.useAndroidX=true\nandroid.enableJetifier=true\nandroid.enableR8=true\n</code></pre>\n<p>and app (build.gradle)</p>\n<pre><code>constraints {\n        implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.8.0&quot;) {\n            because(&quot;kotlin-stdlib-jdk7 is now a part of kotlin-stdlib&quot;)\n        }\n        implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.0&quot;) {\n            because(&quot;kotlin-stdlib-jdk8 is now a part of kotlin-stdlib&quot;)\n        }\n    }\n</code></pre>\n"},{"comments":[{"score":0,"post_type":"answer","creation_date":1688057729,"post_id":76416355,"comment_id":135026039,"body_markdown":"This solution literally fixed the problem. Thanks!","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76416355#comment135026039_76416355","body":"This solution literally fixed the problem. Thanks!"},{"score":0,"post_type":"answer","creation_date":1691479982,"post_id":76416355,"comment_id":135493484,"body_markdown":"Fixed it. For me it was important to know that it needs to go into the android/app/build.gradle file, and not in the android/build.gradle file.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76416355#comment135493484_76416355","body":"Fixed it. For me it was important to know that it needs to go into the android/app/build.gradle file, and not in the android/build.gradle file."}],"comment_count":2,"score":8,"last_activity_date":1701574719,"last_edit_date":1701574719,"creation_date":1686066626,"answer_id":76416355,"question_id":75263047,"body_markdown":"Use:\r\n\r\n    configurations.all {\r\n        resolutionStrategy {\r\n            force &#39;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.10&#39;\r\n        }\r\n    }\r\n\r\nAdding this to the end of the Gradle file helps.\r\n\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76416355#76416355","title":"Duplicate class in Kotlin Android","body":"<p>Use:</p>\n<pre><code>configurations.all {\n    resolutionStrategy {\n        force 'org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.10'\n    }\n}\n</code></pre>\n<p>Adding this to the end of the Gradle file helps.</p>\n"},{"comments":[{"score":0,"post_type":"answer","creation_date":1688945838,"post_id":76462458,"comment_id":135138774,"body_markdown":"Correct! THANK YOU!!!!","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76462458#comment135138774_76462458","body":"Correct! THANK YOU!!!!"},{"score":0,"post_type":"answer","creation_date":1696343624,"post_id":76462458,"comment_id":136138873,"body_markdown":"I had the same issue. Downgraded from `2.7.2` to `2.5.3` and it worked. But why is the new version not working? I don&#39;t know...","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76462458#comment136138873_76462458","body":"I had the same issue. Downgraded from <code>2.7.2</code> to <code>2.5.3</code> and it worked. But why is the new version not working? I don&#39;t know..."}],"comment_count":2,"score":4,"last_activity_date":1686640288,"creation_date":1686640288,"answer_id":76462458,"question_id":75263047,"body_markdown":"This happened to me when upgrading one of these\r\n\r\n    implementation &#39;androidx.navigation:navigation-fragment:2.5.3&#39;\r\n    implementation &#39;androidx.navigation:navigation-ui:2.5.3&#39;\r\n\r\nTo version 2.6.0. When rolling back to 2.5.3 the error went away.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76462458#76462458","title":"Duplicate class in Kotlin Android","body":"<p>This happened to me when upgrading one of these</p>\n<pre><code>implementation 'androidx.navigation:navigation-fragment:2.5.3'\nimplementation 'androidx.navigation:navigation-ui:2.5.3'\n</code></pre>\n<p>To version 2.6.0. When rolling back to 2.5.3 the error went away.</p>\n"},{"comment_count":0,"score":1,"last_activity_date":1686811486,"creation_date":1686811486,"answer_id":76479796,"question_id":75263047,"body_markdown":"In my case, only changing the implementation &#39;androidx.core:core-ktx:1.10.1&#39; to   implementation &#39;androidx.core:core-ktx:1.7.0&#39; worked for me.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76479796#76479796","title":"Duplicate class in Kotlin Android","body":"<p>In my case, only changing the implementation 'androidx.core:core-ktx:1.10.1' to   implementation 'androidx.core:core-ktx:1.7.0' worked for me.</p>\n"},{"comments":[{"score":0,"post_type":"answer","creation_date":1691160846,"post_id":76527618,"comment_id":135458804,"body_markdown":"it work for me thanks","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76527618#comment135458804_76527618","body":"it work for me thanks"}],"comment_count":1,"score":3,"last_activity_date":1689684964,"last_edit_date":1689684964,"creation_date":1687387997,"answer_id":76527618,"question_id":75263047,"body_markdown":"Adding this code inside app level/build.gradle  \r\n\r\n    dependencies{\r\n     ....\r\n        constraints{\r\n            implementation &#39;org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.8.10&#39;\r\n            implementation &#39;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.10&#39;\r\n        }\r\n    }\r\n\r\nand adding this code inside project level/build.gradle\r\n\r\n    dependencies {\r\n        .....\r\n        classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.7.10&quot;\r\n    }\r\nIt fixed this error 100%. It worked for me.\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76527618#76527618","title":"Duplicate class in Kotlin Android","body":"<p>Adding this code inside app level/build.gradle</p>\n<pre><code>dependencies{\n ....\n    constraints{\n        implementation 'org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.8.10'\n        implementation 'org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.10'\n    }\n}\n</code></pre>\n<p>and adding this code inside project level/build.gradle</p>\n<pre><code>dependencies {\n    .....\n    classpath &quot;org.jetbrains.kotlin:kotlin-gradle-plugin:1.7.10&quot;\n}\n</code></pre>\n<p>It fixed this error 100%. It worked for me.</p>\n"},{"comment_count":0,"score":4,"last_activity_date":1688961423,"last_edit_date":1688961423,"creation_date":1687752126,"answer_id":76553444,"question_id":75263047,"body_markdown":"If I update kotlin version to 1.8.0 then it forces me to use **view binding** \r\n\r\ni.e. `classpath &#39;org.jetbrains.kotlin:kotlin-gradle-plugin:1.8.10&#39;`\r\n\r\nthen if you want to keep kotlin version as it was before then just add it in app level gradle-\r\n\r\n    implementation &quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.0&quot;\r\nit will solve *duplicate class* issues though it is a temporary solution.\r\nHere my AGP version is **7.4.1** and Gradle version is **7.5**","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76553444#76553444","title":"Duplicate class in Kotlin Android","body":"<p>If I update kotlin version to 1.8.0 then it forces me to use <strong>view binding</strong></p>\n<p>i.e. <code>classpath 'org.jetbrains.kotlin:kotlin-gradle-plugin:1.8.10'</code></p>\n<p>then if you want to keep kotlin version as it was before then just add it in app level gradle-</p>\n<pre><code>implementation &quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.0&quot;\n</code></pre>\n<p>it will solve <em>duplicate class</em> issues though it is a temporary solution.\nHere my AGP version is <strong>7.4.1</strong> and Gradle version is <strong>7.5</strong></p>\n"},{"comments":[{"score":1,"post_type":"answer","creation_date":1689053600,"post_id":76576129,"comment_id":135154692,"body_markdown":"Thank you so much, I had same problem with pure java, but because I updated `androidx.core:core` to 1.10.1 while keeping `fresco*` at 2.6.0. I had to revert `androidx.core:core` to 1.9.0 because I cannot use newer `fresco*` 3.0.0.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76576129#comment135154692_76576129","body":"Thank you so much, I had same problem with pure java, but because I updated <code>androidx.core:core</code> to 1.10.1 while keeping <code>fresco*</code> at 2.6.0. I had to revert <code>androidx.core:core</code> to 1.9.0 because I cannot use newer <code>fresco*</code> 3.0.0."},{"score":1,"post_type":"answer","creation_date":1689070459,"post_id":76576129,"comment_id":135157848,"body_markdown":"@ZaFaR97 You are very welcome. What baffles me is that at some point I thought `androidx.core:core` was needed but now I see that it is not needed. I must have gone through some transitional stage, because my project was so old, that it had to undergo a lot of changes.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76576129#comment135157848_76576129","body":"@ZaFaR97 You are very welcome. What baffles me is that at some point I thought <code>androidx.core:core</code> was needed but now I see that it is not needed. I must have gone through some transitional stage, because my project was so old, that it had to undergo a lot of changes."},{"score":0,"post_type":"answer","creation_date":1689159982,"post_id":76576129,"comment_id":135173185,"body_markdown":"I didn&#39;t know if it is needed in my project, I leave it till I can test it.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76576129#comment135173185_76576129","body":"I didn&#39;t know if it is needed in my project, I leave it till I can test it."}],"comment_count":3,"score":2,"last_activity_date":1687980483,"last_edit_date":1687980483,"creation_date":1687979957,"answer_id":76576129,"question_id":75263047,"body_markdown":"I had the same exact issue after accepting Android Studio&#39;s suggestion to update certain dependencies.\r\n\r\nI looked at all the solutions here but none applied in my case because... I am **not using kotlin** in my code anywhere (i.e. my development is all in pure Java).\r\n\r\nThat led me to finding the following line in `build.gradle`:\r\n```\r\n\timplementation &#39;androidx.core:core-ktx:1.10.1&#39;\r\n```\r\nI just deleted it and **all built perfectly** as before the updates.\r\n\r\nI have no idea why my `build.gradle` had a reference to `androidx.core:core-ktx:1.9.0` in the first place (before the upgrade).\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76576129#76576129","title":"Duplicate class in Kotlin Android","body":"<p>I had the same exact issue after accepting Android Studio's suggestion to update certain dependencies.</p>\n<p>I looked at all the solutions here but none applied in my case because... I am <strong>not using kotlin</strong> in my code anywhere (i.e. my development is all in pure Java).</p>\n<p>That led me to finding the following line in <code>build.gradle</code>:</p>\n<pre><code>    implementation 'androidx.core:core-ktx:1.10.1'\n</code></pre>\n<p>I just deleted it and <strong>all built perfectly</strong> as before the updates.</p>\n<p>I have no idea why my <code>build.gradle</code> had a reference to <code>androidx.core:core-ktx:1.9.0</code> in the first place (before the upgrade).</p>\n"},{"comments":[{"score":2,"post_type":"answer","creation_date":1689070817,"post_id":76648657,"comment_id":135157933,"body_markdown":"As it’s currently written, your answer is unclear. Please [edit] to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76648657#comment135157933_76648657","body":"As it’s currently written, your answer is unclear. Please <a href=\"https://stackoverflow.com/posts/76648657/edit\">edit</a> to add additional details that will help others understand how this addresses the question asked. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"comment_count":1,"score":0,"last_activity_date":1701574788,"last_edit_date":1701574788,"creation_date":1688923019,"answer_id":76648657,"question_id":75263047,"body_markdown":"Change all lines in file *[build.gradle][1]* to:\r\n   \r\n```lang-none\r\nimplementation &#39;androidx.appcompat:appcompat:1.6.1&#39;\r\nimplementation &#39;com.google.android.material:material:1.8.0&#39;\r\nimplementation &#39;androidx.annotation:annotation:1.3.0&#39;\r\nimplementation &#39;androidx.constraintlayout:constraintlayout:2.1.4&#39;\r\nimplementation &#39;androidx.lifecycle:lifecycle-livedata-ktx:2.5.1&#39;\r\nimplementation &#39;androidx.lifecycle:lifecycle-viewmodel-ktx:2.5.1&#39;\r\ntestImplementation &#39;junit:junit:4.13.2&#39;\r\nandroidTestImplementation &#39;androidx.test.ext:junit:1.1.5&#39;\r\nandroidTestImplementation &#39;androidx.test.espresso:espresso-core:3.5.1&#39;\r\n```\r\n\r\nI&#39;d say downgrade the dependencies. I just do it and it works very well.\r\n\r\n  [1]: https://docs.gradle.org/current/userguide/tutorial_using_tasks.html\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76648657#76648657","title":"Duplicate class in Kotlin Android","body":"<p>Change all lines in file <em><a href=\"https://docs.gradle.org/current/userguide/tutorial_using_tasks.html\" rel=\"nofollow noreferrer\">build.gradle</a></em> to:</p>\n<pre class=\"lang-none prettyprint-override\"><code>implementation 'androidx.appcompat:appcompat:1.6.1'\nimplementation 'com.google.android.material:material:1.8.0'\nimplementation 'androidx.annotation:annotation:1.3.0'\nimplementation 'androidx.constraintlayout:constraintlayout:2.1.4'\nimplementation 'androidx.lifecycle:lifecycle-livedata-ktx:2.5.1'\nimplementation 'androidx.lifecycle:lifecycle-viewmodel-ktx:2.5.1'\ntestImplementation 'junit:junit:4.13.2'\nandroidTestImplementation 'androidx.test.ext:junit:1.1.5'\nandroidTestImplementation 'androidx.test.espresso:espresso-core:3.5.1'\n</code></pre>\n<p>I'd say downgrade the dependencies. I just do it and it works very well.</p>\n"},{"comment_count":0,"score":2,"last_activity_date":1701574854,"last_edit_date":1701574854,"creation_date":1688924094,"answer_id":76648735,"question_id":75263047,"body_markdown":"I had the same problem after updating my Android Studio. For this to work, I had to downgrade my dependencies like this\r\n\r\nPrevious use:\r\n\r\n    dependencies {\r\n    \r\n        implementation &#39;androidx.core:core-ktx:1.10.1&#39;\r\n        implementation &#39;androidx.navigation:navigation-fragment-ktx:2.6.0&#39;\r\n        implementation &#39;androidx.navigation:navigation-ui-ktx:2.6.0&#39;\r\n    }\r\n\r\nChanging to:\r\n\r\n    dependencies {\r\n    \r\n        implementation &#39;androidx.core:core-ktx:1.7.0&#39;\r\n        implementation &#39;androidx.navigation:navigation-fragment-ktx:2.5.3&#39;\r\n        implementation &#39;androidx.navigation:navigation-ui-ktx:2.5.3&#39;\r\n    }\r\n\r\nIt worked for me.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76648735#76648735","title":"Duplicate class in Kotlin Android","body":"<p>I had the same problem after updating my Android Studio. For this to work, I had to downgrade my dependencies like this</p>\n<p>Previous use:</p>\n<pre><code>dependencies {\n\n    implementation 'androidx.core:core-ktx:1.10.1'\n    implementation 'androidx.navigation:navigation-fragment-ktx:2.6.0'\n    implementation 'androidx.navigation:navigation-ui-ktx:2.6.0'\n}\n</code></pre>\n<p>Changing to:</p>\n<pre><code>dependencies {\n\n    implementation 'androidx.core:core-ktx:1.7.0'\n    implementation 'androidx.navigation:navigation-fragment-ktx:2.5.3'\n    implementation 'androidx.navigation:navigation-ui-ktx:2.5.3'\n}\n</code></pre>\n<p>It worked for me.</p>\n"},{"comment_count":0,"score":1,"last_activity_date":1689417934,"creation_date":1689417934,"answer_id":76693378,"question_id":75263047,"body_markdown":"I solved this problem and added this line in the build.gradle:\r\n\r\n\r\n    implementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\r\n\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76693378#76693378","title":"Duplicate class in Kotlin Android","body":"<p>I solved this problem and added this line in the build.gradle:</p>\n<pre><code>implementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\n</code></pre>\n"},{"comments":[{"score":0,"post_type":"answer","creation_date":1690287940,"post_id":76742834,"comment_id":135329649,"body_markdown":"If you have a new question, please ask it by clicking the [Ask Question](https://stackoverflow.com/questions/ask) button. Include a link to this question if it helps provide context. - [From Review](/review/late-answers/34728815)","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76742834#comment135329649_76742834","body":"If you have a new question, please ask it by clicking the <a href=\"https://stackoverflow.com/questions/ask\">Ask Question</a> button. Include a link to this question if it helps provide context. - <a href=\"/review/late-answers/34728815\">From Review</a>"}],"comment_count":1,"score":5,"last_activity_date":1701812987,"last_edit_date":1701812987,"creation_date":1690012761,"answer_id":76742834,"question_id":75263047,"body_markdown":"This problem will be solved by adding the dependency in build.gradle(app) file \r\n\r\n\r\n    implementation &quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.0&quot;\r\n\r\nit&#39;s working properly","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76742834#76742834","title":"Duplicate class in Kotlin Android","body":"<p>This problem will be solved by adding the dependency in build.gradle(app) file</p>\n<pre><code>implementation &quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.0&quot;\n</code></pre>\n<p>it's working properly</p>\n"},{"comment_count":0,"score":4,"last_activity_date":1690838281,"creation_date":1690838281,"answer_id":76807199,"question_id":75263047,"body_markdown":"The issue may be easely fixed by one line only:\r\n\r\n    dependencies {\r\n    .....\r\n        implementation &#39;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.9.0&#39;\r\n    }","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76807199#76807199","title":"Duplicate class in Kotlin Android","body":"<p>The issue may be easely fixed by one line only:</p>\n<pre><code>dependencies {\n.....\n    implementation 'org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.9.0'\n}\n</code></pre>\n"},{"comment_count":0,"score":13,"last_activity_date":1691655495,"last_edit_date":1691655495,"creation_date":1691642489,"answer_id":76872696,"question_id":75263047,"body_markdown":"edit app/build.gradle file in flutter\r\n\r\n    dependencies {\r\n    \r\n        (...)\r\n    \r\n        // Fix Duplicate class\r\n        implementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\r\n    \r\n    }","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76872696#76872696","title":"Duplicate class in Kotlin Android","body":"<p>edit app/build.gradle file in flutter</p>\n<pre><code>dependencies {\n\n    (...)\n\n    // Fix Duplicate class\n    implementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\n\n}\n</code></pre>\n"},{"comment_count":0,"score":12,"last_activity_date":1694578891,"last_edit_date":1694578891,"creation_date":1692085021,"answer_id":76904122,"question_id":75263047,"body_markdown":"Add the below line in your **build.gradle(Module:app)**\r\n\r\n    dependencies {\r\n\r\n    (...)\r\n\r\n    // Fix Duplicate class\r\n    implementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\r\n\r\n    }\r\n\r\nThis is because **kotlin-stdlib-jdk7** and **kotlin-stdlib-jdk8** are older dependencies that should be replaced by *kotlin-stdlib*. However, other libraries may still declare a dependency on them, which needs to be replaced with a dependency on *kotlin-stdlib*.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/76904122#76904122","title":"Duplicate class in Kotlin Android","body":"<p>Add the below line in your <strong>build.gradle(Module:app)</strong></p>\n<pre><code>dependencies {\n\n(...)\n\n// Fix Duplicate class\nimplementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\n\n}\n</code></pre>\n<p>This is because <strong>kotlin-stdlib-jdk7</strong> and <strong>kotlin-stdlib-jdk8</strong> are older dependencies that should be replaced by <em>kotlin-stdlib</em>. However, other libraries may still declare a dependency on them, which needs to be replaced with a dependency on <em>kotlin-stdlib</em>.</p>\n"},{"comments":[{"score":1,"post_type":"answer","creation_date":1696442589,"post_id":77087083,"comment_id":136154866,"body_markdown":"Great! Using the Kotlin Bill of Materials (BOM) is indeed a good approach to manage the Kotlin version and ensure consistency throughout your project. By specifying the Kotlin BOM, you&#39;re effectively managing the Kotlin version for your project and avoiding conflicts related to duplicate class issues.\n\nIncluding the Kotlin BOM allows you to define the Kotlin version in a single place, making it easier to manage dependencies and prevent version conflicts. It&#39;s a good practice, especially when dealing with Kotlin in multi-module or complex projects.","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/77087083#comment136154866_77087083","body":"Great! Using the Kotlin Bill of Materials (BOM) is indeed a good approach to manage the Kotlin version and ensure consistency throughout your project. By specifying the Kotlin BOM, you&#39;re effectively managing the Kotlin version for your project and avoiding conflicts related to duplicate class issues.  Including the Kotlin BOM allows you to define the Kotlin version in a single place, making it easier to manage dependencies and prevent version conflicts. It&#39;s a good practice, especially when dealing with Kotlin in multi-module or complex projects."}],"comment_count":1,"score":5,"last_activity_date":1696088531,"last_edit_date":1696088531,"creation_date":1694505423,"answer_id":77087083,"question_id":75263047,"body_markdown":"add this inside your **dependencies**, it will solve the **error**.\r\n\r\n```\r\ndependencies {\r\n\r\n    (...)\r\n\r\n    // Fix Duplicate class\r\n    implementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\r\n\r\n}\r\n```","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/77087083#77087083","title":"Duplicate class in Kotlin Android","body":"<p>add this inside your <strong>dependencies</strong>, it will solve the <strong>error</strong>.</p>\n<pre><code>dependencies {\n\n    (...)\n\n    // Fix Duplicate class\n    implementation(platform(&quot;org.jetbrains.kotlin:kotlin-bom:1.8.0&quot;))\n\n}\n</code></pre>\n"},{"comment_count":0,"score":1,"last_activity_date":1696756032,"creation_date":1696756032,"answer_id":77252973,"question_id":75263047,"body_markdown":"Here is the real solution, put this code in your gradle (app)\r\n\r\n   \r\n\r\n     constraints {\r\n            implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.8.0&quot;) {\r\n                because(&quot;kotlin-stdlib-jdk7 is now a part of kotlin-stdlib&quot;)\r\n            }\r\n            implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.0&quot;) {\r\n                because(&quot;kotlin-stdlib-jdk8 is now a part of kotlin-stdlib&quot;)\r\n            }\r\n        }","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/77252973#77252973","title":"Duplicate class in Kotlin Android","body":"<p>Here is the real solution, put this code in your gradle (app)</p>\n<pre><code> constraints {\n        implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.8.0&quot;) {\n            because(&quot;kotlin-stdlib-jdk7 is now a part of kotlin-stdlib&quot;)\n        }\n        implementation(&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.8.0&quot;) {\n            because(&quot;kotlin-stdlib-jdk8 is now a part of kotlin-stdlib&quot;)\n        }\n    }\n</code></pre>\n"},{"comment_count":0,"score":0,"last_activity_date":1697225724,"creation_date":1697225724,"answer_id":77290245,"question_id":75263047,"body_markdown":"I have a pure Java app.\r\n\r\nIf you want to update :\r\n- androidx.appcompat:appcompat from 1.4.x to 1.5.0\r\n- androidx.annotation:annotation from 1.5.0 to 1.6.0\r\n\r\nAnd probably a few other.\r\n\r\nIt seems you need to add something like this in your project.\r\n```\r\nplugins {\r\n    id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.8.10&#39;\r\n}\r\n```","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/77290245#77290245","title":"Duplicate class in Kotlin Android","body":"<p>I have a pure Java app.</p>\n<p>If you want to update :</p>\n<ul>\n<li>androidx.appcompat:appcompat from 1.4.x to 1.5.0</li>\n<li>androidx.annotation:annotation from 1.5.0 to 1.6.0</li>\n</ul>\n<p>And probably a few other.</p>\n<p>It seems you need to add something like this in your project.</p>\n<pre><code>plugins {\n    id 'org.jetbrains.kotlin.android' version '1.8.10'\n}\n</code></pre>\n"},{"comment_count":0,"score":0,"last_activity_date":1701575074,"last_edit_date":1701575074,"creation_date":1697528082,"answer_id":77306977,"question_id":75263047,"body_markdown":"Add the below line in the project-level [build.gradle][1] file.\r\n\r\n```lang-none\r\nplugins {\r\n\r\n    id &#39;org.jetbrains.kotlin.android&#39; version &#39;1.8.10&#39; apply false\r\n}\r\n```\r\n\r\n\r\n  [1]: https://docs.gradle.org/current/userguide/tutorial_using_tasks.html\r\n\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/77306977#77306977","title":"Duplicate class in Kotlin Android","body":"<p>Add the below line in the project-level <a href=\"https://docs.gradle.org/current/userguide/tutorial_using_tasks.html\" rel=\"nofollow noreferrer\">build.gradle</a> file.</p>\n<pre class=\"lang-none prettyprint-override\"><code>plugins {\n\n    id 'org.jetbrains.kotlin.android' version '1.8.10' apply false\n}\n</code></pre>\n"},{"comment_count":0,"score":0,"last_activity_date":1701574909,"last_edit_date":1701574909,"creation_date":1697968477,"answer_id":77339451,"question_id":75263047,"body_markdown":"Change this in `~\\android\\app\\build.gradle`\r\n\r\n```\r\ndependencies {\r\n    implementation &quot;org.jetbrains.kotlin:kotlin-stdlib-jdk7:$kotlin_version&quot;\r\n\r\n}\r\n```\r\n\r\nto:\r\n\r\n```\r\ndependencies {\r\n    implementation &quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlin_version&quot;\r\n\r\n}\r\n```\r\n\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/77339451#77339451","title":"Duplicate class in Kotlin Android","body":"<p>Change this in <code>~\\android\\app\\build.gradle</code></p>\n<pre><code>dependencies {\n    implementation &quot;org.jetbrains.kotlin:kotlin-stdlib-jdk7:$kotlin_version&quot;\n\n}\n</code></pre>\n<p>to:</p>\n<pre><code>dependencies {\n    implementation &quot;org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlin_version&quot;\n\n}\n</code></pre>\n"},{"comment_count":0,"score":2,"last_activity_date":1701574888,"last_edit_date":1701574888,"creation_date":1698434038,"answer_id":77376570,"question_id":75263047,"body_markdown":"Try this:\r\n\r\n    dependencies {\r\n         configurations.implementation {\r\n             exclude group: &#39;org.jetbrains.kotlin&#39;, module: &#39;kotlin-stdlib-jdk8&#39;\r\n         }\r\n         ....\r\n    }\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android/77376570#77376570","title":"Duplicate class in Kotlin Android","body":"<p>Try this:</p>\n<pre><code>dependencies {\n     configurations.implementation {\n         exclude group: 'org.jetbrains.kotlin', module: 'kotlin-stdlib-jdk8'\n     }\n     ....\n}\n</code></pre>\n"}],"comment_count":5,"is_answered":true,"view_count":203379,"answer_count":59,"score":368,"last_activity_date":1701812987,"creation_date":1674851299,"last_edit_date":1701574230,"question_id":75263047,"body_markdown":"![Image Example](https://i.stack.imgur.com/ugp7v.png)\r\n\r\nI kept on getting an error that there is a duplicate error in classes.\r\n[This is what I have under org.jetbrains.kotlin folder](https://i.stack.imgur.com/92lfH.png)\r\n[.idea/libraries](https://i.stack.imgur.com/Q0zHs.png)\r\n\r\nIt seems like the problem is because there is two different dependencies for Kotlin, from *stdlib* and *stdlibjdk8*, but I don&#39;t know how to remove either one from my module/project dependencies. How can I do it?\r\n\r\nHere&#39;s the full error code:\r\n\r\n```lang-none\r\nDuplicate class kotlin.collections.jdk8.CollectionsJDK8Kt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\r\nDuplicate class kotlin.internal.jdk7.JDK7PlatformImplementations found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\r\nDuplicate class kotlin.internal.jdk8.JDK8PlatformImplementations found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\r\nDuplicate class kotlin.io.path.ExperimentalPathApi found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\r\nDuplicate class kotlin.io.path.PathRelativizer found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\r\nDuplicate class kotlin.io.path.PathsKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\r\nDuplicate class kotlin.io.path.PathsKt__PathReadWriteKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\r\nDuplicate class kotlin.io.path.PathsKt__PathUtilsKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\r\nDuplicate class kotlin.jdk7.AutoCloseableKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\r\nDuplicate class kotlin.jvm.jdk8.JvmRepeatableKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\r\nDuplicate class kotlin.random.jdk8.PlatformThreadLocalRandom found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\r\nDuplicate class kotlin.streams.jdk8.StreamsKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\r\nDuplicate class kotlin.streams.jdk8.StreamsKt$asSequence$$inlined$Sequence$1 found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\r\nDuplicate class kotlin.streams.jdk8.StreamsKt$asSequence$$inlined$Sequence$2 found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\r\nDuplicate class kotlin.streams.jdk8.StreamsKt$asSequence$$inlined$Sequence$3 found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\r\nDuplicate class kotlin.streams.jdk8.StreamsKt$asSequence$$inlined$Sequence$4 found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\r\nDuplicate class kotlin.text.jdk8.RegexExtensionsJDK8Kt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\r\nDuplicate class kotlin.time.jdk8.DurationConversionsJDK8Kt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\r\n```\r\n\r\nI&#39;ve tried deleting the files from the org.jetbrains.kotlin, but whenever I build the app in Android Studio, the files will be redownloaded again.\r\n\r\nThis is my module app [Gradle][1] code:\r\n\r\n~~~groovy\r\n\r\nplugins {\r\n    id &#39;com.android.application&#39;\r\n    id &#39;com.google.gms.google-services&#39;\r\n}\r\n\r\nandroid {\r\n    compileSdk 33\r\n\r\n    defaultConfig {\r\n        applicationId &quot;com.example.umfs&quot;\r\n        minSdk 21\r\n        targetSdk 32\r\n        versionCode 1\r\n        versionName &quot;1.0&quot;\r\n\r\n        testInstrumentationRunner &quot;androidx.test.runner.AndroidJUnitRunner&quot;\r\n    }\r\n\r\n    buildTypes {\r\n        release {\r\n            minifyEnabled false\r\n            proguardFiles getDefaultProguardFile(&#39;proguard-android-optimize.txt&#39;), &#39;proguard-rules.pro&#39;\r\n        }\r\n    }\r\n    compileOptions {\r\n        sourceCompatibility JavaVersion.VERSION_1_8\r\n        targetCompatibility JavaVersion.VERSION_1_8\r\n    }\r\n\r\n    buildFeatures {\r\n        viewBinding true\r\n    }\r\n\r\n    namespace &#39;com.example.umfs&#39;\r\n}\r\n\r\ndependencies {\r\n\r\n    implementation &#39;androidx.appcompat:appcompat:1.5.1&#39;\r\n    implementation &#39;com.google.android.material:material:1.7.0&#39;\r\n    implementation &#39;androidx.constraintlayout:constraintlayout:2.1.4&#39;\r\n    implementation &#39;com.google.firebase:firebase-database:20.1.0&#39;\r\n    implementation &#39;androidx.preference:preference:1.2.0&#39;\r\n    implementation &#39;com.google.firebase:firebase-auth:21.1.0&#39;\r\n    implementation &#39;com.google.firebase:firebase-core:21.1.1&#39;\r\n    implementation &#39;androidx.navigation:navigation-fragment:2.5.3&#39;\r\n    implementation &#39;androidx.navigation:navigation-ui:2.5.3&#39;\r\n    implementation &#39;com.google.firebase:firebase-firestore:24.4.1&#39;\r\n    implementation &#39;androidx.recyclerview:recyclerview:1.2.1&#39;\r\n    testImplementation &#39;junit:junit:4.13.2&#39;\r\n    androidTestImplementation &#39;androidx.test.ext:junit:1.1.4&#39;\r\n    androidTestImplementation &#39;androidx.test.espresso:espresso-core:3.5.0&#39;\r\n    implementation &#39;de.hdodenhof:circleimageview:3.1.0&#39;\r\n    implementation &quot;androidx.cardview:cardview:1.0.0&quot;\r\n    implementation &#39;com.google.firebase:firebase-firestore:24.4.1&#39;\r\n    implementation &#39;com.google.firebase:firebase-storage:20.1.0&#39;\r\n    implementation &#39;com.google.firebase:firebase-database&#39;\r\n    implementation platform(&#39;com.google.firebase:firebase-bom:28.4.0&#39;)\r\n    implementation &#39;com.squareup.picasso:picasso:2.71828&#39;\r\n    implementation &#39;com.makeramen:roundedimageview:2.3.0&#39;\r\n    implementation &#39;com.github.bumptech.glide:glide:4.14.2&#39;\r\n    implementation &#39;com.github.marlonlom:timeago:4.0.3&#39;\r\n    implementation &quot;androidx.core:core-ktx:+&quot;\r\n\r\n}\r\n\r\napply plugin: &#39;com.google.gms.google-services&#39;\r\n~~~\r\n\r\n  [1]: https://en.wikipedia.org/wiki/Gradle\r\n\r\n","link":"https://stackoverflow.com/questions/75263047/duplicate-class-in-kotlin-android","title":"Duplicate class in Kotlin Android","body":"<p><img src=\"https://i.stack.imgur.com/ugp7v.png\" alt=\"Image Example\" /></p>\n<p>I kept on getting an error that there is a duplicate error in classes.\n<a href=\"https://i.stack.imgur.com/92lfH.png\" rel=\"noreferrer\">This is what I have under org.jetbrains.kotlin folder</a>\n<a href=\"https://i.stack.imgur.com/Q0zHs.png\" rel=\"noreferrer\">.idea/libraries</a></p>\n<p>It seems like the problem is because there is two different dependencies for Kotlin, from <em>stdlib</em> and <em>stdlibjdk8</em>, but I don't know how to remove either one from my module/project dependencies. How can I do it?</p>\n<p>Here's the full error code:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Duplicate class kotlin.collections.jdk8.CollectionsJDK8Kt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.internal.jdk7.JDK7PlatformImplementations found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\nDuplicate class kotlin.internal.jdk8.JDK8PlatformImplementations found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.io.path.ExperimentalPathApi found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\nDuplicate class kotlin.io.path.PathRelativizer found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\nDuplicate class kotlin.io.path.PathsKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\nDuplicate class kotlin.io.path.PathsKt__PathReadWriteKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\nDuplicate class kotlin.io.path.PathsKt__PathUtilsKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\nDuplicate class kotlin.jdk7.AutoCloseableKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk7-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.6.0)\nDuplicate class kotlin.jvm.jdk8.JvmRepeatableKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.random.jdk8.PlatformThreadLocalRandom found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.streams.jdk8.StreamsKt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.streams.jdk8.StreamsKt$asSequence$$inlined$Sequence$1 found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.streams.jdk8.StreamsKt$asSequence$$inlined$Sequence$2 found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.streams.jdk8.StreamsKt$asSequence$$inlined$Sequence$3 found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.streams.jdk8.StreamsKt$asSequence$$inlined$Sequence$4 found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.text.jdk8.RegexExtensionsJDK8Kt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\nDuplicate class kotlin.time.jdk8.DurationConversionsJDK8Kt found in modules jetified-kotlin-stdlib-1.8.0 (org.jetbrains.kotlin:kotlin-stdlib:1.8.0) and jetified-kotlin-stdlib-jdk8-1.6.0 (org.jetbrains.kotlin:kotlin-stdlib-jdk8:1.6.0)\n</code></pre>\n<p>I've tried deleting the files from the org.jetbrains.kotlin, but whenever I build the app in Android Studio, the files will be redownloaded again.</p>\n<p>This is my module app <a href=\"https://en.wikipedia.org/wiki/Gradle\" rel=\"noreferrer\">Gradle</a> code:</p>\n<pre><code>\nplugins {\n    id 'com.android.application'\n    id 'com.google.gms.google-services'\n}\n\nandroid {\n    compileSdk 33\n\n    defaultConfig {\n        applicationId &quot;com.example.umfs&quot;\n        minSdk 21\n        targetSdk 32\n        versionCode 1\n        versionName &quot;1.0&quot;\n\n        testInstrumentationRunner &quot;androidx.test.runner.AndroidJUnitRunner&quot;\n    }\n\n    buildTypes {\n        release {\n            minifyEnabled false\n            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'\n        }\n    }\n    compileOptions {\n        sourceCompatibility JavaVersion.VERSION_1_8\n        targetCompatibility JavaVersion.VERSION_1_8\n    }\n\n    buildFeatures {\n        viewBinding true\n    }\n\n    namespace 'com.example.umfs'\n}\n\ndependencies {\n\n    implementation 'androidx.appcompat:appcompat:1.5.1'\n    implementation 'com.google.android.material:material:1.7.0'\n    implementation 'androidx.constraintlayout:constraintlayout:2.1.4'\n    implementation 'com.google.firebase:firebase-database:20.1.0'\n    implementation 'androidx.preference:preference:1.2.0'\n    implementation 'com.google.firebase:firebase-auth:21.1.0'\n    implementation 'com.google.firebase:firebase-core:21.1.1'\n    implementation 'androidx.navigation:navigation-fragment:2.5.3'\n    implementation 'androidx.navigation:navigation-ui:2.5.3'\n    implementation 'com.google.firebase:firebase-firestore:24.4.1'\n    implementation 'androidx.recyclerview:recyclerview:1.2.1'\n    testImplementation 'junit:junit:4.13.2'\n    androidTestImplementation 'androidx.test.ext:junit:1.1.4'\n    androidTestImplementation 'androidx.test.espresso:espresso-core:3.5.0'\n    implementation 'de.hdodenhof:circleimageview:3.1.0'\n    implementation &quot;androidx.cardview:cardview:1.0.0&quot;\n    implementation 'com.google.firebase:firebase-firestore:24.4.1'\n    implementation 'com.google.firebase:firebase-storage:20.1.0'\n    implementation 'com.google.firebase:firebase-database'\n    implementation platform('com.google.firebase:firebase-bom:28.4.0')\n    implementation 'com.squareup.picasso:picasso:2.71828'\n    implementation 'com.makeramen:roundedimageview:2.3.0'\n    implementation 'com.github.bumptech.glide:glide:4.14.2'\n    implementation 'com.github.marlonlom:timeago:4.0.3'\n    implementation &quot;androidx.core:core-ktx:+&quot;\n\n}\n\napply plugin: 'com.google.gms.google-services'\n</code></pre>\n"},{"tags":["java","methods","time","parameters","java-time"],"comments":[{"score":0,"post_type":"question","creation_date":1701205833,"post_id":77566630,"comment_id":136746116,"body_markdown":"I fixed your code formatting. Please study so you can do that yourself. Also, please put effort into using correct case and such  in your prose. Stack Overflow is meant to be more like Wikipedia, less like a casual chat room.","link":"https://stackoverflow.com/questions/77566630/using-minusminutes-in-the-localtime-class-in-the-time-package#comment136746116_77566630","body":"I fixed your code formatting. Please study so you can do that yourself. Also, please put effort into using correct case and such  in your prose. Stack Overflow is meant to be more like Wikipedia, less like a casual chat room."}],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1701812868,"post_id":77567170,"comment_id":136821318,"body_markdown":"@working.monkey If the Answer is helpful, up-vote (click Up arrow). If the Answer solves your Question, then accept it (click big check mark).","link":"https://stackoverflow.com/questions/77566630/using-minusminutes-in-the-localtime-class-in-the-time-package/77567170#comment136821318_77567170","body":"@working.monkey If the Answer is helpful, up-vote (click Up arrow). If the Answer solves your Question, then accept it (click big check mark)."}],"comment_count":1,"score":0,"last_activity_date":1701205886,"creation_date":1701205886,"answer_id":77567170,"question_id":77566630,"body_markdown":"You must study the [Javadoc][1] for any class you want to use.\r\n\r\nOn [`LocalTime`][2], you will not find any `minutesToSubtract` method. You can only call methods defined on that class.\r\n\r\nYou will find a [`minusMinutes`][3] method.\r\n\r\nBecause *java.time* uses [immutable objects][4], the result of that method is a new `LocalTime` object. The original `LocalTime` object remains intact.\r\n\r\n    LocalTime now = LocalTime.now() ;\r\n    LocalTime then = now.minusMinutes( 2 ) ;\r\n\r\n\r\n  [1]: https://en.wikipedia.org/wiki/Javadoc\r\n  [2]: https://docs.oracle.com/en/java/javase/21/docs/api//java.base/java/time/LocalTime.html\r\n  [3]: https://docs.oracle.com/en/java/javase/21/docs/api//java.base/java/time/LocalTime.html#minusMinutes(long)\r\n  [4]: https://en.wikipedia.org/wiki/Immutable_object","link":"https://stackoverflow.com/questions/77566630/using-minusminutes-in-the-localtime-class-in-the-time-package/77567170#77567170","title":"using minusMinutes() in the LocalTime class in the time package","body":"<p>You must study the <a href=\"https://en.wikipedia.org/wiki/Javadoc\" rel=\"nofollow noreferrer\">Javadoc</a> for any class you want to use.</p>\n<p>On <a href=\"https://docs.oracle.com/en/java/javase/21/docs/api//java.base/java/time/LocalTime.html\" rel=\"nofollow noreferrer\"><code>LocalTime</code></a>, you will not find any <code>minutesToSubtract</code> method. You can only call methods defined on that class.</p>\n<p>You will find a <a href=\"https://docs.oracle.com/en/java/javase/21/docs/api//java.base/java/time/LocalTime.html#minusMinutes(long)\" rel=\"nofollow noreferrer\"><code>minusMinutes</code></a> method.</p>\n<p>Because <em>java.time</em> uses <a href=\"https://en.wikipedia.org/wiki/Immutable_object\" rel=\"nofollow noreferrer\">immutable objects</a>, the result of that method is a new <code>LocalTime</code> object. The original <code>LocalTime</code> object remains intact.</p>\n<pre><code>LocalTime now = LocalTime.now() ;\nLocalTime then = now.minusMinutes( 2 ) ;\n</code></pre>\n"}],"comment_count":1,"is_answered":false,"view_count":22,"answer_count":1,"score":0,"last_activity_date":1701812905,"creation_date":1701199330,"last_edit_date":1701812905,"question_id":77566630,"body_markdown":"I am quite new and am asking to see how to use this method. here is my problematic code...\r\n\r\n```java\r\nimport java.time.LocalTime;\r\n\r\nclass Workingtime{\r\n  public static void main(String[] args){\r\n\r\n    LocalTime timeobj = LocalTime.minusMinutes();\r\n    String subtractedtimevar = timeobj.minutesToSubtract(1);\r\n    System.out.println(subtractedtimevar);\r\n\r\n  }\r\n}\r\n```\r\n\r\nplease give me the correct use of this method with any subtraction of time as an example.\r\n\r\n\r\n\r\ni tried to subtract 1 minute to see how the method works from the oracle literature.\r\n\r\nthanks to those who respond.\r\n\r\n- working monkey","link":"https://stackoverflow.com/questions/77566630/using-minusminutes-in-the-localtime-class-in-the-time-package","title":"using minusMinutes() in the LocalTime class in the time package","body":"<p>I am quite new and am asking to see how to use this method. here is my problematic code...</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.time.LocalTime;\n\nclass Workingtime{\n  public static void main(String[] args){\n\n    LocalTime timeobj = LocalTime.minusMinutes();\n    String subtractedtimevar = timeobj.minutesToSubtract(1);\n    System.out.println(subtractedtimevar);\n\n  }\n}\n</code></pre>\n<p>please give me the correct use of this method with any subtraction of time as an example.</p>\n<p>i tried to subtract 1 minute to see how the method works from the oracle literature.</p>\n<p>thanks to those who respond.</p>\n<ul>\n<li>working monkey</li>\n</ul>\n"},{"tags":["java","intellij-idea","junit"],"comments":[{"score":0,"post_type":"question","creation_date":1701055524,"post_id":77554369,"comment_id":136723460,"body_markdown":"Do not use images for text information like code, logs, and configurations.","link":"https://stackoverflow.com/questions/77554369/offline-intellij-installation-and-junit#comment136723460_77554369","body":"Do not use images for text information like code, logs, and configurations."},{"score":1,"post_type":"question","creation_date":1701082742,"post_id":77554369,"comment_id":136726686,"body_markdown":"Please share full code in GitHub or a Google Driver then I can take a look at it. Is it an Android project?","link":"https://stackoverflow.com/questions/77554369/offline-intellij-installation-and-junit#comment136726686_77554369","body":"Please share full code in GitHub or a Google Driver then I can take a look at it. Is it an Android project?"},{"score":0,"post_type":"question","creation_date":1701109184,"post_id":77554369,"comment_id":136731829,"body_markdown":"@aled The environment is accessed via RDP and does not provide a means for me to copy/paste between host and client. Figured since I&#39;m just attempting to import a dependency that this would help illustrate what I had done and how I had done it so far.","link":"https://stackoverflow.com/questions/77554369/offline-intellij-installation-and-junit#comment136731829_77554369","body":"@aled The environment is accessed via RDP and does not provide a means for me to copy/paste between host and client. Figured since I&#39;m just attempting to import a dependency that this would help illustrate what I had done and how I had done it so far."},{"score":0,"post_type":"question","creation_date":1701109333,"post_id":77554369,"comment_id":136731853,"body_markdown":"@JackyLiu-JetBrains It&#39;s a project that&#39;s intended to use a fuzzing tools&#39; SDK, not targeting Android.","link":"https://stackoverflow.com/questions/77554369/offline-intellij-installation-and-junit#comment136731853_77554369","body":"@JackyLiu-JetBrains It&#39;s a project that&#39;s intended to use a fuzzing tools&#39; SDK, not targeting Android."}],"answers":[{"comment_count":0,"score":1,"last_activity_date":1701709308,"creation_date":1701709308,"answer_id":77601253,"question_id":77554369,"body_markdown":"You hava a Gradle project.\r\n\r\nFor Gradle projects IntelliJ uses Gradle by default to:\r\n- Build and run\r\n- run tests\r\n\r\nIn IntelliJ 2023 the setting is under: Build, Execution, Deployment -&gt; Build Tools -&gt; Gradle\r\n\r\nThus, you need to configure Gradle to use local dependencies. \r\n\r\nThe simplest way you can do that is using [File dependencies](https://docs.gradle.org/current/userguide/dependency_management.html#sub:file_dependencies)\r\n\r\n```\r\ndependencies {\r\n    testImplementation files(&#39;libs/junit-4.12.jar&#39;, &#39;libs/hamcrest-core-1.3.jar&#39;)\r\n}\r\n```\r\n\r\nor alternatively:\r\n```\r\ndependencies {\r\n    testImplementation fileTree(dir: &#39;libs&#39;, include: &#39;*.jar&#39;)\r\n}\r\n```\r\n\r\nNotes:\r\n- you seem to have used file dependencies for implementation, but not for test implementation\r\n- junit depends on `hamcrest-core`. Check the pom for the correct version. [junit-4.12.pom](https://repo1.maven.org/maven2/junit/junit/4.12/junit-4.12.pom)\r\n\r\n\r\nAn alternative approach is to set up a local maven repository.","link":"https://stackoverflow.com/questions/77554369/offline-intellij-installation-and-junit/77601253#77601253","title":"Offline IntelliJ installation and junit","body":"<p>You hava a Gradle project.</p>\n<p>For Gradle projects IntelliJ uses Gradle by default to:</p>\n<ul>\n<li>Build and run</li>\n<li>run tests</li>\n</ul>\n<p>In IntelliJ 2023 the setting is under: Build, Execution, Deployment -&gt; Build Tools -&gt; Gradle</p>\n<p>Thus, you need to configure Gradle to use local dependencies.</p>\n<p>The simplest way you can do that is using <a href=\"https://docs.gradle.org/current/userguide/dependency_management.html#sub:file_dependencies\" rel=\"nofollow noreferrer\">File dependencies</a></p>\n<pre><code>dependencies {\n    testImplementation files('libs/junit-4.12.jar', 'libs/hamcrest-core-1.3.jar')\n}\n</code></pre>\n<p>or alternatively:</p>\n<pre><code>dependencies {\n    testImplementation fileTree(dir: 'libs', include: '*.jar')\n}\n</code></pre>\n<p>Notes:</p>\n<ul>\n<li>you seem to have used file dependencies for implementation, but not for test implementation</li>\n<li>junit depends on <code>hamcrest-core</code>. Check the pom for the correct version. <a href=\"https://repo1.maven.org/maven2/junit/junit/4.12/junit-4.12.pom\" rel=\"nofollow noreferrer\">junit-4.12.pom</a></li>\n</ul>\n<p>An alternative approach is to set up a local maven repository.</p>\n"},{"comment_count":0,"score":0,"last_activity_date":1701801990,"creation_date":1701801990,"answer_id":77608589,"question_id":77554369,"body_markdown":"Thanks for all who responded but ultimately I discovered that IntelliJ was trying to update Gradle even with &quot;Toggle Offline Mode&quot; enabled within Gradle settings. \r\n\r\nBy navigating to File -&gt; Settings -&gt; Build, Execution, Deployment -&gt; Build Tools -&gt; Gradle and manually settings the distribution to &quot;Local installation&quot; it no longer attempted to download itself and behaved appropriately. ","link":"https://stackoverflow.com/questions/77554369/offline-intellij-installation-and-junit/77608589#77608589","title":"Offline IntelliJ installation and junit","body":"<p>Thanks for all who responded but ultimately I discovered that IntelliJ was trying to update Gradle even with &quot;Toggle Offline Mode&quot; enabled within Gradle settings.</p>\n<p>By navigating to File -&gt; Settings -&gt; Build, Execution, Deployment -&gt; Build Tools -&gt; Gradle and manually settings the distribution to &quot;Local installation&quot; it no longer attempted to download itself and behaved appropriately.</p>\n"}],"comment_count":4,"is_answered":true,"view_count":42,"answer_count":2,"score":0,"last_activity_date":1701801990,"creation_date":1701055353,"question_id":77554369,"body_markdown":"I&#39;ve seen similar questions but my installation has no outside connectivity. I&#39;ve tried the recommendations in several posts I&#39;ll link below but my issue persists. I downloaded both junit and hamcrest per installation instructions and have been trying to get my project to recognize junit.\r\n\r\n[![offline junit files][1]][1]\r\n\r\nFirst, the error I&#39;m receiving when attempting to debug:\r\n\r\n[![No cached. version listing for junit][2]][2]\r\n\r\nI have added them to my project under Project Settings -&gt; Libraries\r\n\r\n[![Libraries][3]][3]\r\n\r\nI have added them as modules via Project Settings -&gt; Modules\r\n\r\n[![Project Settings - Modules][4]][4]\r\n\r\nI have it added via Gradle as a dependency:\r\n\r\n[![Gradle dependency][5]][5]\r\n\r\nWhat am I missing? Still very much new to IntelliJ so any and all help is welcome. Thanks!\r\n\r\nhttps://stackoverflow.com/questions/19330832/setting-up-junit-with-intellij-idea\r\n\r\nhttps://stackoverflow.com/questions/60327197/importing-junit-into-intellij\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/X8s4s.png\r\n  [2]: https://i.stack.imgur.com/MCbgb.png\r\n  [3]: https://i.stack.imgur.com/TM3At.png\r\n  [4]: https://i.stack.imgur.com/qiYeC.png\r\n  [5]: https://i.stack.imgur.com/EPAGf.png","link":"https://stackoverflow.com/questions/77554369/offline-intellij-installation-and-junit","title":"Offline IntelliJ installation and junit","body":"<p>I've seen similar questions but my installation has no outside connectivity. I've tried the recommendations in several posts I'll link below but my issue persists. I downloaded both junit and hamcrest per installation instructions and have been trying to get my project to recognize junit.</p>\n<p><a href=\"https://i.stack.imgur.com/X8s4s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X8s4s.png\" alt=\"offline junit files\" /></a></p>\n<p>First, the error I'm receiving when attempting to debug:</p>\n<p><a href=\"https://i.stack.imgur.com/MCbgb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MCbgb.png\" alt=\"No cached. version listing for junit\" /></a></p>\n<p>I have added them to my project under Project Settings -&gt; Libraries</p>\n<p><a href=\"https://i.stack.imgur.com/TM3At.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TM3At.png\" alt=\"Libraries\" /></a></p>\n<p>I have added them as modules via Project Settings -&gt; Modules</p>\n<p><a href=\"https://i.stack.imgur.com/qiYeC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qiYeC.png\" alt=\"Project Settings - Modules\" /></a></p>\n<p>I have it added via Gradle as a dependency:</p>\n<p><a href=\"https://i.stack.imgur.com/EPAGf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EPAGf.png\" alt=\"Gradle dependency\" /></a></p>\n<p>What am I missing? Still very much new to IntelliJ so any and all help is welcome. Thanks!</p>\n<p><a href=\"https://stackoverflow.com/questions/19330832/setting-up-junit-with-intellij-idea\">Setting up JUnit with IntelliJ IDEA</a></p>\n<p><a href=\"https://stackoverflow.com/questions/60327197/importing-junit-into-intellij\">Importing JUnit into Intellij</a></p>\n"},{"tags":["java","arrays","sorting"],"comments":[{"score":4,"post_type":"question","creation_date":1675811440,"post_id":75379859,"comment_id":133008376,"body_markdown":"You haven&#39;t asked a question. Please read [ask].","link":"https://stackoverflow.com/questions/75379859/how-to-sort-insert-and-prioritize-most-recent-in-an-array-list#comment133008376_75379859","body":"You haven&#39;t asked a question. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}],"answers":[{"comment_count":0,"score":0,"last_activity_date":1675816245,"last_edit_date":1675816245,"creation_date":1675814801,"answer_id":75380222,"question_id":75379859,"body_markdown":"Let&#39;s start with the fact that you need to have uniqueness in your array, so you want a set. \r\n\r\nThe best (quick) implementation you can find using the standard libraries is `LinkedHashSet&lt;Integer&gt;`.\r\n\r\nIf we analyze its documentation for a second we can see that by default it preserves the insertion order, which is perfect for your case, however, we also notice that it ignores re-insertions if the element is present:\r\n\r\n\r\n\r\n&gt; This linked list defines the iteration ordering, which is the order in\r\n&gt; which elements were inserted into the set (insertion-order). Note that\r\n&gt; insertion order is not affected if an element is re-inserted into the\r\n&gt; set. (An element e is reinserted into a set s if s.add(e) is invoked\r\n&gt; when s.contains(e) would return true immediately prior to the\r\n&gt; invocation.)\r\n\r\nTo get around this problem, you can create a utility function that first attempts to remove the number you want to insert from the set, then reinserts it again, thus changing the insertion order.\r\n\r\nE.g.\r\n\r\n    final var set = new LinkedHashSet&lt;Integer&gt;();\r\n\r\n...\r\n\r\n    static void addFirst(Set&lt;Integer&gt; set, int val) {\r\n      set.remove(val);\r\n      set.add(val);\r\n    }\r\n\r\nAt this point you can take its iterator and read the set values as you need it most.\r\n\r\nNote:\r\nSince this is only efficient if the reads are in the direction of the iterator or if they are few compared to the inserts, so, if you have to iterate often in reverse then you are better off using a `LinkedList&lt;Integer&gt;`\r\n directly and doing the same little game as `remove()` and `add()`.\r\n\r\nThat&#39;s because, unfortunately although the set is doubly linked, the only way you can scroll through it in reverse is as follows:\r\n\r\n    final var list = new LinkedList&lt;&gt;(set); \r\n    final var it = list.descendingIterator(); \r\n    while(it.hasNext()) {\r\n       int item = it.next();\r\n       // do something \r\n    }","link":"https://stackoverflow.com/questions/75379859/how-to-sort-insert-and-prioritize-most-recent-in-an-array-list/75380222#75380222","title":"How to sort insert and prioritize most recent in an Array List?","body":"<p>Let's start with the fact that you need to have uniqueness in your array, so you want a set.</p>\n<p>The best (quick) implementation you can find using the standard libraries is <code>LinkedHashSet&lt;Integer&gt;</code>.</p>\n<p>If we analyze its documentation for a second we can see that by default it preserves the insertion order, which is perfect for your case, however, we also notice that it ignores re-insertions if the element is present:</p>\n<blockquote>\n<p>This linked list defines the iteration ordering, which is the order in\nwhich elements were inserted into the set (insertion-order). Note that\ninsertion order is not affected if an element is re-inserted into the\nset. (An element e is reinserted into a set s if s.add(e) is invoked\nwhen s.contains(e) would return true immediately prior to the\ninvocation.)</p>\n</blockquote>\n<p>To get around this problem, you can create a utility function that first attempts to remove the number you want to insert from the set, then reinserts it again, thus changing the insertion order.</p>\n<p>E.g.</p>\n<pre><code>final var set = new LinkedHashSet&lt;Integer&gt;();\n</code></pre>\n<p>...</p>\n<pre><code>static void addFirst(Set&lt;Integer&gt; set, int val) {\n  set.remove(val);\n  set.add(val);\n}\n</code></pre>\n<p>At this point you can take its iterator and read the set values as you need it most.</p>\n<p>Note:\nSince this is only efficient if the reads are in the direction of the iterator or if they are few compared to the inserts, so, if you have to iterate often in reverse then you are better off using a <code>LinkedList&lt;Integer&gt;</code>\ndirectly and doing the same little game as <code>remove()</code> and <code>add()</code>.</p>\n<p>That's because, unfortunately although the set is doubly linked, the only way you can scroll through it in reverse is as follows:</p>\n<pre><code>final var list = new LinkedList&lt;&gt;(set); \nfinal var it = list.descendingIterator(); \nwhile(it.hasNext()) {\n   int item = it.next();\n   // do something \n}\n</code></pre>\n"},{"comment_count":0,"score":0,"last_activity_date":1701800298,"last_edit_date":1701800298,"creation_date":1675864160,"answer_id":75386750,"question_id":75379859,"body_markdown":"Keeping to you existing scheme, here is one way this could be accomplished. Read the comments in code:\r\n\r\nRunnable code:\r\n\r\n```\r\nimport java.util.ArrayList;\r\nimport java.util.Arrays;\r\nimport java.util.List;\r\nimport java.util.Scanner;\r\n\r\n\r\npublic class AddNewButDeleteDuplicate_Demo {\r\n    \r\n    // System related newline character sequence. Could be used anywhere.\r\n    public static final String LS = System.lineSeparator(); \r\n    \r\n    // Open a keyboard input stream. Could be used anywhere.\r\n    public static final Scanner userInput = new Scanner(System.in); \r\n    \r\n    // Application Entry Point:\r\n    public static void main(String[] args) {\r\n        // App started this way to avoid the need for statics:\r\n        new AddNewButDeleteDuplicate_Demo().startApp(args);\r\n    }\r\n    \r\n    private void startApp(String[] args) {\r\n        // This code can create an int[] array of any size:\r\n        \r\n        int[] intArray; // Declare our int[] array \r\n        int count = 1;  // Counter used for &#39;number of entries&#39; display:\r\n        \r\n        // Inform of upcoming prompt:\r\n        System.out.println(&quot;Enter integer numbers (1 to 10) to add to Array&quot; + LS \r\n                           + &quot;or enter &#39;s&#39; at any time to stop.&quot;);\r\n\r\n        /* List Interface of Integer to hold all integer values supplied \r\n           by User.This List is later converted to an int[] Array. List\r\n           is used because it can grow dynamically whereas Arrays can not. \r\n           This then allows the User to enter as many elements as desired\r\n           which the rules specify 10 elements max since we can only enter \r\n           values from 1 to 10.                     */\r\n        List&lt;Integer&gt; intList = new ArrayList&lt;&gt;();\r\n        \r\n        // To hold the current value supplied by User:\r\n        String inputValue = &quot;&quot;;  \r\n        \r\n        // Repeatable User Entry Prompt with a Stop mechanism and entry Validation:\r\n        while (inputValue.isEmpty()) {\r\n            // Prompt:\r\n            System.out.print(&quot;Entry #&quot; + count + &quot;: -&gt; &quot;);\r\n            // Get User Entry:\r\n            inputValue = userInput.nextLine().trim();\r\n            // Is &#39;Stop&#39; desired?\r\n            if (inputValue.equalsIgnoreCase(&quot;s&quot;)) {\r\n                // Yes...Inform and exit `while` loop\r\n                System.out.println(&quot;Done Creating Array!&quot;);\r\n                break;  // Exit `while` loop.\r\n            }\r\n            /* Validate User Entry. If the entry IS NOT a string representation\r\n               of a unsigned integer value from 1 to 10 then indicate as invalid\r\n               and allow the User to try again.        */\r\n            if (!inputValue.matches(&quot;\\\\d+&quot;) || Integer.parseInt(inputValue) &lt; 1 || \r\n                                                 Integer.parseInt(inputValue) &gt; 10) {\r\n                System.out.println(&quot;&gt;&gt; Invalid Entry (&quot; + inputValue + &quot;)! Try again... &lt;&lt;&quot; + LS);\r\n                inputValue = &quot;&quot;;    // Empty variable to ensure re-loop.\r\n                continue;  // Jump to top of loop:\r\n            }\r\n\r\n            /* If we made it to this point, then the User supplied value is \r\n               valid. Convert the User supplied string numerical value to \r\n               int data type.               */\r\n            int val = Integer.parseInt(inputValue);\r\n            \r\n            /* For demo purposes, display the Current List before checking\r\n               for duplicates:         */\r\n            System.out.println(&quot;List Previous: -&gt; &quot; + intList);\r\n            \r\n            // Check for duplicate...\r\n            /* If List is not empty and the int value of the User supplied\r\n               number IS currently contained within the List then remove the\r\n               duplicate value already contained within the List and insert \r\n               the new (same) value to the beginning of the List at index 0.  */\r\n            if (!intList.isEmpty() &amp;&amp; intList.contains(val)) {\r\n                int idx = intList.indexOf(val);\r\n                /* If the duplicate is already located at index 0 of the List \r\n                   then there is no point doing any modification to the List\r\n                   since this is where we would place the new value anyways. */\r\n                if (idx != 0) {\r\n                    intList.remove(idx); \r\n                    intList.add(0, val);\r\n                    // Inform of duplicate entry:\r\n                    System.out.println(&quot;&gt;&gt; Duplicate Entry (&quot; + inputValue + &quot;)! &quot;\r\n                            + &quot;Old value removed at index &quot; + idx + &quot; and New value inserted &quot;\r\n                                    + &quot;into index 0. &lt;&lt;&quot; + LS);\r\n                }\r\n            }\r\n            // Otherwise, just add the int value to the List:\r\n            else {\r\n                intList.add(val);\r\n            }\r\n            \r\n            /* For demo purposes, display the Current List after checking\r\n               for duplicates:         */\r\n            System.out.println(&quot;List Current:  -&gt; &quot; + intList);\r\n            \r\n            inputValue = &quot;&quot;; // Empty variable to ensure re-loop.\r\n            count++;  // Increment User entry count:\r\n        }\r\n        \r\n        // Convert the List to an int[] Array using Streams:\r\n        intArray = intList.stream().mapToInt(d -&gt; d).toArray();\r\n        \r\n        // Display int[] Array:\r\n        System.out.println(&quot;The intArray[] Array: -&gt; &quot; + Arrays.toString(intArray));\r\n    }\r\n}\r\n```\r\n\r\n","link":"https://stackoverflow.com/questions/75379859/how-to-sort-insert-and-prioritize-most-recent-in-an-array-list/75386750#75386750","title":"How to sort insert and prioritize most recent in an Array List?","body":"<p>Keeping to you existing scheme, here is one way this could be accomplished. Read the comments in code:</p>\n<p>Runnable code:</p>\n<pre><code>import java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.List;\nimport java.util.Scanner;\n\n\npublic class AddNewButDeleteDuplicate_Demo {\n    \n    // System related newline character sequence. Could be used anywhere.\n    public static final String LS = System.lineSeparator(); \n    \n    // Open a keyboard input stream. Could be used anywhere.\n    public static final Scanner userInput = new Scanner(System.in); \n    \n    // Application Entry Point:\n    public static void main(String[] args) {\n        // App started this way to avoid the need for statics:\n        new AddNewButDeleteDuplicate_Demo().startApp(args);\n    }\n    \n    private void startApp(String[] args) {\n        // This code can create an int[] array of any size:\n        \n        int[] intArray; // Declare our int[] array \n        int count = 1;  // Counter used for 'number of entries' display:\n        \n        // Inform of upcoming prompt:\n        System.out.println(&quot;Enter integer numbers (1 to 10) to add to Array&quot; + LS \n                           + &quot;or enter 's' at any time to stop.&quot;);\n\n        /* List Interface of Integer to hold all integer values supplied \n           by User.This List is later converted to an int[] Array. List\n           is used because it can grow dynamically whereas Arrays can not. \n           This then allows the User to enter as many elements as desired\n           which the rules specify 10 elements max since we can only enter \n           values from 1 to 10.                     */\n        List&lt;Integer&gt; intList = new ArrayList&lt;&gt;();\n        \n        // To hold the current value supplied by User:\n        String inputValue = &quot;&quot;;  \n        \n        // Repeatable User Entry Prompt with a Stop mechanism and entry Validation:\n        while (inputValue.isEmpty()) {\n            // Prompt:\n            System.out.print(&quot;Entry #&quot; + count + &quot;: -&gt; &quot;);\n            // Get User Entry:\n            inputValue = userInput.nextLine().trim();\n            // Is 'Stop' desired?\n            if (inputValue.equalsIgnoreCase(&quot;s&quot;)) {\n                // Yes...Inform and exit `while` loop\n                System.out.println(&quot;Done Creating Array!&quot;);\n                break;  // Exit `while` loop.\n            }\n            /* Validate User Entry. If the entry IS NOT a string representation\n               of a unsigned integer value from 1 to 10 then indicate as invalid\n               and allow the User to try again.        */\n            if (!inputValue.matches(&quot;\\\\d+&quot;) || Integer.parseInt(inputValue) &lt; 1 || \n                                                 Integer.parseInt(inputValue) &gt; 10) {\n                System.out.println(&quot;&gt;&gt; Invalid Entry (&quot; + inputValue + &quot;)! Try again... &lt;&lt;&quot; + LS);\n                inputValue = &quot;&quot;;    // Empty variable to ensure re-loop.\n                continue;  // Jump to top of loop:\n            }\n\n            /* If we made it to this point, then the User supplied value is \n               valid. Convert the User supplied string numerical value to \n               int data type.               */\n            int val = Integer.parseInt(inputValue);\n            \n            /* For demo purposes, display the Current List before checking\n               for duplicates:         */\n            System.out.println(&quot;List Previous: -&gt; &quot; + intList);\n            \n            // Check for duplicate...\n            /* If List is not empty and the int value of the User supplied\n               number IS currently contained within the List then remove the\n               duplicate value already contained within the List and insert \n               the new (same) value to the beginning of the List at index 0.  */\n            if (!intList.isEmpty() &amp;&amp; intList.contains(val)) {\n                int idx = intList.indexOf(val);\n                /* If the duplicate is already located at index 0 of the List \n                   then there is no point doing any modification to the List\n                   since this is where we would place the new value anyways. */\n                if (idx != 0) {\n                    intList.remove(idx); \n                    intList.add(0, val);\n                    // Inform of duplicate entry:\n                    System.out.println(&quot;&gt;&gt; Duplicate Entry (&quot; + inputValue + &quot;)! &quot;\n                            + &quot;Old value removed at index &quot; + idx + &quot; and New value inserted &quot;\n                                    + &quot;into index 0. &lt;&lt;&quot; + LS);\n                }\n            }\n            // Otherwise, just add the int value to the List:\n            else {\n                intList.add(val);\n            }\n            \n            /* For demo purposes, display the Current List after checking\n               for duplicates:         */\n            System.out.println(&quot;List Current:  -&gt; &quot; + intList);\n            \n            inputValue = &quot;&quot;; // Empty variable to ensure re-loop.\n            count++;  // Increment User entry count:\n        }\n        \n        // Convert the List to an int[] Array using Streams:\n        intArray = intList.stream().mapToInt(d -&gt; d).toArray();\n        \n        // Display int[] Array:\n        System.out.println(&quot;The intArray[] Array: -&gt; &quot; + Arrays.toString(intArray));\n    }\n}\n</code></pre>\n"},{"comment_count":0,"score":0,"last_activity_date":1675869676,"creation_date":1675869676,"answer_id":75387938,"question_id":75379859,"body_markdown":"I will provide a solution for arrays and I will presume that if a new item is specified by the user, it will get to the head of the array and pulling everything to the right, with the oldest falling out of the array:\r\n\r\n```\r\nint index = intArray.indexOf(input);\r\nif (index &lt; 0) {\r\n    index = intArray.length; //we default to the last item that would disappear\r\nfor (int i = index; i &gt; 0; i--) {\r\n    intArray[i] = intArray[i - 1];\r\n}\r\nintArray[0] = input;\r\n```","link":"https://stackoverflow.com/questions/75379859/how-to-sort-insert-and-prioritize-most-recent-in-an-array-list/75387938#75387938","title":"How to sort insert and prioritize most recent in an Array List?","body":"<p>I will provide a solution for arrays and I will presume that if a new item is specified by the user, it will get to the head of the array and pulling everything to the right, with the oldest falling out of the array:</p>\n<pre><code>int index = intArray.indexOf(input);\nif (index &lt; 0) {\n    index = intArray.length; //we default to the last item that would disappear\nfor (int i = index; i &gt; 0; i--) {\n    intArray[i] = intArray[i - 1];\n}\nintArray[0] = input;\n</code></pre>\n"}],"comment_count":1,"is_answered":true,"view_count":110,"answer_count":3,"score":-1,"last_activity_date":1701800298,"creation_date":1675810990,"last_edit_date":1675869377,"question_id":75379859,"body_markdown":"I tried checking the array to see if the number is already listed, if the user happens to input a number twice thus number should be placed to the top being its most recent and everything else should be shifted down. in Short given the array [ 4, 5, 6, 7, 9] if the users inputs 7 it should be changed to [7, 4, 5, 6, 9].\r\n\r\n\r\n\r\n\r\n\r\n    //Array Created\r\n    int intArray[] = new int[5]; \r\n\r\n    //Number of values in the array\r\n    int count = 0;\r\n\r\n    //Value user enters\r\n    int userInput = 0;\r\n    \r\n    //Receive user inputs\r\n    Scanner in = new Scanner(System.in);\r\n    \r\n    //First Prompt \r\n    System.out.println(&quot;Enter The File You Wish To Use. Enter 0 to stop:&quot;);\r\n    userInput = in.nextInt();\r\n\r\n    //Keep asking for number if invalid\r\n    while((userInput &lt; 0) || (userInput &gt; 10)){\r\n      System.out.println(&quot;Invalid number. Must be between 1 - 10\\n&quot;);\r\n      System.out.println(&quot;Enter The File You Wish To Use. Enter 0 to stop:&quot;);\r\n      userInput = in.nextInt();\r\n    }\r\n    \r\n    intArray[count] = userInput;\r\n    count++;\r\n    \r\n   \r\n     while(userInput != 0){\r\n\r\n       //Keeps Track of the numbers inputed \r\n      System.out.println(&quot;There is currently &quot; + count + &quot; On The Table.&quot;);\r\n      for(int i = 0; i &lt; count; i++){\r\n        System.out.print(intArray[i] + &quot; &quot;);\r\n      }\r\n  \r\n      System.out.print(&quot;\\n\\n&quot;);\r\n      System.out.println(&quot;Enter The File You Wish To Use. Enter 0 to stop:&quot;);\r\n      \r\n      userInput = in.nextInt();\r\n      \r\n      //Don&#39;t Allow numbers bigger than 10 or less than 1\r\n      while(userInput &lt; 0 || userInput &gt; 10){\r\n        System.out.println(&quot;Invalid number.\\n&quot;);\r\n        System.out.println(&quot;Enter The File You Wish To Use. Enter 0 to stop:&quot;);\r\n        userInput = in.nextInt();\r\n      } \r\n\r\n      if(count == intArray.length){\r\n        int tempPrev;\r\n        for(int i = (intArray.length - 1); i &gt; 0; i--){\r\n          \r\n          //Store the previous value\r\n          tempPrev = intArray[i - 1];\r\n\r\n          //Assign current index to what was in previous\r\n          intArray[i] = tempPrev;\r\n        }\r\n        \r\n        intArray[0] = userInput;\r\n        count = intArray.length;\r\n      } else {\r\n        intArray[count] = userInput;\r\n        count++;\r\n      }\r\n    }\r\n    System.out.println(&quot;The end.&quot;);\r\n  }\r\n}\r\n","link":"https://stackoverflow.com/questions/75379859/how-to-sort-insert-and-prioritize-most-recent-in-an-array-list","title":"How to sort insert and prioritize most recent in an Array List?","body":"<p>I tried checking the array to see if the number is already listed, if the user happens to input a number twice thus number should be placed to the top being its most recent and everything else should be shifted down. in Short given the array [ 4, 5, 6, 7, 9] if the users inputs 7 it should be changed to [7, 4, 5, 6, 9].</p>\n<pre><code>//Array Created\nint intArray[] = new int[5]; \n\n//Number of values in the array\nint count = 0;\n\n//Value user enters\nint userInput = 0;\n\n//Receive user inputs\nScanner in = new Scanner(System.in);\n\n//First Prompt \nSystem.out.println(&quot;Enter The File You Wish To Use. Enter 0 to stop:&quot;);\nuserInput = in.nextInt();\n\n//Keep asking for number if invalid\nwhile((userInput &lt; 0) || (userInput &gt; 10)){\n  System.out.println(&quot;Invalid number. Must be between 1 - 10\\n&quot;);\n  System.out.println(&quot;Enter The File You Wish To Use. Enter 0 to stop:&quot;);\n  userInput = in.nextInt();\n}\n\nintArray[count] = userInput;\ncount++;\n\n\n while(userInput != 0){\n\n   //Keeps Track of the numbers inputed \n  System.out.println(&quot;There is currently &quot; + count + &quot; On The Table.&quot;);\n  for(int i = 0; i &lt; count; i++){\n    System.out.print(intArray[i] + &quot; &quot;);\n  }\n\n  System.out.print(&quot;\\n\\n&quot;);\n  System.out.println(&quot;Enter The File You Wish To Use. Enter 0 to stop:&quot;);\n  \n  userInput = in.nextInt();\n  \n  //Don't Allow numbers bigger than 10 or less than 1\n  while(userInput &lt; 0 || userInput &gt; 10){\n    System.out.println(&quot;Invalid number.\\n&quot;);\n    System.out.println(&quot;Enter The File You Wish To Use. Enter 0 to stop:&quot;);\n    userInput = in.nextInt();\n  } \n\n  if(count == intArray.length){\n    int tempPrev;\n    for(int i = (intArray.length - 1); i &gt; 0; i--){\n      \n      //Store the previous value\n      tempPrev = intArray[i - 1];\n\n      //Assign current index to what was in previous\n      intArray[i] = tempPrev;\n    }\n    \n    intArray[0] = userInput;\n    count = intArray.length;\n  } else {\n    intArray[count] = userInput;\n    count++;\n  }\n}\nSystem.out.println(&quot;The end.&quot;);\n</code></pre>\n<p>}\n}</p>\n"},{"tags":["java","hibernate","methods","spring-data-jpa","deprecated"],"comments":[{"score":0,"post_type":"question","creation_date":1691132722,"post_id":76833652,"comment_id":135453057,"body_markdown":"Never use @lombok.Data because equals will be wrong","link":"https://stackoverflow.com/questions/76833652/spring-data-jpa-with-hibernate-6-why-the-jpa-save-method-do-insert-when-i-tr#comment135453057_76833652","body":"Never use @lombok.Data because equals will be wrong"},{"score":0,"post_type":"question","creation_date":1691135957,"post_id":76833652,"comment_id":135453704,"body_markdown":"@SimonMartinelli yes you are right, but its not important in this question.","link":"https://stackoverflow.com/questions/76833652/spring-data-jpa-with-hibernate-6-why-the-jpa-save-method-do-insert-when-i-tr#comment135453704_76833652","body":"@SimonMartinelli yes you are right, but its not important in this question."}],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1691138675,"post_id":76834134,"comment_id":135454155,"body_markdown":"thx to @Long, its good enough to solve my problem, in fact, I could rewrite the save method as：\n                 ID id = (ID)entityInformation.getId(entity);\t\t\n\t\t\t\t\n\t\tOptional&lt;T&gt; persistenceOptional = this.findById(id);\n\t\tif (persistenceOptional.isEmpty()) {\n\t\t\tthrow new StaleObjectStateException(entityInformation.getEntityName(), id); \n\t\t}\n                // do the update\nBut I still think there is a possible best way to handle this, any more idea?","link":"https://stackoverflow.com/questions/76833652/spring-data-jpa-with-hibernate-6-why-the-jpa-save-method-do-insert-when-i-tr/76834134#comment135454155_76834134","body":"thx to @Long, its good enough to solve my problem, in fact, I could rewrite the save method as：                  ID id = (ID)entityInformation.getId(entity);\t\t \t\t\t\t \t\tOptional&lt;T&gt; persistenceOptional = this.findById(id); \t\tif (persistenceOptional.isEmpty()) { \t\t\tthrow new StaleObjectStateException(entityInformation.getEntityName(), id);  \t\t}                 // do the update But I still think there is a possible best way to handle this, any more idea?"},{"score":0,"post_type":"answer","creation_date":1691163544,"post_id":76834134,"comment_id":135459411,"body_markdown":"Still not get what you&#39;re trying to do. If you modify like that, how can you insert new record from now on?\nYou can extend your repository with a custom interface that contains custom function called updateIfExist(), then you can implement that function with your logic. Throw error when entity not exist... etc. \nFor update() function of JPA, just leave it as it is.","link":"https://stackoverflow.com/questions/76833652/spring-data-jpa-with-hibernate-6-why-the-jpa-save-method-do-insert-when-i-tr/76834134#comment135459411_76834134","body":"Still not get what you&#39;re trying to do. If you modify like that, how can you insert new record from now on? You can extend your repository with a custom interface that contains custom function called updateIfExist(), then you can implement that function with your logic. Throw error when entity not exist... etc.  For update() function of JPA, just leave it as it is."},{"score":0,"post_type":"answer","creation_date":1691372703,"post_id":76834134,"comment_id":135478090,"body_markdown":"I meant the implementation code seems a little strange. It&#39;s need to query at first before update, however I dont want do like that, its not so elegant...","link":"https://stackoverflow.com/questions/76833652/spring-data-jpa-with-hibernate-6-why-the-jpa-save-method-do-insert-when-i-tr/76834134#comment135478090_76834134","body":"I meant the implementation code seems a little strange. It&#39;s need to query at first before update, however I dont want do like that, its not so elegant..."}],"comment_count":3,"score":1,"last_activity_date":1691136905,"creation_date":1691136905,"answer_id":76834134,"question_id":76833652,"body_markdown":"This is implemenation for JPA save function:\r\n\r\n```\r\n    @Transactional\r\n    public &lt;S extends T&gt; S save(S entity) {\r\n        if (this.entityInformation.isNew(entity)) {\r\n            this.em.persist(entity);\r\n            return entity;\r\n        } else {\r\n            return this.em.merge(entity);\r\n        }\r\n    }\r\n```\r\nSo, as you can see, JPA do check if entity is existing or not. \r\nIf yes, then it will update, otherwise JPA will insert a new record. If you don&#39;t want to insert if not exist, you can call findById() first, throw exception if entity not exist, then call save() after that. Please don&#39;t try to modify default behavior of JPA as it can cause more issue in the future. ","link":"https://stackoverflow.com/questions/76833652/spring-data-jpa-with-hibernate-6-why-the-jpa-save-method-do-insert-when-i-tr/76834134#76834134","title":"spring data jpa with hibernate 6 - why the jpa save() method do insert when I try to update a non-existing record?","body":"<p>This is implemenation for JPA save function:</p>\n<pre><code>    @Transactional\n    public &lt;S extends T&gt; S save(S entity) {\n        if (this.entityInformation.isNew(entity)) {\n            this.em.persist(entity);\n            return entity;\n        } else {\n            return this.em.merge(entity);\n        }\n    }\n</code></pre>\n<p>So, as you can see, JPA do check if entity is existing or not.\nIf yes, then it will update, otherwise JPA will insert a new record. If you don't want to insert if not exist, you can call findById() first, throw exception if entity not exist, then call save() after that. Please don't try to modify default behavior of JPA as it can cause more issue in the future.</p>\n"},{"comment_count":0,"score":0,"last_activity_date":1701799950,"creation_date":1701799950,"answer_id":77608413,"question_id":76833652,"body_markdown":"You should implement `org.springframework.data.domain.Persistable`\r\n\r\n**Explanation**: \r\nSpring Data only has a single save method, but underneath it needs to do either persist or merge, as you can see in the save implementation. This is only an issue if you assign the primary key in code. If JPA assigns it, using an IDGenerator, you don&#39;t need to do anything, because spring data sees that the ID is null, so it will call persist. \r\n\r\nSpring Data designed an extension point for this specific usecase, so we can tell the framework if the entity is new or old, and the id is not null. The solution is to implement the `org.springframework.data.domain.Persistable&lt;ID&gt;` and override the `isNew()` method. \r\nWhen you have an unmanaged Entity, and call save it, Spring data will forward to persist, as detailed in the save method. If you have an unmanaged entity, that is not new, Spring data will merge the entity, as the JPA spec specifies.\r\n","link":"https://stackoverflow.com/questions/76833652/spring-data-jpa-with-hibernate-6-why-the-jpa-save-method-do-insert-when-i-tr/77608413#77608413","title":"spring data jpa with hibernate 6 - why the jpa save() method do insert when I try to update a non-existing record?","body":"<p>You should implement <code>org.springframework.data.domain.Persistable</code></p>\n<p><strong>Explanation</strong>:\nSpring Data only has a single save method, but underneath it needs to do either persist or merge, as you can see in the save implementation. This is only an issue if you assign the primary key in code. If JPA assigns it, using an IDGenerator, you don't need to do anything, because spring data sees that the ID is null, so it will call persist.</p>\n<p>Spring Data designed an extension point for this specific usecase, so we can tell the framework if the entity is new or old, and the id is not null. The solution is to implement the <code>org.springframework.data.domain.Persistable&lt;ID&gt;</code> and override the <code>isNew()</code> method.\nWhen you have an unmanaged Entity, and call save it, Spring data will forward to persist, as detailed in the save method. If you have an unmanaged entity, that is not new, Spring data will merge the entity, as the JPA spec specifies.</p>\n"}],"comment_count":2,"is_answered":true,"view_count":394,"answer_count":2,"score":0,"last_activity_date":1701799950,"creation_date":1691132596,"question_id":76833652,"body_markdown":"I have a &quot;Test&quot; entity:\r\n\r\n```\r\n@Entity\r\n@Table(name = &quot;TEST&quot;)\r\n@lombok.Data\r\npublic class Test {\t\r\n\t\r\n\t@Id\r\n\t@jakarta.persistence.GeneratedValue(generator = &quot;test_id_gen_key&quot;)\r\n\t@org.hibernate.annotations.GenericGenerator(name=&quot;test_id_gen_key&quot;, type=org.hibernate.id.IdentityGenerator.class)\r\n\t@Column(name=&quot;id&quot;, nullable = false)\r\n\tprivate Integer id;\r\n\t\r\n\t@Column(name=&quot;name&quot;, nullable = true, length = 10)\r\n\tprivate String name;\r\n\t\r\n}\r\n```\r\n\r\nAnd the TestRepository:\r\n\r\n```\r\n@Repository\r\npublic interface TestRepository extends JpaRepository&lt;Test, Integer&gt; {\r\n\r\n}\r\n```\r\n\r\nWhen I try to do a update in TestService like this:\r\n\r\n```\r\nvar test = new Test(10, &quot;any name&quot;);  // the id value : 10 does not exist in the databse \r\n\r\ntestRepository.save(test);\r\n\r\n```\r\n\r\nThen the hibernate execute the merge() method:\r\n1. query the database with the id value ： 10；\r\n2. got nothing from step 1, then it execute an insert sql to generate a new record.\r\n\r\nBut what I want in this situation is to throw a exception, the CrudRepository#save method also said &quot;also thrown if the entity is assumed to be present but does not exist in the database&quot; :\r\n\r\n\r\n```\r\n\t/**\r\n\t * Saves a given entity. Use the returned instance for further operations as the save operation might have changed the\r\n\t * entity instance completely.\r\n\t *\r\n\t * @param entity must not be {@literal null}.\r\n\t * @return the saved entity; will never be {@literal null}.\r\n\t * @throws IllegalArgumentException in case the given {@literal entity} is {@literal null}.\r\n\t * @throws OptimisticLockingFailureException when the entity uses optimistic locking and has a version attribute with\r\n\t *           a different value from that found in the persistence store. **Also thrown if the entity is assumed to be\r\n\t *           present but does not exist in the database**.\r\n\t */\r\n\t&lt;S extends T&gt; S save(S entity);\r\n```\r\n\r\nWhat is the best way to handle this situation?\r\n\r\n\r\n\r\n\r\n\r\n\r\nI extend the SimpleJpaRepository implementation and add a update method to call the org.hibernate.Session#update() method, it works as I expected, but the method is deprecated already, I dont think its a prefect solution:\r\n\r\n\r\n```\r\n@SuppressWarnings(&quot;deprecation&quot;)\r\n\t@Override\r\n\tpublic T update(T entity) {\t\t\r\n\t\tsession().update(entity);\r\n\t\t\r\n\t\treturn entity;\r\n\t}\r\n```\r\n","link":"https://stackoverflow.com/questions/76833652/spring-data-jpa-with-hibernate-6-why-the-jpa-save-method-do-insert-when-i-tr","title":"spring data jpa with hibernate 6 - why the jpa save() method do insert when I try to update a non-existing record?","body":"<p>I have a &quot;Test&quot; entity:</p>\n<pre><code>@Entity\n@Table(name = &quot;TEST&quot;)\n@lombok.Data\npublic class Test { \n    \n    @Id\n    @jakarta.persistence.GeneratedValue(generator = &quot;test_id_gen_key&quot;)\n    @org.hibernate.annotations.GenericGenerator(name=&quot;test_id_gen_key&quot;, type=org.hibernate.id.IdentityGenerator.class)\n    @Column(name=&quot;id&quot;, nullable = false)\n    private Integer id;\n    \n    @Column(name=&quot;name&quot;, nullable = true, length = 10)\n    private String name;\n    \n}\n</code></pre>\n<p>And the TestRepository:</p>\n<pre><code>@Repository\npublic interface TestRepository extends JpaRepository&lt;Test, Integer&gt; {\n\n}\n</code></pre>\n<p>When I try to do a update in TestService like this:</p>\n<pre><code>var test = new Test(10, &quot;any name&quot;);  // the id value : 10 does not exist in the databse \n\ntestRepository.save(test);\n\n</code></pre>\n<p>Then the hibernate execute the merge() method:</p>\n<ol>\n<li>query the database with the id value ： 10；</li>\n<li>got nothing from step 1, then it execute an insert sql to generate a new record.</li>\n</ol>\n<p>But what I want in this situation is to throw a exception, the CrudRepository#save method also said &quot;also thrown if the entity is assumed to be present but does not exist in the database&quot; :</p>\n<pre><code>    /**\n     * Saves a given entity. Use the returned instance for further operations as the save operation might have changed the\n     * entity instance completely.\n     *\n     * @param entity must not be {@literal null}.\n     * @return the saved entity; will never be {@literal null}.\n     * @throws IllegalArgumentException in case the given {@literal entity} is {@literal null}.\n     * @throws OptimisticLockingFailureException when the entity uses optimistic locking and has a version attribute with\n     *           a different value from that found in the persistence store. **Also thrown if the entity is assumed to be\n     *           present but does not exist in the database**.\n     */\n    &lt;S extends T&gt; S save(S entity);\n</code></pre>\n<p>What is the best way to handle this situation?</p>\n<p>I extend the SimpleJpaRepository implementation and add a update method to call the org.hibernate.Session#update() method, it works as I expected, but the method is deprecated already, I dont think its a prefect solution:</p>\n<pre><code>@SuppressWarnings(&quot;deprecation&quot;)\n    @Override\n    public T update(T entity) {     \n        session().update(entity);\n        \n        return entity;\n    }\n</code></pre>\n"},{"tags":["java","caldav","ical4j"],"comment_count":0,"is_answered":false,"view_count":18,"answer_count":0,"score":0,"last_activity_date":1701799604,"creation_date":1701022354,"last_edit_date":1701799604,"question_id":77552904,"body_markdown":"I&#39;m using ical4j 3.2.14 to add, update or delete events on a file based calendar and it works fine. The next step is doing the same on a caldav server like sogo.\r\nI know ical4j-connector but I&#39;ve got no idea how to use it. I couldn&#39;t find any usefull tutorial or example for that.\r\n\r\nCould someone explain me how to read a calendar object from a caldav server and merge or save the changes back?\r\n\r\nEvery hint is helpful.","link":"https://stackoverflow.com/questions/77552904/how-to-use-ical4j-with-a-caldav-server","title":"How to use ical4j with a caldav server?","body":"<p>I'm using ical4j 3.2.14 to add, update or delete events on a file based calendar and it works fine. The next step is doing the same on a caldav server like sogo.\nI know ical4j-connector but I've got no idea how to use it. I couldn't find any usefull tutorial or example for that.</p>\n<p>Could someone explain me how to read a calendar object from a caldav server and merge or save the changes back?</p>\n<p>Every hint is helpful.</p>\n"},{"tags":["java","event-listener"],"comments":[{"score":0,"post_type":"question","creation_date":1701280846,"post_id":77573232,"comment_id":136757372,"body_markdown":"Define the variable as an instance variable in your class and then in the constructor you you assign the User to this variable.","link":"https://stackoverflow.com/questions/77573232/how-to-modify-a-variable-in-an-event-listener#comment136757372_77573232","body":"Define the variable as an instance variable in your class and then in the constructor you you assign the User to this variable."},{"score":0,"post_type":"question","creation_date":1701281902,"post_id":77573232,"comment_id":136757528,"body_markdown":"Make ButtonAction an inner class of LoginDialog so it has access to user.","link":"https://stackoverflow.com/questions/77573232/how-to-modify-a-variable-in-an-event-listener#comment136757528_77573232","body":"Make ButtonAction an inner class of LoginDialog so it has access to user."},{"score":0,"post_type":"question","creation_date":1701291611,"post_id":77573232,"comment_id":136759063,"body_markdown":"I have to pass it to another jFrame. User must be visible to a login frame and a main frame.The user parameter of LoginDialog comes from main application.","link":"https://stackoverflow.com/questions/77573232/how-to-modify-a-variable-in-an-event-listener#comment136759063_77573232","body":"I have to pass it to another jFrame. User must be visible to a login frame and a main frame.The user parameter of LoginDialog comes from main application."},{"score":0,"post_type":"question","creation_date":1701798284,"post_id":77573232,"comment_id":136819103,"body_markdown":"My is only an excercise. I want that a user is rcognized from the main application after he is successfull logged in.","link":"https://stackoverflow.com/questions/77573232/how-to-modify-a-variable-in-an-event-listener#comment136819103_77573232","body":"My is only an excercise. I want that a user is rcognized from the main application after he is successfull logged in."},{"score":1,"post_type":"question","creation_date":1701798413,"post_id":77573232,"comment_id":136819137,"body_markdown":"If you want help debugging your code, you need to post more of it. I suggest that you post the body of constructor for class `LoginDialog`. I also suggest that you post code that calls that constructor. Is class `ButtonAction` an inner class of `LoginDialog`?","link":"https://stackoverflow.com/questions/77573232/how-to-modify-a-variable-in-an-event-listener#comment136819137_77573232","body":"If you want help debugging your code, you need to post more of it. I suggest that you post the body of constructor for class <code>LoginDialog</code>. I also suggest that you post code that calls that constructor. Is class <code>ButtonAction</code> an inner class of <code>LoginDialog</code>?"},{"score":0,"post_type":"question","creation_date":1701799038,"post_id":77573232,"comment_id":136819240,"body_markdown":"yes ButtonAction is an inner class. as you can see i have posted more.","link":"https://stackoverflow.com/questions/77573232/how-to-modify-a-variable-in-an-event-listener#comment136819240_77573232","body":"yes ButtonAction is an inner class. as you can see i have posted more."}],"comment_count":6,"is_answered":false,"view_count":46,"answer_count":0,"score":2,"last_activity_date":1701798972,"creation_date":1701277982,"last_edit_date":1701798972,"question_id":77573232,"body_markdown":"i want to modify the variable user passed to a constructor and then modify it in an event listener. the application consists of two window one for login and the main window for the application. I want that the user is recognized by the main window. So when the user log in successfully his info are stored in a user object. the problem is that when the user clicks on the login button the user variable is not seen in the inner class ButtonAction. \r\nfor example:\r\n\r\n```\r\npublic class LoginDialog extends JDialog{\r\npublic LoginDialog(User user) {\r\n       \r\n\r\n\r\n....\r\n}\r\nprivate class ButtonAction implements ActionListener{\r\n\t\tpublic void actionPerformed(ActionEvent ev) {\r\n                             ................\r\n                             setUserInfo(user)//here user is not visible\r\n                }\r\n}\r\n\r\n\r\n}\r\n```\r\n```\r\n    \r\n    public class Main {\r\n\r\n\tprivate JFrame mainFrame;\r\n\tprivate LoginFrame loginFrame;\r\n\tprivate JLabel mainFrameLabel=new JLabel(&quot;Sign In&quot;);\r\n\tUser user=null;\r\n\r\n\t/**\r\n\t * Launch the application.\r\n\t */\r\n\tpublic static void main(String[] args) {\r\n\t\tEventQueue.invokeLater(new Runnable() {\r\n\t\t\tpublic void run() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tMain window = new Main();\r\n\t\t\t\t\twindow.mainFrame.setVisible(true);\r\n\t\t\t\t} catch (Exception e) {\r\n\t\t\t\t\te.printStackTrace();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Create the application.\r\n\t */\r\n\tpublic Main() {\r\n\t\tinitialize();\r\n\t}\r\n\r\n\t/**\r\n\t * Initialize the contents of the frame.\r\n\t */\r\n\tprivate void initialize() {\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\tLoginDialog loginDialog = new LoginDialog(user);\r\n\t\tloginDialog.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);\r\n\t\tloginDialog.setModal(true);\r\n\t\tloginDialog.setVisible(true);\r\n\t\tSystem.out.println(&quot;Stampo info studente:&quot;);\r\n\t\tSystem.out.println(user);\r\n\t\tloginDialog.dispose();\r\n\t\t\r\n\t\tif(user.getLoggedIn()) {\r\n\t\t\tmainFrame = new JFrame(&quot;Main Frame&quot;);\r\n\t\t\tmainFrame.setBounds(300, 300, 450, 300);\r\n\t\t\tmainFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\r\n\t\t\tmainFrame.getContentPane().setLayout(null);\r\n\t\t\t\r\n\t\t\tJPanel mainPanel = new JPanel();\r\n\t\t\tmainPanel.setBounds(10, 10, 426, 243);\r\n\t\t\tmainFrame.getContentPane().add(mainPanel);\r\n\t\t\tmainPanel.setLayout(null);\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tmainFrameLabel.setFont(new Font(&quot;Tahoma&quot;, Font.BOLD, 14));\r\n\t\t\tmainFrameLabel.setBounds(70, 102, 252, 33);\r\n\t\t\tmainPanel.add(mainFrameLabel);\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tmainFrame.addWindowListener(new WindowAdapter() {\r\n\t\t\t\tpublic void windowClosed(WindowEvent we) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tmainFrameLabel.setText(&quot;Sign In&quot;);\r\n\t\t\t\t\t\r\n\t\t\t\t\tuser.setLoggedIn(false);\r\n\t\t\t\t\tuser=null;\r\n\t\t\t\t\tSystem.exit(0);\r\n\t\t\t\t}\r\n\t\t\t      public void windowClosing(WindowEvent we) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tmainFrameLabel.setText(&quot;Sign In&quot;);\r\n\t\t\t\t\t\r\n\t\t\t\t\tuser.setLoggedIn(false);\r\n\t\t\t\t\tuser=null;\r\n\t\t\t\t\tSystem.exit(0);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t});\r\n\t\t}\r\n}\r\n}\r\n```\r\nI get an error &quot;user cannot be resolved to a variable&quot; on setInfoUser(user).How can i solve it?\r\nAs you can see i have summerized.\r\nI have tried several things. But i haven&#39;t solved the problem.\r\nP.s.there are some other errors but i am not interested.","link":"https://stackoverflow.com/questions/77573232/how-to-modify-a-variable-in-an-event-listener","title":"How to modify a variable in an event listener","body":"<p>i want to modify the variable user passed to a constructor and then modify it in an event listener. the application consists of two window one for login and the main window for the application. I want that the user is recognized by the main window. So when the user log in successfully his info are stored in a user object. the problem is that when the user clicks on the login button the user variable is not seen in the inner class ButtonAction.\nfor example:</p>\n<pre><code>public class LoginDialog extends JDialog{\npublic LoginDialog(User user) {\n       \n\n\n....\n}\nprivate class ButtonAction implements ActionListener{\n        public void actionPerformed(ActionEvent ev) {\n                             ................\n                             setUserInfo(user)//here user is not visible\n                }\n}\n\n\n}\n</code></pre>\n<pre><code>    \n    public class Main {\n\n    private JFrame mainFrame;\n    private LoginFrame loginFrame;\n    private JLabel mainFrameLabel=new JLabel(&quot;Sign In&quot;);\n    User user=null;\n\n    /**\n     * Launch the application.\n     */\n    public static void main(String[] args) {\n        EventQueue.invokeLater(new Runnable() {\n            public void run() {\n                try {\n                    Main window = new Main();\n                    window.mainFrame.setVisible(true);\n                } catch (Exception e) {\n                    e.printStackTrace();\n                }\n            }\n        });\n    }\n\n    /**\n     * Create the application.\n     */\n    public Main() {\n        initialize();\n    }\n\n    /**\n     * Initialize the contents of the frame.\n     */\n    private void initialize() {\n        \n        \n        \n        \n        LoginDialog loginDialog = new LoginDialog(user);\n        loginDialog.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);\n        loginDialog.setModal(true);\n        loginDialog.setVisible(true);\n        System.out.println(&quot;Stampo info studente:&quot;);\n        System.out.println(user);\n        loginDialog.dispose();\n        \n        if(user.getLoggedIn()) {\n            mainFrame = new JFrame(&quot;Main Frame&quot;);\n            mainFrame.setBounds(300, 300, 450, 300);\n            mainFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n            mainFrame.getContentPane().setLayout(null);\n            \n            JPanel mainPanel = new JPanel();\n            mainPanel.setBounds(10, 10, 426, 243);\n            mainFrame.getContentPane().add(mainPanel);\n            mainPanel.setLayout(null);\n            \n            \n            mainFrameLabel.setFont(new Font(&quot;Tahoma&quot;, Font.BOLD, 14));\n            mainFrameLabel.setBounds(70, 102, 252, 33);\n            mainPanel.add(mainFrameLabel);\n            \n            \n            mainFrame.addWindowListener(new WindowAdapter() {\n                public void windowClosed(WindowEvent we) {\n                    \n                    mainFrameLabel.setText(&quot;Sign In&quot;);\n                    \n                    user.setLoggedIn(false);\n                    user=null;\n                    System.exit(0);\n                }\n                  public void windowClosing(WindowEvent we) {\n                    \n                    mainFrameLabel.setText(&quot;Sign In&quot;);\n                    \n                    user.setLoggedIn(false);\n                    user=null;\n                    System.exit(0);\n                }\n                \n                \n            });\n        }\n}\n}\n</code></pre>\n<p>I get an error &quot;user cannot be resolved to a variable&quot; on setInfoUser(user).How can i solve it?\nAs you can see i have summerized.\nI have tried several things. But i haven't solved the problem.\nP.s.there are some other errors but i am not interested.</p>\n"},{"tags":["java","list","arraylist"],"comments":[{"score":0,"post_type":"question","creation_date":1700064137,"post_id":77489193,"comment_id":136609411,"body_markdown":"Does this answer your question? [Define a fixed-size list in Java](https://stackoverflow.com/questions/5207162/define-a-fixed-size-list-in-java)","link":"https://stackoverflow.com/questions/77489193/fixed-size-list#comment136609411_77489193","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/5207162/define-a-fixed-size-list-in-java\">Define a fixed-size list in Java</a>"},{"score":1,"post_type":"question","creation_date":1700064469,"post_id":77489193,"comment_id":136609473,"body_markdown":"The `List` interface has an `add` method, you will not get a compile-time error whatever you do. You may get an `UnsupportedOperationException` at runtime if you choose an implementation of `List` that left the method unimplemented.","link":"https://stackoverflow.com/questions/77489193/fixed-size-list#comment136609473_77489193","body":"The <code>List</code> interface has an <code>add</code> method, you will not get a compile-time error whatever you do. You may get an <code>UnsupportedOperationException</code> at runtime if you choose an implementation of <code>List</code> that left the method unimplemented."},{"score":0,"post_type":"question","creation_date":1700064905,"post_id":77489193,"comment_id":136609550,"body_markdown":"I think you&#39;re using the right code to create fixed size List. Maybe the issue is coming from the content you&#39;re trying to add into the List ? I suppose it can be null when you call : board.get[...].get[...]","link":"https://stackoverflow.com/questions/77489193/fixed-size-list#comment136609550_77489193","body":"I think you&#39;re using the right code to create fixed size List. Maybe the issue is coming from the content you&#39;re trying to add into the List ? I suppose it can be null when you call : board.get[...].get[...]"},{"score":0,"post_type":"question","creation_date":1700070702,"post_id":77489193,"comment_id":136610712,"body_markdown":"This is a great exercise, slightly more challenging than most.","link":"https://stackoverflow.com/questions/77489193/fixed-size-list#comment136610712_77489193","body":"This is a great exercise, slightly more challenging than most."}],"answers":[{"comment_count":0,"score":3,"last_activity_date":1701794693,"last_edit_date":1701794693,"creation_date":1700065164,"answer_id":77489350,"question_id":77489193,"body_markdown":"I think you dont need `java.util.List`. You can just use normal arrays!\r\n\r\n```java\r\npublic class Test {\r\n    SudokuField[][] board = new int[size_1][size_2];\r\n    \r\n    public void get() {\r\n        System.out.println(board[x][y]);\r\n    }\r\n    public void set() {\r\n        board[x][y] = value;\r\n    }\r\n}\r\n```\r\n***\r\nOr if you REALY need List you can do something like this:\r\n```java\r\nimport java.util.ArrayList;\r\n\r\npublic class Test {\r\n    public static void main(String[] args) {\r\n        ArrayList&lt;Object&gt; board = new ArrayList&lt;&gt;(){\r\n            @Override\r\n            public boolean add(Object o) {\r\n                if (super.size() + 1 &gt;= YOUR_SIZE) {\r\n                    return false; \r\n                }\r\n                return super.add(o);\r\n            }\r\n\r\n            @Override\r\n            public void add(int index, Object element) {\r\n                if (super.size() + 1 &gt;= YOUR_SIZE) {\r\n                    return false;\r\n                }\r\n                super.add(index, element);\r\n            }\r\n        };\r\n    }\r\n}\r\n```\r\n\r\nAnd it actually is in apchare commons library.\r\n&gt; The Apache Commons library provides the FixedSizeList class which does not support the add, remove and clear methods (but the set method is allowed because it does not modify the List&#39;s size). Ditto for FixedSizeList in Eclipse Collections. If you try to call one of these methods, your list remains the same size.\r\n\r\nhttps://stackoverflow.com/a/5968535/22257686","link":"https://stackoverflow.com/questions/77489193/fixed-size-list/77489350#77489350","title":"Fixed-size List","body":"<p>I think you dont need <code>java.util.List</code>. You can just use normal arrays!</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Test {\n    SudokuField[][] board = new int[size_1][size_2];\n    \n    public void get() {\n        System.out.println(board[x][y]);\n    }\n    public void set() {\n        board[x][y] = value;\n    }\n}\n</code></pre>\n<hr />\n<p>Or if you REALY need List you can do something like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.util.ArrayList;\n\npublic class Test {\n    public static void main(String[] args) {\n        ArrayList&lt;Object&gt; board = new ArrayList&lt;&gt;(){\n            @Override\n            public boolean add(Object o) {\n                if (super.size() + 1 &gt;= YOUR_SIZE) {\n                    return false; \n                }\n                return super.add(o);\n            }\n\n            @Override\n            public void add(int index, Object element) {\n                if (super.size() + 1 &gt;= YOUR_SIZE) {\n                    return false;\n                }\n                super.add(index, element);\n            }\n        };\n    }\n}\n</code></pre>\n<p>And it actually is in apchare commons library.</p>\n<blockquote>\n<p>The Apache Commons library provides the FixedSizeList class which does not support the add, remove and clear methods (but the set method is allowed because it does not modify the List's size). Ditto for FixedSizeList in Eclipse Collections. If you try to call one of these methods, your list remains the same size.</p>\n</blockquote>\n<p><a href=\"https://stackoverflow.com/a/5968535/22257686\">https://stackoverflow.com/a/5968535/22257686</a></p>\n"},{"comment_count":0,"score":0,"last_activity_date":1700070902,"last_edit_date":1700070902,"creation_date":1700070519,"answer_id":77489904,"question_id":77489193,"body_markdown":"&gt; _&quot;... How to create instances of List with fixed sizes ...&quot;_\r\n\r\nI don&#39;t believe there is anything within the _Java Framework_.\r\n\r\nHere is the _JavaDoc_ for the _Collections Framework_.\\\r\n_[The Collections Framework (Java SE 21 &amp;amp; JDK 21)](https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/doc-files/coll-index.html#the-collections-framework-heading)_.\r\n\r\nSimilar to _@Denis_&#39;s answer, just use an _array_, which are of a fixed-length, by default.\\\r\n_[Arrays (The Java&amp;trade; Tutorials &amp;gt; Learning the Java Language &amp;gt; Language Basics)](https://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)_.\r\n\r\n```java\r\nSudokuField[][] board = new SudokuField[9][9];\r\n```\r\n\r\nAlternately, encapsulate the _ArrayList_ class, checking the parameters for each _&quot;add&quot;_ method.\r\n\r\nHere is an example.\r\n\r\n```java\r\nclass SudokuFieldList extends ArrayList&lt;List&lt;SudokuField&gt;&gt; {\r\n    @Override\r\n    public boolean add(List&lt;SudokuField&gt; e) {\r\n        if (size() == 9 || e.size() &gt; 9)\r\n            throw new ListOutOfBoundsException();\r\n        return super.add(e);\r\n    }\r\n\r\n    @Override\r\n    public void add(int index, List&lt;SudokuField&gt; element) {\r\n        if (size() == 9 || index &gt;= 9 || element.size() &gt; 9)\r\n            throw new ListOutOfBoundsException();\r\n        super.add(index, element);\r\n    }\r\n\r\n    @Override\r\n    public boolean addAll(Collection&lt;? extends List&lt;SudokuField&gt;&gt; c) {\r\n        if (size() == 9 || c.size() &gt; 9)\r\n            throw new ListOutOfBoundsException();\r\n        return super.addAll(c);\r\n    }\r\n\r\n    @Override\r\n    public boolean addAll(int index, Collection&lt;? extends List&lt;SudokuField&gt;&gt; c) {\r\n        if (size() == 9 || index &gt;= 9 || c.size() &gt; 9)\r\n            throw new ListOutOfBoundsException();\r\n        return super.addAll(index, c);\r\n    }\r\n\r\n    static class ListOutOfBoundsException extends RuntimeException { }\r\n}\r\n```\r\n\r\nAnd, here is an example usage; intentionally erroring.\r\n\r\n```java\r\nSudokuFieldList l = new SudokuFieldList();\r\nfor (int i = 0; i &lt; 20; i++) l.add(List.of());\r\n```\r\n\r\n```none\r\nException in thread &quot;main&quot; Example$SudokuFieldList$ListOutOfBoundsException\r\n\tat Example$SudokuFieldList.add(Example.java:17)\r\n\tat Example.main(Example.java:10)\r\n```\r\n\r\nOn a final note, here is a _Wikipedia_ article on solving _Sudoku_ puzzles.\\\r\n_[Wikipedia &amp;ndash; Sudoku solving algorithms](https://en.wikipedia.org/wiki/Sudoku_solving_algorithms#Sudoku_brute_force)_.","link":"https://stackoverflow.com/questions/77489193/fixed-size-list/77489904#77489904","title":"Fixed-size List","body":"<blockquote>\n<p><em>&quot;... How to create instances of List with fixed sizes ...&quot;</em></p>\n</blockquote>\n<p>I don't believe there is anything within the <em>Java Framework</em>.</p>\n<p>Here is the <em>JavaDoc</em> for the <em>Collections Framework</em>.<br />\n<em><a href=\"https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/doc-files/coll-index.html#the-collections-framework-heading\" rel=\"nofollow noreferrer\">The Collections Framework (Java SE 21 &amp; JDK 21)</a></em>.</p>\n<p>Similar to <em>@Denis</em>'s answer, just use an <em>array</em>, which are of a fixed-length, by default.<br />\n<em><a href=\"https://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html\" rel=\"nofollow noreferrer\">Arrays (The Java™ Tutorials &gt; Learning the Java Language &gt; Language Basics)</a></em>.</p>\n<pre class=\"lang-java prettyprint-override\"><code>SudokuField[][] board = new SudokuField[9][9];\n</code></pre>\n<p>Alternately, encapsulate the <em>ArrayList</em> class, checking the parameters for each <em>&quot;add&quot;</em> method.</p>\n<p>Here is an example.</p>\n<pre class=\"lang-java prettyprint-override\"><code>class SudokuFieldList extends ArrayList&lt;List&lt;SudokuField&gt;&gt; {\n    @Override\n    public boolean add(List&lt;SudokuField&gt; e) {\n        if (size() == 9 || e.size() &gt; 9)\n            throw new ListOutOfBoundsException();\n        return super.add(e);\n    }\n\n    @Override\n    public void add(int index, List&lt;SudokuField&gt; element) {\n        if (size() == 9 || index &gt;= 9 || element.size() &gt; 9)\n            throw new ListOutOfBoundsException();\n        super.add(index, element);\n    }\n\n    @Override\n    public boolean addAll(Collection&lt;? extends List&lt;SudokuField&gt;&gt; c) {\n        if (size() == 9 || c.size() &gt; 9)\n            throw new ListOutOfBoundsException();\n        return super.addAll(c);\n    }\n\n    @Override\n    public boolean addAll(int index, Collection&lt;? extends List&lt;SudokuField&gt;&gt; c) {\n        if (size() == 9 || index &gt;= 9 || c.size() &gt; 9)\n            throw new ListOutOfBoundsException();\n        return super.addAll(index, c);\n    }\n\n    static class ListOutOfBoundsException extends RuntimeException { }\n}\n</code></pre>\n<p>And, here is an example usage; intentionally erroring.</p>\n<pre class=\"lang-java prettyprint-override\"><code>SudokuFieldList l = new SudokuFieldList();\nfor (int i = 0; i &lt; 20; i++) l.add(List.of());\n</code></pre>\n<pre class=\"lang-none prettyprint-override\"><code>Exception in thread &quot;main&quot; Example$SudokuFieldList$ListOutOfBoundsException\n    at Example$SudokuFieldList.add(Example.java:17)\n    at Example.main(Example.java:10)\n</code></pre>\n<p>On a final note, here is a <em>Wikipedia</em> article on solving <em>Sudoku</em> puzzles.<br />\n<em><a href=\"https://en.wikipedia.org/wiki/Sudoku_solving_algorithms#Sudoku_brute_force\" rel=\"nofollow noreferrer\">Wikipedia – Sudoku solving algorithms</a></em>.</p>\n"}],"comment_count":4,"is_answered":true,"view_count":73,"answer_count":2,"score":1,"last_activity_date":1701794693,"creation_date":1700063907,"last_edit_date":1700064181,"question_id":77489193,"body_markdown":"How to create instances of List with fixed sizes (it is not possible to perform add() operations on them, but it is possible to perform set())? When I try to change `fields.set(i, board.get(i).get(x));` into `fields.add(new SudokuField());` I do not get compiler errors in IntelliJ.\r\n\r\n```package org.sudoku;\r\n\r\nimport java.util.*;\r\n\r\npublic class SudokuBoard {\r\n\r\n    private final List&lt;List&lt;SudokuField&gt;&gt; board = new ArrayList&lt;&gt;();\r\n    private final SudokuSolver solver;\r\n    //private final List&lt;ComponentObserver&gt; observers = Arrays.asList(new ComponentObserver[3]);\r\n    private final ComponentObserver[] observers = new ComponentObserver[3];\r\n    private boolean state = true;\r\n\r\n    public SudokuBoard(SudokuSolver solver) {\r\n        this.solver = Objects.requireNonNull(solver);\r\n        for (int i = 0; i &lt; 9; i++) {\r\n            List&lt;SudokuField&gt; row = Arrays.asList(new SudokuField[9]);\r\n            for (int j = 0; j &lt; 9; j++) {\r\n                row.set(j, new SudokuField());\r\n            }\r\n            board.add(row);\r\n        }\r\n        for (int i = 0; i &lt; 3; i++) {\r\n            observers[i] = new ComponentObserver();\r\n        }\r\n    }\r\n\r\n    public void solveGame() {\r\n        solver.solve(this);\r\n    }\r\n\r\n    public boolean isSafe() {\r\n        return checkBoard();\r\n    }\r\n\r\n    public int get(int y, int x) {\r\n        return board.get(y).get(x).getFieldValue();\r\n    }\r\n\r\n    private  void setState() {\r\n        state = observers[0].getCorrectState();\r\n        state &amp;= observers[1].getCorrectState();\r\n        state &amp;= observers[2].getCorrectState();\r\n    }\r\n\r\n    private void update(int y, int x) {\r\n        observers[0].update(getRow(y));\r\n        observers[1].update(getColumn(x));\r\n        observers[2].update(getBox(y, x));\r\n    }\r\n\r\n    public void set(int y, int x, int value) {\r\n        board.get(y).get(x).setFieldValue(value);\r\n        update(y, x);\r\n        setState();\r\n    }\r\n\r\n    public SudokuRow getRow(int y) {\r\n        List&lt;SudokuField&gt; fields = Arrays.asList(new SudokuField[9]);\r\n        for (int i = 0; i &lt; 9; i++) {\r\n            fields.set(i, board.get(y).get(i));\r\n        }\r\n        return new SudokuRow(fields);\r\n    }\r\n\r\n    public SudokuColumn getColumn(int x) {\r\n        List&lt;SudokuField&gt; fields = Arrays.asList(new SudokuField[9]);\r\n        for (int i = 0; i &lt; 9; i++) {\r\n            fields.set(i, board.get(i).get(x));\r\n        }\r\n        return new SudokuColumn(fields);\r\n    }\r\n\r\n    public SudokuBox getBox(int y, int x) {\r\n        List&lt;SudokuField&gt; fields = Arrays.asList(new SudokuField[9]);\r\n        int row = y / 3 * 3;\r\n        int col = x / 3 * 3;\r\n        int index = 0;\r\n        for (int i = row; i &lt; row + 3; i++) {\r\n            for (int j = col; j &lt; col + 3; j++) {\r\n                fields.set(index, board.get(i).get(j));\r\n                index++;\r\n            }\r\n        }\r\n        return new SudokuBox(fields);\r\n    }\r\n\r\n    private boolean checkBoard() {\r\n        return state;\r\n    }\r\n}\r\n```\r\n","link":"https://stackoverflow.com/questions/77489193/fixed-size-list","title":"Fixed-size List","body":"<p>How to create instances of List with fixed sizes (it is not possible to perform add() operations on them, but it is possible to perform set())? When I try to change <code>fields.set(i, board.get(i).get(x));</code> into <code>fields.add(new SudokuField());</code> I do not get compiler errors in IntelliJ.</p>\n<pre><code>\nimport java.util.*;\n\npublic class SudokuBoard {\n\n    private final List&lt;List&lt;SudokuField&gt;&gt; board = new ArrayList&lt;&gt;();\n    private final SudokuSolver solver;\n    //private final List&lt;ComponentObserver&gt; observers = Arrays.asList(new ComponentObserver[3]);\n    private final ComponentObserver[] observers = new ComponentObserver[3];\n    private boolean state = true;\n\n    public SudokuBoard(SudokuSolver solver) {\n        this.solver = Objects.requireNonNull(solver);\n        for (int i = 0; i &lt; 9; i++) {\n            List&lt;SudokuField&gt; row = Arrays.asList(new SudokuField[9]);\n            for (int j = 0; j &lt; 9; j++) {\n                row.set(j, new SudokuField());\n            }\n            board.add(row);\n        }\n        for (int i = 0; i &lt; 3; i++) {\n            observers[i] = new ComponentObserver();\n        }\n    }\n\n    public void solveGame() {\n        solver.solve(this);\n    }\n\n    public boolean isSafe() {\n        return checkBoard();\n    }\n\n    public int get(int y, int x) {\n        return board.get(y).get(x).getFieldValue();\n    }\n\n    private  void setState() {\n        state = observers[0].getCorrectState();\n        state &amp;= observers[1].getCorrectState();\n        state &amp;= observers[2].getCorrectState();\n    }\n\n    private void update(int y, int x) {\n        observers[0].update(getRow(y));\n        observers[1].update(getColumn(x));\n        observers[2].update(getBox(y, x));\n    }\n\n    public void set(int y, int x, int value) {\n        board.get(y).get(x).setFieldValue(value);\n        update(y, x);\n        setState();\n    }\n\n    public SudokuRow getRow(int y) {\n        List&lt;SudokuField&gt; fields = Arrays.asList(new SudokuField[9]);\n        for (int i = 0; i &lt; 9; i++) {\n            fields.set(i, board.get(y).get(i));\n        }\n        return new SudokuRow(fields);\n    }\n\n    public SudokuColumn getColumn(int x) {\n        List&lt;SudokuField&gt; fields = Arrays.asList(new SudokuField[9]);\n        for (int i = 0; i &lt; 9; i++) {\n            fields.set(i, board.get(i).get(x));\n        }\n        return new SudokuColumn(fields);\n    }\n\n    public SudokuBox getBox(int y, int x) {\n        List&lt;SudokuField&gt; fields = Arrays.asList(new SudokuField[9]);\n        int row = y / 3 * 3;\n        int col = x / 3 * 3;\n        int index = 0;\n        for (int i = row; i &lt; row + 3; i++) {\n            for (int j = col; j &lt; col + 3; j++) {\n                fields.set(index, board.get(i).get(j));\n                index++;\n            }\n        }\n        return new SudokuBox(fields);\n    }\n\n    private boolean checkBoard() {\n        return state;\n    }\n}\n</code></pre>\n"},{"tags":["java","spring-boot","swagger","spring-rest","openapi-generator"],"comments":[{"score":0,"post_type":"question","creation_date":1690980690,"post_id":76765012,"comment_id":135428182,"body_markdown":"You can try to publish an API-JAR for the generated code in one project and consume it in the other.","link":"https://stackoverflow.com/questions/76765012/how-share-pojos-created-by-openapi-generator-in-spring-boot-across-micro-service#comment135428182_76765012","body":"You can try to publish an API-JAR for the generated code in one project and consume it in the other."},{"score":0,"post_type":"question","creation_date":1690983078,"post_id":76765012,"comment_id":135428813,"body_markdown":"@cyberbrain We already have a Jar published, but we also want the models in jar to be referenced to yaml, else we have to create a schema with same fields for request and response in the micro-service. If we could have some thing like\ncreditCard:\n   jarPath: &quot;foo-service.jar:CreditCardModel.java&quot;","link":"https://stackoverflow.com/questions/76765012/how-share-pojos-created-by-openapi-generator-in-spring-boot-across-micro-service#comment135428813_76765012","body":"@cyberbrain We already have a Jar published, but we also want the models in jar to be referenced to yaml, else we have to create a schema with same fields for request and response in the micro-service. If we could have some thing like creditCard:    jarPath: &quot;foo-service.jar:CreditCardModel.java&quot;"}],"answers":[{"comment_count":0,"score":0,"last_activity_date":1701793773,"creation_date":1701793773,"answer_id":77607795,"question_id":76765012,"body_markdown":"You can accomplish this with `schemaMappings` \r\n\r\nStep 1: Add `Foo` as dependency in `Bar`\r\n\r\nStep 2: Add \r\n```\r\nschemaMappings = [&quot;FooPojo&quot;: &quot;com.foo.pojo.FooPojo&quot;]\r\n```\r\nto your openApi generator config.\r\n\r\nStep 3:\r\nCreate an empty schema in your yaml file with the same name\r\n```\r\nFooPojo:\r\n   type: object\r\n```\r\n\r\nStep 4:\r\n\r\nReference it in `Bar`\r\n```\r\nBarPojo:\r\n   type: object\r\n   properties:\r\n      fooPojo:\r\n        $ref: &#39;#/components/schemas/FooPojo&#39;\r\n```","link":"https://stackoverflow.com/questions/76765012/how-share-pojos-created-by-openapi-generator-in-spring-boot-across-micro-service/77607795#77607795","title":"How share POJOs created by OpenAPI Generator in spring boot across micro-services?","body":"<p>You can accomplish this with <code>schemaMappings</code></p>\n<p>Step 1: Add <code>Foo</code> as dependency in <code>Bar</code></p>\n<p>Step 2: Add</p>\n<pre><code>schemaMappings = [&quot;FooPojo&quot;: &quot;com.foo.pojo.FooPojo&quot;]\n</code></pre>\n<p>to your openApi generator config.</p>\n<p>Step 3:\nCreate an empty schema in your yaml file with the same name</p>\n<pre><code>FooPojo:\n   type: object\n</code></pre>\n<p>Step 4:</p>\n<p>Reference it in <code>Bar</code></p>\n<pre><code>BarPojo:\n   type: object\n   properties:\n      fooPojo:\n        $ref: '#/components/schemas/FooPojo'\n</code></pre>\n"}],"comment_count":2,"is_answered":false,"view_count":89,"answer_count":1,"score":0,"last_activity_date":1701793773,"creation_date":1690304662,"last_edit_date":1690980166,"question_id":76765012,"body_markdown":"Suppose I have 2 micro-services `Foo` and `Bar` and generate the POJOs using `gradle openApigenerate\r\n` everything specified in yaml file.\r\n\r\nThe openAPI generator generates POJOs as follows:\r\n\r\n```\r\nFoo:\r\nfooPojo1\r\nfooPojo2\r\nAccessible only to micro-service Foo\r\n```\r\n\r\n\r\n```\r\nBar:\r\nbarPojo1\r\nbarPojo2\r\nAccessible only to micro-service Bar\r\n```\r\nAlso I&#39;m sharing models across both micro-service. So `barPojo1` and `barPojo2` is available in Foo and `fooPojo1` and `fooPojo2` is available in Bar.\r\n\r\nHowever, if I want to use `fooPojo1` as a schema in `Bar` I need to re-declare `fooPojo1` in Bar micro-service which looks like:\r\n```\r\nBar:\r\nbarPojo1\r\nbarPojo2\r\nfooPojo1\r\n```\r\n\r\nSo is there anyway I don&#39;t have to create repetitive objects and just reference the existing object from imported library something like:\r\n```\r\nBar:\r\nbarPojo1\r\nbarPojo2\r\n$ref: foo-service.fooPojo1\r\n```\r\nI need a solution for this because whenever I use `fooPojo1` in Bar service I need to map the `fooPojo1` of Bar service to `fooPojo1` of Foo service and vice-versa for internal comms.\r\n\r\nI tried finding solution in OpenApi docs, stackoverflow and various other places, but not information. Not sure of referencing to external library works.","link":"https://stackoverflow.com/questions/76765012/how-share-pojos-created-by-openapi-generator-in-spring-boot-across-micro-service","title":"How share POJOs created by OpenAPI Generator in spring boot across micro-services?","body":"<p>Suppose I have 2 micro-services <code>Foo</code> and <code>Bar</code> and generate the POJOs using <code>gradle openApigenerate </code> everything specified in yaml file.</p>\n<p>The openAPI generator generates POJOs as follows:</p>\n<pre><code>Foo:\nfooPojo1\nfooPojo2\nAccessible only to micro-service Foo\n</code></pre>\n<pre><code>Bar:\nbarPojo1\nbarPojo2\nAccessible only to micro-service Bar\n</code></pre>\n<p>Also I'm sharing models across both micro-service. So <code>barPojo1</code> and <code>barPojo2</code> is available in Foo and <code>fooPojo1</code> and <code>fooPojo2</code> is available in Bar.</p>\n<p>However, if I want to use <code>fooPojo1</code> as a schema in <code>Bar</code> I need to re-declare <code>fooPojo1</code> in Bar micro-service which looks like:</p>\n<pre><code>Bar:\nbarPojo1\nbarPojo2\nfooPojo1\n</code></pre>\n<p>So is there anyway I don't have to create repetitive objects and just reference the existing object from imported library something like:</p>\n<pre><code>Bar:\nbarPojo1\nbarPojo2\n$ref: foo-service.fooPojo1\n</code></pre>\n<p>I need a solution for this because whenever I use <code>fooPojo1</code> in Bar service I need to map the <code>fooPojo1</code> of Bar service to <code>fooPojo1</code> of Foo service and vice-versa for internal comms.</p>\n<p>I tried finding solution in OpenApi docs, stackoverflow and various other places, but not information. Not sure of referencing to external library works.</p>\n"},{"tags":["java","google-cloud-platform","google-app-engine","google-cloud-storage","gcs"],"comments":[{"score":0,"post_type":"question","creation_date":1701350795,"post_id":77578549,"comment_id":136766501,"body_markdown":"I&#39;m not a Java expert, but regarding GCP, an effective approach for handling GCS writing is to enumerate all the files that need to be transferred to GCS in a Pub/Sub queue. Then, utilize a Cloud Run Job (not a service) to process each file, limiting the job to `x` number of workers.","link":"https://stackoverflow.com/questions/77578549/uploading-files-to-gcs-using-multithread-keeps-running#comment136766501_77578549","body":"I&#39;m not a Java expert, but regarding GCP, an effective approach for handling GCS writing is to enumerate all the files that need to be transferred to GCS in a Pub/Sub queue. Then, utilize a Cloud Run Job (not a service) to process each file, limiting the job to <code>x</code> number of workers."},{"score":0,"post_type":"question","creation_date":1701353301,"post_id":77578549,"comment_id":136767002,"body_markdown":"Why don&#39;t you create your storage service in a singleton? a config.getStorageService() could solve your issue.","link":"https://stackoverflow.com/questions/77578549/uploading-files-to-gcs-using-multithread-keeps-running#comment136767002_77578549","body":"Why don&#39;t you create your storage service in a singleton? a config.getStorageService() could solve your issue."},{"score":1,"post_type":"question","creation_date":1701367803,"post_id":77578549,"comment_id":136769893,"body_markdown":"There is a limit to how many HTTP egress data streams are useful. That number is around 4 egress data transfer connections to the Internet. Trying to do a large number of parallel object uploads will actually slow you down and as you found, crash your application. Transfer one object at a time and go have dinner.","link":"https://stackoverflow.com/questions/77578549/uploading-files-to-gcs-using-multithread-keeps-running#comment136769893_77578549","body":"There is a limit to how many HTTP egress data streams are useful. That number is around 4 egress data transfer connections to the Internet. Trying to do a large number of parallel object uploads will actually slow you down and as you found, crash your application. Transfer one object at a time and go have dinner."},{"score":0,"post_type":"question","creation_date":1701429583,"post_id":77578549,"comment_id":136777365,"body_markdown":"@guillaumeblaquiere We tried the singleton approach, but that dint help us either :(","link":"https://stackoverflow.com/questions/77578549/uploading-files-to-gcs-using-multithread-keeps-running#comment136777365_77578549","body":"@guillaumeblaquiere We tried the singleton approach, but that dint help us either :("}],"answers":[{"comment_count":0,"score":1,"last_activity_date":1701793195,"creation_date":1701793195,"answer_id":77607722,"question_id":77578549,"body_markdown":"Posting this as a community for the benefits of others \r\n\r\n&lt;hr&gt;\r\n\r\nAs mentioned by @John Hanley:\r\n\r\n&gt; There is a limit to how many HTTP egress data streams are useful. That number is around 4 egress data transfer connections to the Internet. Trying to do a large number of parallel object uploads will actually slow you down and as you found, crash your application. Transfer one object at a time and go have dinner.","link":"https://stackoverflow.com/questions/77578549/uploading-files-to-gcs-using-multithread-keeps-running/77607722#77607722","title":"Uploading files to GCS using Multithread keeps running","body":"<p>Posting this as a community for the benefits of others</p>\n<hr>\n<p>As mentioned by @John Hanley:</p>\n<blockquote>\n<p>There is a limit to how many HTTP egress data streams are useful. That number is around 4 egress data transfer connections to the Internet. Trying to do a large number of parallel object uploads will actually slow you down and as you found, crash your application. Transfer one object at a time and go have dinner.</p>\n</blockquote>\n"}],"comment_count":4,"is_answered":true,"view_count":62,"answer_count":1,"score":0,"last_activity_date":1701793195,"creation_date":1701348350,"question_id":77578549,"body_markdown":"Am trying to upload 36k+ CSV files to GCS from a java application.\r\nThis application is hosted as an appengine in the same GCP.\r\n\r\nAs the number of files are more, am using parallelStream.foreach in java to upload the files.\r\n\r\n```\r\nvoid createFiles()\r\n    {\r\n        try {\r\n            Map&lt;Integer, FileDetail&gt; collection = GetFiles();\r\n            collection.getValue().entrySet().parallelStream().forEach((entry) -&gt; {\r\n                try{\r\n                    createFileInGCS();\r\n                } catch (Exception e) {\r\n                    LOG.error(&quot;Error occurred while creating FilesInGCS : &quot; + e.getMessage());\r\n                    throw new RuntimeException(e);\r\n                }\r\n            });\r\n        }\r\n        catch (Exception e) {\r\n            LOG.error(&quot;Error occurred while creating files : &quot;+ e.getMessage());\r\n            throw new CustomException(&quot;Unable to process files&quot;);\r\n        }\r\n    }\r\n\r\n\r\n    public void createFileInGCS()\r\n    {\r\n        try {\r\n            String fileName =&quot;file_&quot; + fileId + &quot;.csv&quot;;\r\n            String gcsBucket = config.getGcsBucket();\r\n            var blobId = BlobId.of(gcsBucket, fileName);\r\n            var blobInfo = BlobInfo.newBuilder(blobId).setContentType(&quot;text/plain&quot;).build();\r\n            var storage = StorageOptions.newBuilder().setProjectId(config.getProject())\r\n                    .build().getService();\r\n            storage.create(blobInfo, csvContent.getBytes());\r\n        }\r\n        catch(Exception e){\r\n            LOG.error(&quot;Storage failed with exception :&quot;+e.getMessage());\r\n        }\r\n    }\r\n```\r\n\r\nThe application is failing, as the number of files(based on external factor) to be stored has increased recently.The whole process of storing runs for  Following are the logs of appengine\r\n\r\n**ERROR: onFailure exception: com.google.cloud.logging.LoggingException: io.grpc.StatusRuntimeException: INTERNAL: Panic! This is a bug!**\r\n\r\n**Storage successful for fileId 46010**\r\n\r\n**ERROR: onFailure exception: com.google.cloud.logging.LoggingException: io.grpc.StatusRuntimeException: INTERNAL: Panic! This is a bug!**\r\n\r\n**Storage successful for fileId 46192**\r\n\r\nNote : **ERROR: onFailure exception: com.google.cloud.logging.LoggingException: io.grpc.StatusRuntimeException: INTERNAL: Panic! This is a bug!** - This log is observed from the time the appengine start to act on the request\r\n\r\nThese logs are observed for a while and then we start to receive \r\n\r\n**Storage failed with exception :Broken pipe**\r\n\r\n**Storage failed with exception :Remote host terminated the handshake**\r\n\r\nLater which the application stops\r\n\r\nI also tried batching the collection into 10 equal parts, but the strange behaviour is every batch (~3k files) is completing in 4mins except for the last batch, which keeps running for more than an hour and fails with the same error logs.\r\n\r\n**Storage failed with exception :Broken pipe**\r\n\r\n**Storage failed with exception :Remote host terminated the handshake**\r\n\r\nCan someone helps us on, is there a better way to bulk upload these files to GCS. Tried StorageBatch from GCS, but it doesnt have a create option.","link":"https://stackoverflow.com/questions/77578549/uploading-files-to-gcs-using-multithread-keeps-running","title":"Uploading files to GCS using Multithread keeps running","body":"<p>Am trying to upload 36k+ CSV files to GCS from a java application.\nThis application is hosted as an appengine in the same GCP.</p>\n<p>As the number of files are more, am using parallelStream.foreach in java to upload the files.</p>\n<pre><code>void createFiles()\n    {\n        try {\n            Map&lt;Integer, FileDetail&gt; collection = GetFiles();\n            collection.getValue().entrySet().parallelStream().forEach((entry) -&gt; {\n                try{\n                    createFileInGCS();\n                } catch (Exception e) {\n                    LOG.error(&quot;Error occurred while creating FilesInGCS : &quot; + e.getMessage());\n                    throw new RuntimeException(e);\n                }\n            });\n        }\n        catch (Exception e) {\n            LOG.error(&quot;Error occurred while creating files : &quot;+ e.getMessage());\n            throw new CustomException(&quot;Unable to process files&quot;);\n        }\n    }\n\n\n    public void createFileInGCS()\n    {\n        try {\n            String fileName =&quot;file_&quot; + fileId + &quot;.csv&quot;;\n            String gcsBucket = config.getGcsBucket();\n            var blobId = BlobId.of(gcsBucket, fileName);\n            var blobInfo = BlobInfo.newBuilder(blobId).setContentType(&quot;text/plain&quot;).build();\n            var storage = StorageOptions.newBuilder().setProjectId(config.getProject())\n                    .build().getService();\n            storage.create(blobInfo, csvContent.getBytes());\n        }\n        catch(Exception e){\n            LOG.error(&quot;Storage failed with exception :&quot;+e.getMessage());\n        }\n    }\n</code></pre>\n<p>The application is failing, as the number of files(based on external factor) to be stored has increased recently.The whole process of storing runs for  Following are the logs of appengine</p>\n<p><strong>ERROR: onFailure exception: com.google.cloud.logging.LoggingException: io.grpc.StatusRuntimeException: INTERNAL: Panic! This is a bug!</strong></p>\n<p><strong>Storage successful for fileId 46010</strong></p>\n<p><strong>ERROR: onFailure exception: com.google.cloud.logging.LoggingException: io.grpc.StatusRuntimeException: INTERNAL: Panic! This is a bug!</strong></p>\n<p><strong>Storage successful for fileId 46192</strong></p>\n<p>Note : <strong>ERROR: onFailure exception: com.google.cloud.logging.LoggingException: io.grpc.StatusRuntimeException: INTERNAL: Panic! This is a bug!</strong> - This log is observed from the time the appengine start to act on the request</p>\n<p>These logs are observed for a while and then we start to receive</p>\n<p><strong>Storage failed with exception :Broken pipe</strong></p>\n<p><strong>Storage failed with exception :Remote host terminated the handshake</strong></p>\n<p>Later which the application stops</p>\n<p>I also tried batching the collection into 10 equal parts, but the strange behaviour is every batch (~3k files) is completing in 4mins except for the last batch, which keeps running for more than an hour and fails with the same error logs.</p>\n<p><strong>Storage failed with exception :Broken pipe</strong></p>\n<p><strong>Storage failed with exception :Remote host terminated the handshake</strong></p>\n<p>Can someone helps us on, is there a better way to bulk upload these files to GCS. Tried StorageBatch from GCS, but it doesnt have a create option.</p>\n"},{"tags":["java","sorting"],"answers":[{"comment_count":0,"score":0,"last_activity_date":1698127082,"last_edit_date":1698127082,"creation_date":1698126236,"answer_id":77349755,"question_id":77349724,"body_markdown":"Sorting the array first was a good idea. And since you are now working on a sorted array, you only need one loop. Pick a number from index `i` and if number of elements after `i` equals value in `i`, then return `1`. You also need to check if there are identical values in the array, since the rule was &quot;number of integers *greater than* p in the array equals p&quot;. Remember that integers can also be negative or zero.\r\n\r\n    Arrays.sort(a);\r\n\r\n    // If the last value is zero we can stop immediately. This helps\r\n    // remove one array length check from the next loop.\r\n    if (a[a.length - 1] == 0) {\r\n        return 1;\r\n    }\r\n\r\n    // Loop until next-to-last. The last element was checked\r\n    // above.\r\n    for (int i = 0; i &lt; a.length - 1; i++) {\r\n        final int p = a[i];\r\n\r\n        // Ignore value if the next one is not greater.\r\n        if (p == a[i + 1]) {\r\n            continue;\r\n        }\r\n\r\n        if (p == (a.length - i - 1)) {\r\n            return 1;\r\n        }\r\n    }\r\n\r\nFor future reference, it would be helpful in debugging to add the failing test cases. But it didn&#39;t matter here because rewriting your algorithm was easier.","link":"https://stackoverflow.com/questions/77349724/noble-integers-java/77349755#77349755","title":"Noble Integers (Java)","body":"<p>Sorting the array first was a good idea. And since you are now working on a sorted array, you only need one loop. Pick a number from index <code>i</code> and if number of elements after <code>i</code> equals value in <code>i</code>, then return <code>1</code>. You also need to check if there are identical values in the array, since the rule was &quot;number of integers <em>greater than</em> p in the array equals p&quot;. Remember that integers can also be negative or zero.</p>\n<pre><code>Arrays.sort(a);\n\n// If the last value is zero we can stop immediately. This helps\n// remove one array length check from the next loop.\nif (a[a.length - 1] == 0) {\n    return 1;\n}\n\n// Loop until next-to-last. The last element was checked\n// above.\nfor (int i = 0; i &lt; a.length - 1; i++) {\n    final int p = a[i];\n\n    // Ignore value if the next one is not greater.\n    if (p == a[i + 1]) {\n        continue;\n    }\n\n    if (p == (a.length - i - 1)) {\n        return 1;\n    }\n}\n</code></pre>\n<p>For future reference, it would be helpful in debugging to add the failing test cases. But it didn't matter here because rewriting your algorithm was easier.</p>\n"},{"comments":[{"score":0,"post_type":"answer","creation_date":1698128126,"post_id":77349837,"comment_id":136362333,"body_markdown":"Why didn&#39;t I think about reversing the sort order, that makes it so much simpler! Anyway, if you check that the first value is not zero before entering the loop, you can start from 1 and simplify the test inside the loop.","link":"https://stackoverflow.com/questions/77349724/noble-integers-java/77349837#comment136362333_77349837","body":"Why didn&#39;t I think about reversing the sort order, that makes it so much simpler! Anyway, if you check that the first value is not zero before entering the loop, you can start from 1 and simplify the test inside the loop."}],"comment_count":1,"score":1,"last_activity_date":1698127894,"last_edit_date":1698127894,"creation_date":1698127542,"answer_id":77349837,"question_id":77349724,"body_markdown":"If you sort your array in descending order, the index of an element basically tell you there are n-element that is either larger or equals to that element.\r\n\r\ne.g.\r\n```\r\nindex:  0    1    2    3    4    5    6\r\nvalue: 11    9    6    6    6    5    2\r\n```\r\n\r\nindex 0, the value is 11 and there is 0 value that is larger/equals to 11.\r\nindex 5, the value is 5 and there is 5 value that are larger/equals to 5.\r\n\r\nThe tricky part are the duplicated values: index 2,3,4 are all 6, and only the first one (index 2) is telling you that 2 elements are greater than it.\r\n\r\n\r\nSo it is basically sorting the array in descending order, find any index that is the same as the value in array, and make sure that value is the first one in duplicated sequence:\r\n\r\n```\r\nsort array in desc order\r\n\r\nfor (int i = 0; i &lt; array.length; ++i) {\r\n    if (array[i] == i &amp;&amp; (i == 0 || array[i-1] != array[i]) {\r\n        return true;\r\n    }\r\n}\r\nreturn false\r\n```","link":"https://stackoverflow.com/questions/77349724/noble-integers-java/77349837#77349837","title":"Noble Integers (Java)","body":"<p>If you sort your array in descending order, the index of an element basically tell you there are n-element that is either larger or equals to that element.</p>\n<p>e.g.</p>\n<pre><code>index:  0    1    2    3    4    5    6\nvalue: 11    9    6    6    6    5    2\n</code></pre>\n<p>index 0, the value is 11 and there is 0 value that is larger/equals to 11.\nindex 5, the value is 5 and there is 5 value that are larger/equals to 5.</p>\n<p>The tricky part are the duplicated values: index 2,3,4 are all 6, and only the first one (index 2) is telling you that 2 elements are greater than it.</p>\n<p>So it is basically sorting the array in descending order, find any index that is the same as the value in array, and make sure that value is the first one in duplicated sequence:</p>\n<pre><code>sort array in desc order\n\nfor (int i = 0; i &lt; array.length; ++i) {\n    if (array[i] == i &amp;&amp; (i == 0 || array[i-1] != array[i]) {\n        return true;\n    }\n}\nreturn false\n</code></pre>\n"},{"comment_count":0,"score":0,"last_activity_date":1701793038,"last_edit_date":1701793038,"creation_date":1701789773,"answer_id":77607333,"question_id":77349724,"body_markdown":"- first, handle the special cases of empty or null array. Then check for the special case of `[0]` to avoid needless repetitive logic within the main loop.\r\n- sort the array.\r\n- then iterate across the array until you find a value that equals the number left to iterate while making certain that the numbers ahead of it are not equal to the found solution.\r\n\r\nNote that it is not required to iterate across the entire array. If the the current value is greater than the amount of numbers remaining, then no solution can exist so the loop is terminated.\r\n```\r\npublic static int solve(int[] arr) {\r\n    if (arr == null || arr.length == 0) {\r\n        return -1;\r\n    }\r\n    if (arr[arr.length-1] == 0) { \r\n        return 1;\r\n    }\r\n    Arrays.sort(arr);\r\n    for (int i = 0; arr[i] &lt; arr.length-i; i++) {\r\n        if (arr[i] == arr.length - i - 1 &amp;&amp; arr[i] != arr[i+1]) {\r\n            return 1;\r\n        }\r\n    }\r\n    return -1;\r\n}\r\n}","link":"https://stackoverflow.com/questions/77349724/noble-integers-java/77607333#77607333","title":"Noble Integers (Java)","body":"<ul>\n<li>first, handle the special cases of empty or null array. Then check for the special case of <code>[0]</code> to avoid needless repetitive logic within the main loop.</li>\n<li>sort the array.</li>\n<li>then iterate across the array until you find a value that equals the number left to iterate while making certain that the numbers ahead of it are not equal to the found solution.</li>\n</ul>\n<p>Note that it is not required to iterate across the entire array. If the the current value is greater than the amount of numbers remaining, then no solution can exist so the loop is terminated.</p>\n<pre><code>public static int solve(int[] arr) {\n    if (arr == null || arr.length == 0) {\n        return -1;\n    }\n    if (arr[arr.length-1] == 0) { \n        return 1;\n    }\n    Arrays.sort(arr);\n    for (int i = 0; arr[i] &lt; arr.length-i; i++) {\n        if (arr[i] == arr.length - i - 1 &amp;&amp; arr[i] != arr[i+1]) {\n            return 1;\n        }\n    }\n    return -1;\n}\n}\n</code></pre>\n"}],"comment_count":0,"is_answered":true,"view_count":63,"answer_count":3,"score":-1,"last_activity_date":1701793038,"creation_date":1698125717,"question_id":77349724,"body_markdown":"Given an integer array A, find if an integer p exists in the array such that the number of integers greater than p in the array equals p.Return 1 if any such integer p is present else, return -1.\r\n\r\ni tried this but this only passed some test cases..\r\n\r\n\r\n\r\n\r\n```\r\npublic class Solution {\r\n    public int solve(int[] A) {\r\n        Arrays.sort(A);\r\n        int [] newarr = new int [A.length];\r\n        for (int i = A.length -1 ; i &gt;=0 ; i--){\r\n            newarr[A.length-1-i]=A[i];\r\n        }\r\n        for (int i = 0 ; i &lt; A.length ; i++){\r\n            if (newarr[i]==i){\r\n                return 1;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n}\r\n\r\n```\r\n","link":"https://stackoverflow.com/questions/77349724/noble-integers-java","title":"Noble Integers (Java)","body":"<p>Given an integer array A, find if an integer p exists in the array such that the number of integers greater than p in the array equals p.Return 1 if any such integer p is present else, return -1.</p>\n<p>i tried this but this only passed some test cases..</p>\n<pre><code>public class Solution {\n    public int solve(int[] A) {\n        Arrays.sort(A);\n        int [] newarr = new int [A.length];\n        for (int i = A.length -1 ; i &gt;=0 ; i--){\n            newarr[A.length-1-i]=A[i];\n        }\n        for (int i = 0 ; i &lt; A.length ; i++){\n            if (newarr[i]==i){\n                return 1;\n            }\n        }\n        return -1;\n    }\n}\n\n</code></pre>\n"},{"tags":["java","geometry","esri"],"comments":[{"score":0,"post_type":"question","creation_date":1686885518,"post_id":76485896,"comment_id":134862825,"body_markdown":"You are not using the API and it&#39;s library contains it, https://pro.arcgis.com/en/pro-app/latest/sdk/api-reference/topic8275.html","link":"https://stackoverflow.com/questions/76485896/geometryengine-project-method-of-esri-geometry-api-for-java-not-working#comment134862825_76485896","body":"You are not using the API and it&#39;s library contains it, <a href=\"https://pro.arcgis.com/en/pro-app/latest/sdk/api-reference/topic8275.html\" rel=\"nofollow noreferrer\">pro.arcgis.com/en/pro-app/latest/sdk/api-reference/&hellip;</a>"},{"score":0,"post_type":"question","creation_date":1686885694,"post_id":76485896,"comment_id":134862833,"body_markdown":"Note: with api&#39;s use documentation &quot;index&quot; link at the top of the javadoc page and press ctrl + F for find on page and enter the method or class name then click your way through to find if it exists.","link":"https://stackoverflow.com/questions/76485896/geometryengine-project-method-of-esri-geometry-api-for-java-not-working#comment134862833_76485896","body":"Note: with api&#39;s use documentation &quot;index&quot; link at the top of the javadoc page and press ctrl + F for find on page and enter the method or class name then click your way through to find if it exists."}],"answers":[{"comment_count":0,"score":0,"last_activity_date":1701792488,"last_edit_date":1701792488,"creation_date":1701732707,"answer_id":77603088,"question_id":76485896,"body_markdown":"The Project method only takes two parameters: the geometry and the desired spatial reference.  The original spatial reference is stored on the original geometry.  I suspect the examples you are looking at are old and the three parameter version has been deprecated.\r\n\r\nI would also use an Equal-area projection system like Albers (https://en.wikipedia.org/wiki/Equal-area_projection) rather then Web Mercator.  Web Mercator is designed to preserve compass bearings, and it will wildly distort areas the farther away you get from the equator.  It&#39;s really not suitable for anything other than driving directions.","link":"https://stackoverflow.com/questions/76485896/geometryengine-project-method-of-esri-geometry-api-for-java-not-working/77603088#77603088","title":"GeometryEngine.project() method of Esri Geometry API for Java not working","body":"<p>The Project method only takes two parameters: the geometry and the desired spatial reference.  The original spatial reference is stored on the original geometry.  I suspect the examples you are looking at are old and the three parameter version has been deprecated.</p>\n<p>I would also use an Equal-area projection system like Albers (<a href=\"https://en.wikipedia.org/wiki/Equal-area_projection\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Equal-area_projection</a>) rather then Web Mercator.  Web Mercator is designed to preserve compass bearings, and it will wildly distort areas the farther away you get from the equator.  It's really not suitable for anything other than driving directions.</p>\n"}],"comment_count":2,"is_answered":false,"view_count":72,"answer_count":1,"score":0,"last_activity_date":1701792488,"creation_date":1686868462,"question_id":76485896,"body_markdown":"I am trying to calculate the 2D area of a polygon created from vertices defined by latitude and longitude coordinates using the following dependencies:\r\n\r\n```java\r\nimport com.esri.core.geometry.Geometry;\r\nimport com.esri.core.geometry.GeometryEngine;\r\nimport com.esri.core.geometry.Point;\r\nimport com.esri.core.geometry.Polygon;\r\nimport com.esri.core.geometry.SpatialReference;\r\n```\r\n\r\nI have initialized the vertices using latitude and longitude coordinates and assuming that they are in the wgs84 spatial reference system. In the [documentation](https://esri.github.io/geometry-api-java/javadoc/com/esri/core/geometry/Point.html), it is also stated that &quot;In case of Geographic Coordinate Systems, the X coordinate is the longitude and the Y is the latitude.&quot; \r\n\r\n```java\r\nSpatialReference wgs84 = SpatialReference.create(4326);\r\n\r\nPoint kassel = new Point(9.49, 51.29);\r\nPoint bamberg = new Point (10.90, 49.88);\r\nPoint gotha = new Point(10.70,50.93);\r\n```\r\n\r\nNow the polygon is formed without any problems:\r\n\r\n```java\r\nPolygon polygon = new Polygon();\r\npolygon.startPath(kassel);\r\npolygon.lineTo(bamberg);\r\npolygon.lineTo(gotha);\r\npolygon.closePathWithLine();\r\n```\r\n\r\nIf I use the method `polygon.calculateArea2D()`, then the result is negative. It is [explained](https://esri.github.io/geometry-api-java/javadoc/com/esri/core/geometry/MultiPath.html#calculateArea2D--) that &quot;If the spatial reference is a Geographic Coordinate System (WGS84) then the 2D area calculation is defined in angular units.&quot;\r\n\r\nAfter some research, it seems to me that the polygon should be projected to another spatial reference system (Web Mercator), so that the measurement can be done in proper units (meters and square meters):\r\n\r\n```java\r\nSpatialReference webMercator= SpatialReference.create(3857);\r\nPolygon newPolygon = GeometryEngine.project(polygon,wgs84,webMercator);\r\n```\r\n\r\nHowever, I receive an error that the method is not found. I have seen several examples use this method to project a geometry from one spatial reference system to another. I also could not find this method in the [documentation](https://esri.github.io/geometry-api-java/javadoc/com/esri/core/geometry/GeometryEngine.html) of the `GeometryEngine` class. Does anyone have any ideas what went wrong here? Your help would be much appreciated.","link":"https://stackoverflow.com/questions/76485896/geometryengine-project-method-of-esri-geometry-api-for-java-not-working","title":"GeometryEngine.project() method of Esri Geometry API for Java not working","body":"<p>I am trying to calculate the 2D area of a polygon created from vertices defined by latitude and longitude coordinates using the following dependencies:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import com.esri.core.geometry.Geometry;\nimport com.esri.core.geometry.GeometryEngine;\nimport com.esri.core.geometry.Point;\nimport com.esri.core.geometry.Polygon;\nimport com.esri.core.geometry.SpatialReference;\n</code></pre>\n<p>I have initialized the vertices using latitude and longitude coordinates and assuming that they are in the wgs84 spatial reference system. In the <a href=\"https://esri.github.io/geometry-api-java/javadoc/com/esri/core/geometry/Point.html\" rel=\"nofollow noreferrer\">documentation</a>, it is also stated that &quot;In case of Geographic Coordinate Systems, the X coordinate is the longitude and the Y is the latitude.&quot;</p>\n<pre class=\"lang-java prettyprint-override\"><code>SpatialReference wgs84 = SpatialReference.create(4326);\n\nPoint kassel = new Point(9.49, 51.29);\nPoint bamberg = new Point (10.90, 49.88);\nPoint gotha = new Point(10.70,50.93);\n</code></pre>\n<p>Now the polygon is formed without any problems:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Polygon polygon = new Polygon();\npolygon.startPath(kassel);\npolygon.lineTo(bamberg);\npolygon.lineTo(gotha);\npolygon.closePathWithLine();\n</code></pre>\n<p>If I use the method <code>polygon.calculateArea2D()</code>, then the result is negative. It is <a href=\"https://esri.github.io/geometry-api-java/javadoc/com/esri/core/geometry/MultiPath.html#calculateArea2D--\" rel=\"nofollow noreferrer\">explained</a> that &quot;If the spatial reference is a Geographic Coordinate System (WGS84) then the 2D area calculation is defined in angular units.&quot;</p>\n<p>After some research, it seems to me that the polygon should be projected to another spatial reference system (Web Mercator), so that the measurement can be done in proper units (meters and square meters):</p>\n<pre class=\"lang-java prettyprint-override\"><code>SpatialReference webMercator= SpatialReference.create(3857);\nPolygon newPolygon = GeometryEngine.project(polygon,wgs84,webMercator);\n</code></pre>\n<p>However, I receive an error that the method is not found. I have seen several examples use this method to project a geometry from one spatial reference system to another. I also could not find this method in the <a href=\"https://esri.github.io/geometry-api-java/javadoc/com/esri/core/geometry/GeometryEngine.html\" rel=\"nofollow noreferrer\">documentation</a> of the <code>GeometryEngine</code> class. Does anyone have any ideas what went wrong here? Your help would be much appreciated.</p>\n"},{"tags":["java","if-statement","parsing","antlr","boolean-logic"],"comments":[{"score":0,"post_type":"question","creation_date":1701241938,"post_id":77568789,"comment_id":136749834,"body_markdown":"Are you aware that string comparison in Java is done with the `equals` method, not the `==` operator?  I&#39;m not sure from the wording of your question whether this is the difficulty you&#39;re facing or not.","link":"https://stackoverflow.com/questions/77568789/derive-conditions-for-each-variable-assignment-from-pseudocode#comment136749834_77568789","body":"Are you aware that string comparison in Java is done with the <code>equals</code> method, not the <code>==</code> operator?  I&#39;m not sure from the wording of your question whether this is the difficulty you&#39;re facing or not."},{"score":0,"post_type":"question","creation_date":1701255179,"post_id":77568789,"comment_id":136752119,"body_markdown":"So, given an &quot;end result&quot;, like `a == &quot;Yes&quot;`, you want all the paths that lead to this result? In the case of `a` equals to `&quot;Yes&quot;`, for example `[b==&quot;foo1&quot;, c==&quot;foo2&quot;, d==&quot;foo3&quot;]`, `[b==&quot;foo1&quot;, c==&quot;foo13&quot;, d!=(&quot;foo11&quot;,&quot;foo12&quot;,&quot;foo8&quot;,&quot;foo9&quot;)]` , `[b==&quot;foo1&quot;, c!=&quot;foo13&quot;]`, etc.","link":"https://stackoverflow.com/questions/77568789/derive-conditions-for-each-variable-assignment-from-pseudocode#comment136752119_77568789","body":"So, given an &quot;end result&quot;, like <code>a == &quot;Yes&quot;</code>, you want all the paths that lead to this result? In the case of <code>a</code> equals to <code>&quot;Yes&quot;</code>, for example <code>[b==&quot;foo1&quot;, c==&quot;foo2&quot;, d==&quot;foo3&quot;]</code>, <code>[b==&quot;foo1&quot;, c==&quot;foo13&quot;, d!=(&quot;foo11&quot;,&quot;foo12&quot;,&quot;foo8&quot;,&quot;foo9&quot;)]</code> , <code>[b==&quot;foo1&quot;, c!=&quot;foo13&quot;]</code>, etc."},{"score":0,"post_type":"question","creation_date":1701255214,"post_id":77568789,"comment_id":136752125,"body_markdown":"This is an algebraic rewrite problem. You want to rewrite &quot;if e1 then e2 else e3&quot; as the Boolean expression &quot;(e1 and e2) or (not e1 and not e3)&quot;. You&#39;re stack should be an expression (which you never say), but you don&#39;t need one. You are rewriting if-then-else into an expression of ands, ors, and nots. Proceed recursively, bottom up, returning an expression. You can ignore `a = &quot;No&quot;` if you assume the value is set in the following statement, which it is. For &quot;if e1 then a=yes then a=no&quot;, simply return &quot;e1&quot;. The output expression can probably be simplified, but that is another step.","link":"https://stackoverflow.com/questions/77568789/derive-conditions-for-each-variable-assignment-from-pseudocode#comment136752125_77568789","body":"This is an algebraic rewrite problem. You want to rewrite &quot;if e1 then e2 else e3&quot; as the Boolean expression &quot;(e1 and e2) or (not e1 and not e3)&quot;. You&#39;re stack should be an expression (which you never say), but you don&#39;t need one. You are rewriting if-then-else into an expression of ands, ors, and nots. Proceed recursively, bottom up, returning an expression. You can ignore <code>a = &quot;No&quot;</code> if you assume the value is set in the following statement, which it is. For &quot;if e1 then a=yes then a=no&quot;, simply return &quot;e1&quot;. The output expression can probably be simplified, but that is another step."},{"score":0,"post_type":"question","creation_date":1701266509,"post_id":77568789,"comment_id":136754296,"body_markdown":"@DawoodibnKareem the pseudocode I provided is not Java, I will be converting the pseudocode to Java. Sorry that was not clear","link":"https://stackoverflow.com/questions/77568789/derive-conditions-for-each-variable-assignment-from-pseudocode#comment136754296_77568789","body":"@DawoodibnKareem the pseudocode I provided is not Java, I will be converting the pseudocode to Java. Sorry that was not clear"},{"score":0,"post_type":"question","creation_date":1701266531,"post_id":77568789,"comment_id":136754303,"body_markdown":"@BartKiers yes that sounds about right","link":"https://stackoverflow.com/questions/77568789/derive-conditions-for-each-variable-assignment-from-pseudocode#comment136754303_77568789","body":"@BartKiers yes that sounds about right"}],"comment_count":5,"is_answered":false,"view_count":68,"answer_count":0,"score":0,"last_activity_date":1701791970,"creation_date":1701236224,"last_edit_date":1701791970,"question_id":77568789,"body_markdown":"I have some pseudocode that is in the form: \r\n\r\n```\r\npatch a:\r\n  if b == &quot;foo1&quot;\r\n  then\r\n    a = &quot;No&quot;\r\n    if c == &quot;foo2&quot;\r\n    then\r\n      if d == &quot;foo3&quot; || d == &quot;foo4&quot; || d == &quot;foo5&quot; || d == &quot;foo6&quot;\r\n      then\r\n        a = &quot;Yes&quot;\r\n      else\r\n        a = &quot;No&quot;\r\n    else\r\n      if c == &quot;foo7&quot;\r\n      then\r\n        if d == &quot;foo8&quot; || d == &quot;foo9&quot;\r\n        then\r\n          a = &quot;Yes&quot;\r\n        else\r\n          a = &quot;No&quot;\r\n      else\r\n        if c == &quot;foo10&quot;\r\n        then\r\n          if d == &quot;foo11&quot; || d == &quot;foo12&quot;\r\n          then\r\n            a = &quot;Yes&quot;\r\n          else\r\n            a = &quot;No&quot;\r\n        else\r\n          if c == &quot;foo13&quot;\r\n          then\r\n            if d != &quot;foo11&quot; &amp;&amp; d != &quot;foo12&quot; &amp;&amp; d != &quot;foo8&quot; &amp;&amp; d != &quot;foo9&quot;\r\n            then\r\n              a = &quot;Yes&quot;\r\n            else\r\n              a = &quot;No&quot;\r\n          else\r\n            a = &quot;Yes&quot;\r\n\r\n```\r\nI have an ANTLR file that I am using to parse this pseudocode. I would like to be able to derive a single condition that satisfies each variable assignment I encounter as I parse the pseudocode.\r\nFor the example above a single condition for `a = &quot;yes&quot;` would look like:\r\n```(b == &quot;foo1&quot; AND c == &quot;foo2&quot; AND (d == &quot;foo3&quot; OR d == &quot;foo4&quot; OR d == &quot;foo5&quot; OR d == &quot;foo6&quot;)) OR\r\n  (b == &quot;foo1&quot; AND c == &quot;foo7&quot; AND (d == &quot;foo8&quot; OR d == &quot;foo9&quot;)) OR\r\n  (b == &quot;foo1&quot; AND c == &quot;foo10&quot; AND (d == &quot;foo11&quot; OR d == &quot;foo12&quot;)) OR\r\n  (b == &quot;foo1&quot; AND c == &quot;foo13&quot; AND d != &quot;foo11&quot; AND d != &quot;foo12&quot; AND d != &quot;foo8&quot; AND d != &quot;foo9&quot;)\r\n```\r\nand the single condition for `a = &quot;no&quot;` would look like:\r\n```\r\n(b == &quot;foo1&quot; AND c == &quot;foo2&quot; AND d != &quot;foo3&quot; AND d != &quot;foo4&quot; AND d != &quot;foo5&quot; AND d != &quot;foo6&quot;) OR\r\n  (b == &quot;foo1&quot; AND c == &quot;foo7&quot; AND d != &quot;foo8&quot; AND d != &quot;foo9&quot;) OR\r\n  (b == &quot;foo1&quot; AND c == &quot;foo10&quot; AND d != &quot;foo11&quot; AND d != &quot;foo12&quot;) OR\r\n  (b == &quot;foo1&quot; AND c == &quot;foo13&quot; AND (d == &quot;foo11&quot; OR d == &quot;foo12&quot; OR d == &quot;foo8&quot; OR d == &quot;foo9&quot;))\r\n```\r\n\r\n\r\n\r\nI am using a stack to maintain my conditions. Everytime, I enter an `if` block I push my condition to the stack and pop it when I leave the `if` block. When I enter a `then` block I push an AND to the stack and when I enter an `else` block I push an `OR` to stack. This works fine for simple patches but I am struggling to figure how to accommodate for line 4 in the example patch.\r\n\r\nWith the my current solution I am getting something like `a = &quot;No&quot;` when `b == &quot;foo1&quot; OR ...` this causing problems since it possible for `a == &quot;Yes&quot;` if a couple of more conditions are met. How do I account for this situation? \r\n\r\n**Update 1**\r\nInstead of trying to do this entirely in pass I decided to build an AST out of ANTLR&#39;s parse tree. It has a couple of node types which just store some data, like conditionNode storing if statements, assignmentNode storing assignments and the main ASTNode which captures scope and has things reference to parent, thenBranch, elseBranch and a root node which can be an assignmentNode or conditionNode. Using this structure it was easy to build out the conditions for leaf node assignments. Still would like help trying to figure out nonleaf node assignments. ","link":"https://stackoverflow.com/questions/77568789/derive-conditions-for-each-variable-assignment-from-pseudocode","title":"Derive conditions for each variable assignment from pseudocode","body":"<p>I have some pseudocode that is in the form:</p>\n<pre><code>patch a:\n  if b == &quot;foo1&quot;\n  then\n    a = &quot;No&quot;\n    if c == &quot;foo2&quot;\n    then\n      if d == &quot;foo3&quot; || d == &quot;foo4&quot; || d == &quot;foo5&quot; || d == &quot;foo6&quot;\n      then\n        a = &quot;Yes&quot;\n      else\n        a = &quot;No&quot;\n    else\n      if c == &quot;foo7&quot;\n      then\n        if d == &quot;foo8&quot; || d == &quot;foo9&quot;\n        then\n          a = &quot;Yes&quot;\n        else\n          a = &quot;No&quot;\n      else\n        if c == &quot;foo10&quot;\n        then\n          if d == &quot;foo11&quot; || d == &quot;foo12&quot;\n          then\n            a = &quot;Yes&quot;\n          else\n            a = &quot;No&quot;\n        else\n          if c == &quot;foo13&quot;\n          then\n            if d != &quot;foo11&quot; &amp;&amp; d != &quot;foo12&quot; &amp;&amp; d != &quot;foo8&quot; &amp;&amp; d != &quot;foo9&quot;\n            then\n              a = &quot;Yes&quot;\n            else\n              a = &quot;No&quot;\n          else\n            a = &quot;Yes&quot;\n\n</code></pre>\n<p>I have an ANTLR file that I am using to parse this pseudocode. I would like to be able to derive a single condition that satisfies each variable assignment I encounter as I parse the pseudocode.\nFor the example above a single condition for <code>a = &quot;yes&quot;</code> would look like:</p>\n<pre><code>  (b == &quot;foo1&quot; AND c == &quot;foo7&quot; AND (d == &quot;foo8&quot; OR d == &quot;foo9&quot;)) OR\n  (b == &quot;foo1&quot; AND c == &quot;foo10&quot; AND (d == &quot;foo11&quot; OR d == &quot;foo12&quot;)) OR\n  (b == &quot;foo1&quot; AND c == &quot;foo13&quot; AND d != &quot;foo11&quot; AND d != &quot;foo12&quot; AND d != &quot;foo8&quot; AND d != &quot;foo9&quot;)\n</code></pre>\n<p>and the single condition for <code>a = &quot;no&quot;</code> would look like:</p>\n<pre><code>(b == &quot;foo1&quot; AND c == &quot;foo2&quot; AND d != &quot;foo3&quot; AND d != &quot;foo4&quot; AND d != &quot;foo5&quot; AND d != &quot;foo6&quot;) OR\n  (b == &quot;foo1&quot; AND c == &quot;foo7&quot; AND d != &quot;foo8&quot; AND d != &quot;foo9&quot;) OR\n  (b == &quot;foo1&quot; AND c == &quot;foo10&quot; AND d != &quot;foo11&quot; AND d != &quot;foo12&quot;) OR\n  (b == &quot;foo1&quot; AND c == &quot;foo13&quot; AND (d == &quot;foo11&quot; OR d == &quot;foo12&quot; OR d == &quot;foo8&quot; OR d == &quot;foo9&quot;))\n</code></pre>\n<p>I am using a stack to maintain my conditions. Everytime, I enter an <code>if</code> block I push my condition to the stack and pop it when I leave the <code>if</code> block. When I enter a <code>then</code> block I push an AND to the stack and when I enter an <code>else</code> block I push an <code>OR</code> to stack. This works fine for simple patches but I am struggling to figure how to accommodate for line 4 in the example patch.</p>\n<p>With the my current solution I am getting something like <code>a = &quot;No&quot;</code> when <code>b == &quot;foo1&quot; OR ...</code> this causing problems since it possible for <code>a == &quot;Yes&quot;</code> if a couple of more conditions are met. How do I account for this situation?</p>\n<p><strong>Update 1</strong>\nInstead of trying to do this entirely in pass I decided to build an AST out of ANTLR's parse tree. It has a couple of node types which just store some data, like conditionNode storing if statements, assignmentNode storing assignments and the main ASTNode which captures scope and has things reference to parent, thenBranch, elseBranch and a root node which can be an assignmentNode or conditionNode. Using this structure it was easy to build out the conditions for leaf node assignments. Still would like help trying to figure out nonleaf node assignments.</p>\n"},{"tags":["java","multithreading","java-threads","thread-sleep"],"comments":[{"score":0,"post_type":"question","creation_date":1701106094,"post_id":77558805,"comment_id":136731289,"body_markdown":"What kind of error were you expecting, and why?","link":"https://stackoverflow.com/questions/77558805/looking-for-clarity-on-thread-sleep-method#comment136731289_77558805","body":"What kind of error were you expecting, and why?"},{"score":0,"post_type":"question","creation_date":1701106221,"post_id":77558805,"comment_id":136731303,"body_markdown":"Tip: Replace `System.currentTimeMillis()` with `java.time.Instant.now()`.","link":"https://stackoverflow.com/questions/77558805/looking-for-clarity-on-thread-sleep-method#comment136731303_77558805","body":"Tip: Replace <code>System.currentTimeMillis()</code> with <code>java.time.Instant.now()</code>."},{"score":3,"post_type":"question","creation_date":1701106301,"post_id":77558805,"comment_id":136731315,"body_markdown":"Why would `Thread#sleep` throw an error? A non-daemon `Thread` is allowed to continue running even when the main thread completes, as the jvm will not shutdown until all non-daemon threads complete (Which they are by default, unless you are currently a daemon thread. The main thread is non-daemon). What you&#39;re seeing here is normal, your main thread completes first, then the second thread completes.","link":"https://stackoverflow.com/questions/77558805/looking-for-clarity-on-thread-sleep-method#comment136731315_77558805","body":"Why would <code>Thread#sleep</code> throw an error? A non-daemon <code>Thread</code> is allowed to continue running even when the main thread completes, as the jvm will not shutdown until all non-daemon threads complete (Which they are by default, unless you are currently a daemon thread. The main thread is non-daemon). What you&#39;re seeing here is normal, your main thread completes first, then the second thread completes."},{"score":3,"post_type":"question","creation_date":1701106320,"post_id":77558805,"comment_id":136731318,"body_markdown":"Does this answer your question? [How can thread run after main method closes?](https://stackoverflow.com/questions/22146899/how-can-thread-run-after-main-method-closes)","link":"https://stackoverflow.com/questions/77558805/looking-for-clarity-on-thread-sleep-method#comment136731318_77558805","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/22146899/how-can-thread-run-after-main-method-closes\">How can thread run after main method closes?</a>"},{"score":2,"post_type":"question","creation_date":1701106365,"post_id":77558805,"comment_id":136731330,"body_markdown":"Nothing is calling interrupt on the thread. Here is an answer demonstrating thread interruption https://stackoverflow.com/a/5915306/217324","link":"https://stackoverflow.com/questions/77558805/looking-for-clarity-on-thread-sleep-method#comment136731330_77558805","body":"Nothing is calling interrupt on the thread. Here is an answer demonstrating thread interruption <a href=\"https://stackoverflow.com/a/5915306/217324\">stackoverflow.com/a/5915306/217324</a>"},{"score":0,"post_type":"question","creation_date":1701106939,"post_id":77558805,"comment_id":136731429,"body_markdown":"@BasilBourque My confusion is how thread.sleep() puts main thread to sleep when &#39;thread&#39; here is a reference of user defined thread.","link":"https://stackoverflow.com/questions/77558805/looking-for-clarity-on-thread-sleep-method#comment136731429_77558805","body":"@BasilBourque My confusion is how thread.sleep() puts main thread to sleep when &#39;thread&#39; here is a reference of user defined thread."},{"score":5,"post_type":"question","creation_date":1701107131,"post_id":77558805,"comment_id":136731458,"body_markdown":"Sleep is a static method. Java doesnt care what instance you call it on.","link":"https://stackoverflow.com/questions/77558805/looking-for-clarity-on-thread-sleep-method#comment136731458_77558805","body":"Sleep is a static method. Java doesnt care what instance you call it on."},{"score":2,"post_type":"question","creation_date":1701107466,"post_id":77558805,"comment_id":136731532,"body_markdown":"You can&#39;t force another thread to sleep.","link":"https://stackoverflow.com/questions/77558805/looking-for-clarity-on-thread-sleep-method#comment136731532_77558805","body":"You can&#39;t force another thread to sleep."},{"score":0,"post_type":"question","creation_date":1701118448,"post_id":77558805,"comment_id":136733319,"body_markdown":"Don&#39;t think of `thread.sleep(n)` as putting _any_ thread to sleep. What `thread.sleep(1000)` does in your program is the same as what `Thread.sleep(1000)` would do. And what `Thread.sleep(1000)` does is _nothing._ It does nothing for 1000 milliseconds,\\* and then it returns. \\[* Actually, for _at least_ 1000 milliseconds. It&#39;s allowed to take a tiny bit longer than the time you specify, but it is not allowed to take any less time.]","link":"https://stackoverflow.com/questions/77558805/looking-for-clarity-on-thread-sleep-method#comment136733319_77558805","body":"Don&#39;t think of <code>thread.sleep(n)</code> as putting <i>any</i> thread to sleep. What <code>thread.sleep(1000)</code> does in your program is the same as what <code>Thread.sleep(1000)</code> would do. And what <code>Thread.sleep(1000)</code> does is <i>nothing.</i> It does nothing for 1000 milliseconds,* and then it returns. &#91;* Actually, for <i>at least</i> 1000 milliseconds. It&#39;s allowed to take a tiny bit longer than the time you specify, but it is not allowed to take any less time.]"},{"score":0,"post_type":"question","creation_date":1701200337,"post_id":77558805,"comment_id":136745211,"body_markdown":"You said it yourself. It puts the thread *that is running it* to sleep.","link":"https://stackoverflow.com/questions/77558805/looking-for-clarity-on-thread-sleep-method#comment136745211_77558805","body":"You said it yourself. It puts the thread <i>that is running it</i> to sleep."}],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1701107707,"post_id":77558906,"comment_id":136731580,"body_markdown":"Admittedly `someThread.sleep(...)` is like a witch accidentally drinking her own potions.","link":"https://stackoverflow.com/questions/77558805/looking-for-clarity-on-thread-sleep-method/77558906#comment136731580_77558906","body":"Admittedly <code>someThread.sleep(...)</code> is like a witch accidentally drinking her own potions."}],"comment_count":1,"score":2,"last_activity_date":1701790285,"last_edit_date":1701790285,"creation_date":1701106747,"answer_id":77558906,"question_id":77558805,"body_markdown":"Letting a thread put another thread to sleep would be a security risk so it is not allowed. `Thread.sleep` is a static method that puts the current thread to sleep.  \r\n\r\n\r\nOne of the more confusing features of the Java language is that you&#39;re allowed to call static methods on object instances as if they were instance methods. The actual instance is ignored (it can even be null), the type of the variable is used to figure out what class to call the method on. But that can leave the user thinking they are doing something with a particular instance that they aren&#39;t.\r\n","link":"https://stackoverflow.com/questions/77558805/looking-for-clarity-on-thread-sleep-method/77558906#77558906","title":"Looking for clarity on Thread.sleep() method","body":"<p>Letting a thread put another thread to sleep would be a security risk so it is not allowed. <code>Thread.sleep</code> is a static method that puts the current thread to sleep.</p>\n<p>One of the more confusing features of the Java language is that you're allowed to call static methods on object instances as if they were instance methods. The actual instance is ignored (it can even be null), the type of the variable is used to figure out what class to call the method on. But that can leave the user thinking they are doing something with a particular instance that they aren't.</p>\n"},{"comment_count":0,"score":0,"last_activity_date":1701198603,"creation_date":1701198603,"answer_id":77566548,"question_id":77558805,"body_markdown":"&gt; Why is the main thread is sleeping when called on the reference of user defined thread.\r\n\r\nIf we look at the [`Thread` class source][1] we see:\r\n\r\n&gt;     public static native void sleep(long millis) throws InterruptedException;\r\n\r\nThis is a `static` method so should be called as `Thread.sleep(...)` and not on an instance of `Thread`.  Calling it as `thread.sleep(...)` is a an anti-pattern.  You think you are affecting the `thread` instance but in reality the caller is the one that is sleeping.  Looking at the javadocs of this method it confirms this:\r\n\r\n&gt; Causes the currently executing thread to sleep (temporarily cease execution) for the specified number of milliseconds, subject to the precision and accuracy of system timers and schedulers. The thread does not lose ownership of any monitors.\r\n\r\nIn [Eclipse (a free IDE)][2], when I try to use `sleep()` with an instance variable I get a warning:\r\n\r\n[![enter image description here][3]][3]\r\n\r\nPaying attention to these sorts of warnings will help.\r\n\r\n  [1]: https://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html#sleep-long-\r\n  [2]: https://www.eclipse.org/\r\n  [3]: https://i.stack.imgur.com/ymdbF.png","link":"https://stackoverflow.com/questions/77558805/looking-for-clarity-on-thread-sleep-method/77566548#77566548","title":"Looking for clarity on Thread.sleep() method","body":"<blockquote>\n<p>Why is the main thread is sleeping when called on the reference of user defined thread.</p>\n</blockquote>\n<p>If we look at the <a href=\"https://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html#sleep-long-\" rel=\"nofollow noreferrer\"><code>Thread</code> class source</a> we see:</p>\n<blockquote>\n<pre><code>public static native void sleep(long millis) throws InterruptedException;\n</code></pre>\n</blockquote>\n<p>This is a <code>static</code> method so should be called as <code>Thread.sleep(...)</code> and not on an instance of <code>Thread</code>.  Calling it as <code>thread.sleep(...)</code> is a an anti-pattern.  You think you are affecting the <code>thread</code> instance but in reality the caller is the one that is sleeping.  Looking at the javadocs of this method it confirms this:</p>\n<blockquote>\n<p>Causes the currently executing thread to sleep (temporarily cease execution) for the specified number of milliseconds, subject to the precision and accuracy of system timers and schedulers. The thread does not lose ownership of any monitors.</p>\n</blockquote>\n<p>In <a href=\"https://www.eclipse.org/\" rel=\"nofollow noreferrer\">Eclipse (a free IDE)</a>, when I try to use <code>sleep()</code> with an instance variable I get a warning:</p>\n<p><a href=\"https://i.stack.imgur.com/ymdbF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ymdbF.png\" alt=\"enter image description here\" /></a></p>\n<p>Paying attention to these sorts of warnings will help.</p>\n"}],"comment_count":10,"is_answered":true,"view_count":100,"answer_count":2,"score":1,"last_activity_date":1701790285,"creation_date":1701105749,"last_edit_date":1701106758,"question_id":77558805,"body_markdown":"Thread.sleep() method puts the thread that is running it to sleep. \r\nthread.sleep() statement in the below code will be run by main thread, &#39;thread&#39; in the below code is an user defined thread. Why is the main thread is sleeping when called on the reference of user defined thread.\r\n\r\n\r\n```\r\npublic class ThreadDemo {\r\n\r\n    public static Thread t1 = null;\r\n    public static Thread t2 = null;\r\n    public static void main(String[] args) throws InterruptedException{\r\n\r\n        System.out.println(&quot;start of main function, Thread : &quot;+Thread.currentThread().getName());\r\n        t1 = Thread.currentThread(); //main thread\r\n        MyThread thread = new MyThread();\r\n        t2 = thread;\r\n        thread.start();\r\n\r\n        System.out.println(&quot;Before sleep in main method : &quot;+System.currentTimeMillis());\r\n        thread.sleep(1000);\r\n        System.out.println(&quot;After sleep in main method : &quot;+System.currentTimeMillis());\r\n\r\n        System.out.println(&quot;In main method, Thread : &quot;+t1.getName()+&quot; ,In state: &quot;+t1.getState());\r\n        System.out.println(&quot;In main method, Thread : &quot;+t2.getName()+&quot; ,In state: &quot;+t2.getState());\r\n\r\n        System.out.println(&quot;Is thread, &quot;+thread.getName() + &quot; alive : &quot;+ thread.isAlive());\r\n\r\n        System.out.println(&quot;end of main function, Thread : &quot;+Thread.currentThread().getName());\r\n    }\r\n\r\n    public static class MyThread extends Thread{\r\n        int sum = 0;\r\n        @Override\r\n        public void run() {\r\n            System.out.println(&quot;In run method, Thread : &quot;+t1.getName()+&quot; ,In state: &quot;+t1.getState());\r\n            System.out.println(&quot;In run method, Thread : &quot;+t2.getName()+&quot; ,In state: &quot;+t2.getState());\r\n            System.out.println(&quot;start of run method, Thread : &quot;+Thread.currentThread().getName());\r\n            for(int i=0; i&lt;10000; i++){\r\n                sum += i;\r\n            }\r\n            try{\r\n                Thread.sleep(10000);\r\n                System.out.println(&quot;After sleep in run method : &quot;+System.currentTimeMillis());\r\n            }catch (InterruptedException e){\r\n                e.printStackTrace();\r\n            }\r\n            System.out.println(&quot;end of run method, &quot;+ Thread.currentThread().getName() +&quot;, returns : &quot;+sum);\r\n        }\r\n    }\r\n}\r\n\r\n```\r\n\r\n\r\nOutput:\r\n\r\n```\r\nstart of main function, Thread : main\r\nBefore sleep in main method : 1701105524066\r\nIn run method, Thread : main ,In state: TIMED_WAITING\r\nIn run method, Thread : Thread-0 ,In state: RUNNABLE\r\nstart of run method, Thread : Thread-0\r\nAfter sleep in main method : 1701105525070\r\nIn main method, Thread : main ,In state: RUNNABLE\r\nIn main method, Thread : Thread-0 ,In state: TIMED_WAITING\r\nIs thread, Thread-0 alive : true\r\nend of main function, Thread : main\r\nAfter sleep in run method : 1701105534071\r\nend of run method, Thread-0, returns : 49995000\r\n```\r\n\r\n\r\nI don&#39;t understand how main thread is sleeping when called on the reference of user defined thread.","link":"https://stackoverflow.com/questions/77558805/looking-for-clarity-on-thread-sleep-method","title":"Looking for clarity on Thread.sleep() method","body":"<p>Thread.sleep() method puts the thread that is running it to sleep.\nthread.sleep() statement in the below code will be run by main thread, 'thread' in the below code is an user defined thread. Why is the main thread is sleeping when called on the reference of user defined thread.</p>\n<pre><code>public class ThreadDemo {\n\n    public static Thread t1 = null;\n    public static Thread t2 = null;\n    public static void main(String[] args) throws InterruptedException{\n\n        System.out.println(&quot;start of main function, Thread : &quot;+Thread.currentThread().getName());\n        t1 = Thread.currentThread(); //main thread\n        MyThread thread = new MyThread();\n        t2 = thread;\n        thread.start();\n\n        System.out.println(&quot;Before sleep in main method : &quot;+System.currentTimeMillis());\n        thread.sleep(1000);\n        System.out.println(&quot;After sleep in main method : &quot;+System.currentTimeMillis());\n\n        System.out.println(&quot;In main method, Thread : &quot;+t1.getName()+&quot; ,In state: &quot;+t1.getState());\n        System.out.println(&quot;In main method, Thread : &quot;+t2.getName()+&quot; ,In state: &quot;+t2.getState());\n\n        System.out.println(&quot;Is thread, &quot;+thread.getName() + &quot; alive : &quot;+ thread.isAlive());\n\n        System.out.println(&quot;end of main function, Thread : &quot;+Thread.currentThread().getName());\n    }\n\n    public static class MyThread extends Thread{\n        int sum = 0;\n        @Override\n        public void run() {\n            System.out.println(&quot;In run method, Thread : &quot;+t1.getName()+&quot; ,In state: &quot;+t1.getState());\n            System.out.println(&quot;In run method, Thread : &quot;+t2.getName()+&quot; ,In state: &quot;+t2.getState());\n            System.out.println(&quot;start of run method, Thread : &quot;+Thread.currentThread().getName());\n            for(int i=0; i&lt;10000; i++){\n                sum += i;\n            }\n            try{\n                Thread.sleep(10000);\n                System.out.println(&quot;After sleep in run method : &quot;+System.currentTimeMillis());\n            }catch (InterruptedException e){\n                e.printStackTrace();\n            }\n            System.out.println(&quot;end of run method, &quot;+ Thread.currentThread().getName() +&quot;, returns : &quot;+sum);\n        }\n    }\n}\n\n</code></pre>\n<p>Output:</p>\n<pre><code>start of main function, Thread : main\nBefore sleep in main method : 1701105524066\nIn run method, Thread : main ,In state: TIMED_WAITING\nIn run method, Thread : Thread-0 ,In state: RUNNABLE\nstart of run method, Thread : Thread-0\nAfter sleep in main method : 1701105525070\nIn main method, Thread : main ,In state: RUNNABLE\nIn main method, Thread : Thread-0 ,In state: TIMED_WAITING\nIs thread, Thread-0 alive : true\nend of main function, Thread : main\nAfter sleep in run method : 1701105534071\nend of run method, Thread-0, returns : 49995000\n</code></pre>\n<p>I don't understand how main thread is sleeping when called on the reference of user defined thread.</p>\n"},{"tags":["java","aws-lambda","aws-api-gateway","aws-cdk"],"comments":[{"score":0,"post_type":"question","creation_date":1701438584,"post_id":76583718,"comment_id":136778870,"body_markdown":"Have you managed to improve it?","link":"https://stackoverflow.com/questions/76583718/aws-snapstart-for-java-lambda-using-aws-cdk#comment136778870_76583718","body":"Have you managed to improve it?"},{"score":0,"post_type":"question","creation_date":1701439903,"post_id":76583718,"comment_id":136779123,"body_markdown":"No, SnapStart is for sure enabled and I am still facing 2s-3s cold start times for the function.","link":"https://stackoverflow.com/questions/76583718/aws-snapstart-for-java-lambda-using-aws-cdk#comment136779123_76583718","body":"No, SnapStart is for sure enabled and I am still facing 2s-3s cold start times for the function."}],"comment_count":2,"is_answered":false,"view_count":246,"answer_count":0,"score":2,"last_activity_date":1701786615,"creation_date":1688062998,"last_edit_date":1701786615,"question_id":76583718,"body_markdown":"I am trying to orchestrate Lambda&#39;s using the Java 11 (or 17) AWS CDK. Lambda has serious issues with JVM compilation and cold starts, so I have been looking into using the newer SnapStart feature offered by AWS. The CDK pushes the CloudFormation stack with SnapStart components included, a new version of the Lambda, and an Alias for the version. These are all necessary requirements for SnapStart.\r\n\r\n**CDK Lambda Creation w/ SnapStart Config &amp; Alias**\r\n\r\n```\r\n       //Lambda Function\r\n        String lambdaHandlerName = &quot;com.handlers.lambdaHandler::handleRequest&quot;;\r\n        IRole role5 = Role.fromRoleName(this, &quot;Lambda&quot;, &quot;LambdaRole&quot;);\r\n\r\n        Function lambdaFunction = new Function(this, &quot;lambdaFunction&quot;, getLambdaFunctionProps(lambdaEnvMap, lambdaHandlerName, role5, &quot;lambdaHandler&quot;));\r\n        dynamoTable.grantReadData(lambdaFunction);\r\n\r\n        //SnapStart Config\r\n        lambdaFunction.getCurrentVersion().addAlias(&quot;snap&quot;, AliasOptions.builder()\r\n                .description(&quot;Alias version for snap resources&quot;)\r\n                .build());\r\n        CfnFunction lambdaCfnFunction = (CfnFunction) lambdaCfnFunction.getNode().getDefaultChild();\r\n        lambdaCfnFunction.setSnapStart(CfnFunction.SnapStartProperty.builder()\r\n                .applyOn(&quot;PublishedVersions&quot;)\r\n                .build());\r\n```\r\n\r\nWithin the AWS Console itself, it appears SnapStart is enabled for the base function set to &quot;PublishedVersions&quot;.\r\n\r\n[SnapStart enabled on base function](https://i.stack.imgur.com/S1r0t.png)\r\n\r\n\r\nAnd when I look at my most recently published version, I find that it too has SnapStart enabled.\r\n\r\n[SnapStart enabled on Version](https://i.stack.imgur.com/nU1Ao.png)\r\n\r\nBut when I invoke my Lambda function through API Gateway (which is configured to the correct version of Lambda), SnapStart does not seem to be working for the function and my cold start times are still ~2s.\r\n\r\nI have also tried implementing runtime hooks, suggested by AWS for SnapStart to the Lambda function handler itself:\r\n\r\n**Handler Runtime Hooks for SnapStart**\r\n\r\n```\r\n   public GetAllQuotesHandler() {\r\n        Core.getGlobalContext().register(this);\r\n    }\r\n\r\n    @Override\r\n    public APIGatewayProxyResponseEvent handleRequest(APIGatewayProxyRequestEvent event, Context context) {\r\n      ...\r\n    }\r\n\r\n    \r\n    @Override\r\n    public void beforeCheckpoint(org.crac.Context&lt;? extends Resource&gt; context) throws Exception {\r\n        this.dynamoDb.close();\r\n        System.out.println(&quot;Before&quot;);\r\n    }\r\n\r\n    @Override\r\n    public void afterRestore(org.crac.Context&lt;? extends Resource&gt; context) throws Exception {\r\n        System.out.println(&quot;After&quot;);\r\n    }\r\n}\r\n```\r\n\r\nI am not sure what is wrong with my configuration, any advice?\r\n\r\nI am expecting AWS Lambda to engage SnapStart and invoke my Lambda function without cold starts.","link":"https://stackoverflow.com/questions/76583718/aws-snapstart-for-java-lambda-using-aws-cdk","title":"AWS SnapStart For Java Lambda Using AWS CDK","body":"<p>I am trying to orchestrate Lambda's using the Java 11 (or 17) AWS CDK. Lambda has serious issues with JVM compilation and cold starts, so I have been looking into using the newer SnapStart feature offered by AWS. The CDK pushes the CloudFormation stack with SnapStart components included, a new version of the Lambda, and an Alias for the version. These are all necessary requirements for SnapStart.</p>\n<p><strong>CDK Lambda Creation w/ SnapStart Config &amp; Alias</strong></p>\n<pre><code>       //Lambda Function\n        String lambdaHandlerName = &quot;com.handlers.lambdaHandler::handleRequest&quot;;\n        IRole role5 = Role.fromRoleName(this, &quot;Lambda&quot;, &quot;LambdaRole&quot;);\n\n        Function lambdaFunction = new Function(this, &quot;lambdaFunction&quot;, getLambdaFunctionProps(lambdaEnvMap, lambdaHandlerName, role5, &quot;lambdaHandler&quot;));\n        dynamoTable.grantReadData(lambdaFunction);\n\n        //SnapStart Config\n        lambdaFunction.getCurrentVersion().addAlias(&quot;snap&quot;, AliasOptions.builder()\n                .description(&quot;Alias version for snap resources&quot;)\n                .build());\n        CfnFunction lambdaCfnFunction = (CfnFunction) lambdaCfnFunction.getNode().getDefaultChild();\n        lambdaCfnFunction.setSnapStart(CfnFunction.SnapStartProperty.builder()\n                .applyOn(&quot;PublishedVersions&quot;)\n                .build());\n</code></pre>\n<p>Within the AWS Console itself, it appears SnapStart is enabled for the base function set to &quot;PublishedVersions&quot;.</p>\n<p><a href=\"https://i.stack.imgur.com/S1r0t.png\" rel=\"nofollow noreferrer\">SnapStart enabled on base function</a></p>\n<p>And when I look at my most recently published version, I find that it too has SnapStart enabled.</p>\n<p><a href=\"https://i.stack.imgur.com/nU1Ao.png\" rel=\"nofollow noreferrer\">SnapStart enabled on Version</a></p>\n<p>But when I invoke my Lambda function through API Gateway (which is configured to the correct version of Lambda), SnapStart does not seem to be working for the function and my cold start times are still ~2s.</p>\n<p>I have also tried implementing runtime hooks, suggested by AWS for SnapStart to the Lambda function handler itself:</p>\n<p><strong>Handler Runtime Hooks for SnapStart</strong></p>\n<pre><code>   public GetAllQuotesHandler() {\n        Core.getGlobalContext().register(this);\n    }\n\n    @Override\n    public APIGatewayProxyResponseEvent handleRequest(APIGatewayProxyRequestEvent event, Context context) {\n      ...\n    }\n\n    \n    @Override\n    public void beforeCheckpoint(org.crac.Context&lt;? extends Resource&gt; context) throws Exception {\n        this.dynamoDb.close();\n        System.out.println(&quot;Before&quot;);\n    }\n\n    @Override\n    public void afterRestore(org.crac.Context&lt;? extends Resource&gt; context) throws Exception {\n        System.out.println(&quot;After&quot;);\n    }\n}\n</code></pre>\n<p>I am not sure what is wrong with my configuration, any advice?</p>\n<p>I am expecting AWS Lambda to engage SnapStart and invoke my Lambda function without cold starts.</p>\n"},{"tags":["java","spring"],"comments":[{"score":0,"post_type":"question","creation_date":1693249203,"post_id":76995396,"comment_id":135732968,"body_markdown":"There&#39;s a new fluent style that uses lambdas. See the migration guide https://docs.spring.io/spring-security/reference/migration/index.html","link":"https://stackoverflow.com/questions/76995396/why-does-my-ide-say-formlogin-and-exceptionhandling-is-deprecated#comment135732968_76995396","body":"There&#39;s a new fluent style that uses lambdas. See the migration guide <a href=\"https://docs.spring.io/spring-security/reference/migration/index.html\" rel=\"nofollow noreferrer\">docs.spring.io/spring-security/reference/migration/index.htm&zwnj;&#8203;l</a>"}],"answers":[{"comment_count":0,"score":4,"last_activity_date":1701783114,"last_edit_date":1701783114,"creation_date":1693250060,"answer_id":76995493,"question_id":76995396,"body_markdown":"Like [Michael][1] said:\r\n\r\n&gt; There&#39;s a new fluent style that uses lambdas...\r\n\r\nSo, you can do this way:\r\n\r\n```java\r\n.formLogin(formLogin -&gt;\r\n    formLogin\r\n        .loginPage(&quot;/login&quot;)\r\n        .permitAll()\r\n)\r\n```\r\n\r\nCheck the [*migration guide*][2].\r\n\r\n\r\n  [1]: https://stackoverflow.com/users/1898563/michael\r\n  [2]: https://docs.spring.io/spring-security/reference/migration-7/configuration.html","link":"https://stackoverflow.com/questions/76995396/why-does-my-ide-say-formlogin-and-exceptionhandling-is-deprecated/76995493#76995493","title":"Why does my IDE say .formLogin() .and() .exceptionHandling() is deprecated?","body":"<p>Like <a href=\"https://stackoverflow.com/users/1898563/michael\">Michael</a> said:</p>\n<blockquote>\n<p>There's a new fluent style that uses lambdas...</p>\n</blockquote>\n<p>So, you can do this way:</p>\n<pre class=\"lang-java prettyprint-override\"><code>.formLogin(formLogin -&gt;\n    formLogin\n        .loginPage(&quot;/login&quot;)\n        .permitAll()\n)\n</code></pre>\n<p>Check the <a href=\"https://docs.spring.io/spring-security/reference/migration-7/configuration.html\" rel=\"nofollow noreferrer\"><em>migration guide</em></a>.</p>\n"}],"comment_count":1,"is_answered":true,"view_count":1253,"answer_count":1,"score":3,"last_activity_date":1701783114,"creation_date":1693248883,"question_id":76995396,"body_markdown":"I had to upgrade the Java spring application from 11 to 19 so most of the code had the be changed because some things were deprecated. This includes the .antMatchers() being changed to .requestMatchers(), however when I changed this is my code I was left with some strange syntax errors that say  .formLogin() .and() .exceptionHandling() is deprecated and marked for removal \r\n```\r\n@Deprecated(since = &quot;6.1&quot;, forRemoval = true)\r\n```\r\n```\r\n.formLogin()\r\n .loginPage(&quot;/login&quot;)\r\n .permitAll()\r\n```\r\nWhat am I missing?","link":"https://stackoverflow.com/questions/76995396/why-does-my-ide-say-formlogin-and-exceptionhandling-is-deprecated","title":"Why does my IDE say .formLogin() .and() .exceptionHandling() is deprecated?","body":"<p>I had to upgrade the Java spring application from 11 to 19 so most of the code had the be changed because some things were deprecated. This includes the .antMatchers() being changed to .requestMatchers(), however when I changed this is my code I was left with some strange syntax errors that say  .formLogin() .and() .exceptionHandling() is deprecated and marked for removal</p>\n<pre><code>@Deprecated(since = &quot;6.1&quot;, forRemoval = true)\n</code></pre>\n<pre><code>.formLogin()\n .loginPage(&quot;/login&quot;)\n .permitAll()\n</code></pre>\n<p>What am I missing?</p>\n"},{"tags":["java","android","xml","android-studio","android-layout"],"comments":[{"score":0,"post_type":"question","creation_date":1674036762,"post_id":75157515,"comment_id":132627400,"body_markdown":"That doesn&#39;t work anymore like that. Android has now a system splash screen. Which is shown before your first activity. So setting the background in the activity is too late. Check out the splash screen docs https://developer.android.com/develop/ui/views/launch/splash-screen","link":"https://stackoverflow.com/questions/75157515/android-app-launch-background-color-not-changing#comment132627400_75157515","body":"That doesn&#39;t work anymore like that. Android has now a system splash screen. Which is shown before your first activity. So setting the background in the activity is too late. Check out the splash screen docs <a href=\"https://developer.android.com/develop/ui/views/launch/splash-screen\" rel=\"nofollow noreferrer\">developer.android.com/develop/ui/views/launch/splash-screen</a>"}],"answers":[{"comment_count":0,"score":0,"last_activity_date":1701780816,"creation_date":1701780816,"answer_id":77606348,"question_id":75157515,"body_markdown":"it doesn&#39;t related to these attributes that you mention :\r\nthe problem maybe that you don&#39;t  put color in dark mode in color.xml\r\nwith same wight color \r\n\r\n - **in Night Mode:** `&lt;color name=&quot;wight&quot;&gt;#FFFFFF&lt;/color&gt;`\r\n - **in Dark Mode:** `&lt;color name=&quot;wight&quot;&gt;#FFFFFF&lt;/color&gt;`\r\n\r\n","link":"https://stackoverflow.com/questions/75157515/android-app-launch-background-color-not-changing/77606348#77606348","title":"Android app launch background color not changing","body":"<p>it doesn't related to these attributes that you mention :\nthe problem maybe that you don't  put color in dark mode in color.xml\nwith same wight color</p>\n<ul>\n<li><strong>in Night Mode:</strong> <code>&lt;color name=&quot;wight&quot;&gt;#FFFFFF&lt;/color&gt;</code></li>\n<li><strong>in Dark Mode:</strong> <code>&lt;color name=&quot;wight&quot;&gt;#FFFFFF&lt;/color&gt;</code></li>\n</ul>\n"}],"comment_count":1,"is_answered":false,"view_count":296,"answer_count":1,"score":1,"last_activity_date":1701780816,"creation_date":1674036283,"question_id":75157515,"body_markdown":"I am making an android application using android studio. It works fine in light mode but when I turn on dark mode the launch screen(the initial screen shown on clicking the icon) has a black background.\r\n\r\nin activity_main.xml I tried using\r\n\r\n    android:windowBackground=&quot;@color/white&quot;\r\n\r\n```\r\nandroid:drawableTint=&quot;@color/white&quot;\r\n```\r\n\r\n```\r\napp:tint=&quot;@color/white&quot;\r\n```\r\n\r\nbut none of the above options worked for me.","link":"https://stackoverflow.com/questions/75157515/android-app-launch-background-color-not-changing","title":"Android app launch background color not changing","body":"<p>I am making an android application using android studio. It works fine in light mode but when I turn on dark mode the launch screen(the initial screen shown on clicking the icon) has a black background.</p>\n<p>in activity_main.xml I tried using</p>\n<pre><code>android:windowBackground=&quot;@color/white&quot;\n</code></pre>\n<pre><code>android:drawableTint=&quot;@color/white&quot;\n</code></pre>\n<pre><code>app:tint=&quot;@color/white&quot;\n</code></pre>\n<p>but none of the above options worked for me.</p>\n"},{"tags":["java"],"comments":[{"score":1,"post_type":"question","creation_date":1700491446,"post_id":77516750,"comment_id":136657719,"body_markdown":"What have you tried? Why didn&#39;t it work?","link":"https://stackoverflow.com/questions/77516750/how-can-i-print-string-expressions-one-under-the-other-in-line-in-java#comment136657719_77516750","body":"What have you tried? Why didn&#39;t it work?"},{"score":1,"post_type":"question","creation_date":1700491550,"post_id":77516750,"comment_id":136657737,"body_markdown":"Frankly, I haven&#39;t tried anything because I don&#39;t have enough knowledge, so I felt the need to write here.","link":"https://stackoverflow.com/questions/77516750/how-can-i-print-string-expressions-one-under-the-other-in-line-in-java#comment136657737_77516750","body":"Frankly, I haven&#39;t tried anything because I don&#39;t have enough knowledge, so I felt the need to write here."},{"score":2,"post_type":"question","creation_date":1700491636,"post_id":77516750,"comment_id":136657753,"body_markdown":"People are here to help you, not to do your work. Try first, fail then ask a proper question showing what didn&#39;t work.","link":"https://stackoverflow.com/questions/77516750/how-can-i-print-string-expressions-one-under-the-other-in-line-in-java#comment136657753_77516750","body":"People are here to help you, not to do your work. Try first, fail then ask a proper question showing what didn&#39;t work."},{"score":1,"post_type":"question","creation_date":1700491850,"post_id":77516750,"comment_id":136657799,"body_markdown":"I don&#39;t want anyone else to do my job. I shared it to get ideas because I didn&#39;t know what to do. If you noticed, I didn&#39;t ask if you could do it, I asked how I could do it.","link":"https://stackoverflow.com/questions/77516750/how-can-i-print-string-expressions-one-under-the-other-in-line-in-java#comment136657799_77516750","body":"I don&#39;t want anyone else to do my job. I shared it to get ideas because I didn&#39;t know what to do. If you noticed, I didn&#39;t ask if you could do it, I asked how I could do it."},{"score":1,"post_type":"question","creation_date":1700491965,"post_id":77516750,"comment_id":136657813,"body_markdown":"You can add spaces or tab characters to the strings to make the &quot;columns&quot; equal in width on each row.","link":"https://stackoverflow.com/questions/77516750/how-can-i-print-string-expressions-one-under-the-other-in-line-in-java#comment136657813_77516750","body":"You can add spaces or tab characters to the strings to make the &quot;columns&quot; equal in width on each row."},{"score":1,"post_type":"question","creation_date":1700492300,"post_id":77516750,"comment_id":136657883,"body_markdown":"Yes, I tried but the order changes in string expressions of different lengths. Thanks for your help but.","link":"https://stackoverflow.com/questions/77516750/how-can-i-print-string-expressions-one-under-the-other-in-line-in-java#comment136657883_77516750","body":"Yes, I tried but the order changes in string expressions of different lengths. Thanks for your help but."},{"score":0,"post_type":"question","creation_date":1701876377,"post_id":77516750,"comment_id":136829563,"body_markdown":"May I ask why you reversed my edit? It seems that it would have made your post more likely to be upvoted.","link":"https://stackoverflow.com/questions/77516750/how-can-i-print-string-expressions-one-under-the-other-in-line-in-java#comment136829563_77516750","body":"May I ask why you reversed my edit? It seems that it would have made your post more likely to be upvoted."}],"answers":[{"comment_count":0,"score":1,"last_activity_date":1700491950,"creation_date":1700491950,"answer_id":77516833,"question_id":77516750,"body_markdown":"Your question isn&#39;t very clear, but I think you want to print a table of data out in Java. Try using the `System.out.format()` method. Here&#39;s a quick  example of how to use it:\r\n\r\n```java\r\nSystem.out.format(&quot;%-15s %-15s %-15s\\n&quot;, &quot;Column 1&quot;, &quot;Column 2&quot;, &quot;Column 3&quot;);\r\nSystem.out.format(&quot;%-15s %-15s %-15s\\n&quot;, &quot;Hello&quot;, &quot;World&quot;, &quot;!&quot;);\r\nSystem.out.format(&quot;%-15s %-15s %-15s\\n&quot;, &quot;This&quot;, &quot;is&quot;, &quot;a table&quot;);\r\n```\r\n\r\nThis will output the following table to the console:\r\n\r\n```none\r\nColumn 1        Column 2        Column 3\r\nHello           World           !\r\nThis            is              a table\r\n```\r\n\r\nIf you want to display the table in a more sophisticated way, (right now, it might not be very clear that it&#39;s a table at all!), you can try using a third-party library such as *j-text-utils* or *ASCIITable*. These libraries provide more advanced features such as sorting, row numbering, and more. Here&#39;s an example of how to use *j-text-utils* to print a table:\r\n\r\n```java\r\nTextTable tt = new TextTable(new String[]{&quot;Column 1&quot;, &quot;Column 2&quot;, &quot;Column 3&quot;}, new String[][]{\r\n    {&quot;Hello&quot;, &quot;World&quot;, &quot;!&quot;},\r\n    {&quot;This&quot;, &quot;is&quot;, &quot;a table&quot;}\r\n});\r\ntt.printTable();\r\n```\r\n\r\nThis will output the following table to the console:\r\n\r\n```none\r\n+---------------+---------------+---------------+\r\n| Column 1      | Column 2      | Column 3      |\r\n+---------------+---------------+---------------+\r\n| Hello         | World         | !             |\r\n+---------------+---------------+---------------+\r\n| This          | is            | a table       |\r\n+---------------+---------------+---------------+\r\n```\r\n\r\nIf this isn&#39;t what you want to do, please update your question with more details. It&#39;s not very clear right now.","link":"https://stackoverflow.com/questions/77516750/how-can-i-print-string-expressions-one-under-the-other-in-line-in-java/77516833#77516833","title":"How can I print string expressions one under the other in line in java?","body":"<p>Your question isn't very clear, but I think you want to print a table of data out in Java. Try using the <code>System.out.format()</code> method. Here's a quick  example of how to use it:</p>\n<pre class=\"lang-java prettyprint-override\"><code>System.out.format(&quot;%-15s %-15s %-15s\\n&quot;, &quot;Column 1&quot;, &quot;Column 2&quot;, &quot;Column 3&quot;);\nSystem.out.format(&quot;%-15s %-15s %-15s\\n&quot;, &quot;Hello&quot;, &quot;World&quot;, &quot;!&quot;);\nSystem.out.format(&quot;%-15s %-15s %-15s\\n&quot;, &quot;This&quot;, &quot;is&quot;, &quot;a table&quot;);\n</code></pre>\n<p>This will output the following table to the console:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Column 1        Column 2        Column 3\nHello           World           !\nThis            is              a table\n</code></pre>\n<p>If you want to display the table in a more sophisticated way, (right now, it might not be very clear that it's a table at all!), you can try using a third-party library such as <em>j-text-utils</em> or <em>ASCIITable</em>. These libraries provide more advanced features such as sorting, row numbering, and more. Here's an example of how to use <em>j-text-utils</em> to print a table:</p>\n<pre class=\"lang-java prettyprint-override\"><code>TextTable tt = new TextTable(new String[]{&quot;Column 1&quot;, &quot;Column 2&quot;, &quot;Column 3&quot;}, new String[][]{\n    {&quot;Hello&quot;, &quot;World&quot;, &quot;!&quot;},\n    {&quot;This&quot;, &quot;is&quot;, &quot;a table&quot;}\n});\ntt.printTable();\n</code></pre>\n<p>This will output the following table to the console:</p>\n<pre class=\"lang-none prettyprint-override\"><code>+---------------+---------------+---------------+\n| Column 1      | Column 2      | Column 3      |\n+---------------+---------------+---------------+\n| Hello         | World         | !             |\n+---------------+---------------+---------------+\n| This          | is            | a table       |\n+---------------+---------------+---------------+\n</code></pre>\n<p>If this isn't what you want to do, please update your question with more details. It's not very clear right now.</p>\n"}],"comment_count":7,"is_answered":true,"view_count":103,"answer_count":1,"score":-7,"last_activity_date":1701780241,"creation_date":1700491397,"last_edit_date":1701780241,"question_id":77516750,"body_markdown":"In a school project, I need to print string expressions one under the other in the same alignment. How can I do that.\r\n\r\n\r\n\r\n[enter image description here](https://i.stack.imgur.com/SEr4E.png)\r\n\r\nFor example, in a situation like here, how can I print names, surnames and numbers in the same line, one under the other? Thank you in advance to everyone who answers and helps.","link":"https://stackoverflow.com/questions/77516750/how-can-i-print-string-expressions-one-under-the-other-in-line-in-java","title":"How can I print string expressions one under the other in line in java?","body":"<p>In a school project, I need to print string expressions one under the other in the same alignment. How can I do that.</p>\n<p><a href=\"https://i.stack.imgur.com/SEr4E.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n<p>For example, in a situation like here, how can I print names, surnames and numbers in the same line, one under the other? Thank you in advance to everyone who answers and helps.</p>\n"},{"tags":["java","spring","spring-boot","spring-security"],"comments":[{"score":1,"post_type":"question","creation_date":1696948548,"post_id":77266685,"comment_id":136216176,"body_markdown":"Those spring security methods are being changed to take lambdas to configure them instead of using that fluent style.","link":"https://stackoverflow.com/questions/77266685/spring-security-6-cors-is-deprecated-and-marked-for-removal#comment136216176_77266685","body":"Those spring security methods are being changed to take lambdas to configure them instead of using that fluent style."},{"score":0,"post_type":"question","creation_date":1696948955,"post_id":77266685,"comment_id":136216269,"body_markdown":"See [here](https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/config/annotation/web/builders/HttpSecurity.html#cors()) and [here](https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/config/annotation/web/builders/HttpSecurity.html#cors(org.springframework.security.config.Customizer)).","link":"https://stackoverflow.com/questions/77266685/spring-security-6-cors-is-deprecated-and-marked-for-removal#comment136216269_77266685","body":"See <a href=\"https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/config/annotation/web/builders/HttpSecurity.html#cors()\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/config/annotation/web/builders/HttpSecurity.html#cors(org.springframework.security.config.Customizer)\" rel=\"nofollow noreferrer\">here</a>."},{"score":1,"post_type":"question","creation_date":1701690293,"post_id":77266685,"comment_id":136802821,"body_markdown":"Does this answer your question? [How to configure CORS in a Spring Boot + Spring Security application?](https://stackoverflow.com/questions/36968963/how-to-configure-cors-in-a-spring-boot-spring-security-application)","link":"https://stackoverflow.com/questions/77266685/spring-security-6-cors-is-deprecated-and-marked-for-removal#comment136802821_77266685","body":"Does this answer your question? <a href=\"https://stackoverflow.com/questions/36968963/how-to-configure-cors-in-a-spring-boot-spring-security-application\">How to configure CORS in a Spring Boot + Spring Security application?</a>"}],"answers":[{"comment_count":0,"score":2,"last_activity_date":1696948608,"creation_date":1696948608,"answer_id":77266742,"question_id":77266685,"body_markdown":"According to [Migration Guide][1] and also [configuration][2] to newest version, the `securityFilterChain` should have next one body.\r\n\r\n      @Bean\r\n      public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\r\n        return http.csrf(AbstractHttpConfigurer::disable)\r\n            .cors(AbstractHttpConfigurer::disable)\r\n            .authorizeHttpRequests(request -&gt; {\r\n              request.requestMatchers(&quot;/register&quot;).permitAll();\r\n              request.requestMatchers(&quot;/users&quot;)\r\n                  .hasAnyAuthority(&quot;USER&quot;, &quot;ADMIN&quot;);\r\n            }).formLogin(Customizer.withDefaults()).build();\r\n    \r\n      }\r\n\r\nAlso please read/check from above references to documentation.\r\nBy the way here on stack overflow are many posts about migration to newest version of framework.\r\n\r\n\r\n  [1]: https://docs.spring.io/spring-security/reference/5.8/migration/servlet/config.html\r\n  [2]: https://docs.spring.io/spring-security/reference/migration-7/configuration.html","link":"https://stackoverflow.com/questions/77266685/spring-security-6-cors-is-deprecated-and-marked-for-removal/77266742#77266742","title":"Spring Security 6: cors() is deprecated and marked for removal","body":"<p>According to <a href=\"https://docs.spring.io/spring-security/reference/5.8/migration/servlet/config.html\" rel=\"nofollow noreferrer\">Migration Guide</a> and also <a href=\"https://docs.spring.io/spring-security/reference/migration-7/configuration.html\" rel=\"nofollow noreferrer\">configuration</a> to newest version, the <code>securityFilterChain</code> should have next one body.</p>\n<pre><code>  @Bean\n  public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n    return http.csrf(AbstractHttpConfigurer::disable)\n        .cors(AbstractHttpConfigurer::disable)\n        .authorizeHttpRequests(request -&gt; {\n          request.requestMatchers(&quot;/register&quot;).permitAll();\n          request.requestMatchers(&quot;/users&quot;)\n              .hasAnyAuthority(&quot;USER&quot;, &quot;ADMIN&quot;);\n        }).formLogin(Customizer.withDefaults()).build();\n\n  }\n</code></pre>\n<p>Also please read/check from above references to documentation.\nBy the way here on stack overflow are many posts about migration to newest version of framework.</p>\n"},{"comment_count":0,"score":1,"last_activity_date":1696949019,"creation_date":1696949019,"answer_id":77266790,"question_id":77266685,"body_markdown":"    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\r\n        return http\r\n                .httpBasic(AbstractHttpConfigurer::disable)\r\n                .cors(Customizer.withDefaults())\r\n                .csrf(AbstractHttpConfigurer::disable)\r\n                .authorizeHttpRequests(c -&gt; c.requestMatchers(&quot;/register&quot;).permitAll().requestMatchers(&quot;/users&quot;).hasAnyAuthority(&quot;USER&quot;, &quot;ADMIN&quot;))\r\n                .formLogin(Customizer.withDefaults())\r\n                .build();\r\n    }","link":"https://stackoverflow.com/questions/77266685/spring-security-6-cors-is-deprecated-and-marked-for-removal/77266790#77266790","title":"Spring Security 6: cors() is deprecated and marked for removal","body":"<pre><code>public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n    return http\n            .httpBasic(AbstractHttpConfigurer::disable)\n            .cors(Customizer.withDefaults())\n            .csrf(AbstractHttpConfigurer::disable)\n            .authorizeHttpRequests(c -&gt; c.requestMatchers(&quot;/register&quot;).permitAll().requestMatchers(&quot;/users&quot;).hasAnyAuthority(&quot;USER&quot;, &quot;ADMIN&quot;))\n            .formLogin(Customizer.withDefaults())\n            .build();\n}\n</code></pre>\n"},{"comments":[{"score":0,"post_type":"answer","creation_date":1701681869,"post_id":77598332,"comment_id":136801446,"body_markdown":"Fixed the coding style","link":"https://stackoverflow.com/questions/77266685/spring-security-6-cors-is-deprecated-and-marked-for-removal/77598332#comment136801446_77598332","body":"Fixed the coding style"},{"score":1,"post_type":"answer","creation_date":1701770714,"post_id":77598332,"comment_id":136813987,"body_markdown":"Your answer could be improved with additional supporting information. Please [edit] to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers [in the help center](/help/how-to-answer).","link":"https://stackoverflow.com/questions/77266685/spring-security-6-cors-is-deprecated-and-marked-for-removal/77598332#comment136813987_77598332","body":"Your answer could be improved with additional supporting information. Please <a href=\"https://stackoverflow.com/posts/77598332/edit\">edit</a> to add further details, such as citations or documentation, so that others can confirm that your answer is correct. You can find more information on how to write good answers <a href=\"/help/how-to-answer\">in the help center</a>."}],"comment_count":2,"score":2,"last_activity_date":1701681839,"last_edit_date":1701681839,"creation_date":1701681760,"answer_id":77598332,"question_id":77266685,"body_markdown":"We need to configure beans as below.\r\n\r\n```\r\n@Bean\r\n    public SecurityFilterChain defaultSecurityFilterChain(HttpSecurity http) throws Exception {\r\n        http.csrf(AbstractHttpConfigurer::disable)\r\n                .cors(httpSecurityCorsConfigurer -&gt; httpSecurityCorsConfigurer.configurationSource(corsConfigurationSource()))\r\n                .authorizeHttpRequests((requests) -&gt; requests\r\n                .requestMatchers(&quot;/myAccount&quot;, &quot;/myBalance&quot;, &quot;/myLoans&quot;, &quot;/myCards&quot;, &quot;/user&quot;).authenticated()\r\n                .requestMatchers(&quot;/contacts&quot;, &quot;/notices&quot;, &quot;/register&quot;).permitAll()\r\n        );\r\n        http.formLogin(withDefaults());\r\n        http.httpBasic(withDefaults());\r\n        return http.build();\r\n    }\r\n```\r\n\r\n    @Bean\r\n    public PasswordEncoder passwordEncoder() {\r\n        return new BCryptPasswordEncoder();\r\n    }\r\n\r\n    @Bean\r\n    public CorsConfigurationSource corsConfigurationSource() {\r\n        CorsConfiguration corsConfiguration = new CorsConfiguration();\r\n        //Make the below setting as * to allow connection from any hos\r\n        corsConfiguration.setAllowedOrigins(List.of(&quot;http://localhost:4200&quot;));\r\n        corsConfiguration.setAllowedMethods(List.of(&quot;GET&quot;, &quot;POST&quot;));\r\n        corsConfiguration.setAllowCredentials(true);\r\n        corsConfiguration.setAllowedHeaders(List.of(&quot;*&quot;));\r\n        corsConfiguration.setMaxAge(3600L);\r\n        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\r\n        source.registerCorsConfiguration(&quot;/**&quot;, corsConfiguration);\r\n        return source;\r\n    }","link":"https://stackoverflow.com/questions/77266685/spring-security-6-cors-is-deprecated-and-marked-for-removal/77598332#77598332","title":"Spring Security 6: cors() is deprecated and marked for removal","body":"<p>We need to configure beans as below.</p>\n<pre><code>@Bean\n    public SecurityFilterChain defaultSecurityFilterChain(HttpSecurity http) throws Exception {\n        http.csrf(AbstractHttpConfigurer::disable)\n                .cors(httpSecurityCorsConfigurer -&gt; httpSecurityCorsConfigurer.configurationSource(corsConfigurationSource()))\n                .authorizeHttpRequests((requests) -&gt; requests\n                .requestMatchers(&quot;/myAccount&quot;, &quot;/myBalance&quot;, &quot;/myLoans&quot;, &quot;/myCards&quot;, &quot;/user&quot;).authenticated()\n                .requestMatchers(&quot;/contacts&quot;, &quot;/notices&quot;, &quot;/register&quot;).permitAll()\n        );\n        http.formLogin(withDefaults());\n        http.httpBasic(withDefaults());\n        return http.build();\n    }\n</code></pre>\n<pre><code>@Bean\npublic PasswordEncoder passwordEncoder() {\n    return new BCryptPasswordEncoder();\n}\n\n@Bean\npublic CorsConfigurationSource corsConfigurationSource() {\n    CorsConfiguration corsConfiguration = new CorsConfiguration();\n    //Make the below setting as * to allow connection from any hos\n    corsConfiguration.setAllowedOrigins(List.of(&quot;http://localhost:4200&quot;));\n    corsConfiguration.setAllowedMethods(List.of(&quot;GET&quot;, &quot;POST&quot;));\n    corsConfiguration.setAllowCredentials(true);\n    corsConfiguration.setAllowedHeaders(List.of(&quot;*&quot;));\n    corsConfiguration.setMaxAge(3600L);\n    UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n    source.registerCorsConfiguration(&quot;/**&quot;, corsConfiguration);\n    return source;\n}\n</code></pre>\n"}],"comment_count":3,"is_answered":true,"view_count":4430,"answer_count":3,"score":-2,"last_activity_date":1701777555,"creation_date":1696948120,"last_edit_date":1701777555,"question_id":77266685,"body_markdown":"I have this code below:    \r\n\r\n    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\r\n        return http\r\n                .httpBasic().disable()\r\n                .cors().and().csrf().disable()\r\n                .authorizeHttpRequests()\r\n                .requestMatchers(&quot;/register&quot;)\r\n                .permitAll()\r\n                .and()\r\n                .authorizeHttpRequests()\r\n                .requestMatchers(&quot;/users&quot;)\r\n                .hasAnyAuthority(&quot;USER&quot;, &quot;ADMIN&quot;)\r\n                .and().formLogin().and().build();\r\n    }\r\n\r\nPlease help me in making this feature work","link":"https://stackoverflow.com/questions/77266685/spring-security-6-cors-is-deprecated-and-marked-for-removal","title":"Spring Security 6: cors() is deprecated and marked for removal","body":"<p>I have this code below:</p>\n<pre><code>public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n    return http\n            .httpBasic().disable()\n            .cors().and().csrf().disable()\n            .authorizeHttpRequests()\n            .requestMatchers(&quot;/register&quot;)\n            .permitAll()\n            .and()\n            .authorizeHttpRequests()\n            .requestMatchers(&quot;/users&quot;)\n            .hasAnyAuthority(&quot;USER&quot;, &quot;ADMIN&quot;)\n            .and().formLogin().and().build();\n}\n</code></pre>\n<p>Please help me in making this feature work</p>\n"},{"tags":["java","arraylist","reflection","constructor","java-17"],"comments":[{"score":6,"post_type":"question","creation_date":1701299154,"post_id":77574918,"comment_id":136760047,"body_markdown":"The code assumes that `ArrayList.toArray();` does create a new array, while other implementations of `Collection` don&#39;t necessarily do that, but might return the internal working array. So it assumes that it can simply use that newly created array without having to copy it, but in the other cases it has to copy it, because sharing a read-write data source in multiple `Collection`s usually bears great risk. But old code in Java is usually a mess, with 100s of classes (mostly inner ones) being unnecessary rewrites of already existing ones, and sometimes horribly slow and convoluted code.","link":"https://stackoverflow.com/questions/77574918/is-there-a-good-reason-to-split-in-two-different-cases-the-following-arraylist-c#comment136760047_77574918","body":"The code assumes that <code>ArrayList.toArray();</code> does create a new array, while other implementations of <code>Collection</code> don&#39;t necessarily do that, but might return the internal working array. So it assumes that it can simply use that newly created array without having to copy it, but in the other cases it has to copy it, because sharing a read-write data source in multiple <code>Collection</code>s usually bears great risk. But old code in Java is usually a mess, with 100s of classes (mostly inner ones) being unnecessary rewrites of already existing ones, and sometimes horribly slow and convoluted code."},{"score":0,"post_type":"question","creation_date":1701299180,"post_id":77574918,"comment_id":136760053,"body_markdown":"`c.getClass()` could return a sub-class of `ArrayList`  (The class `ArrayList` is not final and users can subclass it).","link":"https://stackoverflow.com/questions/77574918/is-there-a-good-reason-to-split-in-two-different-cases-the-following-arraylist-c#comment136760053_77574918","body":"<code>c.getClass()</code> could return a sub-class of <code>ArrayList</code>  (The class <code>ArrayList</code> is not final and users can subclass it)."}],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1701387264,"post_id":77575733,"comment_id":136772804,"body_markdown":"I think you got it right when you say that the code knows that the array `a` is not shared with the original `Collection` if it comes from another `ArrayList`, and otherwise it prefers to make an explicit copy of it, by means of `Arrays.copyOf`. On the contrary, I think that even if `toArray()` would return an array of wrong component type, since we have assigned it to `a`, which is of type `Object[]`, that would not be an issue anymore.   Probably this is what the comment in [link](https://github.com/openjdk/jdk/commit/343ecd806bb05065d31124573b3e58a864cfc617) refers to.","link":"https://stackoverflow.com/questions/77574918/is-there-a-good-reason-to-split-in-two-different-cases-the-following-arraylist-c/77575733#comment136772804_77575733","body":"I think you got it right when you say that the code knows that the array <code>a</code> is not shared with the original <code>Collection</code> if it comes from another <code>ArrayList</code>, and otherwise it prefers to make an explicit copy of it, by means of <code>Arrays.copyOf</code>. On the contrary, I think that even if <code>toArray()</code> would return an array of wrong component type, since we have assigned it to <code>a</code>, which is of type <code>Object[]</code>, that would not be an issue anymore.   Probably this is what the comment in <a href=\"https://github.com/openjdk/jdk/commit/343ecd806bb05065d31124573b3e58a864cfc617\" rel=\"nofollow noreferrer\">link</a> refers to."},{"score":0,"post_type":"answer","creation_date":1701390152,"post_id":77575733,"comment_id":136773061,"body_markdown":"Arrays know their component type at run-time. Assigning a `String[]`, for example, to an `Object[]` reference does not change the component type; the array is still a `String[]`. I added some code to my answer demonstrating this. Note that `Arrays#copyOf(T[],int)` will return a copy of the array with the same component type as the source array, whereas `Arrays#copyOf(T[],int,Class)` will return a copy of the array with the component type specified by the third argument.","link":"https://stackoverflow.com/questions/77574918/is-there-a-good-reason-to-split-in-two-different-cases-the-following-arraylist-c/77575733#comment136773061_77575733","body":"Arrays know their component type at run-time. Assigning a <code>String[]</code>, for example, to an <code>Object[]</code> reference does not change the component type; the array is still a <code>String[]</code>. I added some code to my answer demonstrating this. Note that <code>Arrays#copyOf(T[],int)</code> will return a copy of the array with the same component type as the source array, whereas <code>Arrays#copyOf(T[],int,Class)</code> will return a copy of the array with the component type specified by the third argument."},{"score":1,"post_type":"answer","creation_date":1701430795,"post_id":77575733,"comment_id":136777560,"body_markdown":"I do not agree that the contract of `toArray()` allows to return an array of a different size than the collection. Even the number of `null` elements in the returned array should match the number of `null` elements in the collection. “*Nothing in the documentation… says anything about the length of the returned array.*” should be read as “*Nothing in the documentation … says that returning an array of a different length was allowed.*” And well, the `size` used in the `Arrays.copyOf(…)` step has been initialized from the array length anyway.","link":"https://stackoverflow.com/questions/77574918/is-there-a-good-reason-to-split-in-two-different-cases-the-following-arraylist-c/77575733#comment136777560_77575733","body":"I do not agree that the contract of <code>toArray()</code> allows to return an array of a different size than the collection. Even the number of <code>null</code> elements in the returned array should match the number of <code>null</code> elements in the collection. “<i>Nothing in the documentation… says anything about the length of the returned array.</i>” should be read as “<i>Nothing in the documentation … says that returning an array of a different length was allowed.</i>” And well, the <code>size</code> used in the <code>Arrays.copyOf(…)</code> step has been initialized from the array length anyway."},{"score":0,"post_type":"answer","creation_date":1701473064,"post_id":77575733,"comment_id":136784296,"body_markdown":"@Holger I agree it&#39;s common sense that `a.length == c.size()`. But I find the lack of requiring that explicitly to be jarring, given how specific the documentation is in most other respects (including the fact that any `null` elements in the collection must be included in the array). But you&#39;re right, that point doesn&#39;t really matter here, because `size` is taken from `a.length` instead of `c.size()` (I overlooked that part; it&#39;s also not how I would have implemented it). I&#39;ll remove that from my answer.","link":"https://stackoverflow.com/questions/77574918/is-there-a-good-reason-to-split-in-two-different-cases-the-following-arraylist-c/77575733#comment136784296_77575733","body":"@Holger I agree it&#39;s common sense that <code>a.length == c.size()</code>. But I find the lack of requiring that explicitly to be jarring, given how specific the documentation is in most other respects (including the fact that any <code>null</code> elements in the collection must be included in the array). But you&#39;re right, that point doesn&#39;t really matter here, because <code>size</code> is taken from <code>a.length</code> instead of <code>c.size()</code> (I overlooked that part; it&#39;s also not how I would have implemented it). I&#39;ll remove that from my answer."},{"score":2,"post_type":"answer","creation_date":1701686807,"post_id":77575733,"comment_id":136802274,"body_markdown":"The way it has been implemented is the most robust. It only requires the incoming collection to implement a single operation correctly; it even works with concurrent collections having updates while the constructor is executed, as long as the `toArray` operation returns a valid result, either atomically or weakly consistent.","link":"https://stackoverflow.com/questions/77574918/is-there-a-good-reason-to-split-in-two-different-cases-the-following-arraylist-c/77575733#comment136802274_77575733","body":"The way it has been implemented is the most robust. It only requires the incoming collection to implement a single operation correctly; it even works with concurrent collections having updates while the constructor is executed, as long as the <code>toArray</code> operation returns a valid result, either atomically or weakly consistent."},{"score":0,"post_type":"answer","creation_date":1701752495,"post_id":77575733,"comment_id":136811596,"body_markdown":"@Holger Thanks for pointing out the need to consider concurrent collections. I hadn&#39;t considered that.","link":"https://stackoverflow.com/questions/77574918/is-there-a-good-reason-to-split-in-two-different-cases-the-following-arraylist-c/77575733#comment136811596_77575733","body":"@Holger Thanks for pointing out the need to consider concurrent collections. I hadn&#39;t considered that."}],"comment_count":6,"score":6,"last_activity_date":1701472931,"last_edit_date":1701472931,"creation_date":1701315427,"answer_id":77575733,"question_id":77574918,"body_markdown":"_Disclaimer: I was not involved in writing the code for `java.util.ArrayList`, nor know anyone who was_.\r\n\r\n---\r\n\r\nThe constructor you&#39;re looking at is a &quot;copy constructor&quot;; it is meant to create a shallow copy of the given collection `c`. That means the elements of `c` must be copied into the new collection, but the new collection&#39;s &quot;structure&quot; (the array in the case of `ArrayList`) must be distinct. Otherwise, structural modifications to `c` would also be visible via the new collection and vice versa.\r\n\r\nThis part:\r\n\r\n&gt; ```java\r\n&gt; if (c.getClass() == ArrayList.class) {\r\n&gt;     elementData = a;\r\n&gt; } else {\r\n&gt;     elementData = Arrays.copyOf(a, size, Object[].class);\r\n&gt; }\r\n&gt; ```\r\n\r\nEnsures the new `ArrayList` and `c` do not share the same array. But `ArrayList` _knows_ its own implementation of `toArray()` returns a distinct array. So, when `c` is an `ArrayList`, it avoids copying the array, thus avoiding unecessary work. Otherwise, if `c` is an instance of any other collection type, _including a subtype of_ `ArrayList` (which could override `toArray()`),&#160;then that knowledge of `toArray()` can no longer be relied upon, so a defensive copy of the array is made.\r\n\r\nThat said, the contract of [`Collection#toArray()`][1] states:\r\n\r\n&gt; The returned array will be &quot;safe&quot; in that no references to it are maintained by this collection. (In other words, this method must allocate a new array even if this collection is backed by an array). The caller is thus free to modify the returned array.\r\n\r\nSo, it would appear copying the array is not necessary, making the above code seem superfluous. But I can think of one reason why the array should be copied:\r\n\r\n* Security. A malicious implementation of `Collection` could break the contract of `toArray()` and keep a reference to the array, allowing an actor to unexpectedly view and/or modify the new `ArrayList`. Since `ArrayList` is a very widely used class, it&#39;s important this sort of thing is guarded against.\r\n\r\n* _Bonus reason (from [meriton&#39;s answer][2])_: Ensure the component type of the array is `Object`. The component type of `elementData` must be `Object` in order to work correctly with the generic nature of `ArrayList`. A bad implementation of `Collection`, malicious or otherwise, could force an `ArrayStoreException` by having `toArray()` return an array with the wrong component type. By passing `Object[].class` to `Arrays.copyOf`, the above code avoids this problem.\r\n\r\nIn both cases, however, `ArrayList` still _knows_ that its own implementation of `toArray()` returns a distinct array with a component type of `Object`, so copying the array can still be avoided when `c.getClass() == ArrayList.class`.\r\n\r\n---\r\n\r\n## Demonstration\r\n\r\nHere is some code demonstrating the problems described by the two points above when the array is not copied correctly.\r\n\r\n**Main.java**:\r\n\r\n```java\r\nimport java.util.Arrays;\r\nimport java.util.Objects;\r\n\r\npublic class Main {\r\n\r\n    public static void main(String[] args) {\r\n        MaliciousStringCollection malicious = new MaliciousStringCollection();\r\n\r\n        MyArrayList&lt;Object&gt; objects = new MyArrayList&lt;&gt;(malicious);\r\n\r\n        System.out.println(&quot;Current elements of &#39;objects&#39;:&quot;);\r\n        for (int i = 0; i &lt; objects.size(); i++) {\r\n            System.out.printf(&quot;    objects[%d] = %s%n&quot;, i, objects.get(i));\r\n        }\r\n        System.out.println();\r\n\r\n        // Demonstrate how not copying the array can lead to the list&#39;s array being\r\n        // modified unexpectedly.\r\n        System.out.println(&quot;Changing elements of &#39;objects&#39; via &#39;malicious&#39;. New elements of &#39;objects&#39;:&quot;);\r\n        malicious.changeData();\r\n        for (int i = 0; i &lt; objects.size(); i++) {\r\n            System.out.printf(&quot;    objects[%d] = %s%n&quot;, i, objects.get(i));\r\n        }\r\n        System.out.println();\r\n\r\n        // Demonstrate how not ensuring the component type of the backing array is `Object` can\r\n        // lead to an ArrayStoreException.\r\n        System.out.println(&quot;Adding &#39;42&#39; to &#39;objects&#39;.&quot;);\r\n        objects.add(42); // throws ArrayStoreException\r\n    }\r\n\r\n    public interface MyCollection&lt;E&gt; {\r\n\r\n        /**\r\n         * @return a new array, with a component type of {@code Object}, that contains\r\n         *         the elements of this collection in encounter order\r\n         */\r\n        Object[] toArray();\r\n\r\n        /**\r\n         * @return the size of this collection\r\n         */\r\n        int size();\r\n    }\r\n\r\n    public static class MyArrayList&lt;E&gt; implements MyCollection&lt;E&gt; {\r\n\r\n        private Object[] data;\r\n        private int size;\r\n\r\n        public MyArrayList(MyCollection&lt;? extends E&gt; col) {\r\n            size = col.size();\r\n            /*\r\n             * Fails two things:\r\n             * \r\n             *     1. To ensure the component type of &#39;data&#39; is &#39;Object&#39;\r\n             *     2. To ensure the array is not shared with other code.\r\n             * \r\n             * Both things can be fixed by changing the code to:\r\n             * \r\n             *     data = Arrays.copyOf(col.toArray(), size, Object[].class);\r\n             */\r\n            data = col.toArray();\r\n        }\r\n\r\n        public void add(E e) {\r\n            if (data.length == size) {\r\n                int newLength = data.length + Math.max(data.length / 2, 1);\r\n                data = Arrays.copyOf(data, newLength);\r\n            }\r\n            data[size++] = e;\r\n        }\r\n\r\n        @SuppressWarnings(&quot;unchecked&quot;)\r\n        public E get(int index) {\r\n            Objects.checkIndex(index, size);\r\n            return (E) data[index];\r\n        }\r\n\r\n        @Override\r\n        public int size() {\r\n            return size;\r\n        }\r\n\r\n        @Override\r\n        public Object[] toArray() {\r\n            return Arrays.copyOf(data, size);\r\n        }\r\n    }\r\n\r\n    public static class MaliciousStringCollection implements MyCollection&lt;String&gt; {\r\n\r\n        private final String[] data = {&quot;Hello&quot;, &quot;World&quot;};\r\n\r\n        @Override\r\n        public int size() {\r\n            return data.length;\r\n        }\r\n\r\n        public void changeData() {\r\n            data[0] = &quot;Goodbye&quot;;\r\n        }\r\n        \r\n        @Override\r\n        public Object[] toArray() {\r\n            /*\r\n             * Malicious implementation:\r\n             * \r\n             *     1. Does not return a new, distinct array.\r\n             *     2. Returns an array whose component type is &#39;String&#39;, not &#39;Object&#39;.\r\n             */\r\n            return data;\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nOutput:\r\n\r\n```none\r\nCurrent elements of &#39;objects&#39;:\r\n    objects[0] = Hello\r\n    objects[1] = World\r\n\r\nChanging elements of &#39;objects&#39; via &#39;malicious&#39;. New elements of &#39;objects&#39;:\r\n    objects[0] = Goodbye\r\n    objects[1] = World\r\n\r\nAdding &#39;42&#39; to &#39;objects&#39;.\r\nException in thread &quot;main&quot; java.lang.ArrayStoreException: java.lang.Integer\r\n        at Main$MyArrayList.add(Main.java:71)\r\n        at Main.main(Main.java:29)\r\n```\r\n\r\n\r\n\r\n\r\n\r\n  [1]: https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Collection.html#toArray()\r\n  [2]: https://stackoverflow.com/a/77576162/6395627\r\n","link":"https://stackoverflow.com/questions/77574918/is-there-a-good-reason-to-split-in-two-different-cases-the-following-arraylist-c/77575733#77575733","title":"Is there a good reason to split in two different cases the following ArrayList constructor in the OpenJDK code?","body":"<p><em>Disclaimer: I was not involved in writing the code for <code>java.util.ArrayList</code>, nor know anyone who was</em>.</p>\n<hr />\n<p>The constructor you're looking at is a &quot;copy constructor&quot;; it is meant to create a shallow copy of the given collection <code>c</code>. That means the elements of <code>c</code> must be copied into the new collection, but the new collection's &quot;structure&quot; (the array in the case of <code>ArrayList</code>) must be distinct. Otherwise, structural modifications to <code>c</code> would also be visible via the new collection and vice versa.</p>\n<p>This part:</p>\n<blockquote>\n<pre class=\"lang-java prettyprint-override\"><code>if (c.getClass() == ArrayList.class) {\n    elementData = a;\n} else {\n    elementData = Arrays.copyOf(a, size, Object[].class);\n}\n</code></pre>\n</blockquote>\n<p>Ensures the new <code>ArrayList</code> and <code>c</code> do not share the same array. But <code>ArrayList</code> <em>knows</em> its own implementation of <code>toArray()</code> returns a distinct array. So, when <code>c</code> is an <code>ArrayList</code>, it avoids copying the array, thus avoiding unecessary work. Otherwise, if <code>c</code> is an instance of any other collection type, <em>including a subtype of</em> <code>ArrayList</code> (which could override <code>toArray()</code>), then that knowledge of <code>toArray()</code> can no longer be relied upon, so a defensive copy of the array is made.</p>\n<p>That said, the contract of <a href=\"https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Collection.html#toArray()\" rel=\"nofollow noreferrer\"><code>Collection#toArray()</code></a> states:</p>\n<blockquote>\n<p>The returned array will be &quot;safe&quot; in that no references to it are maintained by this collection. (In other words, this method must allocate a new array even if this collection is backed by an array). The caller is thus free to modify the returned array.</p>\n</blockquote>\n<p>So, it would appear copying the array is not necessary, making the above code seem superfluous. But I can think of one reason why the array should be copied:</p>\n<ul>\n<li><p>Security. A malicious implementation of <code>Collection</code> could break the contract of <code>toArray()</code> and keep a reference to the array, allowing an actor to unexpectedly view and/or modify the new <code>ArrayList</code>. Since <code>ArrayList</code> is a very widely used class, it's important this sort of thing is guarded against.</p>\n</li>\n<li><p><em>Bonus reason (from <a href=\"https://stackoverflow.com/a/77576162/6395627\">meriton's answer</a>)</em>: Ensure the component type of the array is <code>Object</code>. The component type of <code>elementData</code> must be <code>Object</code> in order to work correctly with the generic nature of <code>ArrayList</code>. A bad implementation of <code>Collection</code>, malicious or otherwise, could force an <code>ArrayStoreException</code> by having <code>toArray()</code> return an array with the wrong component type. By passing <code>Object[].class</code> to <code>Arrays.copyOf</code>, the above code avoids this problem.</p>\n</li>\n</ul>\n<p>In both cases, however, <code>ArrayList</code> still <em>knows</em> that its own implementation of <code>toArray()</code> returns a distinct array with a component type of <code>Object</code>, so copying the array can still be avoided when <code>c.getClass() == ArrayList.class</code>.</p>\n<hr />\n<h2>Demonstration</h2>\n<p>Here is some code demonstrating the problems described by the two points above when the array is not copied correctly.</p>\n<p><strong>Main.java</strong>:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.util.Arrays;\nimport java.util.Objects;\n\npublic class Main {\n\n    public static void main(String[] args) {\n        MaliciousStringCollection malicious = new MaliciousStringCollection();\n\n        MyArrayList&lt;Object&gt; objects = new MyArrayList&lt;&gt;(malicious);\n\n        System.out.println(&quot;Current elements of 'objects':&quot;);\n        for (int i = 0; i &lt; objects.size(); i++) {\n            System.out.printf(&quot;    objects[%d] = %s%n&quot;, i, objects.get(i));\n        }\n        System.out.println();\n\n        // Demonstrate how not copying the array can lead to the list's array being\n        // modified unexpectedly.\n        System.out.println(&quot;Changing elements of 'objects' via 'malicious'. New elements of 'objects':&quot;);\n        malicious.changeData();\n        for (int i = 0; i &lt; objects.size(); i++) {\n            System.out.printf(&quot;    objects[%d] = %s%n&quot;, i, objects.get(i));\n        }\n        System.out.println();\n\n        // Demonstrate how not ensuring the component type of the backing array is `Object` can\n        // lead to an ArrayStoreException.\n        System.out.println(&quot;Adding '42' to 'objects'.&quot;);\n        objects.add(42); // throws ArrayStoreException\n    }\n\n    public interface MyCollection&lt;E&gt; {\n\n        /**\n         * @return a new array, with a component type of {@code Object}, that contains\n         *         the elements of this collection in encounter order\n         */\n        Object[] toArray();\n\n        /**\n         * @return the size of this collection\n         */\n        int size();\n    }\n\n    public static class MyArrayList&lt;E&gt; implements MyCollection&lt;E&gt; {\n\n        private Object[] data;\n        private int size;\n\n        public MyArrayList(MyCollection&lt;? extends E&gt; col) {\n            size = col.size();\n            /*\n             * Fails two things:\n             * \n             *     1. To ensure the component type of 'data' is 'Object'\n             *     2. To ensure the array is not shared with other code.\n             * \n             * Both things can be fixed by changing the code to:\n             * \n             *     data = Arrays.copyOf(col.toArray(), size, Object[].class);\n             */\n            data = col.toArray();\n        }\n\n        public void add(E e) {\n            if (data.length == size) {\n                int newLength = data.length + Math.max(data.length / 2, 1);\n                data = Arrays.copyOf(data, newLength);\n            }\n            data[size++] = e;\n        }\n\n        @SuppressWarnings(&quot;unchecked&quot;)\n        public E get(int index) {\n            Objects.checkIndex(index, size);\n            return (E) data[index];\n        }\n\n        @Override\n        public int size() {\n            return size;\n        }\n\n        @Override\n        public Object[] toArray() {\n            return Arrays.copyOf(data, size);\n        }\n    }\n\n    public static class MaliciousStringCollection implements MyCollection&lt;String&gt; {\n\n        private final String[] data = {&quot;Hello&quot;, &quot;World&quot;};\n\n        @Override\n        public int size() {\n            return data.length;\n        }\n\n        public void changeData() {\n            data[0] = &quot;Goodbye&quot;;\n        }\n        \n        @Override\n        public Object[] toArray() {\n            /*\n             * Malicious implementation:\n             * \n             *     1. Does not return a new, distinct array.\n             *     2. Returns an array whose component type is 'String', not 'Object'.\n             */\n            return data;\n        }\n    }\n}\n</code></pre>\n<p>Output:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Current elements of 'objects':\n    objects[0] = Hello\n    objects[1] = World\n\nChanging elements of 'objects' via 'malicious'. New elements of 'objects':\n    objects[0] = Goodbye\n    objects[1] = World\n\nAdding '42' to 'objects'.\nException in thread &quot;main&quot; java.lang.ArrayStoreException: java.lang.Integer\n        at Main$MyArrayList.add(Main.java:71)\n        at Main.main(Main.java:29)\n</code></pre>\n"},{"comments":[{"score":2,"post_type":"answer","creation_date":1701459038,"post_id":77576162,"comment_id":136782566,"body_markdown":"Note, in old implementations `Arrays.toList(&quot;foo&quot;).toArray().getClass() == String[].class`.","link":"https://stackoverflow.com/questions/77574918/is-there-a-good-reason-to-split-in-two-different-cases-the-following-arraylist-c/77576162#comment136782566_77576162","body":"Note, in old implementations <code>Arrays.toList(&quot;foo&quot;).toArray().getClass() == String[].class</code>."}],"comment_count":1,"score":5,"last_activity_date":1701323670,"last_edit_date":1701323670,"creation_date":1701323076,"answer_id":77576162,"question_id":77574918,"body_markdown":"If you do a [git blame](https://github.com/openjdk/jdk/blame/master/src/java.base/share/classes/java/util/ArrayList.java) on that source file, you will find that this code was introduced as part of the commit [343ecd806bb050](https://github.com/openjdk/jdk/commit/343ecd806bb05065d31124573b3e58a864cfc617), whose commit message\r\n\r\n&gt; 8231800: Better listing of arrays \r\n\r\nreferences the issue JDK-8231800 in the JDK bugtracker. Alas, this issue is not visible to the public, but googling it reveals it has been shipped with security updates to all Java versions supported at the time, providing strong evidence that this was related to a security issue (which also explains why the details of the issue haven&#39;t been made public, and why the commit message is not descriptive).\r\n\r\nHowever, googling also finds an [enhancement request](https://bugs.openjdk.org/browse/JDK-8257475?page=com.atlassian.jira.plugin.system.issuetabpanels%3Achangehistory-tabpanel) filed by the autor of that code, which does describe the challenges this piece of code is intended to solve:\r\n\r\n&gt; Consider new ArrayList&lt;E&gt;(Collection&lt;E&gt; arg). This calls arg.toArray() and makes a defensive copy of it for use use as the internal array to the ArrayList. This copy is necessary in case the arg&#39;s toArray() implementation produces an array whose class is something other than Object[].class or if it retains a reference to the returned array. (Both of these are spec violations, but they&#39;re unenforceable.)\r\n\r\nThat is, ArrayList needs its array to\r\n\r\n* admit elements of type `E`\r\n* not be accessible (and therefore modifiable) by other code\r\n\r\nImplementations of `Collection.toArray` are specified to satisfy this:\r\n\r\n&gt; `Object[] toArray()`\r\n&gt; \r\n&gt; Returns an array containing all of the elements in this collection. If this collection makes any guarantees as to what order its elements are returned by its iterator, this method must return the elements in the same order. The returned array&#39;s runtime component type is Object.\r\n&gt; \r\n&gt; The returned array will be &quot;safe&quot; in that no references to it are maintained by this collection. (In other words, this method must allocate a new array even if this collection is backed by an array). The caller is thus free to modify the returned array.\r\n\r\nhowever, we can&#39;t be sure that an implementation actually does this. For instance, an implementation might do:\r\n\r\n```\r\nclass StringList implements Collection&lt;String&gt; {\r\n    String[] elements = new String[10];\r\n    int size = 0;\r\n    \r\n    // other methods omitted\r\n\r\n    @Override \r\n    Object[] toArray() {\r\n        return Arrays.copyOf(elements, size);\r\n    }\r\n}\r\n```\r\n\r\nwhich looks totally innocent, right? But this implementation actually violates the spec, because `copyOf` will return a `String[]` rather than an `Object[]`, so if somebody did:\r\n\r\n  \t\tvar strings = new StringList(&quot;Hello&quot;, &quot;World&quot;);\r\n\t\tvar objects = new ArrayList&lt;Object&gt;(strings);\r\n\t\tobjects.add(42); \r\n\r\nThat code is totally correct as far as the compile time type system is concerned, but would fail at runtime with an `ArrayStoreException` if `ArrayList` reused the array returned by `StringList.toArray()`. \r\n\r\nThe second issue is more nefarious. Suppose you have code like this:\r\n\r\n```\r\nclass AccessManager {\r\n    final List&lt;Permission&gt; permissions;\r\n\r\n    public AccessManager(List&lt;Permission&gt; requestedPermissions) {\r\n        permissions = new ArrayList&lt;&gt;(requestedPermissions);\r\n        verifyPermissions();\r\n    }\r\n\r\n    private verifyPermissions() { \r\n        for (var p : permissions) {\r\n            if (!currentUser.has(p)) {\r\n                throw new SecurityException();\r\n            }\r\n        }\r\n    }\r\n\r\n    boolean checkAccess(Permission p) {\r\n        return permissions.contains(p);\r\n    }\r\n}\r\n```\r\n\r\nand some nefarious hacker declared:\r\n\r\n```\r\nclass NefariousList implements Collection&lt;Permission&gt; {\r\n    Object[] permissions = { new InnocentPermission() };\r\n\r\n    @Override\r\n    public Object[] toArray() {\r\n        return permissions;\r\n    }\r\n}\r\n```\r\n\r\nand then did:\r\n\r\n```\r\nvar nefarious = new NefariousList();\r\nvar accessManager = new AccessManager(nefarious);\r\nvar service = new Service(accessManager);\r\n\r\nnefarious.permissions[0] = new AdminPermission();\r\nservice.deleteDatabase();\r\n```\r\n\r\nthey could successfully delete the database, because `AccessManager` finds an `AdminPermission` in the list of verified permissions ... \r\n\r\n(if you believe such hand-written security code with reference sharing bugs to be contrived, behold this [real world example from a recent stackoverflow question](https://stackoverflow.com/questions/77212901/java-static-list-causes-memory-leak/77212960#77212960))\r\n\r\nSince core classes of the Java Language are [required to work correctly even if untrusted code executes within the same JVM](https://www.oracle.com/java/technologies/javase/seccodeguide.html), `ArrayList` can not, in general, rely on `Collection.toArray` to be implemented correctly unless it has verified that the implementation is, in fact, safe, because it comes from a trustworthy JDK class.","link":"https://stackoverflow.com/questions/77574918/is-there-a-good-reason-to-split-in-two-different-cases-the-following-arraylist-c/77576162#77576162","title":"Is there a good reason to split in two different cases the following ArrayList constructor in the OpenJDK code?","body":"<p>If you do a <a href=\"https://github.com/openjdk/jdk/blame/master/src/java.base/share/classes/java/util/ArrayList.java\" rel=\"noreferrer\">git blame</a> on that source file, you will find that this code was introduced as part of the commit <a href=\"https://github.com/openjdk/jdk/commit/343ecd806bb05065d31124573b3e58a864cfc617\" rel=\"noreferrer\">343ecd806bb050</a>, whose commit message</p>\n<blockquote>\n<p>8231800: Better listing of arrays</p>\n</blockquote>\n<p>references the issue JDK-8231800 in the JDK bugtracker. Alas, this issue is not visible to the public, but googling it reveals it has been shipped with security updates to all Java versions supported at the time, providing strong evidence that this was related to a security issue (which also explains why the details of the issue haven't been made public, and why the commit message is not descriptive).</p>\n<p>However, googling also finds an <a href=\"https://bugs.openjdk.org/browse/JDK-8257475?page=com.atlassian.jira.plugin.system.issuetabpanels%3Achangehistory-tabpanel\" rel=\"noreferrer\">enhancement request</a> filed by the autor of that code, which does describe the challenges this piece of code is intended to solve:</p>\n<blockquote>\n<p>Consider new ArrayList(Collection arg). This calls arg.toArray() and makes a defensive copy of it for use use as the internal array to the ArrayList. This copy is necessary in case the arg's toArray() implementation produces an array whose class is something other than Object[].class or if it retains a reference to the returned array. (Both of these are spec violations, but they're unenforceable.)</p>\n</blockquote>\n<p>That is, ArrayList needs its array to</p>\n<ul>\n<li>admit elements of type <code>E</code></li>\n<li>not be accessible (and therefore modifiable) by other code</li>\n</ul>\n<p>Implementations of <code>Collection.toArray</code> are specified to satisfy this:</p>\n<blockquote>\n<p><code>Object[] toArray()</code></p>\n<p>Returns an array containing all of the elements in this collection. If this collection makes any guarantees as to what order its elements are returned by its iterator, this method must return the elements in the same order. The returned array's runtime component type is Object.</p>\n<p>The returned array will be &quot;safe&quot; in that no references to it are maintained by this collection. (In other words, this method must allocate a new array even if this collection is backed by an array). The caller is thus free to modify the returned array.</p>\n</blockquote>\n<p>however, we can't be sure that an implementation actually does this. For instance, an implementation might do:</p>\n<pre><code>class StringList implements Collection&lt;String&gt; {\n    String[] elements = new String[10];\n    int size = 0;\n    \n    // other methods omitted\n\n    @Override \n    Object[] toArray() {\n        return Arrays.copyOf(elements, size);\n    }\n}\n</code></pre>\n<p>which looks totally innocent, right? But this implementation actually violates the spec, because <code>copyOf</code> will return a <code>String[]</code> rather than an <code>Object[]</code>, so if somebody did:</p>\n<pre><code>    var strings = new StringList(&quot;Hello&quot;, &quot;World&quot;);\n    var objects = new ArrayList&lt;Object&gt;(strings);\n    objects.add(42); \n</code></pre>\n<p>That code is totally correct as far as the compile time type system is concerned, but would fail at runtime with an <code>ArrayStoreException</code> if <code>ArrayList</code> reused the array returned by <code>StringList.toArray()</code>.</p>\n<p>The second issue is more nefarious. Suppose you have code like this:</p>\n<pre><code>class AccessManager {\n    final List&lt;Permission&gt; permissions;\n\n    public AccessManager(List&lt;Permission&gt; requestedPermissions) {\n        permissions = new ArrayList&lt;&gt;(requestedPermissions);\n        verifyPermissions();\n    }\n\n    private verifyPermissions() { \n        for (var p : permissions) {\n            if (!currentUser.has(p)) {\n                throw new SecurityException();\n            }\n        }\n    }\n\n    boolean checkAccess(Permission p) {\n        return permissions.contains(p);\n    }\n}\n</code></pre>\n<p>and some nefarious hacker declared:</p>\n<pre><code>class NefariousList implements Collection&lt;Permission&gt; {\n    Object[] permissions = { new InnocentPermission() };\n\n    @Override\n    public Object[] toArray() {\n        return permissions;\n    }\n}\n</code></pre>\n<p>and then did:</p>\n<pre><code>var nefarious = new NefariousList();\nvar accessManager = new AccessManager(nefarious);\nvar service = new Service(accessManager);\n\nnefarious.permissions[0] = new AdminPermission();\nservice.deleteDatabase();\n</code></pre>\n<p>they could successfully delete the database, because <code>AccessManager</code> finds an <code>AdminPermission</code> in the list of verified permissions ...</p>\n<p>(if you believe such hand-written security code with reference sharing bugs to be contrived, behold this <a href=\"https://stackoverflow.com/questions/77212901/java-static-list-causes-memory-leak/77212960#77212960\">real world example from a recent stackoverflow question</a>)</p>\n<p>Since core classes of the Java Language are <a href=\"https://www.oracle.com/java/technologies/javase/seccodeguide.html\" rel=\"noreferrer\">required to work correctly even if untrusted code executes within the same JVM</a>, <code>ArrayList</code> can not, in general, rely on <code>Collection.toArray</code> to be implemented correctly unless it has verified that the implementation is, in fact, safe, because it comes from a trustworthy JDK class.</p>\n"}],"comment_count":2,"is_answered":true,"view_count":237,"answer_count":2,"score":9,"last_activity_date":1701777337,"creation_date":1701298545,"last_edit_date":1701777337,"question_id":77574918,"body_markdown":"When reading through the OpenJDK code for class ArrayList, for instance, in JDK17 \r\n\r\n&gt;(https://github.com/openjdk/jdk17/blob/master/src/java.base/share/classes/java/util/ArrayList.java)\r\n\r\nI stumbled upon the following constructor:\r\n\r\n\r\n```java\r\npublic ArrayList(Collection&lt;? extends E&gt; c) {\r\n    Object[] a = c.toArray();\r\n    if ((size = a.length) != 0) {\r\n        if (c.getClass() == ArrayList.class) {\r\n            elementData = a;\r\n        } else {\r\n            elementData = Arrays.copyOf(a, size, Object[].class);\r\n        }\r\n    } else {\r\n        // replace with empty array.\r\n        elementData = EMPTY_ELEMENTDATA;\r\n    }\r\n}\r\n```\r\n\r\nWhat is the reason behind the distinction whether `c.getClass()` is an `ArrayList.class` or not? Is this case splitting necessary at all?\r\n\r\n(I was just trying to understand Java code that is part of the OpenJDK distribution for class ArrayList.)","link":"https://stackoverflow.com/questions/77574918/is-there-a-good-reason-to-split-in-two-different-cases-the-following-arraylist-c","title":"Is there a good reason to split in two different cases the following ArrayList constructor in the OpenJDK code?","body":"<p>When reading through the OpenJDK code for class ArrayList, for instance, in JDK17</p>\n<blockquote>\n<p>(<a href=\"https://github.com/openjdk/jdk17/blob/master/src/java.base/share/classes/java/util/ArrayList.java\" rel=\"nofollow noreferrer\">https://github.com/openjdk/jdk17/blob/master/src/java.base/share/classes/java/util/ArrayList.java</a>)</p>\n</blockquote>\n<p>I stumbled upon the following constructor:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public ArrayList(Collection&lt;? extends E&gt; c) {\n    Object[] a = c.toArray();\n    if ((size = a.length) != 0) {\n        if (c.getClass() == ArrayList.class) {\n            elementData = a;\n        } else {\n            elementData = Arrays.copyOf(a, size, Object[].class);\n        }\n    } else {\n        // replace with empty array.\n        elementData = EMPTY_ELEMENTDATA;\n    }\n}\n</code></pre>\n<p>What is the reason behind the distinction whether <code>c.getClass()</code> is an <code>ArrayList.class</code> or not? Is this case splitting necessary at all?</p>\n<p>(I was just trying to understand Java code that is part of the OpenJDK distribution for class ArrayList.)</p>\n"},{"tags":["java","docker","raspberry-pi"],"comments":[{"score":0,"post_type":"question","creation_date":1701258940,"post_id":77570926,"comment_id":136752841,"body_markdown":"One addition: If I run it on windows everything works fine but as soon as I run it on my raspberry pi there seems to be an issue.","link":"https://stackoverflow.com/questions/77570926/running-a-container-executing-a-jar-on-a-raspberry-pi#comment136752841_77570926","body":"One addition: If I run it on windows everything works fine but as soon as I run it on my raspberry pi there seems to be an issue."},{"score":0,"post_type":"question","creation_date":1701264025,"post_id":77570926,"comment_id":136753789,"body_markdown":"You will need to show more details of the actual errors you are seeing - including the commands executed. Try running a simple container - `busybox` or something - so you can check if your basic docker is correct rather than a specific problem with your custom image.","link":"https://stackoverflow.com/questions/77570926/running-a-container-executing-a-jar-on-a-raspberry-pi#comment136753789_77570926","body":"You will need to show more details of the actual errors you are seeing - including the commands executed. Try running a simple container - <code>busybox</code> or something - so you can check if your basic docker is correct rather than a specific problem with your custom image."},{"score":0,"post_type":"question","creation_date":1701268549,"post_id":77570926,"comment_id":136754780,"body_markdown":"A simple container like Hello-World works finde and runs as expected. However if I want to run my docker it&#39;s not working - or at least the .jar is not executed. \nUnfortunatly there is no error message except from the Exit (159) when I look at docker -ps -a. There are no other logs or error messages.","link":"https://stackoverflow.com/questions/77570926/running-a-container-executing-a-jar-on-a-raspberry-pi#comment136754780_77570926","body":"A simple container like Hello-World works finde and runs as expected. However if I want to run my docker it&#39;s not working - or at least the .jar is not executed.  Unfortunatly there is no error message except from the Exit (159) when I look at docker -ps -a. There are no other logs or error messages."},{"score":0,"post_type":"question","creation_date":1701274993,"post_id":77570926,"comment_id":136756243,"body_markdown":"What is the docker command that you use to run the container? Because depending on how you run it, you may need to explicitly attach standard in and standard out using the `-i` and `-t` options to get any output on the console.","link":"https://stackoverflow.com/questions/77570926/running-a-container-executing-a-jar-on-a-raspberry-pi#comment136756243_77570926","body":"What is the docker command that you use to run the container? Because depending on how you run it, you may need to explicitly attach standard in and standard out using the <code>-i</code> and <code>-t</code> options to get any output on the console."},{"score":0,"post_type":"question","creation_date":1701277342,"post_id":77570926,"comment_id":136756746,"body_markdown":"Your sample `Dockerfile` had the `WORKDIR` and `ADD` commands on the same line. Was that correct?","link":"https://stackoverflow.com/questions/77570926/running-a-container-executing-a-jar-on-a-raspberry-pi#comment136756746_77570926","body":"Your sample <code>Dockerfile</code> had the <code>WORKDIR</code> and <code>ADD</code> commands on the same line. Was that correct?"},{"score":0,"post_type":"question","creation_date":1701346020,"post_id":77570926,"comment_id":136765529,"body_markdown":"That&#39;s just a format issue, in my docker file it&#39;s two lines.","link":"https://stackoverflow.com/questions/77570926/running-a-container-executing-a-jar-on-a-raspberry-pi#comment136765529_77570926","body":"That&#39;s just a format issue, in my docker file it&#39;s two lines."},{"score":0,"post_type":"question","creation_date":1701346136,"post_id":77570926,"comment_id":136765549,"body_markdown":"The command I run is simply &quot;docker run repostirory/name:tag&quot; I tried it with -i too but it still didn&#39;t work. My guess is that the jdk doesn&#39;t work correctly on arm64/v8...but I haven&#39;t found one that does until now.","link":"https://stackoverflow.com/questions/77570926/running-a-container-executing-a-jar-on-a-raspberry-pi#comment136765549_77570926","body":"The command I run is simply &quot;docker run repostirory/name:tag&quot; I tried it with -i too but it still didn&#39;t work. My guess is that the jdk doesn&#39;t work correctly on arm64/v8...but I haven&#39;t found one that does until now."},{"score":0,"post_type":"question","creation_date":1701357162,"post_id":77570926,"comment_id":136767823,"body_markdown":"You won&#39;t get any console output if you don&#39;t add `-i` and `-t`, which is probably the reason why you don&#39;t get any error message. To debug more, you can try to run bash in the container like so: `docker run -it repository/name:tag /bin/bash` This should give you a normal shell, but inside the container, allowing you to poke around and try things out.","link":"https://stackoverflow.com/questions/77570926/running-a-container-executing-a-jar-on-a-raspberry-pi#comment136767823_77570926","body":"You won&#39;t get any console output if you don&#39;t add <code>-i</code> and <code>-t</code>, which is probably the reason why you don&#39;t get any error message. To debug more, you can try to run bash in the container like so: <code>docker run -it repository&#47;name:tag &#47;bin&#47;bash</code> This should give you a normal shell, but inside the container, allowing you to poke around and try things out."}],"answers":[{"comment_count":0,"score":0,"last_activity_date":1701773386,"creation_date":1701773386,"answer_id":77605600,"question_id":77570926,"body_markdown":"So you start a container by issuing something like\r\n\r\n    docker run repository/name:tag\r\n\r\nbut all you get is a display of `Exit (159) when I look at docker -ps -a` when running `docker ps -a`. Well, you should have a container id and a container name - something you can reference. Try to retrieve the logs by running\r\n\r\n    docker logs &lt;container name or id&gt;\r\n\r\nI suspect that the `java` executable is not found. Provide it with full path as even the environment variable PATH may not be set within the container or shell interpretation is turned off because you use the entrypoint directly instead of running a shell first.","link":"https://stackoverflow.com/questions/77570926/running-a-container-executing-a-jar-on-a-raspberry-pi/77605600#77605600","title":"Running a container executing a .jar on a raspberry pi","body":"<p>So you start a container by issuing something like</p>\n<pre><code>docker run repository/name:tag\n</code></pre>\n<p>but all you get is a display of <code>Exit (159) when I look at docker -ps -a</code> when running <code>docker ps -a</code>. Well, you should have a container id and a container name - something you can reference. Try to retrieve the logs by running</p>\n<pre><code>docker logs &lt;container name or id&gt;\n</code></pre>\n<p>I suspect that the <code>java</code> executable is not found. Provide it with full path as even the environment variable PATH may not be set within the container or shell interpretation is turned off because you use the entrypoint directly instead of running a shell first.</p>\n"}],"comment_count":8,"is_answered":false,"view_count":34,"answer_count":1,"score":0,"last_activity_date":1701773386,"creation_date":1701258823,"last_edit_date":1701309105,"question_id":77570926,"body_markdown":"I have an issue running a container which should execute a .jar file on a raspberry pi. The .jar contains a simple &quot;Hello world&quot; example code. I use Java 17, the raspberry pi runs on arm64v8. \r\n\r\nMy dockerfile: \r\n\r\n```\r\nFROM arm64v8/openjdk:17-jdk-slim\r\n\r\nWORKDIR /\r\nADD helloworldtest.jar /helloworldtest.jar \r\n\r\nENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;/helloworldtest.jar&quot;]\r\n```\r\n\r\nI tried cmd instead of `ENTRYPOINT` too but there was no change in the behavior. \r\n\r\n\r\nMy build command: \r\n\r\n`docker build --platform linux/arm/v8 helloworldtest`\r\n\r\nThen I tag/push the container and everything seems to be okay. \r\n\r\nBut if I try to run the docker on my raspberry pi there is no output and it seems like the docker couldn&#39;t be started properly (`Exit Code 159`) - there is no other error message.\r\n\r\nDo I miss something here? What could be the issue? ","link":"https://stackoverflow.com/questions/77570926/running-a-container-executing-a-jar-on-a-raspberry-pi","title":"Running a container executing a .jar on a raspberry pi","body":"<p>I have an issue running a container which should execute a .jar file on a raspberry pi. The .jar contains a simple &quot;Hello world&quot; example code. I use Java 17, the raspberry pi runs on arm64v8.</p>\n<p>My dockerfile:</p>\n<pre><code>FROM arm64v8/openjdk:17-jdk-slim\n\nWORKDIR /\nADD helloworldtest.jar /helloworldtest.jar \n\nENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;/helloworldtest.jar&quot;]\n</code></pre>\n<p>I tried cmd instead of <code>ENTRYPOINT</code> too but there was no change in the behavior.</p>\n<p>My build command:</p>\n<p><code>docker build --platform linux/arm/v8 helloworldtest</code></p>\n<p>Then I tag/push the container and everything seems to be okay.</p>\n<p>But if I try to run the docker on my raspberry pi there is no output and it seems like the docker couldn't be started properly (<code>Exit Code 159</code>) - there is no other error message.</p>\n<p>Do I miss something here? What could be the issue?</p>\n"},{"tags":["java","spring-boot","gradle"],"comments":[{"score":0,"post_type":"question","creation_date":1701356180,"post_id":77579350,"comment_id":136767640,"body_markdown":"Your link points to a page that describes the error, gives some info on what to do about it and contains a link to the documentation that explains in detail how to do that. Did you try that; and what&#39;s the question you&#39;re left with?","link":"https://stackoverflow.com/questions/77579350/how-do-i-get-rid-of-automatic-loading-of-test-framework-implementation-dependen#comment136767640_77579350","body":"Your link points to a page that describes the error, gives some info on what to do about it and contains a link to the documentation that explains in detail how to do that. Did you try that; and what&#39;s the question you&#39;re left with?"},{"score":0,"post_type":"question","creation_date":1701704590,"post_id":77579350,"comment_id":136805681,"body_markdown":"Yes ofcourse I tried that. The question I am left with is stated above. Maybe I missunderstood on how to fix that error, somebody with more knowlege than me can probably tell.","link":"https://stackoverflow.com/questions/77579350/how-do-i-get-rid-of-automatic-loading-of-test-framework-implementation-dependen#comment136805681_77579350","body":"Yes ofcourse I tried that. The question I am left with is stated above. Maybe I missunderstood on how to fix that error, somebody with more knowlege than me can probably tell."}],"answers":[{"comment_count":0,"score":1,"last_activity_date":1701771501,"creation_date":1701771501,"answer_id":77605392,"question_id":77579350,"body_markdown":"I was facing the same warning, all I did was add `testRuntimeOnly &#39;org.junit.platform:junit-platform-launcher&#39;` to dependencies section.\r\nThis has been suggested on github repos of eclipse and gradle [here][1] and [here][2].\r\n\r\n\r\n  [1]: https://github.com/eclipse/buildship/issues/980#issuecomment-665124002\r\n  [2]: https://github.com/gradle/gradle/issues/13955#issue-667688825","link":"https://stackoverflow.com/questions/77579350/how-do-i-get-rid-of-automatic-loading-of-test-framework-implementation-dependen/77605392#77605392","title":"How do I get rid of &quot;Automatic loading of test framework implementation dependencies has been deprecated&quot;?","body":"<p>I was facing the same warning, all I did was add <code>testRuntimeOnly 'org.junit.platform:junit-platform-launcher'</code> to dependencies section.\nThis has been suggested on github repos of eclipse and gradle <a href=\"https://github.com/eclipse/buildship/issues/980#issuecomment-665124002\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://github.com/gradle/gradle/issues/13955#issue-667688825\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}],"comment_count":2,"is_answered":true,"view_count":114,"answer_count":1,"score":0,"last_activity_date":1701771501,"creation_date":1701355148,"question_id":77579350,"body_markdown":"I am trying to build a spring boot application, however I can&#39;t get my tests running. It seems like they are failing because of my build.gradle, however after 2 days trying to fix it I thought I might try to ask if anybody here could help.\r\nhttps://scans.gradle.com/s/m7diapblkqpxk/deprecations\r\n\r\nbuild.gradle:\r\n\r\n    plugins {\r\n        id &#39;org.springframework.boot&#39; version &#39;3.2.0&#39;\r\n        id &#39;io.spring.dependency-management&#39; version &#39;1.1.4&#39;\r\n        id &#39;java&#39;\r\n    }\r\n    \r\n    group = &#39;com.fitnessforge&#39;\r\n    version = &#39;0.0.1-SNAPSHOT&#39;\r\n    \r\n    java {\r\n        sourceCompatibility = &#39;20&#39;\r\n    }\r\n    \r\n    configurations {\r\n        compileOnly {\r\n            extendsFrom annotationProcessor\r\n        }\r\n    }\r\n    \r\n    repositories {\r\n        mavenCentral()\r\n    }\r\n    \r\n    dependencies {\r\n        implementation &#39;org.springframework.boot:spring-boot-starter-data-jpa:3.1.2&#39;\r\n        implementation &#39;org.springframework.boot:spring-boot-starter-security&#39;\r\n        implementation &#39;org.springframework.boot:spring-boot-starter-web&#39;\r\n        implementation &#39;com.mysql:mysql-connector-j:8.2.0&#39;\r\n        implementation &#39;javax.persistence:javax.persistence-api:2.2&#39;\r\n        compileOnly &#39;org.projectlombok:lombok&#39;\r\n        developmentOnly &#39;org.springframework.boot:spring-boot-devtools&#39;\r\n        annotationProcessor &#39;org.projectlombok:lombok&#39;\r\n        testImplementation(&#39;org.springframework.boot:spring-boot-starter-test:2.7.14&#39;) {\r\n            exclude group: &#39;junit&#39;\r\n        }\r\n        testImplementation &#39;org.junit.jupiter:junit-jupiter-api&#39;\r\n        testRuntimeOnly &#39;org.junit.jupiter:junit-jupiter-engine&#39;\r\n        testImplementation &#39;org.springframework.security:spring-security-test:6.1.2&#39;\r\n    }\r\n    \r\n    tasks.named(&#39;bootBuildImage&#39;) {\r\n        builder = &#39;paketobuildpacks/builder-jammy-base:latest&#39;\r\n    }\r\n    \r\n    test {\r\n        useJUnitPlatform()\r\n        testFramework {\r\n            useJUnit()\r\n        }\r\n    }\r\n\r\nUserRepositoryTest:\r\n\r\n    package com.fitnessforge.repository;\r\n    \r\n    import com.fitnessforge.FitnessForgeApplication;\r\n    import com.fitnessforge.model.User;\r\n    import com.fitnessforge.repository.UserRepository;\r\n    import org.junit.jupiter.api.Test;\r\n    import org.springframework.beans.factory.annotation.Autowired;\r\n    \r\n    import org.springframework.boot.test.context.SpringBootTest;\r\n    \r\n    import static org.junit.jupiter.api.Assertions.assertEquals;\r\n    import static org.junit.jupiter.api.Assertions.assertNotNull;\r\n    \r\n    @SpringBootTest\r\n    public class UserRepositoryTest {\r\n    \r\n        @Autowired\r\n        private UserRepository userRepository;\r\n    \r\n        @Test\r\n        public void testSaveUser() {\r\n            // Erstelle einen neuen Benutzer\r\n            User user = new User();\r\n            user.setUsername(&quot;testUser&quot;);\r\n            user.setPassword(&quot;testPassword&quot;);\r\n            user.setRole(&quot;Client&quot;);\r\n    \r\n            // Speichere den Benutzer in der Datenbank\r\n            User savedUser = userRepository.save(user);\r\n    \r\n            // &#220;berpr&#252;fe, ob der Benutzer korrekt gespeichert wurde\r\n            assertNotNull(savedUser.getId());\r\n            assertEquals(&quot;testUser&quot;, savedUser.getUsername());\r\n            assertEquals(&quot;testPassword&quot;, savedUser.getPassword());\r\n            assertEquals(&quot;Client&quot;, savedUser.getRole());\r\n        }\r\n    \r\n        \r\n    }\r\n\r\nChanging the build.gradle test part:\r\n\r\n    test {\r\n        useJUnitPlatform()\r\n    }\r\n\r\nI get this:\r\nhttps://scans.gradle.com/s/c6mdkr55724js","link":"https://stackoverflow.com/questions/77579350/how-do-i-get-rid-of-automatic-loading-of-test-framework-implementation-dependen","title":"How do I get rid of &quot;Automatic loading of test framework implementation dependencies has been deprecated&quot;?","body":"<p>I am trying to build a spring boot application, however I can't get my tests running. It seems like they are failing because of my build.gradle, however after 2 days trying to fix it I thought I might try to ask if anybody here could help.\n<a href=\"https://scans.gradle.com/s/m7diapblkqpxk/deprecations\" rel=\"nofollow noreferrer\">https://scans.gradle.com/s/m7diapblkqpxk/deprecations</a></p>\n<p>build.gradle:</p>\n<pre><code>plugins {\n    id 'org.springframework.boot' version '3.2.0'\n    id 'io.spring.dependency-management' version '1.1.4'\n    id 'java'\n}\n\ngroup = 'com.fitnessforge'\nversion = '0.0.1-SNAPSHOT'\n\njava {\n    sourceCompatibility = '20'\n}\n\nconfigurations {\n    compileOnly {\n        extendsFrom annotationProcessor\n    }\n}\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    implementation 'org.springframework.boot:spring-boot-starter-data-jpa:3.1.2'\n    implementation 'org.springframework.boot:spring-boot-starter-security'\n    implementation 'org.springframework.boot:spring-boot-starter-web'\n    implementation 'com.mysql:mysql-connector-j:8.2.0'\n    implementation 'javax.persistence:javax.persistence-api:2.2'\n    compileOnly 'org.projectlombok:lombok'\n    developmentOnly 'org.springframework.boot:spring-boot-devtools'\n    annotationProcessor 'org.projectlombok:lombok'\n    testImplementation('org.springframework.boot:spring-boot-starter-test:2.7.14') {\n        exclude group: 'junit'\n    }\n    testImplementation 'org.junit.jupiter:junit-jupiter-api'\n    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine'\n    testImplementation 'org.springframework.security:spring-security-test:6.1.2'\n}\n\ntasks.named('bootBuildImage') {\n    builder = 'paketobuildpacks/builder-jammy-base:latest'\n}\n\ntest {\n    useJUnitPlatform()\n    testFramework {\n        useJUnit()\n    }\n}\n</code></pre>\n<p>UserRepositoryTest:</p>\n<pre><code>package com.fitnessforge.repository;\n\nimport com.fitnessforge.FitnessForgeApplication;\nimport com.fitnessforge.model.User;\nimport com.fitnessforge.repository.UserRepository;\nimport org.junit.jupiter.api.Test;\nimport org.springframework.beans.factory.annotation.Autowired;\n\nimport org.springframework.boot.test.context.SpringBootTest;\n\nimport static org.junit.jupiter.api.Assertions.assertEquals;\nimport static org.junit.jupiter.api.Assertions.assertNotNull;\n\n@SpringBootTest\npublic class UserRepositoryTest {\n\n    @Autowired\n    private UserRepository userRepository;\n\n    @Test\n    public void testSaveUser() {\n        // Erstelle einen neuen Benutzer\n        User user = new User();\n        user.setUsername(&quot;testUser&quot;);\n        user.setPassword(&quot;testPassword&quot;);\n        user.setRole(&quot;Client&quot;);\n\n        // Speichere den Benutzer in der Datenbank\n        User savedUser = userRepository.save(user);\n\n        // Überprüfe, ob der Benutzer korrekt gespeichert wurde\n        assertNotNull(savedUser.getId());\n        assertEquals(&quot;testUser&quot;, savedUser.getUsername());\n        assertEquals(&quot;testPassword&quot;, savedUser.getPassword());\n        assertEquals(&quot;Client&quot;, savedUser.getRole());\n    }\n\n    \n}\n</code></pre>\n<p>Changing the build.gradle test part:</p>\n<pre><code>test {\n    useJUnitPlatform()\n}\n</code></pre>\n<p>I get this:\n<a href=\"https://scans.gradle.com/s/c6mdkr55724js\" rel=\"nofollow noreferrer\">https://scans.gradle.com/s/c6mdkr55724js</a></p>\n"},{"tags":["java","spring-boot","docker","maven","azure-aks"],"comments":[{"score":0,"post_type":"question","creation_date":1701239446,"post_id":77564673,"comment_id":136749555,"body_markdown":"The ClassNotFoundException for org.jboss.resteasy.client.jaxrs.internal.proxy.ProxyBuilderImpl indicates that the required class is not found at runtime. Since you&#39;ve confirmed that the JAR containing this class is present in the Docker image, Check the version of the Resteasy library in the UAT environment. It is possible that the version in the UAT environment is different from the version in the test environment, which could cause the missing class error. Make sure that the Resteasy library version is the same in both environments. classloading issues can arise due to conflict in hierarchy.","link":"https://stackoverflow.com/questions/77564673/classnotfoundexception-in-aks-pod-org-jboss-resteasy-client-jaxrs-internal-prox#comment136749555_77564673","body":"The ClassNotFoundException for org.jboss.resteasy.client.jaxrs.internal.proxy.ProxyBuilderI&zwnj;&#8203;mpl indicates that the required class is not found at runtime. Since you&#39;ve confirmed that the JAR containing this class is present in the Docker image, Check the version of the Resteasy library in the UAT environment. It is possible that the version in the UAT environment is different from the version in the test environment, which could cause the missing class error. Make sure that the Resteasy library version is the same in both environments. classloading issues can arise due to conflict in hierarchy."},{"score":0,"post_type":"question","creation_date":1701242350,"post_id":77564673,"comment_id":136749878,"body_markdown":"Both UAT and Test environments have same versions of resteasy-client library.","link":"https://stackoverflow.com/questions/77564673/classnotfoundexception-in-aks-pod-org-jboss-resteasy-client-jaxrs-internal-prox#comment136749878_77564673","body":"Both UAT and Test environments have same versions of resteasy-client library."}],"answers":[{"comment_count":0,"score":0,"last_activity_date":1701769028,"creation_date":1701769028,"answer_id":77605137,"question_id":77564673,"body_markdown":"I ran into the same type of issue today. I&#39;m using the keycloak-admin-client to configure multiple realms, and I was doing this through the Stream API, specifically the sequential stream, Collection.stream(). I&#39;m using spring-boot with embedded tomcat.\r\n\r\nI started testing the use of parallel stream through Collection.parallelStream(), and for some of the items I get basically the same stacktrace as you do, with cause: Caused by: java.lang.ClassNotFoundException: org.jboss.resteasy.client.jaxrs.internal.proxy.ProxyBuilderImpl\r\n\r\nI noticed a pattern for the items that failed, and that was that the underlying Thread was based on the ForkJoinPool. It seems to me like the classpath for these threads do not include certain classes. I wont speculate on why that is. Someone more qualified could probably supply information on that.\r\n\r\nI &quot;fixed&quot; my issue by setting up a java.util.concurrent.ExecutorService instead (java.util.concurrent.Executors.newFixedThreadPool(int)). Then I loop through my realm collection and submit my tasks through ExecutorService.invokeAll (I need to block until all are done). After doing this I have not been able to reproduce the issue.\r\n\r\nAs to why you get different results based on the environment you run your code in, is it due to varying number of items in your Collection? Ref &quot;Exception while adding Patients to batch&quot;","link":"https://stackoverflow.com/questions/77564673/classnotfoundexception-in-aks-pod-org-jboss-resteasy-client-jaxrs-internal-prox/77605137#77605137","title":"ClassNotFoundException in AKS Pod: org.jboss.resteasy.client.jaxrs.internal.proxy.ProxyBuilderImpl - Error Occurs in UAT Env, but Not in Test Env","body":"<p>I ran into the same type of issue today. I'm using the keycloak-admin-client to configure multiple realms, and I was doing this through the Stream API, specifically the sequential stream, Collection.stream(). I'm using spring-boot with embedded tomcat.</p>\n<p>I started testing the use of parallel stream through Collection.parallelStream(), and for some of the items I get basically the same stacktrace as you do, with cause: Caused by: java.lang.ClassNotFoundException: org.jboss.resteasy.client.jaxrs.internal.proxy.ProxyBuilderImpl</p>\n<p>I noticed a pattern for the items that failed, and that was that the underlying Thread was based on the ForkJoinPool. It seems to me like the classpath for these threads do not include certain classes. I wont speculate on why that is. Someone more qualified could probably supply information on that.</p>\n<p>I &quot;fixed&quot; my issue by setting up a java.util.concurrent.ExecutorService instead (java.util.concurrent.Executors.newFixedThreadPool(int)). Then I loop through my realm collection and submit my tasks through ExecutorService.invokeAll (I need to block until all are done). After doing this I have not been able to reproduce the issue.</p>\n<p>As to why you get different results based on the environment you run your code in, is it due to varying number of items in your Collection? Ref &quot;Exception while adding Patients to batch&quot;</p>\n"}],"comment_count":2,"is_answered":false,"view_count":88,"answer_count":1,"score":1,"last_activity_date":1701769028,"creation_date":1701181667,"question_id":77564673,"body_markdown":"I am encountering a `java.lang.ClassNotFoundException` specifically for the class `org.jboss.resteasy.client.jaxrs.internal.proxy.ProxyBuilderImpl` when my service attempts to connect to the Keycloak server using the Keycloak admin client.\r\n\r\nHere are the specifics of the issue:\r\n- The error occurs in the User Acceptance Testing (UAT) environment running in an Azure Kubernetes Service (AKS) cluster.\r\n- The service is Dockerized, and the Docker image is built and deployed in the test environment, which operates on a different AKS cluster than the UAT environment.\r\n- The Docker image is then copied from the test environment and deployed in the UAT environment.\r\n- Importantly, the `ClassNotFoundException` does not occur in the test environment.\r\n\r\nI have checked the following aspects:\r\n- Dependencies: The required dependencies, including the Resteasy library, are included in the Docker image.\r\n- Environment Variables: I have verified that all necessary environment variables are correctly set in the UAT environment.\r\n- Configuration: There are no apparent differences in configurations between the test and UAT environments.\r\n- Classpath: The classpath seems to be correctly configured in the Docker image.\r\n\r\nI have reviewed the error logs, but they primarily indicate the `ClassNotFoundException` without providing additional insights into the root cause.\r\n\r\nAny guidance or insights on resolving this issue would be greatly appreciated. If you need more details or logs, please let me know. Thank you!\r\n\r\nBelow is the errorl log\r\n```\r\njava.lang.RuntimeException: Exception while adding Patients to batch \r\n\tat com.xxx.workxxxxxxxxxxxxxxxx.service.impl.CxxxxxxxxServiceImpl.savePatients(CxxxxxxxxServiceImpl.java:235)\r\n\tat com.xxx.workxxxxxxxxxxxxxxxx.service.impl.ExxxxServiceImpl.saveEvents(ExxxxServiceImpl.java:120)\r\n\tat com.xxx.workxxxxxxxxxxxxxxxx.service.impl.ExxxxServiceImpl.segregateEventsByEntitiesAndSave(ExxxxServiceImpl.java:184)\r\n\tat com.xxx.workxxxxxxxxxxxxxxxx.service.impl.ExxxxServiceImpl.lambda$saveEventsAsEntities$0(ExxxxServiceImpl.java:97)\r\n\tat java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)\r\n\tat java.base/java.util.concurrent.CompletableFuture$AsyncRun.exec(CompletableFuture.java:1796)\r\n\tat java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:373)\r\n\tat java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1182)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:1655)\r\n\tat java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1622)\r\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:165)\r\nCaused by: java.lang.RuntimeException: java.lang.ClassNotFoundException: org.jboss.resteasy.client.jaxrs.internal.proxy.ProxyBuilderImpl\r\n\tat org.jboss.resteasy.client.jaxrs.ProxyBuilder.builder(ProxyBuilder.java:41)\r\n\tat org.jboss.resteasy.client.jaxrs.internal.ClientWebTarget.createProxyBuilder(ClientWebTarget.java:107)\r\n\tat org.jboss.resteasy.client.jaxrs.internal.ClientWebTarget.proxy(ClientWebTarget.java:94)\r\n\tat org.keycloak.admin.client.spi.ResteasyClientClassicProvider.targetProxy(ResteasyClientClassicProvider.java:48)\r\n\tat org.keycloak.admin.client.token.TokenManager.&lt;init&gt;(TokenManager.java:61)\r\n\tat org.keycloak.admin.client.Keycloak.&lt;init&gt;(Keycloak.java:91)\r\n\tat org.keycloak.admin.client.KeycloakBuilder.build(KeycloakBuilder.java:152)\r\n\tat com.xxx.workxxxxxxxxxxxxxxxx.config.KeycloakConfig.getInstance(KeycloakConfig.java:37)\r\n\tat com.xxx.workxxxxxxxxxxxxxxxx.service.impl.KxxxxxxxServiceImpl.getInstance(KxxxxxxxServiceImpl.java:240)\r\n\tat com.xxx.workxxxxxxxxxxxxxxxx.service.impl.KxxxxxxxServiceImpl.getRealmResource(KxxxxxxxServiceImpl.java:226)\r\n\tat com.xxx.workxxxxxxxxxxxxxxxx.service.impl.KxxxxxxxServiceImpl.importUsers(KxxxxxxxServiceImpl.java:132)\r\n\tat com.xxx.workxxxxxxxxxxxxxxxx.service.impl.CxxxxxxxxServiceImpl.savePatients(CxxxxxxxxServiceImpl.java:227)\r\n\t... 10 more\r\nCaused by: java.lang.ClassNotFoundException: org.jboss.resteasy.client.jaxrs.internal.proxy.ProxyBuilderImpl\r\n\tat java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)\r\n\tat java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)\r\n\tat java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:525)\r\n\tat org.jboss.resteasy.client.jaxrs.ProxyBuilder.builder(ProxyBuilder.java:35)\r\n\t... 21 more\r\n```\r\n\r\n\r\nI tried to reproduce the error in my local system by pulling the image, running in it, and executed the follwoing commands to check if the docker container has the class\r\n\r\n\r\n```\r\ndocker exec -it &lt;docker_id&gt; /bin/bash\r\njar -tf /root/.m2/repository/org/jboss/resteasy/resteasy-client/4.7.9.Final/resteasy-client-4.7.9.Final.jar | grep ProxyBuilderImpl.class\r\n```\r\nIt gave the following \r\norg/jboss/resteasy/client/jaxrs/internal/proxy/ProxyBuilderImpl.class","link":"https://stackoverflow.com/questions/77564673/classnotfoundexception-in-aks-pod-org-jboss-resteasy-client-jaxrs-internal-prox","title":"ClassNotFoundException in AKS Pod: org.jboss.resteasy.client.jaxrs.internal.proxy.ProxyBuilderImpl - Error Occurs in UAT Env, but Not in Test Env","body":"<p>I am encountering a <code>java.lang.ClassNotFoundException</code> specifically for the class <code>org.jboss.resteasy.client.jaxrs.internal.proxy.ProxyBuilderImpl</code> when my service attempts to connect to the Keycloak server using the Keycloak admin client.</p>\n<p>Here are the specifics of the issue:</p>\n<ul>\n<li>The error occurs in the User Acceptance Testing (UAT) environment running in an Azure Kubernetes Service (AKS) cluster.</li>\n<li>The service is Dockerized, and the Docker image is built and deployed in the test environment, which operates on a different AKS cluster than the UAT environment.</li>\n<li>The Docker image is then copied from the test environment and deployed in the UAT environment.</li>\n<li>Importantly, the <code>ClassNotFoundException</code> does not occur in the test environment.</li>\n</ul>\n<p>I have checked the following aspects:</p>\n<ul>\n<li>Dependencies: The required dependencies, including the Resteasy library, are included in the Docker image.</li>\n<li>Environment Variables: I have verified that all necessary environment variables are correctly set in the UAT environment.</li>\n<li>Configuration: There are no apparent differences in configurations between the test and UAT environments.</li>\n<li>Classpath: The classpath seems to be correctly configured in the Docker image.</li>\n</ul>\n<p>I have reviewed the error logs, but they primarily indicate the <code>ClassNotFoundException</code> without providing additional insights into the root cause.</p>\n<p>Any guidance or insights on resolving this issue would be greatly appreciated. If you need more details or logs, please let me know. Thank you!</p>\n<p>Below is the errorl log</p>\n<pre><code>java.lang.RuntimeException: Exception while adding Patients to batch \n    at com.xxx.workxxxxxxxxxxxxxxxx.service.impl.CxxxxxxxxServiceImpl.savePatients(CxxxxxxxxServiceImpl.java:235)\n    at com.xxx.workxxxxxxxxxxxxxxxx.service.impl.ExxxxServiceImpl.saveEvents(ExxxxServiceImpl.java:120)\n    at com.xxx.workxxxxxxxxxxxxxxxx.service.impl.ExxxxServiceImpl.segregateEventsByEntitiesAndSave(ExxxxServiceImpl.java:184)\n    at com.xxx.workxxxxxxxxxxxxxxxx.service.impl.ExxxxServiceImpl.lambda$saveEventsAsEntities$0(ExxxxServiceImpl.java:97)\n    at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)\n    at java.base/java.util.concurrent.CompletableFuture$AsyncRun.exec(CompletableFuture.java:1796)\n    at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:373)\n    at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1182)\n    at java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:1655)\n    at java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1622)\n    at java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:165)\nCaused by: java.lang.RuntimeException: java.lang.ClassNotFoundException: org.jboss.resteasy.client.jaxrs.internal.proxy.ProxyBuilderImpl\n    at org.jboss.resteasy.client.jaxrs.ProxyBuilder.builder(ProxyBuilder.java:41)\n    at org.jboss.resteasy.client.jaxrs.internal.ClientWebTarget.createProxyBuilder(ClientWebTarget.java:107)\n    at org.jboss.resteasy.client.jaxrs.internal.ClientWebTarget.proxy(ClientWebTarget.java:94)\n    at org.keycloak.admin.client.spi.ResteasyClientClassicProvider.targetProxy(ResteasyClientClassicProvider.java:48)\n    at org.keycloak.admin.client.token.TokenManager.&lt;init&gt;(TokenManager.java:61)\n    at org.keycloak.admin.client.Keycloak.&lt;init&gt;(Keycloak.java:91)\n    at org.keycloak.admin.client.KeycloakBuilder.build(KeycloakBuilder.java:152)\n    at com.xxx.workxxxxxxxxxxxxxxxx.config.KeycloakConfig.getInstance(KeycloakConfig.java:37)\n    at com.xxx.workxxxxxxxxxxxxxxxx.service.impl.KxxxxxxxServiceImpl.getInstance(KxxxxxxxServiceImpl.java:240)\n    at com.xxx.workxxxxxxxxxxxxxxxx.service.impl.KxxxxxxxServiceImpl.getRealmResource(KxxxxxxxServiceImpl.java:226)\n    at com.xxx.workxxxxxxxxxxxxxxxx.service.impl.KxxxxxxxServiceImpl.importUsers(KxxxxxxxServiceImpl.java:132)\n    at com.xxx.workxxxxxxxxxxxxxxxx.service.impl.CxxxxxxxxServiceImpl.savePatients(CxxxxxxxxServiceImpl.java:227)\n    ... 10 more\nCaused by: java.lang.ClassNotFoundException: org.jboss.resteasy.client.jaxrs.internal.proxy.ProxyBuilderImpl\n    at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641)\n    at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188)\n    at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:525)\n    at org.jboss.resteasy.client.jaxrs.ProxyBuilder.builder(ProxyBuilder.java:35)\n    ... 21 more\n</code></pre>\n<p>I tried to reproduce the error in my local system by pulling the image, running in it, and executed the follwoing commands to check if the docker container has the class</p>\n<pre><code>docker exec -it &lt;docker_id&gt; /bin/bash\njar -tf /root/.m2/repository/org/jboss/resteasy/resteasy-client/4.7.9.Final/resteasy-client-4.7.9.Final.jar | grep ProxyBuilderImpl.class\n</code></pre>\n<p>It gave the following\norg/jboss/resteasy/client/jaxrs/internal/proxy/ProxyBuilderImpl.class</p>\n"},{"tags":["java","micronaut","micronaut-rest"],"comments":[{"score":0,"post_type":"question","creation_date":1701118098,"post_id":77556288,"comment_id":136733278,"body_markdown":"I suspect you miss the `@Body` annotation in the `addPerson` method argument - `@Valid @NotNull @Body final Person person`. Also, your test does not mock the `DataService` - if you want to mock it, you should use the `@MockBean` annotation to do so.","link":"https://stackoverflow.com/questions/77556288/unable-to-get-micronauttest-to-work-with-a-post-against-the-httpclient#comment136733278_77556288","body":"I suspect you miss the <code>@Body</code> annotation in the <code>addPerson</code> method argument - <code>@Valid @NotNull @Body final Person person</code>. Also, your test does not mock the <code>DataService</code> - if you want to mock it, you should use the <code>@MockBean</code> annotation to do so."},{"score":0,"post_type":"question","creation_date":1701272661,"post_id":77556288,"comment_id":136755743,"body_markdown":"Thanks @Szymon . The DataService is mocked, or at least the mock as coded above works for all of the GET tests (and the DELETE test). WRT the `@body&#39;`- I&#39;ll give that a go, but if that works I&#39;ll be more confused again. The endpoint as coded in the question works for manual tests (calls through postman, curl and httpie)","link":"https://stackoverflow.com/questions/77556288/unable-to-get-micronauttest-to-work-with-a-post-against-the-httpclient#comment136755743_77556288","body":"Thanks @Szymon . The DataService is mocked, or at least the mock as coded above works for all of the GET tests (and the DELETE test). WRT the <code>@body&#39;</code>- I&#39;ll give that a go, but if that works I&#39;ll be more confused again. The endpoint as coded in the question works for manual tests (calls through postman, curl and httpie)"},{"score":0,"post_type":"question","creation_date":1701272865,"post_id":77556288,"comment_id":136755785,"body_markdown":"It worked! Thanks. @Szymon, can you post your comment as an answer and I&#39;ll accept? I could do it myself, but you don&#39;t get credit then! If you (know and) could address why it works from command line but not from the tests, that would be awesome. Thanks","link":"https://stackoverflow.com/questions/77556288/unable-to-get-micronauttest-to-work-with-a-post-against-the-httpclient#comment136755785_77556288","body":"It worked! Thanks. @Szymon, can you post your comment as an answer and I&#39;ll accept? I could do it myself, but you don&#39;t get credit then! If you (know and) could address why it works from command line but not from the tests, that would be awesome. Thanks"}],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1701768400,"post_id":77605053,"comment_id":136813629,"body_markdown":"@szymon-stepniak, deserves credit for this, based on his comment. If you post an answer, I&#39;ll remove this and accept yours to give credit","link":"https://stackoverflow.com/questions/77556288/unable-to-get-micronauttest-to-work-with-a-post-against-the-httpclient/77605053#comment136813629_77605053","body":"@szymon-stepniak, deserves credit for this, based on his comment. If you post an answer, I&#39;ll remove this and accept yours to give credit"}],"comment_count":1,"score":0,"last_activity_date":1701768283,"creation_date":1701768283,"answer_id":77605053,"question_id":77556288,"body_markdown":"_Answer from comment from @szymon-stepniak_\r\n\r\nWithin the post method declaration, make sure there is a `@Body` annotation on the incoming data packet\r\n\r\n```java\r\n@Controller(&quot;/people&quot;)\r\n// ...\r\npublic class PersonController {\r\n   // ...\r\n\r\n  @Post\r\n  @Status(HttpStatus.CREATED)\r\n  public Person addPerson(@Valid @NotNull @Body final Person person) {\r\n    //Note the `@Body` in the method definition\r\n\r\n    final Person p = dataSvc.save(person);\r\n    //log it!\r\n    return p;\r\n  }\r\n}\r\n```\r\n\r\nUnsure why the endpoint would work but the test client fails without the annotation, but BOTH work if the annotation is added. ","link":"https://stackoverflow.com/questions/77556288/unable-to-get-micronauttest-to-work-with-a-post-against-the-httpclient/77605053#77605053","title":"Unable to get MicronautTest to work with a POST against the HttpClient","body":"<p><em>Answer from comment from @szymon-stepniak</em></p>\n<p>Within the post method declaration, make sure there is a <code>@Body</code> annotation on the incoming data packet</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Controller(&quot;/people&quot;)\n// ...\npublic class PersonController {\n   // ...\n\n  @Post\n  @Status(HttpStatus.CREATED)\n  public Person addPerson(@Valid @NotNull @Body final Person person) {\n    //Note the `@Body` in the method definition\n\n    final Person p = dataSvc.save(person);\n    //log it!\n    return p;\n  }\n}\n</code></pre>\n<p>Unsure why the endpoint would work but the test client fails without the annotation, but BOTH work if the annotation is added.</p>\n"}],"comment_count":3,"is_answered":true,"view_count":36,"answer_count":1,"score":0,"last_activity_date":1701768283,"creation_date":1701082108,"last_edit_date":1701087193,"question_id":77556288,"body_markdown":"I&#39;m implementing a web API as a micronaut service. I have tests against the GET endpoints working, but cannot get the POST endpoints working correctly. I receive an error response &#39;BAD REQUEST&#39;. The endpoint works correctly from command line `curl` or `http`(ie) POST requests.\r\n\r\nThe controller:\r\n``` java\r\n@Controller(&quot;/people&quot;)\r\n@ExecuteOn(TaskExecutors.IO)  //Make sure the controller is executed on a non-main thread pool so it does not block\r\npublic class PersonController {\r\n   private final DataService dataSvc;\r\n\r\n   public PersonController(final DataService dataSvc) {\r\n    this.dataSvc = dataSvc;\r\n  }\r\n\r\n  //Various GET endpoints\r\n\r\n  @Post   //I also tried adding &#39;(consumes = MediaType.APPLICATION_JSON, produces = MediaType.APPLICATION_JSON)&#39;. This had no effect\r\n  @Status(HttpStatus.CREATED)\r\n  public Person addPerson(@Valid @NotNull final Person person) {\r\n    final Person p = dataSvc.save(person);\r\n    //log it!\r\n    return p;\r\n  }\r\n}\r\n```\r\n_I have an exception handler handling `Throwable` and returning 500 (INTERNAL_SERVICE_ERROR)._\r\n\r\n_I also have a handler for `ConstraintViolationException`s, which returns a 412 (PRECONDITION_FAILED) response._\r\n\r\nTest that&#39;s failing is:\r\n``` java\r\n@MicronautTest\r\npublic class PersonControllerClient {\r\n  @Inject @Client(&quot;/people&quot;)\r\n  HttpClient client;\r\n\r\n  @Inject DataService dataSvc;\r\n  final DataService mock = mock(DataService.class);\r\n\r\n  //Various tests of the GET endpoints\r\n\r\n  @Test\r\n  @DisplayName(&quot;Add a person successfully&quot;)\r\n  public void testAddPersonHappypath() {\r\n    final Person.PersonBuilder pb = Person.builder().firstName(&quot;John&quot;).lastName(&quot;Doe&quot;);\r\n    final Person in = pb.build();\r\n    final Person expected = pb.id(&quot;1234&quot;).build();\r\n\r\n    try {\r\n      final HttpRequest&lt;Person&gt; request = HttpRequest.POST(&quot;/&quot;, in).contentType(MediaType.APPLICATION_JSON).accept(MediaType.APPLICATION_JSON);\r\n      //Note - I also tried having the client &#39;/&#39;, and the request endpoint &#39;/people&#39;, which failed in the same manner\r\n      //I also tried `HttpRequest.create(HttpMethod.POST, &quot;/people&quot;).body(in)` with same result. \r\n\r\n      when(mock.save(in)).thenReturn(expected);\r\n\r\n      final HttpResponse&lt;Person&gt; response = client.toBlocking().exchange(request, Person.class);\r\n      assertEquals(HttpStatus.CREATED, response.getStatus());\r\n\r\n      final Person body = response.body();\r\n      assertNotNull(body);\r\n      assertEquals(expected, body);\r\n    } catch (HttpClientResponseException ex) {\r\n      fail(String.format(&quot;Received exception (%s) - Status %d&quot;, ex.getMessage(), ex.getStatus().getCode()));\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nAs far as I can see, this *should* succeed, but it is going to the `fail` (catch block). \r\n\r\nI&#39;ve tried stepping through the test and it doesn&#39;t seem to be making it into the `PersonController` code at all, so it&#39;s something with how the POST query is being constructed.\r\n\r\nI&#39;m assuming I&#39;m creating the client incorrectly, but cannot see where. Any help would be appreciated.\r\n\r\n&gt; **Note** - I&#39;m moving from SpringBoot to Micronaut. Not sure if I&#39;m trying to apply Spring concepts where they shouldn&#39;t be!\r\n\r\n### More info\r\n\r\nI have added tests for the DELETE method, which succeed (both happy and unhappy paths). It&#39;s ONLY the POST requests that fail, with BAD REQUEST\r\n\r\nAlso, probably useful to have the `Person` data object\r\n``` java\r\n@MappedEntity\r\n@Data\r\n@EqualsAndHashCode\r\n@Builder\r\n@NoArgsConstructor\r\n@AllArgsConstructor\r\npublic class Person {\r\n  @Id\r\n  @GeneratedValue\r\n  String id;\r\n\r\n  @NotEmpty(message=&quot;First name cannot be empty&quot;)\r\n  String firstName;\r\n\r\n  @NotEmpty(message=&quot;Last name cannot be empty&quot;)\r\n  String lastName;\r\n\r\n  int age;\r\n}\r\n```\r\n_Lombok annotations to make this &#39;record&#39;ish. Not actually using `Record` as the validation annotations can&#39;t be applied to fields of a record (`target` for `NotEmpty` and `Id` annotations does not include `RECORD_COMPONENT`)_","link":"https://stackoverflow.com/questions/77556288/unable-to-get-micronauttest-to-work-with-a-post-against-the-httpclient","title":"Unable to get MicronautTest to work with a POST against the HttpClient","body":"<p>I'm implementing a web API as a micronaut service. I have tests against the GET endpoints working, but cannot get the POST endpoints working correctly. I receive an error response 'BAD REQUEST'. The endpoint works correctly from command line <code>curl</code> or <code>http</code>(ie) POST requests.</p>\n<p>The controller:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Controller(&quot;/people&quot;)\n@ExecuteOn(TaskExecutors.IO)  //Make sure the controller is executed on a non-main thread pool so it does not block\npublic class PersonController {\n   private final DataService dataSvc;\n\n   public PersonController(final DataService dataSvc) {\n    this.dataSvc = dataSvc;\n  }\n\n  //Various GET endpoints\n\n  @Post   //I also tried adding '(consumes = MediaType.APPLICATION_JSON, produces = MediaType.APPLICATION_JSON)'. This had no effect\n  @Status(HttpStatus.CREATED)\n  public Person addPerson(@Valid @NotNull final Person person) {\n    final Person p = dataSvc.save(person);\n    //log it!\n    return p;\n  }\n}\n</code></pre>\n<p><em>I have an exception handler handling <code>Throwable</code> and returning 500 (INTERNAL_SERVICE_ERROR).</em></p>\n<p><em>I also have a handler for <code>ConstraintViolationException</code>s, which returns a 412 (PRECONDITION_FAILED) response.</em></p>\n<p>Test that's failing is:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@MicronautTest\npublic class PersonControllerClient {\n  @Inject @Client(&quot;/people&quot;)\n  HttpClient client;\n\n  @Inject DataService dataSvc;\n  final DataService mock = mock(DataService.class);\n\n  //Various tests of the GET endpoints\n\n  @Test\n  @DisplayName(&quot;Add a person successfully&quot;)\n  public void testAddPersonHappypath() {\n    final Person.PersonBuilder pb = Person.builder().firstName(&quot;John&quot;).lastName(&quot;Doe&quot;);\n    final Person in = pb.build();\n    final Person expected = pb.id(&quot;1234&quot;).build();\n\n    try {\n      final HttpRequest&lt;Person&gt; request = HttpRequest.POST(&quot;/&quot;, in).contentType(MediaType.APPLICATION_JSON).accept(MediaType.APPLICATION_JSON);\n      //Note - I also tried having the client '/', and the request endpoint '/people', which failed in the same manner\n      //I also tried `HttpRequest.create(HttpMethod.POST, &quot;/people&quot;).body(in)` with same result. \n\n      when(mock.save(in)).thenReturn(expected);\n\n      final HttpResponse&lt;Person&gt; response = client.toBlocking().exchange(request, Person.class);\n      assertEquals(HttpStatus.CREATED, response.getStatus());\n\n      final Person body = response.body();\n      assertNotNull(body);\n      assertEquals(expected, body);\n    } catch (HttpClientResponseException ex) {\n      fail(String.format(&quot;Received exception (%s) - Status %d&quot;, ex.getMessage(), ex.getStatus().getCode()));\n    }\n  }\n}\n</code></pre>\n<p>As far as I can see, this <em>should</em> succeed, but it is going to the <code>fail</code> (catch block).</p>\n<p>I've tried stepping through the test and it doesn't seem to be making it into the <code>PersonController</code> code at all, so it's something with how the POST query is being constructed.</p>\n<p>I'm assuming I'm creating the client incorrectly, but cannot see where. Any help would be appreciated.</p>\n<blockquote>\n<p><strong>Note</strong> - I'm moving from SpringBoot to Micronaut. Not sure if I'm trying to apply Spring concepts where they shouldn't be!</p>\n</blockquote>\n<h3>More info</h3>\n<p>I have added tests for the DELETE method, which succeed (both happy and unhappy paths). It's ONLY the POST requests that fail, with BAD REQUEST</p>\n<p>Also, probably useful to have the <code>Person</code> data object</p>\n<pre class=\"lang-java prettyprint-override\"><code>@MappedEntity\n@Data\n@EqualsAndHashCode\n@Builder\n@NoArgsConstructor\n@AllArgsConstructor\npublic class Person {\n  @Id\n  @GeneratedValue\n  String id;\n\n  @NotEmpty(message=&quot;First name cannot be empty&quot;)\n  String firstName;\n\n  @NotEmpty(message=&quot;Last name cannot be empty&quot;)\n  String lastName;\n\n  int age;\n}\n</code></pre>\n<p><em>Lombok annotations to make this 'record'ish. Not actually using <code>Record</code> as the validation annotations can't be applied to fields of a record (<code>target</code> for <code>NotEmpty</code> and <code>Id</code> annotations does not include <code>RECORD_COMPONENT</code>)</em></p>\n"},{"tags":["java","spring-boot","amazon-s3","aws-sdk"],"comments":[{"score":0,"post_type":"question","creation_date":1701543796,"post_id":77562607,"comment_id":136789891,"body_markdown":"404 suggest that the Multipart isn&#39;t located. Could that be due to authentication parameters? Reference: https://docs.aws.amazon.com/AmazonS3/latest/API/API_AbortMultipartUpload.html#API_AbortMultipartUpload_Errors","link":"https://stackoverflow.com/questions/77562607/problem-with-abortmultipart-using-s3-mock-findify#comment136789891_77562607","body":"404 suggest that the Multipart isn&#39;t located. Could that be due to authentication parameters? Reference: <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/API/API_AbortMultipartUpload.html#API_AbortMultipartUpload_Errors\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/AmazonS3/latest/API/&hellip;</a>"},{"score":0,"post_type":"question","creation_date":1701764867,"post_id":77562607,"comment_id":136813006,"body_markdown":"Could you share the response body associated with the 404 NOT_FOUND request/response of the AbortUploadRequest ?","link":"https://stackoverflow.com/questions/77562607/problem-with-abortmultipart-using-s3-mock-findify#comment136813006_77562607","body":"Could you share the response body associated with the 404 NOT_FOUND request/response of the AbortUploadRequest ?"}],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1701812464,"post_id":77604932,"comment_id":136821242,"body_markdown":"This helped me, thats true I initiated the upload but didn&#39;t upload any part, I&#39;m gonna try uploading one part but I&#39;m sure will be this, thanks!","link":"https://stackoverflow.com/questions/77562607/problem-with-abortmultipart-using-s3-mock-findify/77604932#comment136821242_77604932","body":"This helped me, thats true I initiated the upload but didn&#39;t upload any part, I&#39;m gonna try uploading one part but I&#39;m sure will be this, thanks!"},{"score":0,"post_type":"answer","creation_date":1702284683,"post_id":77604932,"comment_id":136872999,"body_markdown":"sadly it didnt work, i have 5 parts uploaded and still returns a 404","link":"https://stackoverflow.com/questions/77562607/problem-with-abortmultipart-using-s3-mock-findify/77604932#comment136872999_77604932","body":"sadly it didnt work, i have 5 parts uploaded and still returns a 404"},{"score":0,"post_type":"answer","creation_date":1702286145,"post_id":77604932,"comment_id":136873195,"body_markdown":"Could you share both request / responses from `MultiPartUploadRequest` and `AbortMultipartUploadRequest` ?","link":"https://stackoverflow.com/questions/77562607/problem-with-abortmultipart-using-s3-mock-findify/77604932#comment136873195_77604932","body":"Could you share both request / responses from <code>MultiPartUploadRequest</code> and <code>AbortMultipartUploadRequest</code> ?"}],"comment_count":3,"score":1,"last_activity_date":1701766821,"creation_date":1701766821,"answer_id":77604932,"question_id":77562607,"body_markdown":"Did you initiate the real upload after creating the MultiPartUploadRequest ?\r\n\r\nAccording to [documentation](https://docs.aws.amazon.com/AmazonS3/latest/userguide/abort-mpu.html) :\r\n\r\n&gt; After you initiate a multipart upload, you begin uploading parts. Amazon S3 stores these parts, but it creates the object from the parts only after you upload all of them and send a successful request to complete the multipart upload (you should verify that your request to complete multipart upload is successful).\r\n\r\n&gt; You can stop an in-progress multipart upload in Amazon S3 using the AWS Command Line Interface (AWS CLI), REST API, or AWS SDKs. You can also stop an incomplete multipart upload using a bucket lifecycle configuration.\r\n\r\nSo if you only created the MultiPartUploadRequest but didnt really upload parts using the UploadPart function, it should be normal that the S3 client returns 404 on the abort since nothing is associated with the UploadId.\r\n\r\nAlso see this [documentation](https://docs.aws.amazon.com/AmazonS3/latest/userguide/mpuoverview.html) should help.","link":"https://stackoverflow.com/questions/77562607/problem-with-abortmultipart-using-s3-mock-findify/77604932#77604932","title":"Problem with abortMultiPart using S3 mock findify","body":"<p>Did you initiate the real upload after creating the MultiPartUploadRequest ?</p>\n<p>According to <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/abort-mpu.html\" rel=\"nofollow noreferrer\">documentation</a> :</p>\n<blockquote>\n<p>After you initiate a multipart upload, you begin uploading parts. Amazon S3 stores these parts, but it creates the object from the parts only after you upload all of them and send a successful request to complete the multipart upload (you should verify that your request to complete multipart upload is successful).</p>\n</blockquote>\n<blockquote>\n<p>You can stop an in-progress multipart upload in Amazon S3 using the AWS Command Line Interface (AWS CLI), REST API, or AWS SDKs. You can also stop an incomplete multipart upload using a bucket lifecycle configuration.</p>\n</blockquote>\n<p>So if you only created the MultiPartUploadRequest but didnt really upload parts using the UploadPart function, it should be normal that the S3 client returns 404 on the abort since nothing is associated with the UploadId.</p>\n<p>Also see this <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/mpuoverview.html\" rel=\"nofollow noreferrer\">documentation</a> should help.</p>\n"}],"comment_count":2,"is_answered":true,"view_count":131,"answer_count":1,"score":0,"last_activity_date":1701766821,"creation_date":1701163198,"question_id":77562607,"body_markdown":"I&#39;m trying to cancel a multiPartUpload that won&#39;t be completed, I&#39;m making the request to initiate the upload with the following code\r\n\r\n          CreateMultipartUploadRequest request = CreateMultipartUploadRequest.builder()\r\n         .bucket(bucket).key(destinationUrl).build();\r\n      CreateMultipartUploadResponse multipart = s3Client.createMultipartUpload(request);\r\n      return multipart.uploadId();\r\n\r\nThe CreateMultipartUploadResponse has the three values, bucket, key and uploadId\r\nI&#39;m passing the same 3 values to cancel the upload and it returns 404 not found\r\n\r\n      var abortUploadRequest = AbortMultipartUploadRequest.builder()\r\n      .uploadId(uploadId)\r\n      .bucket(bucket)\r\n      .key(key)\r\n      .build();\r\n      s3Client.abortMultipartUpload(abortUploadRequest);\r\n\r\nany idea why? the upload of the file works fine","link":"https://stackoverflow.com/questions/77562607/problem-with-abortmultipart-using-s3-mock-findify","title":"Problem with abortMultiPart using S3 mock findify","body":"<p>I'm trying to cancel a multiPartUpload that won't be completed, I'm making the request to initiate the upload with the following code</p>\n<pre><code>      CreateMultipartUploadRequest request = CreateMultipartUploadRequest.builder()\n     .bucket(bucket).key(destinationUrl).build();\n  CreateMultipartUploadResponse multipart = s3Client.createMultipartUpload(request);\n  return multipart.uploadId();\n</code></pre>\n<p>The CreateMultipartUploadResponse has the three values, bucket, key and uploadId\nI'm passing the same 3 values to cancel the upload and it returns 404 not found</p>\n<pre><code>  var abortUploadRequest = AbortMultipartUploadRequest.builder()\n  .uploadId(uploadId)\n  .bucket(bucket)\n  .key(key)\n  .build();\n  s3Client.abortMultipartUpload(abortUploadRequest);\n</code></pre>\n<p>any idea why? the upload of the file works fine</p>\n"},{"tags":["java","maven","visual-studio-code","gradle"],"comments":[{"score":0,"post_type":"question","creation_date":1677569711,"post_id":75578686,"comment_id":133358818,"body_markdown":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking.\n\nPlease see [how to ask](https://stackoverflow.com/help/how-to-ask).\n\n[minimal reproducible example](https://stackoverflow.com/help/minimal-reproducible-example)","link":"https://stackoverflow.com/questions/75578686/java-maven-project-in-vscode-unable-to-find-valid-certification-path-to-request#comment133358818_75578686","body":"Please clarify your specific problem or provide additional details to highlight exactly what you need. As it&#39;s currently written, it&#39;s hard to tell exactly what you&#39;re asking.  Please see <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask</a>.  <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1678284866,"post_id":75668679,"comment_id":133502818,"body_markdown":"Thanks! that clarifies a lot. But unfortunately I tried both options and I&#39;m still getting the error :(","link":"https://stackoverflow.com/questions/75578686/java-maven-project-in-vscode-unable-to-find-valid-certification-path-to-request/75668679#comment133502818_75668679","body":"Thanks! that clarifies a lot. But unfortunately I tried both options and I&#39;m still getting the error :("},{"score":0,"post_type":"answer","creation_date":1701764976,"post_id":75668679,"comment_id":136813029,"body_markdown":"Thanks! for me first option worked. I was using remote-development with Java project. After doing following steps, PKIX errors with pom.xml went away,\n```\n# Set JAVA_HOME to path of your VSCode JRE\nexport JAVA_HOME=~/.vscode-server/extensions/redhat.java-1.25.0/jre/17.0.9-linux-x86_64/\n# Import certs\n$JAVA_HOME/bin/keytool -import -trustcacerts -storepass changeit -noprompt -alias mycert -file ~/certs/certificate.crt -cacerts\n```","link":"https://stackoverflow.com/questions/75578686/java-maven-project-in-vscode-unable-to-find-valid-certification-path-to-request/75668679#comment136813029_75668679","body":"Thanks! for me first option worked. I was using remote-development with Java project. After doing following steps, PKIX errors with pom.xml went away, ``` # Set JAVA_HOME to path of your VSCode JRE export JAVA_HOME=~/.vscode-server/extensions/redhat.java-1.25.0/jre&zwnj;&#8203;/17.0.9-linux-x86_64&zwnj;&#8203;/ # Import certs $JAVA_HOME/bin/keytool -import -trustcacerts -storepass changeit -noprompt -alias mycert -file ~/certs/certificate.crt -cacerts ```"}],"comment_count":2,"score":2,"last_activity_date":1678246582,"last_edit_date":1678246582,"creation_date":1678238882,"answer_id":75668679,"question_id":75578686,"body_markdown":"Trying to resolve this problem for my environment, I found your comment\r\n&gt; It seems that the &quot;Language Support for Java&quot; (VSCode plugin) is using a different jdk ...\r\n\r\nwas the key to discovering a fix in my case.\r\n[This link][1] explains that the extension does use an embedded JRE and also provides a resolution to the problem.\r\n\r\nThe embedded JRE is located at (depending on extension version and operating system):\r\n```\r\n.vscode/extensions/redhat.java-1.15.0-linux-x64/jre\r\n```\r\nwhich is usually located directly under `$HOME` on Linux and MacOS or `%USERPROFILE%` on Windows. The embedded JRE has a `cacerts` file, for example:\r\n```\r\n.vscode/extensions/redhat.java-1.15.0-linux-x64/jre/17.0.6-linux-x86_64/lib/security/cacerts\r\n```\r\n\r\nTo resolve the problem you can either:\r\n1. add the required certificates to the embedded JRE `cacerts` file, *however, you will need to repeat this every time the extension is updated*, or\r\n2. configure the embedded JRE to use another certificate store file that contains the required certificates by modifying the VSCode user settings (`settings.xml` file) `&quot;java.jdt.ls.vmargs&quot;` entry to *append* the properties:\r\n   ```\r\n   &quot;-Djavax.net.ssl.trustStore=path/to/other/cacerts -Djavax.net.ssl.trustStorePassword=changeit&quot;\r\n   ```\r\n   substituting the correct certificate store path and password.\r\n\r\nIn the case of option 2 you can simply use the path to the Open JDK 11 `cacerts` file that you have already modified.\r\n\r\n  [1]: https://github.com/redhat-developer/vscode-java/issues/2259","link":"https://stackoverflow.com/questions/75578686/java-maven-project-in-vscode-unable-to-find-valid-certification-path-to-request/75668679#75668679","title":"Java Maven project in VSCode: unable to find valid certification path to requested target","body":"<p>Trying to resolve this problem for my environment, I found your comment</p>\n<blockquote>\n<p>It seems that the &quot;Language Support for Java&quot; (VSCode plugin) is using a different jdk ...</p>\n</blockquote>\n<p>was the key to discovering a fix in my case.\n<a href=\"https://github.com/redhat-developer/vscode-java/issues/2259\" rel=\"nofollow noreferrer\">This link</a> explains that the extension does use an embedded JRE and also provides a resolution to the problem.</p>\n<p>The embedded JRE is located at (depending on extension version and operating system):</p>\n<pre><code>.vscode/extensions/redhat.java-1.15.0-linux-x64/jre\n</code></pre>\n<p>which is usually located directly under <code>$HOME</code> on Linux and MacOS or <code>%USERPROFILE%</code> on Windows. The embedded JRE has a <code>cacerts</code> file, for example:</p>\n<pre><code>.vscode/extensions/redhat.java-1.15.0-linux-x64/jre/17.0.6-linux-x86_64/lib/security/cacerts\n</code></pre>\n<p>To resolve the problem you can either:</p>\n<ol>\n<li>add the required certificates to the embedded JRE <code>cacerts</code> file, <em>however, you will need to repeat this every time the extension is updated</em>, or</li>\n<li>configure the embedded JRE to use another certificate store file that contains the required certificates by modifying the VSCode user settings (<code>settings.xml</code> file) <code>&quot;java.jdt.ls.vmargs&quot;</code> entry to <em>append</em> the properties:\n<pre><code>&quot;-Djavax.net.ssl.trustStore=path/to/other/cacerts -Djavax.net.ssl.trustStorePassword=changeit&quot;\n</code></pre>\nsubstituting the correct certificate store path and password.</li>\n</ol>\n<p>In the case of option 2 you can simply use the path to the Open JDK 11 <code>cacerts</code> file that you have already modified.</p>\n"},{"comment_count":0,"score":0,"last_activity_date":1690880038,"creation_date":1690880038,"answer_id":76810007,"question_id":75578686,"body_markdown":"Starting with Maven 3.9 they changed the default Transport implementation to **native**.\r\n\r\nTry with this option to disable SSL verifications:\r\n\r\n    mvn compile -Daether.connector.https.securityMode=insecure\r\n\r\nBackground:\r\nhttps://maven.apache.org/resolver/configuration.html","link":"https://stackoverflow.com/questions/75578686/java-maven-project-in-vscode-unable-to-find-valid-certification-path-to-request/76810007#76810007","title":"Java Maven project in VSCode: unable to find valid certification path to requested target","body":"<p>Starting with Maven 3.9 they changed the default Transport implementation to <strong>native</strong>.</p>\n<p>Try with this option to disable SSL verifications:</p>\n<pre><code>mvn compile -Daether.connector.https.securityMode=insecure\n</code></pre>\n<p>Background:\n<a href=\"https://maven.apache.org/resolver/configuration.html\" rel=\"nofollow noreferrer\">https://maven.apache.org/resolver/configuration.html</a></p>\n"},{"comment_count":0,"score":0,"last_activity_date":1701765121,"creation_date":1701765121,"answer_id":77604763,"question_id":75578686,"body_markdown":"For me first option from above answer worked. I was using VS Code Remote Development with Java project. After doing following steps, PKIX errors with pom.xml went away,\r\n```\r\n# Set JAVA_HOME to path of your VSCode JRE\r\nexport JAVA_HOME=~/.vscode-server/extensions/redhat.java-1.25.0/jre/17.0.9-linux-x86_64/\r\n# Import certs\r\n$JAVA_HOME/bin/keytool -import -trustcacerts -storepass changeit -noprompt -alias mycert -file ~/certs/certificate.crt -cacerts\r\n```\r\nhttps://github.com/redhat-developer/vscode-java/wiki/Use-proper-cacerts-to-import-Java-projects also helps.","link":"https://stackoverflow.com/questions/75578686/java-maven-project-in-vscode-unable-to-find-valid-certification-path-to-request/77604763#77604763","title":"Java Maven project in VSCode: unable to find valid certification path to requested target","body":"<p>For me first option from above answer worked. I was using VS Code Remote Development with Java project. After doing following steps, PKIX errors with pom.xml went away,</p>\n<pre><code># Set JAVA_HOME to path of your VSCode JRE\nexport JAVA_HOME=~/.vscode-server/extensions/redhat.java-1.25.0/jre/17.0.9-linux-x86_64/\n# Import certs\n$JAVA_HOME/bin/keytool -import -trustcacerts -storepass changeit -noprompt -alias mycert -file ~/certs/certificate.crt -cacerts\n</code></pre>\n<p><a href=\"https://github.com/redhat-developer/vscode-java/wiki/Use-proper-cacerts-to-import-Java-projects\" rel=\"nofollow noreferrer\">https://github.com/redhat-developer/vscode-java/wiki/Use-proper-cacerts-to-import-Java-projects</a> also helps.</p>\n"}],"comment_count":1,"is_answered":true,"view_count":2132,"answer_count":3,"score":1,"last_activity_date":1701765121,"creation_date":1677489979,"question_id":75578686,"body_markdown":"Full disclaimer: **I&#39;m not a Java expert**.\r\n\r\nMy work group developed a Java project, managed by maven, which should be compiled against jdk-11. They all use IntelliJ and I was able to set it up on this platform. I&#39;m now trying to do the same setup on VSCode, because I&#39;m more familiar with it.\r\n\r\nI installed openjdk-11, added the relevant `cacerts` in `/Library/Java/JavaVirtualMachines/adoptopenjdk-11.jdk/Contents/Home/lib/security`, pointed VSCode to this version and to the same maven executable used by IntelliJ for compiling. \r\n\r\nI can correctly compile the project by doing `mvn clean install` and run part of the application in the Run/Debug window (only had to manually add all the `classPaths` in `launch.json`). However the &quot;Language Support for Java&quot; tab in the Output window still shows me this error\r\n\r\n```\r\nCannot download published Gradle versions.\r\norg.gradle.api.UncheckedIOException: Cannot download published Gradle versions.\r\n....\r\nCaused by: javax.net.ssl.SSLHandshakeException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target\r\n...\r\nCaused by: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target\r\n...\r\n[Error - 10:18:41] 27 Feb 2023, 10:18:41 Error occured while building workspace. Details: \r\n message: The project cannot be built until build path errors are resolved;\r\n```\r\n\r\nIt seems that the &quot;Language Support for Java&quot; is using a different jdk with no cacerts installed, but somehow I cannot figure out where this version is located. I tried to specify the right `java_home` wherever I could in VSCode (also in Gradle) but somehow I cannot get rid of this error.\r\nI don&#39;t know if this is really a problem or not, as the project is compiling when I launch maven, but it would be good to fix it. To me it is not really clear at the moment how many different &quot;layers&quot; are used when opening a java project like this in VSCode. ","link":"https://stackoverflow.com/questions/75578686/java-maven-project-in-vscode-unable-to-find-valid-certification-path-to-request","title":"Java Maven project in VSCode: unable to find valid certification path to requested target","body":"<p>Full disclaimer: <strong>I'm not a Java expert</strong>.</p>\n<p>My work group developed a Java project, managed by maven, which should be compiled against jdk-11. They all use IntelliJ and I was able to set it up on this platform. I'm now trying to do the same setup on VSCode, because I'm more familiar with it.</p>\n<p>I installed openjdk-11, added the relevant <code>cacerts</code> in <code>/Library/Java/JavaVirtualMachines/adoptopenjdk-11.jdk/Contents/Home/lib/security</code>, pointed VSCode to this version and to the same maven executable used by IntelliJ for compiling.</p>\n<p>I can correctly compile the project by doing <code>mvn clean install</code> and run part of the application in the Run/Debug window (only had to manually add all the <code>classPaths</code> in <code>launch.json</code>). However the &quot;Language Support for Java&quot; tab in the Output window still shows me this error</p>\n<pre><code>Cannot download published Gradle versions.\norg.gradle.api.UncheckedIOException: Cannot download published Gradle versions.\n....\nCaused by: javax.net.ssl.SSLHandshakeException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target\n...\nCaused by: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target\n...\n[Error - 10:18:41] 27 Feb 2023, 10:18:41 Error occured while building workspace. Details: \n message: The project cannot be built until build path errors are resolved;\n</code></pre>\n<p>It seems that the &quot;Language Support for Java&quot; is using a different jdk with no cacerts installed, but somehow I cannot figure out where this version is located. I tried to specify the right <code>java_home</code> wherever I could in VSCode (also in Gradle) but somehow I cannot get rid of this error.\nI don't know if this is really a problem or not, as the project is compiling when I launch maven, but it would be good to fix it. To me it is not really clear at the moment how many different &quot;layers&quot; are used when opening a java project like this in VSCode.</p>\n"},{"tags":["java","apache-spark","jdbc","concurrency"],"comment_count":0,"is_answered":false,"view_count":50,"answer_count":0,"score":2,"last_activity_date":1701764405,"creation_date":1701332267,"last_edit_date":1701764405,"question_id":77576862,"body_markdown":"We have dataset with column named &quot;table&quot; to save to jdbc depend on table value.\r\n\r\nWe should filter by table and each result store to own table.\r\n\r\n    final Dataset&lt;Row&gt; dust = (create dataset).cache();\r\n\r\n        final List&lt;Object&gt; tables = dust.select(&quot;table&quot;)\r\n            .collectAsList()\r\n            .stream()\r\n            .map(s -&gt; s.getAs(&quot;table&quot;))\r\n            .collect(Collectors.toList());\r\n\r\n        tables.forEach(table -&gt; {\r\n            final Dataset&lt;Row&gt; tableDs = dust.filter(col(&quot;table&quot;).equalTo(table)).drop(col(&quot;table&quot;));\r\n            tableDs.write()\r\n                .format(&quot;jdbc&quot;)\r\n                .option(URL, etlConfig.getUrl() + &quot;?currentSchema=&quot; + schema)\r\n                .option(USER, etlConfig.getUserName())\r\n                .option(PASSWORD, etlConfig.getPassword())\r\n                .option(DRIVER, ORG_POSTGRESQL_DRIVER)\r\n                .option(DB_TABLE, tableName)\r\n                .mode(APPEND)\r\n                .save();\r\n        });\r\n\r\n\r\n1. How do we replace `tables.forEach` to repartition by column &quot;table&quot; to save into different tables simultaneously?\r\n\r\n   Each time of `tables.forEach`, we wait for &quot;write&quot; operation.\r\n\r\n2. I don&#39;t want to use Java concurrency features like `ExecutorService` or others. Because I want to remove `...cache();` and perform changes through one pipe (create dataset =&gt; filter by table =&gt; save to jdbc). All save to tables start simultaneously (not one by one)\r\n\r\n\r\nI soe https://stackoverflow.com/questions/58006110/spark-scala-how-to-save-a-grouped-dataframe-to-different-files\r\n\r\nin this case we cannot save to jdbc because need set  .option(DB_TABLE, tableName) But idea with partitionBy is quite good!","link":"https://stackoverflow.com/questions/77576862/how-to-store-dataset-to-jdbc-simultatiously-to-different-tables","title":"How to store dataset to jdbc simultatiously to different tables?","body":"<p>We have dataset with column named &quot;table&quot; to save to jdbc depend on table value.</p>\n<p>We should filter by table and each result store to own table.</p>\n<pre><code>final Dataset&lt;Row&gt; dust = (create dataset).cache();\n\n    final List&lt;Object&gt; tables = dust.select(&quot;table&quot;)\n        .collectAsList()\n        .stream()\n        .map(s -&gt; s.getAs(&quot;table&quot;))\n        .collect(Collectors.toList());\n\n    tables.forEach(table -&gt; {\n        final Dataset&lt;Row&gt; tableDs = dust.filter(col(&quot;table&quot;).equalTo(table)).drop(col(&quot;table&quot;));\n        tableDs.write()\n            .format(&quot;jdbc&quot;)\n            .option(URL, etlConfig.getUrl() + &quot;?currentSchema=&quot; + schema)\n            .option(USER, etlConfig.getUserName())\n            .option(PASSWORD, etlConfig.getPassword())\n            .option(DRIVER, ORG_POSTGRESQL_DRIVER)\n            .option(DB_TABLE, tableName)\n            .mode(APPEND)\n            .save();\n    });\n</code></pre>\n<ol>\n<li><p>How do we replace <code>tables.forEach</code> to repartition by column &quot;table&quot; to save into different tables simultaneously?</p>\n<p>Each time of <code>tables.forEach</code>, we wait for &quot;write&quot; operation.</p>\n</li>\n<li><p>I don't want to use Java concurrency features like <code>ExecutorService</code> or others. Because I want to remove <code>...cache();</code> and perform changes through one pipe (create dataset =&gt; filter by table =&gt; save to jdbc). All save to tables start simultaneously (not one by one)</p>\n</li>\n</ol>\n<p>I soe <a href=\"https://stackoverflow.com/questions/58006110/spark-scala-how-to-save-a-grouped-dataframe-to-different-files\">Spark Scala: How to save a grouped Dataframe to different files?</a></p>\n<p>in this case we cannot save to jdbc because need set  .option(DB_TABLE, tableName) But idea with partitionBy is quite good!</p>\n"},{"tags":["java","playframework","sbt","jacoco","jacoco-plugin"],"answers":[{"comment_count":0,"score":1,"last_activity_date":1701764072,"creation_date":1701764072,"answer_id":77604675,"question_id":77477907,"body_markdown":"Just add `addSbtPlugin(&quot;com.github.sbt&quot; % &quot;sbt-jacoco&quot; % &quot;3.4.0&quot;)` to your `plugins.sbt` and execute `sbt jacoco`. After that you should see a HTML report in your path `target/scala-2.13/jacoco/report/`\r\n\r\nYou can configure jacoco by you needs e.g. generating a HTML and a XML by adding\r\n```scala\r\njacocoReportSettings := JacocoReportSettings().withFormats(JacocoReportFormats.XML, JacocoReportFormats.HTML)\r\n```\r\nin your `build.sbt`.\r\n\r\nMore information: https://www.scala-sbt.org/sbt-jacoco/","link":"https://stackoverflow.com/questions/77477907/how-to-configure-jacoco-code-coverage-report-into-java-play-framwork-project/77604675#77604675","title":"How to Configure Jacoco code coverage report into Java Play framwork project?","body":"<p>Just add <code>addSbtPlugin(&quot;com.github.sbt&quot; % &quot;sbt-jacoco&quot; % &quot;3.4.0&quot;)</code> to your <code>plugins.sbt</code> and execute <code>sbt jacoco</code>. After that you should see a HTML report in your path <code>target/scala-2.13/jacoco/report/</code></p>\n<p>You can configure jacoco by you needs e.g. generating a HTML and a XML by adding</p>\n<pre class=\"lang-scala prettyprint-override\"><code>jacocoReportSettings := JacocoReportSettings().withFormats(JacocoReportFormats.XML, JacocoReportFormats.HTML)\n</code></pre>\n<p>in your <code>build.sbt</code>.</p>\n<p>More information: <a href=\"https://www.scala-sbt.org/sbt-jacoco/\" rel=\"nofollow noreferrer\">https://www.scala-sbt.org/sbt-jacoco/</a></p>\n"}],"comment_count":0,"is_answered":true,"view_count":36,"answer_count":1,"score":0,"last_activity_date":1701764072,"creation_date":1699929723,"last_edit_date":1699964448,"question_id":77477907,"body_markdown":"Can someone please give example of how I can set up `jacoco` report into play project? MY `Plugin.sbt` looks like below\r\n```` \r\nresolvers += Resolver.sonatypeRepo(&quot;public&quot;) // (not entirely sure this line is necessary)\r\naddSbtPlugin(&quot;de.johoop&quot; % &quot;jacoco4sbt&quot; % &quot;2.3.0&quot;)\r\n````\r\nand this is `val playVersion = &quot;2.6.25&quot;`\r\n\r\nI tried \r\n````\r\naddSbtPlugin(&quot;de.johoop&quot; % &quot;jacoco4sbt&quot; % &quot;2.3.0&quot;) \r\n````\r\nin `plugin.sbt`\r\nbut when trying to run `activator jacoco:cover`\r\nmy `jacoco` folder not creating\r\nCan some one please guide me ?","link":"https://stackoverflow.com/questions/77477907/how-to-configure-jacoco-code-coverage-report-into-java-play-framwork-project","title":"How to Configure Jacoco code coverage report into Java Play framwork project?","body":"<p>Can someone please give example of how I can set up <code>jacoco</code> report into play project? MY <code>Plugin.sbt</code> looks like below</p>\n<pre><code>resolvers += Resolver.sonatypeRepo(&quot;public&quot;) // (not entirely sure this line is necessary)\naddSbtPlugin(&quot;de.johoop&quot; % &quot;jacoco4sbt&quot; % &quot;2.3.0&quot;)\n</code></pre>\n<p>and this is <code>val playVersion = &quot;2.6.25&quot;</code></p>\n<p>I tried</p>\n<pre><code>addSbtPlugin(&quot;de.johoop&quot; % &quot;jacoco4sbt&quot; % &quot;2.3.0&quot;) \n</code></pre>\n<p>in <code>plugin.sbt</code>\nbut when trying to run <code>activator jacoco:cover</code>\nmy <code>jacoco</code> folder not creating\nCan some one please guide me ?</p>\n"},{"tags":["java","pdf","docx","documents4j"],"comments":[{"score":0,"post_type":"question","creation_date":1675000458,"post_id":75230225,"comment_id":132829826,"body_markdown":"Comments are not for extended discussion; this conversation has been [moved to chat](https://chat.stackoverflow.com/rooms/251473/discussion-on-question-by-anshu-convert-docx-to-pdf-with-documents4j-library).","link":"https://stackoverflow.com/questions/75230225/convert-docx-to-pdf-with-documents4j-which-internally-uses-vbscript-for-the-con#comment132829826_75230225","body":"Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/251473/discussion-on-question-by-anshu-convert-docx-to-pdf-with-documents4j-library\">moved to chat</a>."}],"answers":[{"comment_count":0,"score":0,"last_activity_date":1701763428,"last_edit_date":1701763428,"creation_date":1701763164,"answer_id":77604620,"question_id":75230225,"body_markdown":"I had this issue and my conclusion is that you need to create the service that runs the document conversion with the same user that runs the service if you won&#39;t do it it will run with local system(or with any other user you set to run which is different from the one who created the service) and will try to create and read folders of the user that created the service and then it will get stuck.\r\nAfter I created the service with admin user and also ran the service with the same user it fixed my issue.\r\nIn addition as mentioned you should also make sure that the following folders exists and if not create them:\r\n\r\nC:\\Windows\\SysWOW64\\config\\systemprofile\\Desktop\r\nC:\\Windows\\System32\\config\\systemprofile\\Desktop\r\n\r\n\r\nIn case you don&#39;t have permission to log in to the system with the admin user but you have it credentials you can create the service with Task scheduler and create a one time task that will run the service creation as the admin user and then set the same user to run the service\r\n","link":"https://stackoverflow.com/questions/75230225/convert-docx-to-pdf-with-documents4j-which-internally-uses-vbscript-for-the-con/77604620#77604620","title":"Convert DOCX to PDF with documents4j (Which Internally uses VBScript for the conversion)","body":"<p>I had this issue and my conclusion is that you need to create the service that runs the document conversion with the same user that runs the service if you won't do it it will run with local system(or with any other user you set to run which is different from the one who created the service) and will try to create and read folders of the user that created the service and then it will get stuck.\nAfter I created the service with admin user and also ran the service with the same user it fixed my issue.\nIn addition as mentioned you should also make sure that the following folders exists and if not create them:</p>\n<p>C:\\Windows\\SysWOW64\\config\\systemprofile\\Desktop\nC:\\Windows\\System32\\config\\systemprofile\\Desktop</p>\n<p>In case you don't have permission to log in to the system with the admin user but you have it credentials you can create the service with Task scheduler and create a one time task that will run the service creation as the admin user and then set the same user to run the service</p>\n"}],"comment_count":1,"is_answered":false,"view_count":480,"answer_count":1,"score":0,"last_activity_date":1701763428,"creation_date":1674626815,"last_edit_date":1675233872,"question_id":75230225,"body_markdown":"The following is the simple code snippet which I am trying to use to convert a DOCX file into a PDF on my local system, which is as it is picked up from http://documents4j.com/#/.\r\n\r\n 1. Running this piece of code as a part of service inside a web app (.war) deployed on **Tomcat 9.0.37** which is running as Windows service.\r\n 2. Created the below folder C:\\Windows\\SysWOW64\\config\\systemprofile\\Desktop (**Running documents4j application as Windows service**).\r\n 3. MS Office professional 2016 is installed (**licenced copy**).\r\n\r\nWell with same configuration on **VM 1: Windows server 2012** and **VM 2: Windows server 2019** as mentioned in above three points. I&#39;m able to convert the DOCX to PDF in my **VM 1 : Windows server 2012**. But the below problem I&#39;m facing in **VM 2: Windows server 2019**.\r\n\r\nOn calling execute method the current thread is getting blocked for forever, which leads to memory leak. Please find the below error on execute method. \r\n\r\n```\r\norg.apache.catalina.loader.WebappClassLoaderBase.clearReferencesThreads The web application [appName] is still processing a request that has yet to finish. This is very likely to create a memory leak. You can control the time allowed for requests to finish by using the unloadDelay attribute of the standard Context implementation. Stack trace of request processing thread:[\r\n java.base@11.0.5/jdk.internal.misc.Unsafe.park(Native Method)\r\n java.base@11.0.5/java.util.concurrent.locks.LockSupport.park(LockSupport.java:194)\r\n java.base@11.0.5/java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:885)\r\n java.base@11.0.5/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1039)\r\n java.base@11.0.5/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)\r\n java.base@11.0.5/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)\r\n com.documents4j.job.AbstractFutureWrappingPriorityFuture.get(AbstractFutureWrappingPriorityFuture.java:204)\r\n com.documents4j.job.AbstractFutureWrappingPriorityFuture.get(AbstractFutureWrappingPriorityFuture.java:10)\r\n com.documents4j.job.ConversionJobAdapter.execute(ConversionJobAdapter.java:13)\r\n```\r\n\r\n**Code Snippet 1**:\r\n\r\n```\r\nimport java.io.File;\r\nimport java.io.FileInputStream;\r\nimport java.io.FileOutputStream;\r\nimport java.io.InputStream;\r\nimport java.io.OutputStream;\r\nimport com.documents4j.api.DocumentType;\r\nimport com.documents4j.api.IConverter;\r\nimport com.documents4j.job.LocalConverter;\r\n\r\npublic class WordMLToPDF2 {\r\n\r\n\tpublic static void main(String[] args) {\r\n\r\n\t\tFile inputWord  = new File(&quot;C:\\\\Users\\\\anshu\\\\Downloads\\\\test.docx&quot;)\r\n        , outputFile  = new File(&quot;C:\\\\Users\\\\anshu\\\\Downloads\\\\test.pdf&quot;);\r\n        try  {\r\n            InputStream docxInputStream = new FileInputStream(inputWord);\r\n            OutputStream outputStream = new FileOutputStream(outputFile);\r\n            IConverter converter = LocalConverter.builder()\r\n\t\t               .baseFolder(tmpDir)\r\n\t\t               .workerPool(20, 25, 2, TimeUnit.SECONDS)\r\n\t\t               .processTimeout(30, TimeUnit.SECONDS)\r\n\t\t               .build();\r\n            converter.convert(docxInputStream).as(DocumentType.DOCX).to(outputStream).as(DocumentType.PDF).execute();\r\n            outputStream.close();\r\n            System.out.println(&quot;success&quot;);\r\n\t\t\tconverter.shutDown();\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n        }\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n```\r\nBelow dependencies which I&#39;ve configured in pom.xml\r\n\r\n```\r\n   &lt;dependencies&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.docx4j&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;docx4j-documents4j-local&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;8.3.3&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.docx4j&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;docx4j-JAXB-ReferenceImpl&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;8.3.3&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;log4j-slf4j-impl&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;2.17.1&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t\t&lt;!-- API, java.xml.bind module --&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;jakarta.xml.bind&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;jakarta.xml.bind-api&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;2.3.2&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;!-- Runtime, com.sun.xml.bind module --&gt;\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.glassfish.jaxb&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;jaxb-runtime&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;2.3.2&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\t&lt;/dependencies&gt;\r\n```\r\n\r\n**EDIT:**\r\n\r\nAfter analyzing the source code. What I understood is:\r\n\r\n+ Internally documents4j executes a VBScript with the help of another library zt-exec (ZeroTurnaround Process Executor) to start the WINWORD or for the conversion of DOCX to PDF or to stop the WINWORD\r\n\r\n+ WINWORD program freezes When it executes **wordApplication.Documents.Open(inputFile, False, True, False)** [word_convert][1]\r\n\r\n+ In above statement wordApplication holds the object of Word.Application\r\n\r\n    [word_start][2]\r\n    [word_convert][3]\r\n    [word_shutdwon][4]\r\n\r\n\r\n  [1]: https://github.com/documents4j/documents4j/blob/master/documents4j-transformer-msoffice/documents4j-transformer-msoffice-word/src/main/resources/word_convert.vbs#L37\r\n  [2]: https://github.com/documents4j/documents4j/blob/master/documents4j-transformer-msoffice/documents4j-transformer-msoffice-word/src/main/resources/word_start.vbs\r\n  [3]: https://github.com/documents4j/documents4j/blob/master/documents4j-transformer-msoffice/documents4j-transformer-msoffice-word/src/main/resources/word_convert.vbs\r\n  [4]: https://github.com/documents4j/documents4j/blob/master/documents4j-transformer-msoffice/documents4j-transformer-msoffice-word/src/main/resources/word_shutdown.vbs","link":"https://stackoverflow.com/questions/75230225/convert-docx-to-pdf-with-documents4j-which-internally-uses-vbscript-for-the-con","title":"Convert DOCX to PDF with documents4j (Which Internally uses VBScript for the conversion)","body":"<p>The following is the simple code snippet which I am trying to use to convert a DOCX file into a PDF on my local system, which is as it is picked up from <a href=\"http://documents4j.com/#/\" rel=\"nofollow noreferrer\">http://documents4j.com/#/</a>.</p>\n<ol>\n<li>Running this piece of code as a part of service inside a web app (.war) deployed on <strong>Tomcat 9.0.37</strong> which is running as Windows service.</li>\n<li>Created the below folder C:\\Windows\\SysWOW64\\config\\systemprofile\\Desktop (<strong>Running documents4j application as Windows service</strong>).</li>\n<li>MS Office professional 2016 is installed (<strong>licenced copy</strong>).</li>\n</ol>\n<p>Well with same configuration on <strong>VM 1: Windows server 2012</strong> and <strong>VM 2: Windows server 2019</strong> as mentioned in above three points. I'm able to convert the DOCX to PDF in my <strong>VM 1 : Windows server 2012</strong>. But the below problem I'm facing in <strong>VM 2: Windows server 2019</strong>.</p>\n<p>On calling execute method the current thread is getting blocked for forever, which leads to memory leak. Please find the below error on execute method.</p>\n<pre><code>org.apache.catalina.loader.WebappClassLoaderBase.clearReferencesThreads The web application [appName] is still processing a request that has yet to finish. This is very likely to create a memory leak. You can control the time allowed for requests to finish by using the unloadDelay attribute of the standard Context implementation. Stack trace of request processing thread:[\n java.base@11.0.5/jdk.internal.misc.Unsafe.park(Native Method)\n java.base@11.0.5/java.util.concurrent.locks.LockSupport.park(LockSupport.java:194)\n java.base@11.0.5/java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:885)\n java.base@11.0.5/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1039)\n java.base@11.0.5/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)\n java.base@11.0.5/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)\n com.documents4j.job.AbstractFutureWrappingPriorityFuture.get(AbstractFutureWrappingPriorityFuture.java:204)\n com.documents4j.job.AbstractFutureWrappingPriorityFuture.get(AbstractFutureWrappingPriorityFuture.java:10)\n com.documents4j.job.ConversionJobAdapter.execute(ConversionJobAdapter.java:13)\n</code></pre>\n<p><strong>Code Snippet 1</strong>:</p>\n<pre><code>import java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.InputStream;\nimport java.io.OutputStream;\nimport com.documents4j.api.DocumentType;\nimport com.documents4j.api.IConverter;\nimport com.documents4j.job.LocalConverter;\n\npublic class WordMLToPDF2 {\n\n    public static void main(String[] args) {\n\n        File inputWord  = new File(&quot;C:\\\\Users\\\\anshu\\\\Downloads\\\\test.docx&quot;)\n        , outputFile  = new File(&quot;C:\\\\Users\\\\anshu\\\\Downloads\\\\test.pdf&quot;);\n        try  {\n            InputStream docxInputStream = new FileInputStream(inputWord);\n            OutputStream outputStream = new FileOutputStream(outputFile);\n            IConverter converter = LocalConverter.builder()\n                       .baseFolder(tmpDir)\n                       .workerPool(20, 25, 2, TimeUnit.SECONDS)\n                       .processTimeout(30, TimeUnit.SECONDS)\n                       .build();\n            converter.convert(docxInputStream).as(DocumentType.DOCX).to(outputStream).as(DocumentType.PDF).execute();\n            outputStream.close();\n            System.out.println(&quot;success&quot;);\n            converter.shutDown();\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n        \n    }\n    \n}\n</code></pre>\n<p>Below dependencies which I've configured in pom.xml</p>\n<pre><code>   &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.docx4j&lt;/groupId&gt;\n            &lt;artifactId&gt;docx4j-documents4j-local&lt;/artifactId&gt;\n            &lt;version&gt;8.3.3&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.docx4j&lt;/groupId&gt;\n            &lt;artifactId&gt;docx4j-JAXB-ReferenceImpl&lt;/artifactId&gt;\n            &lt;version&gt;8.3.3&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n            &lt;artifactId&gt;log4j-slf4j-impl&lt;/artifactId&gt;\n            &lt;version&gt;2.17.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!-- API, java.xml.bind module --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;jakarta.xml.bind&lt;/groupId&gt;\n            &lt;artifactId&gt;jakarta.xml.bind-api&lt;/artifactId&gt;\n            &lt;version&gt;2.3.2&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- Runtime, com.sun.xml.bind module --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.glassfish.jaxb&lt;/groupId&gt;\n            &lt;artifactId&gt;jaxb-runtime&lt;/artifactId&gt;\n            &lt;version&gt;2.3.2&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n</code></pre>\n<p><strong>EDIT:</strong></p>\n<p>After analyzing the source code. What I understood is:</p>\n<ul>\n<li><p>Internally documents4j executes a VBScript with the help of another library zt-exec (ZeroTurnaround Process Executor) to start the WINWORD or for the conversion of DOCX to PDF or to stop the WINWORD</p>\n</li>\n<li><p>WINWORD program freezes When it executes <strong>wordApplication.Documents.Open(inputFile, False, True, False)</strong> <a href=\"https://github.com/documents4j/documents4j/blob/master/documents4j-transformer-msoffice/documents4j-transformer-msoffice-word/src/main/resources/word_convert.vbs#L37\" rel=\"nofollow noreferrer\">word_convert</a></p>\n</li>\n<li><p>In above statement wordApplication holds the object of Word.Application</p>\n<p><a href=\"https://github.com/documents4j/documents4j/blob/master/documents4j-transformer-msoffice/documents4j-transformer-msoffice-word/src/main/resources/word_start.vbs\" rel=\"nofollow noreferrer\">word_start</a>\n<a href=\"https://github.com/documents4j/documents4j/blob/master/documents4j-transformer-msoffice/documents4j-transformer-msoffice-word/src/main/resources/word_convert.vbs\" rel=\"nofollow noreferrer\">word_convert</a>\n<a href=\"https://github.com/documents4j/documents4j/blob/master/documents4j-transformer-msoffice/documents4j-transformer-msoffice-word/src/main/resources/word_shutdown.vbs\" rel=\"nofollow noreferrer\">word_shutdwon</a></p>\n</li>\n</ul>\n"},{"tags":["java","maven","intellij-idea"],"answers":[{"comment_count":0,"score":2,"last_activity_date":1701202799,"creation_date":1701202799,"answer_id":77566939,"question_id":77566785,"body_markdown":"Quoting the answer from the [related issue](https://youtrack.jetbrains.com/issue/IDEA-325749/Dependencies-tool-window-seems-to-be-removed#focus=Comments-27-7880710.0-0):\r\n\r\n&gt; Please install [Package Search](https://plugins.jetbrains.com/plugin/12507-package-search) plugin from the Marketplace, it is just not bundled. We are in the middle of its redesign.","link":"https://stackoverflow.com/questions/77566785/intellij-idea-dependencies-tool-window-missing/77566939#77566939","title":"Intellij IDEA Dependencies Tool Window Missing","body":"<p>Quoting the answer from the <a href=\"https://youtrack.jetbrains.com/issue/IDEA-325749/Dependencies-tool-window-seems-to-be-removed#focus=Comments-27-7880710.0-0\" rel=\"nofollow noreferrer\">related issue</a>:</p>\n<blockquote>\n<p>Please install <a href=\"https://plugins.jetbrains.com/plugin/12507-package-search\" rel=\"nofollow noreferrer\">Package Search</a> plugin from the Marketplace, it is just not bundled. We are in the middle of its redesign.</p>\n</blockquote>\n"},{"comment_count":0,"score":0,"last_activity_date":1701763181,"creation_date":1701763181,"answer_id":77604622,"question_id":77566785,"body_markdown":"As listed on the documentation page for [Package Search](https://www.jetbrains.com/help/idea/package-search.html), this requires the Package Search plugin. Make sure this plugin is installed &amp; enabled.","link":"https://stackoverflow.com/questions/77566785/intellij-idea-dependencies-tool-window-missing/77604622#77604622","title":"Intellij IDEA Dependencies Tool Window Missing","body":"<p>As listed on the documentation page for <a href=\"https://www.jetbrains.com/help/idea/package-search.html\" rel=\"nofollow noreferrer\">Package Search</a>, this requires the Package Search plugin. Make sure this plugin is installed &amp; enabled.</p>\n"}],"comment_count":0,"is_answered":true,"view_count":52,"answer_count":2,"score":1,"last_activity_date":1701763181,"creation_date":1701200931,"last_edit_date":1701201277,"question_id":77566785,"body_markdown":"When using Intellij IDEA previously for a maven project, it had what I assume was a built in dependency tool that would show me a simple list of all of my dependencies and allow me to upgrade any of them to the latest versions with a simple click of a button. I have need to perform major updates to my application, and I can no longer find this.\r\n\r\nAccording to documentation that I&#39;ve found on JetBrains own website, the module I&#39;m looking for is the [Dependencies Tool Window](https://www.jetbrains.com/guide/java/tutorials/managing-dependencies/update-dependencies/).\r\n\r\n![Text](https://www.jetbrains.com/guide/assets/dependencies-with-upgrades-2e4c3a15.png)\r\n\r\nAccording to that documentation, this can be opened using the Quick Launch at the bottom left. However, it says that I need to open a module called &quot;Dependency&quot;. However, I don&#39;t have an option for this. I just have &quot;Dependency Viewer&quot;, which is not even close to the same thing. Hell, far as I can tell, Dependency Viewer has nothing to do with my project&#39;s Maven dependencies. It doesn&#39;t list anything I&#39;ve added to my project, it just shows me some custom Java class files I set up for Hibernate Dialects.\r\n\r\n[![enter image description here][1]][1]\r\n\r\nMy current version of Intellij IDEA is 2023.2.1 (Ultimate Edition), Build #IU-232.9559.62.\r\n\r\nI am behind on the upgrades, but this current version I&#39;m using led to this problem in the first place, and broke half of my plugins so I&#39;ve been very hesitant to perform another upgrade.\r\n\r\nDo I need to downgrade IDEA to restore this functionality? I know I had a 222.* build previously the last time I used this feature. I assume what I&#39;m looking for isn&#39;t a plugin based on the JetBrains articles.\r\n\r\n  [1]: https://i.stack.imgur.com/izfIU.png","link":"https://stackoverflow.com/questions/77566785/intellij-idea-dependencies-tool-window-missing","title":"Intellij IDEA Dependencies Tool Window Missing","body":"<p>When using Intellij IDEA previously for a maven project, it had what I assume was a built in dependency tool that would show me a simple list of all of my dependencies and allow me to upgrade any of them to the latest versions with a simple click of a button. I have need to perform major updates to my application, and I can no longer find this.</p>\n<p>According to documentation that I've found on JetBrains own website, the module I'm looking for is the <a href=\"https://www.jetbrains.com/guide/java/tutorials/managing-dependencies/update-dependencies/\" rel=\"nofollow noreferrer\">Dependencies Tool Window</a>.</p>\n<p><img src=\"https://www.jetbrains.com/guide/assets/dependencies-with-upgrades-2e4c3a15.png\" alt=\"Text\" /></p>\n<p>According to that documentation, this can be opened using the Quick Launch at the bottom left. However, it says that I need to open a module called &quot;Dependency&quot;. However, I don't have an option for this. I just have &quot;Dependency Viewer&quot;, which is not even close to the same thing. Hell, far as I can tell, Dependency Viewer has nothing to do with my project's Maven dependencies. It doesn't list anything I've added to my project, it just shows me some custom Java class files I set up for Hibernate Dialects.</p>\n<p><a href=\"https://i.stack.imgur.com/izfIU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/izfIU.png\" alt=\"enter image description here\" /></a></p>\n<p>My current version of Intellij IDEA is 2023.2.1 (Ultimate Edition), Build #IU-232.9559.62.</p>\n<p>I am behind on the upgrades, but this current version I'm using led to this problem in the first place, and broke half of my plugins so I've been very hesitant to perform another upgrade.</p>\n<p>Do I need to downgrade IDEA to restore this functionality? I know I had a 222.* build previously the last time I used this feature. I assume what I'm looking for isn't a plugin based on the JetBrains articles.</p>\n"},{"tags":["java","maven"],"comments":[{"score":0,"post_type":"question","creation_date":1678369892,"post_id":75682819,"comment_id":133521820,"body_markdown":"Get maven to give you the stacktraces for the errors; e.g. `mvn -e ...`.  The problem &gt;is&lt; most likely something to do with encoding.  Maybe some of the HTML files it is copying are NOT properly encoded UTF-8.  Maybe Maven is trying to read them as UTF-8 and that is failing.","link":"https://stackoverflow.com/questions/75682819/failed-with-malformedinputexception-input-length-1-when-building-java-applica#comment133521820_75682819","body":"Get maven to give you the stacktraces for the errors; e.g. <code>mvn -e ...</code>.  The problem &gt;is&lt; most likely something to do with encoding.  Maybe some of the HTML files it is copying are NOT properly encoded UTF-8.  Maybe Maven is trying to read them as UTF-8 and that is failing."}],"answers":[{"comment_count":0,"score":1,"last_activity_date":1691012449,"creation_date":1691012449,"answer_id":76823701,"question_id":75682819,"body_markdown":"I had this issue and fixed it by adding the below plugin to my pom.xml:\r\n```\r\n&lt;plugin&gt;\r\n    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n    &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt;\r\n    &lt;version&gt;3.1.0&lt;/version&gt;\r\n&lt;/plugin&gt;\r\n```\r\n\r\nThis is a workaround, and the proper fix is to make sure your files are properly encoded. More details in the selected answer here: https://stackoverflow.com/questions/65910112/maven-clean-install-failed-to-execute-goal-org-apache-maven-pluginsmaven-resou","link":"https://stackoverflow.com/questions/75682819/failed-with-malformedinputexception-input-length-1-when-building-java-applica/76823701#76823701","title":"failed with MalformedInputException: Input length = 1 when building java application with maven 3.9.0","body":"<p>I had this issue and fixed it by adding the below plugin to my pom.xml:</p>\n<pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n    &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt;\n    &lt;version&gt;3.1.0&lt;/version&gt;\n&lt;/plugin&gt;\n</code></pre>\n<p>This is a workaround, and the proper fix is to make sure your files are properly encoded. More details in the selected answer here: <a href=\"https://stackoverflow.com/questions/65910112/maven-clean-install-failed-to-execute-goal-org-apache-maven-pluginsmaven-resou\">Maven clean install: Failed to execute goal org.apache.maven.plugins:maven-resources-plugin:3.2.0:resources</a></p>\n"},{"comment_count":0,"score":0,"last_activity_date":1701752755,"creation_date":1701752755,"answer_id":77603926,"question_id":75682819,"body_markdown":"The first response helped me, but it still resulted in a &#39;Warning&#39;. I resolved it by making the following configuration:\r\n\r\n    &lt;plugin&gt;\r\n        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\r\n        &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt;\r\n        &lt;version&gt;3.1.0&lt;/version&gt;\r\n        &lt;configuration&gt;\r\n            &lt;encoding&gt;UTF-8&lt;/encoding&gt;\r\n        &lt;/configuration&gt;\r\n    &lt;/plugin&gt;\r\n\r\n","link":"https://stackoverflow.com/questions/75682819/failed-with-malformedinputexception-input-length-1-when-building-java-applica/77603926#77603926","title":"failed with MalformedInputException: Input length = 1 when building java application with maven 3.9.0","body":"<p>The first response helped me, but it still resulted in a 'Warning'. I resolved it by making the following configuration:</p>\n<pre><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n    &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt;\n    &lt;version&gt;3.1.0&lt;/version&gt;\n    &lt;configuration&gt;\n        &lt;encoding&gt;UTF-8&lt;/encoding&gt;\n    &lt;/configuration&gt;\n&lt;/plugin&gt;\n</code></pre>\n"}],"comment_count":1,"is_answered":true,"view_count":2629,"answer_count":2,"score":2,"last_activity_date":1701752755,"creation_date":1678355079,"question_id":75682819,"body_markdown":"The java application is building perfectly fine with maven 3.6.0-3.8.x . However with maven 3.9.0 it is giving this strange error for html or xml files.\r\n\r\nFailed to execute goal org.apache.maven.plugins:maven-resources-plugin:3.3.0:resources (default-resources) on project {project_name}: filtering {path1}/30168019.html to {path2}/30168019.html failed with MalformedInputException: Input length = 1 -&gt; [Help 1]\r\n\r\n\r\n\r\nFirst I thought might be some encoding issue wrt maven but in the pom file it is mentioned utf-8 itself. Does anyobody have any idea what might be causing this error?","link":"https://stackoverflow.com/questions/75682819/failed-with-malformedinputexception-input-length-1-when-building-java-applica","title":"failed with MalformedInputException: Input length = 1 when building java application with maven 3.9.0","body":"<p>The java application is building perfectly fine with maven 3.6.0-3.8.x . However with maven 3.9.0 it is giving this strange error for html or xml files.</p>\n<p>Failed to execute goal org.apache.maven.plugins:maven-resources-plugin:3.3.0:resources (default-resources) on project {project_name}: filtering {path1}/30168019.html to {path2}/30168019.html failed with MalformedInputException: Input length = 1 -&gt; [Help 1]</p>\n<p>First I thought might be some encoding issue wrt maven but in the pom file it is mentioned utf-8 itself. Does anyobody have any idea what might be causing this error?</p>\n"},{"tags":["java","xml","jaxb"],"answers":[{"comment_count":0,"score":0,"last_activity_date":1701728222,"last_edit_date":1701728222,"creation_date":1701726969,"answer_id":77602782,"question_id":77479159,"body_markdown":"Yes, it is possible to unmarshal XML instances that include varying content distinguished by a given attribute having different values.\r\n\r\nHere is a standalone Maven demonstration [project][21] and [zip][20] that uses these JAXB features to provide a solution:\r\n\r\n+ `@XmlJavaTypeAdapter(MethodXmlAdapter.class)` - a JAXB annotation to specify a class to provide custom _unmarshaller_ and _marshaller_ methods.\r\n+ `MethodXmlAdapter.class` - receives a [DOM][10] [`Element`][11] from JAXB when unmarshalling the _method_ element. The `Element` instance is used to read the distinguishing name as a DOM attribute. When marshaling, JAXB provides a `MethodXXN` instance to be marshaled, in the adapter, to back to a DOM `Element` representation.\r\n\r\nThe key points for unmarshalling is the distinguishing attribute is programmatically accessible and the DOM element can be unmarshaled to the desired Java type.\r\n\r\n[Context.mainUnmarshalByName(...)][36]\r\n~~~\r\npublic static Object mainUnmarshalByName(Element element)\r\n{\r\n    Object value = null;\r\n    String name = element.getAttribute(&quot;name&quot;);\r\n    switch (name)\r\n    {\r\n        case &quot;platce-info&quot;:\r\n            value = mainUnmarshal(element, METHODXX1_CLASS);\r\n            break;\r\n        case &quot;platce-data&quot;:\r\n            value = mainUnmarshal(element, METHODXX2_CLASS);\r\n            break;\r\n        default:\r\n            value = element;\r\n            break;\r\n    }\r\n    return value;\r\n}\r\n~~~\r\n\r\nThe key point for marshalling is the different `MethodXXN` instances can be marshaled to the one _method_ element using a declared [QName][12] with or without a namespace.\r\n\r\n[Context.mainWrapAsMethod(...)][36]\r\n~~~\r\n@SuppressWarnings({ &quot;rawtypes&quot;, &quot;unchecked&quot; })\r\npublic static Object mainWrapAsMethod(Object value)\r\n{\r\n    Object wrap = null;\r\n    if ( value != null )\r\n    {\r\n        if ( isJAXBElement(value) )\r\n            value = ((JAXBElement) value).getValue();\r\n\r\n        if ( METHODXX1_CLASS.equals(value.getClass()) )\r\n            wrap = new JAXBElement(METHOD_QNAME, METHODXX1_CLASS, value);\r\n        else if ( METHODXX2_CLASS.equals(value.getClass()) )\r\n            wrap = new JAXBElement(METHOD_QNAME, METHODXX2_CLASS, value);\r\n    }\r\n    return wrap;\r\n}\r\n~~~\r\n\r\n#### Implementation\r\n\r\nThe [sample project][21] generates the JAXB classes using the [HiSrc HigherJAXB][2] Maven plugin and XJC plugins from [HiSrc BasicJAXB][1]. The XML Schema defines the `MethodXXN` types as sub-types of `MethodBase` which contains common attributes and elements.\r\n\r\n**Classes generated from [platce.xsd][31] by XJC**\r\n~~~\r\norg\r\n└── example\r\n    └── platce\r\n        ├── MethodBase.java\r\n        ├── MethodXX1.java\r\n        ├── MethodXX2.java\r\n        ├── ObjectFactory.java\r\n        ├── Response.java\r\n        └── VeraWSClass.java\r\n~~~\r\n\r\nThe [platce.xsd][31] schema defines the `VeraWSClass` type to hold the _any_ element; but, the [HiSrc HigherJAXB][2] Maven plugin uses the [HiSrc BasicJAXB][1] customization XJC plugin and the [HiSrc HyperJAXB Annox][3] annotation XJC plugin to add the `@XmlAnyElement` and `@XmlJavaTypeAdapter` annotation using a separate configuration file: [VeraWSClass.any.xml][30].\r\n\r\n#### Execution\r\n\r\nFor the demo, you can run the test and/or application using:\r\n\r\n~~~\r\nmvn -Ptest clean test\r\nmvn -Pexec compile exec:java -Dexec.args=&quot;src/test/samples/response01.xml&quot;\r\nmvn -Pexec compile exec:java -Dexec.args=&quot;src/test/samples/response02.xml&quot;\r\n~~~\r\n\r\n_Disclaimer:_ I am the maintainer for the forked [HiSrc BasicJAXB][1], [HiSrc HigherJAXB][2] and [HiSrc HyperJAXB Annox][3] projects.\r\n\r\n&lt;!-- References --&gt;\r\n\r\n[1]: https://github.com/patrodyne/hisrc-basicjaxb#readme\r\n[2]: https://github.com/patrodyne/hisrc-higherjaxb#readme\r\n[3]: https://github.com/patrodyne/hisrc-hyperjaxb-annox#readme\r\n[10]: https://www.w3.org/TR/WD-DOM/introduction.html\r\n[11]: https://www.w3.org/2003/01/dom2-javadoc/org/w3c/dom/Element.html\r\n[12]: https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/namespace/QName.html\r\n[20]: https://github.com/patrodyne/hisrc-basicjaxb/releases/download/2.1.1/hisrc-basicjaxb-sample-platce-01-2.1.1-mvn-src.zip\r\n[21]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/README.md\r\n[22]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/OUTPUT.txt\r\n[23]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/project-pom.xml\r\n[24]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/bin/run.sh\r\n[25]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/bin/run.cmd\r\n[30]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/main/resources/org/example/platce/VeraWSClass.any.xml\r\n[31]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/main/resources/platce.xsd\r\n[32]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/main/resources/platce.xjb\r\n[33]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/main/java/org/example/platce/Demo.java\r\n[34]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/main/java/org/example/platce/util/DOMUtils.java\r\n[35]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/main/java/org/example/platce/util/XmlTypeUtils.java\r\n[36]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/main/java/org/example/platce/Context.java\r\n[37]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/main/java/org/example/platce/MethodXmlAdapter.java\r\n[41]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/test/samples/response01.xml\r\n[42]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/test/samples/response02.xml\r\n[43]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/test/resources/jvmsystem.arguments\r\n[44]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/test/resources/jvmsystem.properties\r\n[45]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/test/resources/simplelogger.properties\r\n[46]: https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/test/java/org/example/platce/ContextTest.java","link":"https://stackoverflow.com/questions/77479159/unmarshalling-multiple-xmls-with-similar-wrapper/77602782#77602782","title":"Unmarshalling multiple XMLs with similar wrapper","body":"<p>Yes, it is possible to unmarshal XML instances that include varying content distinguished by a given attribute having different values.</p>\n<p>Here is a standalone Maven demonstration <a href=\"https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/README.md\" rel=\"nofollow noreferrer\">project</a> and <a href=\"https://github.com/patrodyne/hisrc-basicjaxb/releases/download/2.1.1/hisrc-basicjaxb-sample-platce-01-2.1.1-mvn-src.zip\" rel=\"nofollow noreferrer\">zip</a> that uses these JAXB features to provide a solution:</p>\n<ul>\n<li><code>@XmlJavaTypeAdapter(MethodXmlAdapter.class)</code> - a JAXB annotation to specify a class to provide custom <em>unmarshaller</em> and <em>marshaller</em> methods.</li>\n<li><code>MethodXmlAdapter.class</code> - receives a <a href=\"https://www.w3.org/TR/WD-DOM/introduction.html\" rel=\"nofollow noreferrer\">DOM</a> <a href=\"https://www.w3.org/2003/01/dom2-javadoc/org/w3c/dom/Element.html\" rel=\"nofollow noreferrer\"><code>Element</code></a> from JAXB when unmarshalling the <em>method</em> element. The <code>Element</code> instance is used to read the distinguishing name as a DOM attribute. When marshaling, JAXB provides a <code>MethodXXN</code> instance to be marshaled, in the adapter, to back to a DOM <code>Element</code> representation.</li>\n</ul>\n<p>The key points for unmarshalling is the distinguishing attribute is programmatically accessible and the DOM element can be unmarshaled to the desired Java type.</p>\n<p><a href=\"https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/main/java/org/example/platce/Context.java\" rel=\"nofollow noreferrer\">Context.mainUnmarshalByName(...)</a></p>\n<pre><code>public static Object mainUnmarshalByName(Element element)\n{\n    Object value = null;\n    String name = element.getAttribute(&quot;name&quot;);\n    switch (name)\n    {\n        case &quot;platce-info&quot;:\n            value = mainUnmarshal(element, METHODXX1_CLASS);\n            break;\n        case &quot;platce-data&quot;:\n            value = mainUnmarshal(element, METHODXX2_CLASS);\n            break;\n        default:\n            value = element;\n            break;\n    }\n    return value;\n}\n</code></pre>\n<p>The key point for marshalling is the different <code>MethodXXN</code> instances can be marshaled to the one <em>method</em> element using a declared <a href=\"https://docs.oracle.com/en/java/javase/17/docs/api/java.xml/javax/xml/namespace/QName.html\" rel=\"nofollow noreferrer\">QName</a> with or without a namespace.</p>\n<p><a href=\"https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/main/java/org/example/platce/Context.java\" rel=\"nofollow noreferrer\">Context.mainWrapAsMethod(...)</a></p>\n<pre><code>@SuppressWarnings({ &quot;rawtypes&quot;, &quot;unchecked&quot; })\npublic static Object mainWrapAsMethod(Object value)\n{\n    Object wrap = null;\n    if ( value != null )\n    {\n        if ( isJAXBElement(value) )\n            value = ((JAXBElement) value).getValue();\n\n        if ( METHODXX1_CLASS.equals(value.getClass()) )\n            wrap = new JAXBElement(METHOD_QNAME, METHODXX1_CLASS, value);\n        else if ( METHODXX2_CLASS.equals(value.getClass()) )\n            wrap = new JAXBElement(METHOD_QNAME, METHODXX2_CLASS, value);\n    }\n    return wrap;\n}\n</code></pre>\n<h4>Implementation</h4>\n<p>The <a href=\"https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/README.md\" rel=\"nofollow noreferrer\">sample project</a> generates the JAXB classes using the <a href=\"https://github.com/patrodyne/hisrc-higherjaxb#readme\" rel=\"nofollow noreferrer\">HiSrc HigherJAXB</a> Maven plugin and XJC plugins from <a href=\"https://github.com/patrodyne/hisrc-basicjaxb#readme\" rel=\"nofollow noreferrer\">HiSrc BasicJAXB</a>. The XML Schema defines the <code>MethodXXN</code> types as sub-types of <code>MethodBase</code> which contains common attributes and elements.</p>\n<p><strong>Classes generated from <a href=\"https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/main/resources/platce.xsd\" rel=\"nofollow noreferrer\">platce.xsd</a> by XJC</strong></p>\n<pre><code>org\n└── example\n    └── platce\n        ├── MethodBase.java\n        ├── MethodXX1.java\n        ├── MethodXX2.java\n        ├── ObjectFactory.java\n        ├── Response.java\n        └── VeraWSClass.java\n</code></pre>\n<p>The <a href=\"https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/main/resources/platce.xsd\" rel=\"nofollow noreferrer\">platce.xsd</a> schema defines the <code>VeraWSClass</code> type to hold the <em>any</em> element; but, the <a href=\"https://github.com/patrodyne/hisrc-higherjaxb#readme\" rel=\"nofollow noreferrer\">HiSrc HigherJAXB</a> Maven plugin uses the <a href=\"https://github.com/patrodyne/hisrc-basicjaxb#readme\" rel=\"nofollow noreferrer\">HiSrc BasicJAXB</a> customization XJC plugin and the <a href=\"https://github.com/patrodyne/hisrc-hyperjaxb-annox#readme\" rel=\"nofollow noreferrer\">HiSrc HyperJAXB Annox</a> annotation XJC plugin to add the <code>@XmlAnyElement</code> and <code>@XmlJavaTypeAdapter</code> annotation using a separate configuration file: <a href=\"https://github.com/patrodyne/hisrc-basicjaxb/blob/master/higher/assembly/samples/platce-01/src/main/resources/org/example/platce/VeraWSClass.any.xml\" rel=\"nofollow noreferrer\">VeraWSClass.any.xml</a>.</p>\n<h4>Execution</h4>\n<p>For the demo, you can run the test and/or application using:</p>\n<pre><code>mvn -Ptest clean test\nmvn -Pexec compile exec:java -Dexec.args=&quot;src/test/samples/response01.xml&quot;\nmvn -Pexec compile exec:java -Dexec.args=&quot;src/test/samples/response02.xml&quot;\n</code></pre>\n<p><em>Disclaimer:</em> I am the maintainer for the forked <a href=\"https://github.com/patrodyne/hisrc-basicjaxb#readme\" rel=\"nofollow noreferrer\">HiSrc BasicJAXB</a>, <a href=\"https://github.com/patrodyne/hisrc-higherjaxb#readme\" rel=\"nofollow noreferrer\">HiSrc HigherJAXB</a> and <a href=\"https://github.com/patrodyne/hisrc-hyperjaxb-annox#readme\" rel=\"nofollow noreferrer\">HiSrc HyperJAXB Annox</a> projects.</p>\n\n"}],"comment_count":0,"is_answered":false,"view_count":70,"answer_count":1,"score":0,"last_activity_date":1701728222,"creation_date":1699950726,"question_id":77479159,"body_markdown":"I have multiple different XMLs with similar wrapper. For example:\r\n```\r\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\r\n&lt;response id=&quot;085845&quot;&gt;\r\n  &lt;class name=&quot;vera-pd&quot; version=&quot;1.25&quot; revision=&quot;1&quot;&gt;\r\n    &lt;method name=&quot;platce-info&quot;&gt;\r\n      &lt;status&gt;0&lt;/status&gt;\r\n      &lt;error_msg/&gt;\r\n      ... method content ...\r\n    &lt;/method&gt;\r\n  &lt;/class&gt;\r\n&lt;/response&gt;\r\n```\r\n\r\nI want to unmarshall them to POJOs based on the content or the attribute &quot;name&quot; in &lt;method&gt;. Is something like that posible? I want to avoid having to write different ResponseClass for every method. XMLs arent mine, they come from different system so i am unable to use type or namespace.\r\n\r\nI tried to use @XmlElements like this (classes MethodXX1 and MethodXX2 override VeraWSMethod). It didnt work because unmarshaller is unable to determine class and uses the last one in @XmlElements. \r\n\r\n\r\n```\r\n@XmlRootElement(name = &quot;class&quot;)\r\npublic class VeraWSClass {\r\n    private String name;\r\n    private String version;\r\n    private String revision;\r\n    private VeraWSMethod method;\r\n\r\n    @XmlAttribute\r\n    public String getName() {\r\n        return name;\r\n    }\r\n\r\n    public void setName(String name) {\r\n        this.name = name;\r\n    }\r\n\r\n    @XmlAttribute\r\n    public String getVersion() {\r\n        return version;\r\n    }\r\n\r\n    public void setVersion(String version) {\r\n        this.version = version;\r\n    }\r\n\r\n    @XmlAttribute\r\n    public String getRevision() {\r\n        return revision;\r\n    }\r\n\r\n    public void setRevision(String revision) {\r\n        this.revision = revision;\r\n    }\r\n\r\n    @XmlElements({\r\n            @XmlElement(name = &quot;method&quot;, type = MethodXX1.class),\r\n            @XmlElement(name = &quot;method&quot;, type = MethodXX2.class)\r\n    })\r\n    public VeraWSMethod getMethod() {\r\n        return method;\r\n    }\r\n\r\n    public void setMethod(VeraWSMethod method) {\r\n        this.method = method;\r\n    }\r\n}\r\n```\r\n","link":"https://stackoverflow.com/questions/77479159/unmarshalling-multiple-xmls-with-similar-wrapper","title":"Unmarshalling multiple XMLs with similar wrapper","body":"<p>I have multiple different XMLs with similar wrapper. For example:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;response id=&quot;085845&quot;&gt;\n  &lt;class name=&quot;vera-pd&quot; version=&quot;1.25&quot; revision=&quot;1&quot;&gt;\n    &lt;method name=&quot;platce-info&quot;&gt;\n      &lt;status&gt;0&lt;/status&gt;\n      &lt;error_msg/&gt;\n      ... method content ...\n    &lt;/method&gt;\n  &lt;/class&gt;\n&lt;/response&gt;\n</code></pre>\n<p>I want to unmarshall them to POJOs based on the content or the attribute &quot;name&quot; in . Is something like that posible? I want to avoid having to write different ResponseClass for every method. XMLs arent mine, they come from different system so i am unable to use type or namespace.</p>\n<p>I tried to use @XmlElements like this (classes MethodXX1 and MethodXX2 override VeraWSMethod). It didnt work because unmarshaller is unable to determine class and uses the last one in @XmlElements.</p>\n<pre><code>@XmlRootElement(name = &quot;class&quot;)\npublic class VeraWSClass {\n    private String name;\n    private String version;\n    private String revision;\n    private VeraWSMethod method;\n\n    @XmlAttribute\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    @XmlAttribute\n    public String getVersion() {\n        return version;\n    }\n\n    public void setVersion(String version) {\n        this.version = version;\n    }\n\n    @XmlAttribute\n    public String getRevision() {\n        return revision;\n    }\n\n    public void setRevision(String revision) {\n        this.revision = revision;\n    }\n\n    @XmlElements({\n            @XmlElement(name = &quot;method&quot;, type = MethodXX1.class),\n            @XmlElement(name = &quot;method&quot;, type = MethodXX2.class)\n    })\n    public VeraWSMethod getMethod() {\n        return method;\n    }\n\n    public void setMethod(VeraWSMethod method) {\n        this.method = method;\n    }\n}\n</code></pre>\n"},{"tags":["java","jquery","arrays","element"],"answers":[{"comment_count":0,"score":1,"last_activity_date":1701265803,"last_edit_date":1701265803,"creation_date":1701201219,"answer_id":77566810,"question_id":77566620,"body_markdown":"The code for this problem could be heavily optimized, but assuming we want an answer that is easier to understand, here is some java code to replace a word with it&#39;s synonym, **no input is validated**, so will fail if using null values:\r\n\r\n```\r\npublic class SynonymHandler {\r\n\tpublic static void main(String[] args) {\r\n\t\tString[] synonymData = { &quot;merciful&quot;, &quot;gracious&quot;, &quot;kindly&quot;, &quot;forgiving&quot; };\r\n\t\tSystem.out.println(&quot;# original&quot;);\r\n\t\tfor (String element : synonymData) {\r\n\t\t\tSystem.out.println(element);\r\n\t\t}\r\n\r\n\t\tString[] modified = removeSynonym(synonymData, &quot;merciful&quot;, &quot;gracious&quot;);\r\n\t\tSystem.out.println(&quot;# modified&quot;);\r\n\t\tfor (String element : modified) {\r\n\t\t\tSystem.out.println(element);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static String[] removeSynonym(String[] synonymData, String word, String synonym) {\r\n\t\t// result will have the same length as source:\r\n\t\tString[] result = new String[synonymData.length];\r\n\r\n\t\t// loop through the synonymData\r\n\t\tfor (int index = 0; index &lt; synonymData.length; index++) {\r\n\t\t// if word = synonymData[index] use synomyn, else use the original value\r\n\t\t\tresult[index] = word.equals(synonymData[index]) ? synonym : synonymData[index];\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n}\r\n```","link":"https://stackoverflow.com/questions/77566620/remove-an-element-from-an-index-in-an-array/77566810#77566810","title":"Remove an element from an index in an array","body":"<p>The code for this problem could be heavily optimized, but assuming we want an answer that is easier to understand, here is some java code to replace a word with it's synonym, <strong>no input is validated</strong>, so will fail if using null values:</p>\n<pre><code>public class SynonymHandler {\n    public static void main(String[] args) {\n        String[] synonymData = { &quot;merciful&quot;, &quot;gracious&quot;, &quot;kindly&quot;, &quot;forgiving&quot; };\n        System.out.println(&quot;# original&quot;);\n        for (String element : synonymData) {\n            System.out.println(element);\n        }\n\n        String[] modified = removeSynonym(synonymData, &quot;merciful&quot;, &quot;gracious&quot;);\n        System.out.println(&quot;# modified&quot;);\n        for (String element : modified) {\n            System.out.println(element);\n        }\n    }\n\n    private static String[] removeSynonym(String[] synonymData, String word, String synonym) {\n        // result will have the same length as source:\n        String[] result = new String[synonymData.length];\n\n        // loop through the synonymData\n        for (int index = 0; index &lt; synonymData.length; index++) {\n        // if word = synonymData[index] use synomyn, else use the original value\n            result[index] = word.equals(synonymData[index]) ? synonym : synonymData[index];\n        }\n        return result;\n    }\n}\n</code></pre>\n"},{"comment_count":0,"score":0,"last_activity_date":1701202256,"creation_date":1701202256,"answer_id":77566894,"question_id":77566620,"body_markdown":"That&#39;s a very strange way to store the data. Is that your design or one you were handled? It would make more sense to store either a HashMap of Strings (the word) to arrays of strings (the synonyms). But let&#39;s work with what you have.\r\n\r\nIt looks like your synonym data is being passed in as an array of simple strings -- just like they appear when you printed them -- rather than parsed into a better format. So `synonymData[0]` is the data for `merciful` and `synonynData[1]` is the data for `powerful`. After that, it&#39;s free format text.\r\n\r\nLet&#39;s look at your code:\r\n\r\n```java\r\npublic static void removeSynonym(String[] synonymData, String word, String synonym) {\r\n    int index = synonymLineIndex(synonymData, word);\r\n    String[] removedSynData = new String[synonymData.length];\r\n    for (int i = 0, int m = 0; i &lt; synonymData.length; i++)\r\n        if (synonymData[index].contains(word))\r\n            removedSynData[m++] = synonymData[i];\r\n}\r\n```\r\n\r\nYour code never modifies synonymData. It creates a new removedSynData array, builds it out, and then proceeds to dump it on the floor, not doing anything with it. Furthermore, it&#39;s not in the same style as the original structure.\r\n\r\nThere are two basic approaches you can take. First, you get the right index when you do this:\r\n\r\n\r\n```java\r\n    int index = synonymLineIndex(synonymData, word);\r\n```\r\n\r\n**Method One: Parse Line, Remove, Rebuild Line**\r\n\r\nMethod one would involve parsing this line -- making a string array of the synonyms, then removing the one you&#39;re trying to remove, then rebuilding a new string.\r\n\r\nDo do that you could do:\r\n\r\n```java\r\n   String[] bigParts = synonymData[index].split(&quot;\\\\|&quot;);\r\n```\r\n\r\nAfter this, `bigParts[0]` contains the word (possibly with white space) and `bigParts[1]` contains all the synonyms as a single string (possibly with white space). Note that `split()` takes a regular expression, which is why I included the `\\\\`. So it passes a single `\\` to split, to escape the pipe character that would otherwise stand for OR.\r\n\r\nYou&#39;ll want to check the length of the array is at least 2 then do:\r\n\r\n```java\r\n   String[] synonyms = bigParts[1].split(&quot;,&quot;);\r\n```\r\n\r\nYou can run through the array, trim them of white space, and then look for the one you want to remove it. Remove it from the array. Then reassemble a string (code of you to figure out), and do this:\r\n\r\n\r\n```java\r\n   synonymData[index] = YourNewString;\r\n```\r\n\r\n**Method Two: ReplaceAll()**\r\n\r\nThe other approach would be to just use a regular expression with `String.replaceAll()`. It would need to be a sorta complicated RE to make sure you only match the entire word. For instance, if you&#39;re supposed to remove `rent` you wouldn&#39;t want to match `parent`. That will take time to figure out, but when you&#39;re done, it&#39;s a single line of code.\r\n\r\n```java\r\n   synonymData[index] = synonymData[index].replaceAll(&quot;The big RE&quot;);\r\n```\r\n\r\n\r\n\r\n","link":"https://stackoverflow.com/questions/77566620/remove-an-element-from-an-index-in-an-array/77566894#77566894","title":"Remove an element from an index in an array","body":"<p>That's a very strange way to store the data. Is that your design or one you were handled? It would make more sense to store either a HashMap of Strings (the word) to arrays of strings (the synonyms). But let's work with what you have.</p>\n<p>It looks like your synonym data is being passed in as an array of simple strings -- just like they appear when you printed them -- rather than parsed into a better format. So <code>synonymData[0]</code> is the data for <code>merciful</code> and <code>synonynData[1]</code> is the data for <code>powerful</code>. After that, it's free format text.</p>\n<p>Let's look at your code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static void removeSynonym(String[] synonymData, String word, String synonym) {\n    int index = synonymLineIndex(synonymData, word);\n    String[] removedSynData = new String[synonymData.length];\n    for (int i = 0, int m = 0; i &lt; synonymData.length; i++)\n        if (synonymData[index].contains(word))\n            removedSynData[m++] = synonymData[i];\n}\n</code></pre>\n<p>Your code never modifies synonymData. It creates a new removedSynData array, builds it out, and then proceeds to dump it on the floor, not doing anything with it. Furthermore, it's not in the same style as the original structure.</p>\n<p>There are two basic approaches you can take. First, you get the right index when you do this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    int index = synonymLineIndex(synonymData, word);\n</code></pre>\n<p><strong>Method One: Parse Line, Remove, Rebuild Line</strong></p>\n<p>Method one would involve parsing this line -- making a string array of the synonyms, then removing the one you're trying to remove, then rebuilding a new string.</p>\n<p>Do do that you could do:</p>\n<pre class=\"lang-java prettyprint-override\"><code>   String[] bigParts = synonymData[index].split(&quot;\\\\|&quot;);\n</code></pre>\n<p>After this, <code>bigParts[0]</code> contains the word (possibly with white space) and <code>bigParts[1]</code> contains all the synonyms as a single string (possibly with white space). Note that <code>split()</code> takes a regular expression, which is why I included the <code>\\\\</code>. So it passes a single <code>\\</code> to split, to escape the pipe character that would otherwise stand for OR.</p>\n<p>You'll want to check the length of the array is at least 2 then do:</p>\n<pre class=\"lang-java prettyprint-override\"><code>   String[] synonyms = bigParts[1].split(&quot;,&quot;);\n</code></pre>\n<p>You can run through the array, trim them of white space, and then look for the one you want to remove it. Remove it from the array. Then reassemble a string (code of you to figure out), and do this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>   synonymData[index] = YourNewString;\n</code></pre>\n<p><strong>Method Two: ReplaceAll()</strong></p>\n<p>The other approach would be to just use a regular expression with <code>String.replaceAll()</code>. It would need to be a sorta complicated RE to make sure you only match the entire word. For instance, if you're supposed to remove <code>rent</code> you wouldn't want to match <code>parent</code>. That will take time to figure out, but when you're done, it's a single line of code.</p>\n<pre class=\"lang-java prettyprint-override\"><code>   synonymData[index] = synonymData[index].replaceAll(&quot;The big RE&quot;);\n</code></pre>\n"}],"comment_count":0,"is_answered":true,"view_count":56,"answer_count":2,"score":0,"last_activity_date":1701725108,"creation_date":1701199242,"last_edit_date":1701725108,"question_id":77566620,"body_markdown":"I have a question where i have to remove a  an array. for example;\r\n\r\n      2 (3, 5, 6) \r\n    \r\nIn this case in th array \r\n.\r\n    \r\nFor example, i have to implement this defintion in my main class,\r\n\r\n\r\n    \r\n\r\n    \r\n    \r\n      \r\n\r\n","link":"https://stackoverflow.com/questions/77566620/remove-an-element-from-an-index-in-an-array","title":"Remove an element from an index in an array","body":"<p>I have a question where i have to remove a  an array. for example;</p>\n<pre><code>  2 (3, 5, 6) \n</code></pre>\n<p>In this case in th array\n.</p>\n<p>For example, i have to implement this defintion in my main class,</p>\n"},{"tags":["java","spring-mvc","spring-security","azure-active-directory","saml-2.0"],"comment_count":0,"is_answered":false,"view_count":75,"answer_count":0,"score":0,"last_activity_date":1701717699,"creation_date":1696504457,"last_edit_date":1701717699,"question_id":77236583,"body_markdown":"I have created a Java application but I need to secure it using Azure AD SAML using Spring Boot I have done it but when I am trying to convert it for without Spring Boot it is not working.\r\n\r\nHere is my SamlAppConfig file where I do configuration:    \r\n\r\n    @Configuration\r\n    public class SamlSecurityConfiguration extends SamlServiceProviderServerBeanConfiguration {\r\n\r\n\t@Override\r\n\tprotected SamlServerConfiguration getDefaultHostSamlServerConfiguration() {\r\n\t\tfinal SamlServerConfiguration samlAppConfig = new SamlServerConfiguration();\r\n        final LocalServiceProviderConfiguration serviceProvider = getLocalServiceProviderConfiguration();\r\n        samlAppConfig.setServiceProvider(serviceProvider);\r\n        return samlAppConfig;\r\n\t}\r\n\t\r\n\r\n\tprivate LocalServiceProviderConfiguration getLocalServiceProviderConfiguration() {\r\n\t\tfinal LocalServiceProviderConfiguration serviceProvider = new LocalServiceProviderConfiguration();\r\n\r\n\t\tserviceProvider.setSignRequests(false);\r\n\t\tserviceProvider.setWantAssertionsSigned(false);\r\n\t\tserviceProvider.setEntityId(&quot;https://localhost:8443&quot;);\r\n\t\tserviceProvider.setSignMetadata(false);\r\n\t\tserviceProvider.setKeys(rotatingKeys());\r\n\t\tserviceProvider.setBasePath(&quot;/&quot;);\r\n\t\tList&lt;Object&gt; namedIds = new ArrayList&lt;&gt;();\r\n\t\tnamedIds.add(&quot;urn:oasis:names:tc:SAML:2.0:nameid-format:persistent&quot;);\r\n\t\tnamedIds.add(&quot;urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress&quot;);\r\n\t\tnamedIds.add(&quot;urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified&quot;);\r\n\t\tserviceProvider.setNameIds(namedIds);\r\n\t\tList&lt;ExternalIdentityProviderConfiguration&gt; providers = new ArrayList&lt;&gt;();\r\n\t\tproviders.add(externalProvider());\r\n\t\tserviceProvider.setProviders(providers);\r\n\t\treturn serviceProvider;\r\n\t}\r\n\r\n\tprivate ExternalIdentityProviderConfiguration externalProvider() {\r\n\t\tfinal ExternalIdentityProviderConfiguration externalIdentityProviderConfiguration = new ExternalIdentityProviderConfiguration();\r\n\t\texternalIdentityProviderConfiguration.setMetadata(&quot;https://dev-673817.okta.com/app/exkqkkg0kUVEvNyg14x6/sso/saml/metadata&quot;);\r\n\t\ttry{\r\n\t\t\texternalIdentityProviderConfiguration.setAuthenticationRequestBinding(new java.net.URI(&quot;urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST&quot;));\r\n\t\t}catch(URISyntaxException e){\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\t\texternalIdentityProviderConfiguration.setSkipSslValidation(true);\r\n\r\n\t\treturn externalIdentityProviderConfiguration;\r\n\t}\r\n\r\n\tprivate RotatingKeys rotatingKeys() {\r\n\t\tX509Certificate myCertificate = CertUtil.getCertificateByName(&quot;spring&quot;, &quot;keystore.jks&quot;, &quot;secret&quot;);\r\n\t\tfinal RotatingKeys rotatingKeys = new RotatingKeys();\r\n\t\tSimpleKey activeKey = new SimpleKey();\r\n\t\tactiveKey.setName(&quot;spring&quot;);\r\n\t\ttry {\r\n\t\t\tactiveKey.setCertificate(getCertificateForKey(myCertificate));\r\n\t\t} catch (CertificateEncodingException e) {\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\t\trotatingKeys.setActive(activeKey);\r\n\t\treturn rotatingKeys;\r\n\t}\r\n\r\n\tprivate String getCertificateForKey(X509Certificate myCertificate) throws CertificateEncodingException {\r\n\t\treturn getEncoder().encodeToString(myCertificate.getEncoded());\r\n\t}\r\n    }\r\n\r\nAnd this is my WebSecurityConfigurerAdapter configuration:\r\n\r\n    @EnableWebSecurity\r\n    @Configuration\r\n    @Order(2)\r\n    public class SecurityConfiguration extends WebSecurityConfigurerAdapter {\r\n    \r\n    \t@Override\r\n    \tprotected void configure(final HttpSecurity http) throws Exception {\r\n    \t\thttp\r\n    \t\t\t\t.antMatcher(&quot;/**&quot;)\r\n    \t\t\t\t.authorizeRequests()\r\n    \t\t\t\t.antMatchers(GET, &quot;/home&quot;).permitAll()\r\n    \t\t\t\t.antMatchers(GET, &quot;/api/samlLink&quot;).permitAll()\r\n    \t\t\t\t.antMatchers(&quot;/**&quot;).authenticated()\r\n    \t\t\t\t.and()\r\n    \t\t\t\t.formLogin().loginPage(&quot;/home&quot;)\r\n    \t\t;\r\n    \r\n    \t\thttp.csrf().disable();\r\n    \t\thttp.headers().cacheControl().disable();\r\n    \t}\r\n    }\r\n\r\nAnd to read creti:\r\n\r\n    public class CertUtil {\r\n    \r\n    \tpublic static X509Certificate getCertificateByName(String certificateAlias, String trustStoreName, String password) {\r\n    \t\ttry {\r\n    \t\t\tKeyStore keyStore = KeyStore.getInstance(&quot;JKS&quot;);\r\n    \t\t\tloadKeyStore(keyStore, trustStoreName, password);\r\n    \t\t\tCertificate cert = keyStore.getCertificate(certificateAlias);\r\n    \t\t\tif (cert.getType().equals(&quot;X.509&quot;)) {\r\n    \t\t\t\treturn (X509Certificate) cert;\r\n    \t\t\t}\r\n    \t\t\tthrow new Error(&quot;Could not find a suitable x509 certificate for alias &quot; + certificateAlias + &quot; in &quot; + trustStoreName);\r\n    \t\t} catch (KeyStoreException | IOException | NoSuchAlgorithmException | CertificateException e) {\r\n    \t\t\tthrow new Error(&quot;Error opening keystore: &quot; + e.getCause(), e);\r\n    \t\t}\r\n    \t}\r\n    \r\n    \tprivate static void loadKeyStore(KeyStore keyStore, String jksPath, String jksPassword) throws IOException, NoSuchAlgorithmException,\r\n    \t\t\tCertificateException {\r\n    \t\tchar[] password = null;\r\n    \t\tif (jksPassword != null) {\r\n    \t\t\tpassword = jksPassword.toCharArray();\r\n    \t\t}\r\n    \t\tkeyStore.load(ClassLoader.getSystemResourceAsStream(jksPath), password);\r\n    \t}\r\n    }\r\n\r\nThis is my filter class where I check for the authentication:\r\n\r\n    public class SamlAuthenticationFilter implements Filter {\r\n\r\n    \t@Override\r\n    \tpublic void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)\r\n    \t\t\tthrows IOException, ServletException {\r\n    \t\tHttpServletRequest req = (HttpServletRequest) request;\r\n    \t\tHttpServletResponse res = (HttpServletResponse) response;\r\n    \t\t\r\n    \t\tAuthentication authentication = (Authentication) req.getUserPrincipal();\r\n    \t\tSamlAuthentication samlAuthentication = (SamlAuthentication) authentication;\r\n    \t\tif (samlAuthentication.isAuthenticated()) {\r\n    \t\t\tchain.doFilter(request, response);\r\n    \t\t\treturn;\r\n    \t\t} else {\r\n    \t\t\t\r\n    \t\t}\r\n    \t\t \r\n    \t}\r\n\r\n    }\r\n\r\nBut I am create jar and include it in my java application but it&#39;s not working and I am using this dependencies:\r\n\r\n    &lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.security.extensions&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-security-saml2-core&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;2.0.0.M31&lt;/version&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\nHow can I correct the security so I can secure my application using Java filter and not Spring Boot?\r\n","link":"https://stackoverflow.com/questions/77236583/secure-java-we-application-using-azure-ad-saml-but-do-not-want-to-use-spring-boo","title":"Secure Java we application using Azure AD SAML but do not want to use Spring Boot","body":"<p>I have created a Java application but I need to secure it using Azure AD SAML using Spring Boot I have done it but when I am trying to convert it for without Spring Boot it is not working.</p>\n<p>Here is my SamlAppConfig file where I do configuration:</p>\n<pre><code>@Configuration\npublic class SamlSecurityConfiguration extends SamlServiceProviderServerBeanConfiguration {\n\n@Override\nprotected SamlServerConfiguration getDefaultHostSamlServerConfiguration() {\n    final SamlServerConfiguration samlAppConfig = new SamlServerConfiguration();\n    final LocalServiceProviderConfiguration serviceProvider = getLocalServiceProviderConfiguration();\n    samlAppConfig.setServiceProvider(serviceProvider);\n    return samlAppConfig;\n}\n\n\nprivate LocalServiceProviderConfiguration getLocalServiceProviderConfiguration() {\n    final LocalServiceProviderConfiguration serviceProvider = new LocalServiceProviderConfiguration();\n\n    serviceProvider.setSignRequests(false);\n    serviceProvider.setWantAssertionsSigned(false);\n    serviceProvider.setEntityId(&quot;https://localhost:8443&quot;);\n    serviceProvider.setSignMetadata(false);\n    serviceProvider.setKeys(rotatingKeys());\n    serviceProvider.setBasePath(&quot;/&quot;);\n    List&lt;Object&gt; namedIds = new ArrayList&lt;&gt;();\n    namedIds.add(&quot;urn:oasis:names:tc:SAML:2.0:nameid-format:persistent&quot;);\n    namedIds.add(&quot;urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress&quot;);\n    namedIds.add(&quot;urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified&quot;);\n    serviceProvider.setNameIds(namedIds);\n    List&lt;ExternalIdentityProviderConfiguration&gt; providers = new ArrayList&lt;&gt;();\n    providers.add(externalProvider());\n    serviceProvider.setProviders(providers);\n    return serviceProvider;\n}\n\nprivate ExternalIdentityProviderConfiguration externalProvider() {\n    final ExternalIdentityProviderConfiguration externalIdentityProviderConfiguration = new ExternalIdentityProviderConfiguration();\n    externalIdentityProviderConfiguration.setMetadata(&quot;https://dev-673817.okta.com/app/exkqkkg0kUVEvNyg14x6/sso/saml/metadata&quot;);\n    try{\n        externalIdentityProviderConfiguration.setAuthenticationRequestBinding(new java.net.URI(&quot;urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST&quot;));\n    }catch(URISyntaxException e){\n        e.printStackTrace();\n    }\n    externalIdentityProviderConfiguration.setSkipSslValidation(true);\n\n    return externalIdentityProviderConfiguration;\n}\n\nprivate RotatingKeys rotatingKeys() {\n    X509Certificate myCertificate = CertUtil.getCertificateByName(&quot;spring&quot;, &quot;keystore.jks&quot;, &quot;secret&quot;);\n    final RotatingKeys rotatingKeys = new RotatingKeys();\n    SimpleKey activeKey = new SimpleKey();\n    activeKey.setName(&quot;spring&quot;);\n    try {\n        activeKey.setCertificate(getCertificateForKey(myCertificate));\n    } catch (CertificateEncodingException e) {\n        e.printStackTrace();\n    }\n    rotatingKeys.setActive(activeKey);\n    return rotatingKeys;\n}\n\nprivate String getCertificateForKey(X509Certificate myCertificate) throws CertificateEncodingException {\n    return getEncoder().encodeToString(myCertificate.getEncoded());\n}\n}\n</code></pre>\n<p>And this is my WebSecurityConfigurerAdapter configuration:</p>\n<pre><code>@EnableWebSecurity\n@Configuration\n@Order(2)\npublic class SecurityConfiguration extends WebSecurityConfigurerAdapter {\n\n    @Override\n    protected void configure(final HttpSecurity http) throws Exception {\n        http\n                .antMatcher(&quot;/**&quot;)\n                .authorizeRequests()\n                .antMatchers(GET, &quot;/home&quot;).permitAll()\n                .antMatchers(GET, &quot;/api/samlLink&quot;).permitAll()\n                .antMatchers(&quot;/**&quot;).authenticated()\n                .and()\n                .formLogin().loginPage(&quot;/home&quot;)\n        ;\n\n        http.csrf().disable();\n        http.headers().cacheControl().disable();\n    }\n}\n</code></pre>\n<p>And to read creti:</p>\n<pre><code>public class CertUtil {\n\n    public static X509Certificate getCertificateByName(String certificateAlias, String trustStoreName, String password) {\n        try {\n            KeyStore keyStore = KeyStore.getInstance(&quot;JKS&quot;);\n            loadKeyStore(keyStore, trustStoreName, password);\n            Certificate cert = keyStore.getCertificate(certificateAlias);\n            if (cert.getType().equals(&quot;X.509&quot;)) {\n                return (X509Certificate) cert;\n            }\n            throw new Error(&quot;Could not find a suitable x509 certificate for alias &quot; + certificateAlias + &quot; in &quot; + trustStoreName);\n        } catch (KeyStoreException | IOException | NoSuchAlgorithmException | CertificateException e) {\n            throw new Error(&quot;Error opening keystore: &quot; + e.getCause(), e);\n        }\n    }\n\n    private static void loadKeyStore(KeyStore keyStore, String jksPath, String jksPassword) throws IOException, NoSuchAlgorithmException,\n            CertificateException {\n        char[] password = null;\n        if (jksPassword != null) {\n            password = jksPassword.toCharArray();\n        }\n        keyStore.load(ClassLoader.getSystemResourceAsStream(jksPath), password);\n    }\n}\n</code></pre>\n<p>This is my filter class where I check for the authentication:</p>\n<pre><code>public class SamlAuthenticationFilter implements Filter {\n\n    @Override\n    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)\n            throws IOException, ServletException {\n        HttpServletRequest req = (HttpServletRequest) request;\n        HttpServletResponse res = (HttpServletResponse) response;\n        \n        Authentication authentication = (Authentication) req.getUserPrincipal();\n        SamlAuthentication samlAuthentication = (SamlAuthentication) authentication;\n        if (samlAuthentication.isAuthenticated()) {\n            chain.doFilter(request, response);\n            return;\n        } else {\n            \n        }\n         \n    }\n\n}\n</code></pre>\n<p>But I am create jar and include it in my java application but it's not working and I am using this dependencies:</p>\n<pre><code>&lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.security.extensions&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-security-saml2-core&lt;/artifactId&gt;\n        &lt;version&gt;2.0.0.M31&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre>\n<p>How can I correct the security so I can secure my application using Java filter and not Spring Boot?</p>\n"},{"tags":["java","keycloak","saml","saml-2.0","opensaml"],"comment_count":0,"is_answered":false,"view_count":31,"answer_count":0,"score":0,"last_activity_date":1701717602,"creation_date":1698139081,"last_edit_date":1701717602,"question_id":77350852,"body_markdown":"I am trying to secure my Java web application using Keycloak SAML authentication but somehow when I am trying to generate the AuthnRequest it is not passing `&lt;ds:DigestValue&gt;` and `&lt;ds:SignatureValue&gt;` and may be because of the keycloak is giving below error:\r\n\r\n    2023-10-24 09:08:03,777 ERROR [org.keycloak.protocol.saml.SamlService] (executor-thread-21) request validation failed: org.keycloak.common.VerificationException: SigAlg was null\r\n\r\nTo generate AuthnRequest my code is as below:\r\n\r\n     public AuthnRequest buildRequest(String spProviderId, String acsUrl, String idpUrl) {\r\n    \t\t\t\r\n    \t\t\tIssuerBuilder issuerBuilder = new IssuerBuilder();\r\n    \t\t\tIssuer issuer = issuerBuilder.buildObject(&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;, &quot;Issuer&quot;, &quot;saml2&quot;);\r\n    \t\t\tissuer.setValue(spProviderId);\r\n    \r\n    \t\t\t/* Creation of AuthRequestObject */\r\n    \t\t\tDateTime issueInstant = new DateTime();\r\n    \t\t\tAuthnRequestBuilder authRequestBuilder = new AuthnRequestBuilder();\r\n    \r\n    \t\t\tAuthnRequest authRequest = authRequestBuilder.buildObject(SAMLConstants.SAML20P_NS, &quot;AuthnRequest&quot;, &quot;saml2&quot;);\r\n    \t\t\tauthRequest.setForceAuthn(false);\r\n    \t\t\tauthRequest.setIssueInstant(issueInstant);\r\n    \t\t\tauthRequest.setProtocolBinding(SAMLConstants.SAML2_POST_BINDING_URI);\r\n    \t\t\tauthRequest.setAssertionConsumerServiceURL(acsUrl);\r\n    \t\t\tauthRequest.setIssuer(issuer);\r\n    \t\t\tauthRequest.setID(generateID());\r\n    \t\t\tauthRequest.setVersion(SAMLVersion.VERSION_20);\r\n    \t\t\tauthRequest.setDestination(idpUrl);\r\n    \t\t\tauthRequest.setNameIDPolicy(buildNameIdPolicy());\r\n    \t\t\t\r\n    \t\t\tXMLObjectBuilder&lt;Signature&gt; signFactory = Configuration.getBuilderFactory().getBuilder(Signature.DEFAULT_ELEMENT_NAME);\r\n    \t\t    Signature signature = signFactory.buildObject(Signature.DEFAULT_ELEMENT_NAME);\r\n    \t\t    Credential cred = null;\r\n    \t\t            try {\r\n    \t\t            \tcred = this.getSenderSigningCredential();\r\n    \t\t            \t//signature.setSignatureAlgorithm(SignatureConstants.ALGO_ID_SIGNATURE_RSA_SHA256);\r\n    \t\t            \t//  signature.setCanonicalizationAlgorithm(SignatureConstants.ALGO_ID_C14N_EXCL_OMIT_COMMENTS);\r\n    \t\t            \t  \r\n    \t\t\t\t\t\tsignature.setSigningCredential(cred);\r\n    \t\t\t\t\t} catch (Exception e) {\r\n    \t\t\t\t\t\t// TODO Auto-generated catch block\r\n    \t\t\t\t\t\te.printStackTrace();\r\n    \t\t\t\t\t}\r\n    \t\t            \r\n    \t\t            // Perform signing\r\n    \t\t            try {\r\n    \t\t            \t  SecurityHelper.prepareSignatureParams(signature, cred, null, null);\r\n    \t\t            \t  SecurityConfiguration secConfiguration = Configuration.getGlobalSecurityConfiguration(); \r\n    \t\t                  NamedKeyInfoGeneratorManager namedKeyInfoGeneratorManager = secConfiguration.getKeyInfoGeneratorManager(); \r\n    \t\t                  KeyInfoGeneratorManager keyInfoGeneratorManager = namedKeyInfoGeneratorManager.getDefaultManager();\r\n    \t\t                  KeyInfoGeneratorFactory keyInfoGeneratorFactory = keyInfoGeneratorManager.getFactory(cred);\r\n    \t\t                  KeyInfoGenerator keyInfoGenerator = keyInfoGeneratorFactory.newInstance();\r\n    \t\t                  KeyInfo keyInfo = null;\r\n    \t\t                  try {\r\n    \t\t                      keyInfo = keyInfoGenerator.generate(cred);\r\n    \t\t                  } catch  (Exception e) {\r\n    \t\t                      e.printStackTrace();\r\n    \t\t                  } \r\n    \t\t                  signature.setKeyInfo(keyInfo);\r\n    \t\t                  authRequest.setSignature(signature);\r\n    \t\t            \t  \r\n    \t\t            \t  \r\n    \t\t            \t  \r\n    \t\t            \t  Marshaller marshaller = Configuration.getMarshallerFactory().getMarshaller(authRequest);\r\n    \t\t            \t  marshaller.marshall(authRequest);\r\n    \t\t              \r\n    \t\t            \t  \r\n    \t\t\t\t\t\tSigner.signObject(signature);\r\n    \t\t\t\t\t} catch (Exception e) {\r\n    \t\t\t\t\t\t// TODO Auto-generated catch block\r\n    \t\t\t\t\t\te.printStackTrace();\r\n    \t\t\t\t\t}\r\n    \t\t\treturn authRequest;\r\n    \t\t}\r\n\r\nBut when I am printing it XML it is showing as below:\r\n\r\n    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;saml2p:AuthnRequest \r\n    xmlns:saml2p=&quot;urn:oasis:names:tc:SAML:2.0:protocol&quot; AssertionConsumerServiceURL=&quot;http://localhost:9222/saml/*&quot; Destination=&quot;http://localhost:8280/realms/IDP_REALM/protocol/saml&quot; ForceAuthn=&quot;false&quot; ID=&quot;_4479bf8ac628da22c598a8427556a2ef5be431e5&quot; IssueInstant=&quot;2023-10-23T16:26:45.682Z&quot; ProtocolBinding=&quot;urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST&quot; Version=&quot;2.0&quot;&gt;&lt;saml2p:Issuer xmlns:saml2p=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;&gt;Sample&lt;/saml2p:Issuer&gt;&lt;ds:Signature xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\r\n    &lt;ds:SignedInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\r\n    &lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;/&gt;\r\n    &lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot; xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;/&gt;\r\n    &lt;ds:Reference URI=&quot;#_4479bf8ac628da22c598a8427556a2ef5be431e5&quot; xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\r\n    &lt;ds:Transforms xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\r\n    &lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot; xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;/&gt;\r\n    &lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;/&gt;\r\n    &lt;/ds:Transforms&gt;\r\n    &lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#sha1&quot; xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;/&gt;\r\n    &lt;ds:DigestValue xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;/&gt;\r\n    &lt;/ds:Reference&gt;\r\n    &lt;/ds:SignedInfo&gt;\r\n    &lt;ds:SignatureValue xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;/&gt;\r\n    &lt;ds:KeyInfo&gt;&lt;ds:X509Data&gt;&lt;ds:X509Certificate&gt;MIICmzCCAYMCBgGK23vMZzANBgkqhkiG9w0BAQsFADARMQ8wDQYDVQQDDAZTYW1wbGUwHhcNMjMw\r\n    OTI4MTEwODU4WhcNMzMwOTI4MTExMDM4WjARMQ8wDQYDVQQDDAZTYW1wbGUwggEiMA0GCSqGSIb3\r\n    DQEBAQUAA4IBDwAwggEKAoIBAQCrxYgVkHoGaC1PAvffPNJYIVbZqfaoRInDI74CqRHoLCm\r\n    aaTfhzwfXrrOU/ys72Ult4Ff3wC8iQjONtNJTv0XTHw1vpnuOXzqMZ62N7IAE+N2J0UpK8+3yE1q\r\n    Xlss07qiHl6Bege+epk+Ae/iqiqyg1vre/8JUe61cbpWSlsQFb+O0/wrl9o576ak3BPo3zWgy\r\n    W/APTfI0jkNoJpflrMK2ahk51lIzjxwLyYAnsOKw5VGnAYxDL3nDXcuY3aERB9rZec7YVA/hzWcg\r\n    OUeWEhnmd3xCmw2kZ1MHcIs8dpFHJdhH6TgZljHhC7B/KhC1yRwMWCyFAgMBAAEwDQYJ\r\n    KoZIhvcNAQELBQADggEBAKsqbTj9F0tUyKNDAUPwXh8dFfR0ztKNjUXxMHzf5ufU\r\n    Cj7cDK3p3PSN/a4KlIj18A86BZ4ABU8oUJja0XG2Jt5MgoaifktC+ymYN73q6kLx4IklG5y3U5RS\r\n    3W7jKXd9lf/kE+n4tUjzETfISpUdx/80asWU5WLlcoYUk0jK8u3u10kYMkGVcpxchy32KUxEQ6i8\r\n    6ODZZ0qlKCwAuELPdDrK+SwVvJL3gBbCoxcNNJWKWj5VAGwdqzorrE2uHuhzSmDYMQYRkCGedexV\r\n    Rrkp8byYxR3cpnh4OZr32E9XcvhLyQUJqsMuYHouRa99wYIW3Dr/CUW0K10=&lt;/ds:X509Certificate&gt;&lt;/ds:X509Data&gt;&lt;/ds:KeyInfo&gt;&lt;/ds:Signature&gt;&lt;saml2p:NameIDPolicy AllowCreate=&quot;true&quot; Format=&quot;urn:oasis:names:tc:SAML:2.0:nameid-format:transient&quot; xmlns:saml2p=&quot;urn:oasis:names:tc:SAML:2.0:protocol&quot;/&gt;&lt;/saml2p:AuthnRequest&gt;\r\n\r\nHow can I set those two values, or why keycloak is giving that error?\r\n","link":"https://stackoverflow.com/questions/77350852/how-to-generate-dsdigestvalue-and-dssignaturevalue-using-java-saml2-0","title":"How to generate &lt;ds:DigestValue&gt; and &lt;ds:SignatureValue&gt; using java SAML2.0","body":"<p>I am trying to secure my Java web application using Keycloak SAML authentication but somehow when I am trying to generate the AuthnRequest it is not passing <code>&lt;ds:DigestValue&gt;</code> and <code>&lt;ds:SignatureValue&gt;</code> and may be because of the keycloak is giving below error:</p>\n<pre><code>2023-10-24 09:08:03,777 ERROR [org.keycloak.protocol.saml.SamlService] (executor-thread-21) request validation failed: org.keycloak.common.VerificationException: SigAlg was null\n</code></pre>\n<p>To generate AuthnRequest my code is as below:</p>\n<pre><code> public AuthnRequest buildRequest(String spProviderId, String acsUrl, String idpUrl) {\n            \n            IssuerBuilder issuerBuilder = new IssuerBuilder();\n            Issuer issuer = issuerBuilder.buildObject(&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;, &quot;Issuer&quot;, &quot;saml2&quot;);\n            issuer.setValue(spProviderId);\n\n            /* Creation of AuthRequestObject */\n            DateTime issueInstant = new DateTime();\n            AuthnRequestBuilder authRequestBuilder = new AuthnRequestBuilder();\n\n            AuthnRequest authRequest = authRequestBuilder.buildObject(SAMLConstants.SAML20P_NS, &quot;AuthnRequest&quot;, &quot;saml2&quot;);\n            authRequest.setForceAuthn(false);\n            authRequest.setIssueInstant(issueInstant);\n            authRequest.setProtocolBinding(SAMLConstants.SAML2_POST_BINDING_URI);\n            authRequest.setAssertionConsumerServiceURL(acsUrl);\n            authRequest.setIssuer(issuer);\n            authRequest.setID(generateID());\n            authRequest.setVersion(SAMLVersion.VERSION_20);\n            authRequest.setDestination(idpUrl);\n            authRequest.setNameIDPolicy(buildNameIdPolicy());\n            \n            XMLObjectBuilder&lt;Signature&gt; signFactory = Configuration.getBuilderFactory().getBuilder(Signature.DEFAULT_ELEMENT_NAME);\n            Signature signature = signFactory.buildObject(Signature.DEFAULT_ELEMENT_NAME);\n            Credential cred = null;\n                    try {\n                        cred = this.getSenderSigningCredential();\n                        //signature.setSignatureAlgorithm(SignatureConstants.ALGO_ID_SIGNATURE_RSA_SHA256);\n                        //  signature.setCanonicalizationAlgorithm(SignatureConstants.ALGO_ID_C14N_EXCL_OMIT_COMMENTS);\n                          \n                        signature.setSigningCredential(cred);\n                    } catch (Exception e) {\n                        // TODO Auto-generated catch block\n                        e.printStackTrace();\n                    }\n                    \n                    // Perform signing\n                    try {\n                          SecurityHelper.prepareSignatureParams(signature, cred, null, null);\n                          SecurityConfiguration secConfiguration = Configuration.getGlobalSecurityConfiguration(); \n                          NamedKeyInfoGeneratorManager namedKeyInfoGeneratorManager = secConfiguration.getKeyInfoGeneratorManager(); \n                          KeyInfoGeneratorManager keyInfoGeneratorManager = namedKeyInfoGeneratorManager.getDefaultManager();\n                          KeyInfoGeneratorFactory keyInfoGeneratorFactory = keyInfoGeneratorManager.getFactory(cred);\n                          KeyInfoGenerator keyInfoGenerator = keyInfoGeneratorFactory.newInstance();\n                          KeyInfo keyInfo = null;\n                          try {\n                              keyInfo = keyInfoGenerator.generate(cred);\n                          } catch  (Exception e) {\n                              e.printStackTrace();\n                          } \n                          signature.setKeyInfo(keyInfo);\n                          authRequest.setSignature(signature);\n                          \n                          \n                          \n                          Marshaller marshaller = Configuration.getMarshallerFactory().getMarshaller(authRequest);\n                          marshaller.marshall(authRequest);\n                      \n                          \n                        Signer.signObject(signature);\n                    } catch (Exception e) {\n                        // TODO Auto-generated catch block\n                        e.printStackTrace();\n                    }\n            return authRequest;\n        }\n</code></pre>\n<p>But when I am printing it XML it is showing as below:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;saml2p:AuthnRequest \nxmlns:saml2p=&quot;urn:oasis:names:tc:SAML:2.0:protocol&quot; AssertionConsumerServiceURL=&quot;http://localhost:9222/saml/*&quot; Destination=&quot;http://localhost:8280/realms/IDP_REALM/protocol/saml&quot; ForceAuthn=&quot;false&quot; ID=&quot;_4479bf8ac628da22c598a8427556a2ef5be431e5&quot; IssueInstant=&quot;2023-10-23T16:26:45.682Z&quot; ProtocolBinding=&quot;urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST&quot; Version=&quot;2.0&quot;&gt;&lt;saml2p:Issuer xmlns:saml2p=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;&gt;Sample&lt;/saml2p:Issuer&gt;&lt;ds:Signature xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\n&lt;ds:SignedInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\n&lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;/&gt;\n&lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot; xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;/&gt;\n&lt;ds:Reference URI=&quot;#_4479bf8ac628da22c598a8427556a2ef5be431e5&quot; xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\n&lt;ds:Transforms xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;\n&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot; xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;/&gt;\n&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;/&gt;\n&lt;/ds:Transforms&gt;\n&lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#sha1&quot; xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;/&gt;\n&lt;ds:DigestValue xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;/&gt;\n&lt;/ds:Reference&gt;\n&lt;/ds:SignedInfo&gt;\n&lt;ds:SignatureValue xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;/&gt;\n&lt;ds:KeyInfo&gt;&lt;ds:X509Data&gt;&lt;ds:X509Certificate&gt;MIICmzCCAYMCBgGK23vMZzANBgkqhkiG9w0BAQsFADARMQ8wDQYDVQQDDAZTYW1wbGUwHhcNMjMw\nOTI4MTEwODU4WhcNMzMwOTI4MTExMDM4WjARMQ8wDQYDVQQDDAZTYW1wbGUwggEiMA0GCSqGSIb3\nDQEBAQUAA4IBDwAwggEKAoIBAQCrxYgVkHoGaC1PAvffPNJYIVbZqfaoRInDI74CqRHoLCm\naaTfhzwfXrrOU/ys72Ult4Ff3wC8iQjONtNJTv0XTHw1vpnuOXzqMZ62N7IAE+N2J0UpK8+3yE1q\nXlss07qiHl6Bege+epk+Ae/iqiqyg1vre/8JUe61cbpWSlsQFb+O0/wrl9o576ak3BPo3zWgy\nW/APTfI0jkNoJpflrMK2ahk51lIzjxwLyYAnsOKw5VGnAYxDL3nDXcuY3aERB9rZec7YVA/hzWcg\nOUeWEhnmd3xCmw2kZ1MHcIs8dpFHJdhH6TgZljHhC7B/KhC1yRwMWCyFAgMBAAEwDQYJ\nKoZIhvcNAQELBQADggEBAKsqbTj9F0tUyKNDAUPwXh8dFfR0ztKNjUXxMHzf5ufU\nCj7cDK3p3PSN/a4KlIj18A86BZ4ABU8oUJja0XG2Jt5MgoaifktC+ymYN73q6kLx4IklG5y3U5RS\n3W7jKXd9lf/kE+n4tUjzETfISpUdx/80asWU5WLlcoYUk0jK8u3u10kYMkGVcpxchy32KUxEQ6i8\n6ODZZ0qlKCwAuELPdDrK+SwVvJL3gBbCoxcNNJWKWj5VAGwdqzorrE2uHuhzSmDYMQYRkCGedexV\nRrkp8byYxR3cpnh4OZr32E9XcvhLyQUJqsMuYHouRa99wYIW3Dr/CUW0K10=&lt;/ds:X509Certificate&gt;&lt;/ds:X509Data&gt;&lt;/ds:KeyInfo&gt;&lt;/ds:Signature&gt;&lt;saml2p:NameIDPolicy AllowCreate=&quot;true&quot; Format=&quot;urn:oasis:names:tc:SAML:2.0:nameid-format:transient&quot; xmlns:saml2p=&quot;urn:oasis:names:tc:SAML:2.0:protocol&quot;/&gt;&lt;/saml2p:AuthnRequest&gt;\n</code></pre>\n<p>How can I set those two values, or why keycloak is giving that error?</p>\n"},{"tags":["java","spring-boot","spring-security","jira","jira-plugin"],"comments":[{"score":0,"post_type":"question","creation_date":1701104265,"post_id":77558157,"comment_id":136730920,"body_markdown":"your exception says that you have not configured your database..... please read your exceptions before asking here.... remove your postgres dependency","link":"https://stackoverflow.com/questions/77558157/spring-boot-application-for-atlassian-security-is-not-starting#comment136730920_77558157","body":"your exception says that you have not configured your database..... please read your exceptions before asking here.... remove your postgres dependency"}],"comment_count":1,"is_answered":false,"view_count":29,"answer_count":0,"score":0,"last_activity_date":1701717548,"creation_date":1701099558,"last_edit_date":1701717548,"question_id":77558157,"body_markdown":"I have two Spring Boot application one is normal application which include another application as dependency. And in 2nd application I have written Jira security which needs to be added on 1st application.\r\n\r\nBoth separately working fine but the when I am adding 2nd app in 1st app it is showing below error:\r\n\r\n    ***************************\r\n    APPLICATION FAILED TO START\r\n    ***************************\r\n    \r\n    Description:\r\n    \r\n    Parameter 0 of constructor in com.atlassian.connect.spring.internal.request.oauth2.OAuth2JwtClientRegistrationRepository required a bean named &#39;entityManagerFactory&#39; that could not be found.\r\n    \r\n    The injection point has the following annotations:\r\n    \t- @org.springframework.beans.factory.annotation.Autowired(required=true)\r\n    \t- @org.springframework.beans.factory.annotation.Qualifier(&quot;oauth2-jwt-impersonation&quot;)\r\n    \r\n    \r\n    Action:\r\n    \r\n    Consider defining a bean named &#39;entityManagerFactory&#39; in your configuration.\r\n\r\nIn my security application I have following classes:\r\n\r\n    @Component\r\n    public class JiraUtility {\r\n        public AtlassianHostRestClients getAtlassianHostRestClients() {\r\n            return (AtlassianHostRestClients) GetBean.context.getBean(&quot;atlassianHostRestClientsImpl&quot;);\r\n        }\r\n    \r\n    }\r\n\r\nTo get created bean we use application context aware:\r\n\r\n    @Component\r\n    public class GetBean implements ApplicationContextAware {\r\n        public static ApplicationContext context;\r\n        @Override\r\n        public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {\r\n            context = applicationContext;\r\n        }\r\n    }\r\n\r\nAnd oauth 2 implementation is as below: \r\n\r\n    @Component(&quot;oAuth2ClientRequestFilter&quot;)\r\n    public class OAuth2ClientRequestFilter implements ClientRequestFilter {\r\n    \r\n        @Autowired\r\n        private AtlassianHostRestClients atlassianHostRestClients;\r\n    \r\n        @Autowired\r\n        private AtlassianHostRepository hostRepository;\r\n    \r\n        private String userAccountId;\r\n    \r\n        @Override\r\n        public void filter(ClientRequestContext requestContext) {\r\n            AtlassianHostUser hostUser = AtlassianHostUser.builder(getHost(requestContext))\r\n                    .withUserAccountId(userAccountId)\r\n                    .build();\r\n            String token = atlassianHostRestClients.getAccessToken(hostUser).getTokenValue();\r\n            requestContext.getHeaders().add(&quot;Authorization&quot;, String.format(&quot;Bearer %s&quot;, token));\r\n        }\r\n    \r\n        public String getUserAccountId() {\r\n            return userAccountId;\r\n        }\r\n    \r\n        public void setUserAccountId(String userAccountId) {\r\n            this.userAccountId = userAccountId;\r\n        }\r\n    \r\n        private AtlassianHost getHost(ClientRequestContext requestContext) {\r\n            URI requestUri = requestContext.getUri();\r\n            String baseUrl = String.format(&quot;%s://%s&quot;, requestUri.getScheme(), requestUri.getHost());\r\n            return hostRepository.findFirstByBaseUrlOrderByLastModifiedDateDesc(baseUrl).get();\r\n        }\r\n    }\r\n\r\nAnd in pom.xml I have added below dependencies:\r\n\r\n    &lt;dependencies&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n                &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;com.atlassian.connect&lt;/groupId&gt;\r\n                &lt;artifactId&gt;atlassian-connect-spring-boot-starter&lt;/artifactId&gt;\r\n                &lt;version&gt;${atlassian-connect-spring-boot.version}&lt;/version&gt;\r\n            &lt;/dependency&gt;\r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;com.atlassian.connect&lt;/groupId&gt;\r\n                &lt;artifactId&gt;atlassian-connect-spring-boot-jpa-starter&lt;/artifactId&gt;\r\n                &lt;version&gt;${atlassian-connect-spring-boot.version}&lt;/version&gt;\r\n            &lt;/dependency&gt;\r\n    \r\n            &lt;dependency&gt;\r\n                &lt;groupId&gt;org.postgresql&lt;/groupId&gt;\r\n                &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\r\n                &lt;version&gt;42.2.25&lt;/version&gt;\r\n            &lt;/dependency&gt; \r\n    &lt;/dependencies&gt;\r\n\r\nAnd in Main application I have just Spring boot starter class :\r\n\r\n \r\n\r\n    @SpringBootApplication(exclude = {MongoAutoConfiguration.class, MongoDataAutoConfiguration.class, FreeMarkerAutoConfiguration.class})\r\n    @ComponentScan(basePackages = {&quot;com&quot;})\r\n    @EnableAutoConfiguration(exclude = {LiquibaseAutoConfiguration.class})\r\n    @ServletComponentScan(basePackages = &quot;com&quot;)\r\n    public class AivApplication extends SpringBootServletInitializer implements WebMvcConfigurer {\r\n    \r\n     public static void main(String[] args) throws Exception {\r\n            new SpringApplication(AivApplication.class).run(args);\r\n        }\r\n    }\r\n\r\n\r\nHow can I do it using adding security application as dependency in Spring Boot application? \r\n","link":"https://stackoverflow.com/questions/77558157/spring-boot-application-for-atlassian-security-is-not-starting","title":"Spring Boot application for Atlassian security is not starting","body":"<p>I have two Spring Boot application one is normal application which include another application as dependency. And in 2nd application I have written Jira security which needs to be added on 1st application.</p>\n<p>Both separately working fine but the when I am adding 2nd app in 1st app it is showing below error:</p>\n<pre><code>***************************\nAPPLICATION FAILED TO START\n***************************\n\nDescription:\n\nParameter 0 of constructor in com.atlassian.connect.spring.internal.request.oauth2.OAuth2JwtClientRegistrationRepository required a bean named 'entityManagerFactory' that could not be found.\n\nThe injection point has the following annotations:\n    - @org.springframework.beans.factory.annotation.Autowired(required=true)\n    - @org.springframework.beans.factory.annotation.Qualifier(&quot;oauth2-jwt-impersonation&quot;)\n\n\nAction:\n\nConsider defining a bean named 'entityManagerFactory' in your configuration.\n</code></pre>\n<p>In my security application I have following classes:</p>\n<pre><code>@Component\npublic class JiraUtility {\n    public AtlassianHostRestClients getAtlassianHostRestClients() {\n        return (AtlassianHostRestClients) GetBean.context.getBean(&quot;atlassianHostRestClientsImpl&quot;);\n    }\n\n}\n</code></pre>\n<p>To get created bean we use application context aware:</p>\n<pre><code>@Component\npublic class GetBean implements ApplicationContextAware {\n    public static ApplicationContext context;\n    @Override\n    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {\n        context = applicationContext;\n    }\n}\n</code></pre>\n<p>And oauth 2 implementation is as below:</p>\n<pre><code>@Component(&quot;oAuth2ClientRequestFilter&quot;)\npublic class OAuth2ClientRequestFilter implements ClientRequestFilter {\n\n    @Autowired\n    private AtlassianHostRestClients atlassianHostRestClients;\n\n    @Autowired\n    private AtlassianHostRepository hostRepository;\n\n    private String userAccountId;\n\n    @Override\n    public void filter(ClientRequestContext requestContext) {\n        AtlassianHostUser hostUser = AtlassianHostUser.builder(getHost(requestContext))\n                .withUserAccountId(userAccountId)\n                .build();\n        String token = atlassianHostRestClients.getAccessToken(hostUser).getTokenValue();\n        requestContext.getHeaders().add(&quot;Authorization&quot;, String.format(&quot;Bearer %s&quot;, token));\n    }\n\n    public String getUserAccountId() {\n        return userAccountId;\n    }\n\n    public void setUserAccountId(String userAccountId) {\n        this.userAccountId = userAccountId;\n    }\n\n    private AtlassianHost getHost(ClientRequestContext requestContext) {\n        URI requestUri = requestContext.getUri();\n        String baseUrl = String.format(&quot;%s://%s&quot;, requestUri.getScheme(), requestUri.getHost());\n        return hostRepository.findFirstByBaseUrlOrderByLastModifiedDateDesc(baseUrl).get();\n    }\n}\n</code></pre>\n<p>And in pom.xml I have added below dependencies:</p>\n<pre><code>&lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.atlassian.connect&lt;/groupId&gt;\n            &lt;artifactId&gt;atlassian-connect-spring-boot-starter&lt;/artifactId&gt;\n            &lt;version&gt;${atlassian-connect-spring-boot.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.atlassian.connect&lt;/groupId&gt;\n            &lt;artifactId&gt;atlassian-connect-spring-boot-jpa-starter&lt;/artifactId&gt;\n            &lt;version&gt;${atlassian-connect-spring-boot.version}&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.postgresql&lt;/groupId&gt;\n            &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\n            &lt;version&gt;42.2.25&lt;/version&gt;\n        &lt;/dependency&gt; \n&lt;/dependencies&gt;\n</code></pre>\n<p>And in Main application I have just Spring boot starter class :</p>\n<pre><code>@SpringBootApplication(exclude = {MongoAutoConfiguration.class, MongoDataAutoConfiguration.class, FreeMarkerAutoConfiguration.class})\n@ComponentScan(basePackages = {&quot;com&quot;})\n@EnableAutoConfiguration(exclude = {LiquibaseAutoConfiguration.class})\n@ServletComponentScan(basePackages = &quot;com&quot;)\npublic class AivApplication extends SpringBootServletInitializer implements WebMvcConfigurer {\n\n public static void main(String[] args) throws Exception {\n        new SpringApplication(AivApplication.class).run(args);\n    }\n}\n</code></pre>\n<p>How can I do it using adding security application as dependency in Spring Boot application?</p>\n"},{"tags":["java","keycloak","saml","saml-2.0"],"comment_count":0,"is_answered":false,"view_count":47,"answer_count":0,"score":0,"last_activity_date":1701717499,"creation_date":1698051839,"last_edit_date":1701717499,"question_id":77343929,"body_markdown":"I am trying to secure my web application using Keycloak saml but while adding Signature it is not working and giving below error:\r\n\r\n    exception [org.opensaml.ws.message.encoder.MessageEncodingException: Encountered error \r\n    marshalling message into its DOM representation] with root cause\r\n    \torg.apache.xml.security.signature.XMLSignatureException: The requested algorithm null does not exist. Original Message was: Cannot invoke &quot;java.lang.Class.newInstance()&quot; because &quot;&lt;local3&gt;&quot; is null\r\n    Original Exception was java.lang.NullPointerException: Cannot invoke &quot;java.lang.Class.newInstance()&quot; because &quot;&lt;local3&gt;&quot; is null\r\n    \t\tat org.apache.xml.security.algorithms.SignatureAlgorithm.&lt;init&gt;(Unknown Source)\r\n    \t\tat org.apache.xml.security.signature.SignedInfo.&lt;init&gt;(Unknown Source)\r\n    \t\tat org.apache.xml.security.signature.XMLSignature.&lt;init&gt;(Unknown Source)\r\n    \t\tat org.apache.xml.security.signature.XMLSignature.&lt;init&gt;(Unknown Source)\r\n\r\nAnd my code creating AuthnRequest is as below:\r\n\r\n    protected String generateID() {\r\n    \t        Random r = new Random();\r\n    \t        return &#39;a&#39; + Long.toString(Math.abs(r.nextLong()), 20) + Long.toString(Math.abs(r.nextLong()), 20);\r\n    \t    }\r\n    \t\tpublic AuthnRequest buildRequest(String spProviderId, String acsUrl, String idpUrl) {\r\n    \t\t\t/* Building Issuer object */\r\n    \t\t\t\r\n    \t\t\t\r\n    \t\t\tIssuerBuilder issuerBuilder = new IssuerBuilder();\r\n    \t\t\tIssuer issuer = issuerBuilder.buildObject(&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;, &quot;Issuer&quot;, &quot;saml2&quot;);\r\n    \t\t\tissuer.setValue(spProviderId);\r\n    \r\n    \t\t\t/* Creation of AuthRequestObject */\r\n    \t\t\tDateTime issueInstant = new DateTime();\r\n    \t\t\tAuthnRequestBuilder authRequestBuilder = new AuthnRequestBuilder();\r\n    \r\n    \t\t\tAuthnRequest authRequest = authRequestBuilder.buildObject(SAMLConstants.SAML20P_NS, &quot;AuthnRequest&quot;, &quot;saml2&quot;);\r\n    \t\t\tauthRequest.setForceAuthn(false);\r\n    \t\t\tauthRequest.setIssueInstant(issueInstant);\r\n    \t\t\tauthRequest.setProtocolBinding(SAMLConstants.SAML2_POST_BINDING_URI);\r\n    \t\t\tauthRequest.setAssertionConsumerServiceURL(acsUrl);\r\n    \t\t\tauthRequest.setIssuer(issuer);\r\n    \t\t\tauthRequest.setID(generateID());\r\n    \t\t\t// XXX: How do I get nameIdPolicy?\r\n    //\t\t\tauthRequest.setNameIDPolicy(nameIdPolicy);\r\n    \t\t\tauthRequest.setVersion(SAMLVersion.VERSION_20);\r\n    \t\t\tauthRequest.setDestination(idpUrl);\r\n    \t\t\t\r\n    \t\t\tSignatureBuilder signFactory = new SignatureBuilder();\r\n    \t\t    Signature signature = signFactory.buildObject(Signature.DEFAULT_ELEMENT_NAME);\r\n    \t\t            try {\r\n    \t\t\t\t\t\tsignature.setSigningCredential(this.getSenderSigningCredential());\r\n    \t\t\t\t\t} catch (Exception e) {\r\n    \t\t\t\t\t\t// TODO Auto-generated catch block\r\n    \t\t\t\t\t\te.printStackTrace();\r\n    \t\t\t\t\t}\r\n    \t\t// set signature\r\n    \t\t            authRequest.setSignature(signature);\r\n    \t\t\t\r\n    \r\n    \t\t\treturn authRequest;\r\n    \t\t}\r\nAnd while encoding and generating redirect url I am getting error and it&#39;s code is as below:\r\n\r\n    private static class MessageEncoder extends HTTPRedirectDeflateEncoder {\r\n    \t\tpublic String encode(SAMLObject message, String endpointURL, String relayState) throws MessageEncodingException {\r\n    \t\t\tString encodedMessage = deflateAndBase64Encode(message);\r\n    \t\t\treturn buildRedirectURL(endpointURL, relayState, encodedMessage);\r\n    \t\t}\r\n    \r\n    \t\tpublic String buildRedirectURL(String endpointURL, String relayState, String message) throws MessageEncodingException {\r\n    \t\t\tURLBuilder urlBuilder = new URLBuilder(endpointURL);\r\n    \t\t\tList&lt;Pair&lt;String, String&gt;&gt; queryParams = urlBuilder.getQueryParams();\r\n    \t\t\tqueryParams.clear();\r\n    \t\t\tqueryParams.add(new Pair&lt;String, String&gt;(&quot;SAMLRequest&quot;, message));\r\n    \t\t\tif (checkRelayState(relayState)) {\r\n    \t\t\t\tqueryParams.add(new Pair&lt;String, String&gt;(&quot;RelayState&quot;, relayState));\r\n    \t\t\t}\r\n    \t\t\treturn urlBuilder.buildURL();\r\n    \t\t}\r\n    \t}\r\n\r\nI am getting credential from &quot;jks&quot; file. What mistake am I making, or what configuration is missing?\r\n","link":"https://stackoverflow.com/questions/77343929/keycloak-saml-adding-signature-algorithm-not-working","title":"Keycloak Saml adding Signature algorithm not working","body":"<p>I am trying to secure my web application using Keycloak saml but while adding Signature it is not working and giving below error:</p>\n<pre><code>exception [org.opensaml.ws.message.encoder.MessageEncodingException: Encountered error \nmarshalling message into its DOM representation] with root cause\n    org.apache.xml.security.signature.XMLSignatureException: The requested algorithm null does not exist. Original Message was: Cannot invoke &quot;java.lang.Class.newInstance()&quot; because &quot;&lt;local3&gt;&quot; is null\nOriginal Exception was java.lang.NullPointerException: Cannot invoke &quot;java.lang.Class.newInstance()&quot; because &quot;&lt;local3&gt;&quot; is null\n        at org.apache.xml.security.algorithms.SignatureAlgorithm.&lt;init&gt;(Unknown Source)\n        at org.apache.xml.security.signature.SignedInfo.&lt;init&gt;(Unknown Source)\n        at org.apache.xml.security.signature.XMLSignature.&lt;init&gt;(Unknown Source)\n        at org.apache.xml.security.signature.XMLSignature.&lt;init&gt;(Unknown Source)\n</code></pre>\n<p>And my code creating AuthnRequest is as below:</p>\n<pre><code>protected String generateID() {\n            Random r = new Random();\n            return 'a' + Long.toString(Math.abs(r.nextLong()), 20) + Long.toString(Math.abs(r.nextLong()), 20);\n        }\n        public AuthnRequest buildRequest(String spProviderId, String acsUrl, String idpUrl) {\n            /* Building Issuer object */\n            \n            \n            IssuerBuilder issuerBuilder = new IssuerBuilder();\n            Issuer issuer = issuerBuilder.buildObject(&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;, &quot;Issuer&quot;, &quot;saml2&quot;);\n            issuer.setValue(spProviderId);\n\n            /* Creation of AuthRequestObject */\n            DateTime issueInstant = new DateTime();\n            AuthnRequestBuilder authRequestBuilder = new AuthnRequestBuilder();\n\n            AuthnRequest authRequest = authRequestBuilder.buildObject(SAMLConstants.SAML20P_NS, &quot;AuthnRequest&quot;, &quot;saml2&quot;);\n            authRequest.setForceAuthn(false);\n            authRequest.setIssueInstant(issueInstant);\n            authRequest.setProtocolBinding(SAMLConstants.SAML2_POST_BINDING_URI);\n            authRequest.setAssertionConsumerServiceURL(acsUrl);\n            authRequest.setIssuer(issuer);\n            authRequest.setID(generateID());\n            // XXX: How do I get nameIdPolicy?\n//          authRequest.setNameIDPolicy(nameIdPolicy);\n            authRequest.setVersion(SAMLVersion.VERSION_20);\n            authRequest.setDestination(idpUrl);\n            \n            SignatureBuilder signFactory = new SignatureBuilder();\n            Signature signature = signFactory.buildObject(Signature.DEFAULT_ELEMENT_NAME);\n                    try {\n                        signature.setSigningCredential(this.getSenderSigningCredential());\n                    } catch (Exception e) {\n                        // TODO Auto-generated catch block\n                        e.printStackTrace();\n                    }\n        // set signature\n                    authRequest.setSignature(signature);\n            \n\n            return authRequest;\n        }\n</code></pre>\n<p>And while encoding and generating redirect url I am getting error and it's code is as below:</p>\n<pre><code>private static class MessageEncoder extends HTTPRedirectDeflateEncoder {\n        public String encode(SAMLObject message, String endpointURL, String relayState) throws MessageEncodingException {\n            String encodedMessage = deflateAndBase64Encode(message);\n            return buildRedirectURL(endpointURL, relayState, encodedMessage);\n        }\n\n        public String buildRedirectURL(String endpointURL, String relayState, String message) throws MessageEncodingException {\n            URLBuilder urlBuilder = new URLBuilder(endpointURL);\n            List&lt;Pair&lt;String, String&gt;&gt; queryParams = urlBuilder.getQueryParams();\n            queryParams.clear();\n            queryParams.add(new Pair&lt;String, String&gt;(&quot;SAMLRequest&quot;, message));\n            if (checkRelayState(relayState)) {\n                queryParams.add(new Pair&lt;String, String&gt;(&quot;RelayState&quot;, relayState));\n            }\n            return urlBuilder.buildURL();\n        }\n    }\n</code></pre>\n<p>I am getting credential from &quot;jks&quot; file. What mistake am I making, or what configuration is missing?</p>\n"},{"tags":["python","java","ibm-midrange","jpype"],"comments":[{"score":0,"post_type":"question","creation_date":1701177875,"post_id":77564079,"comment_id":136740847,"body_markdown":"I can connect with `jpype.startJVM(classpath=[driver_file_path])` without `addClassPath`","link":"https://stackoverflow.com/questions/77564079/jpype-dbapi2-cant-understand-this-classnotfoundexception-error#comment136740847_77564079","body":"I can connect with <code>jpype.startJVM(classpath=[driver_file_path])</code> without <code>addClassPath</code>"},{"score":0,"post_type":"question","creation_date":1701260732,"post_id":77564079,"comment_id":136753199,"body_markdown":"@nfgl with your syntax, for me the program just stops after a few seconds. It&#39;s the startJVM which crash silently","link":"https://stackoverflow.com/questions/77564079/jpype-dbapi2-cant-understand-this-classnotfoundexception-error#comment136753199_77564079","body":"@nfgl with your syntax, for me the program just stops after a few seconds. It&#39;s the startJVM which crash silently"},{"score":0,"post_type":"question","creation_date":1701283782,"post_id":77564079,"comment_id":136757798,"body_markdown":"I had the same `ClassNotFoundException` with your code. Is your JVM version 7 or higher ?","link":"https://stackoverflow.com/questions/77564079/jpype-dbapi2-cant-understand-this-classnotfoundexception-error#comment136757798_77564079","body":"I had the same <code>ClassNotFoundException</code> with your code. Is your JVM version 7 or higher ?"},{"score":0,"post_type":"question","creation_date":1701348997,"post_id":77564079,"comment_id":136766110,"body_markdown":"I have Java version1.8.0_351, which is called java 8 AFAIK...","link":"https://stackoverflow.com/questions/77564079/jpype-dbapi2-cant-understand-this-classnotfoundexception-error#comment136766110_77564079","body":"I have Java version1.8.0_351, which is called java 8 AFAIK..."}],"comment_count":4,"is_answered":false,"view_count":53,"answer_count":0,"score":-2,"last_activity_date":1701715379,"creation_date":1701176308,"last_edit_date":1701715379,"question_id":77564079,"body_markdown":"[edit] my question has been closed for duplicate, but none of the answers I see relates to python or jpype, so I think that my question is legitimate\r\n\r\nI can&#39;t use java -classpath because I don&#39;t run java directly (launched from jpype)\r\nI can&#39;t use the argument -cp, nor my  Class-Path entry in MANIFEST.MF because I don&#39;t run java directly (launched from jpype)\r\nAnyway, as I showed in my example, the path of the jar file is recognized by  jpype, because  class_path = jpype.getClassPath(True)\r\nprint(&quot;Class Path &quot; + class_path) gives Class Path C:\\Users...\\jt400-20.0.6.jar\r\n[/edit]\r\n\r\n\r\nI want to use run SQL on an IBM i file from **python**, jdbc with **jpype**.\r\nI downloaded and installed in my folder IBM&#39;s jar (jt400-20.0.6.jar)\r\nThen I ran this simple test\r\n```python\r\nimport os\r\nimport jpype\r\nimport jpype.dbapi2\r\n\r\ndriver_file_path = os.path.join(os.path.dirname(__file__), &quot;jt400-20.0.6.jar&quot;)\r\n\r\njpype.startJVM()\r\nprint(&#39;startJVM effectu&#233;&#39;)\r\n\r\njpype.addClassPath(driver_file_path)\r\nclass_path = jpype.getClassPath(True)\r\nprint(&quot;Class Path &quot; + class_path)\r\n\r\njpype.java.lang.System.out.println(&quot;hello world&quot;)\r\n\r\nconnection_string = &#39;jdbc:as400://MACHINE&#39;\r\n\r\ntry:\r\n    cnx = jpype.dbapi2.connect(connection_string, driver= &quot;com.ibm.as400.access.AS400JDBCDriver&quot;,\r\n                     driver_args={\r\n                            &quot;user&quot;: &#39;UTIL&#39;,\r\n                            &quot;password&quot;: &#39;MOTPASSE&#39;,\r\n                            &quot;extended metadata&quot;: &quot;true&quot;,\r\n                        }\r\n                    )\r\nexcept jpype.dbapi2.Error as err:\r\n    print(&quot;Erreur&quot; + err)\r\n```\r\nThe driver exists at the driver_file_path that is printed\r\nThere&#39;s an AS400JDBCDriver.class in com\\ibm\\as400\\access in the jar file (I opened the file with  7 zip)\r\nWhen running, I have\r\n```\r\nstartJVM effectu&#233;\r\nClass Path C:\\Users...\\jt400-20.0.6.jar\r\nhello world\r\n```\r\nSo the path should have been added to the jvm, and java is working...\r\nBut I have also\r\n```\r\nTraceback (most recent call last):\r\n  File &quot;org.jpype.JPypeContext.java&quot;, line -1, in org.jpype.JPypeContext.callMethod\r\nException: Java Exception\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File &quot;C:\\...\\Test_jpype_question.py&quot;, line 37, in &lt;module&gt;\r\n    cnx = jpype.dbapi2.connect(connection_string, driver= &quot;com.ibm.as400.access.AS400JDBCDriver&quot;,\r\n  File &quot;C:\\...\\jpype\\dbapi2.py&quot;, line 404, in connect\r\n    _jpype.JClass(&#39;java.lang.Class&#39;).forName(driver).newInstance()\r\njava.lang.java.lang.ClassNotFoundException: java.lang.ClassNotFoundException: com.ibm.as400.access.AS400JDBCDriver`\r\n```\r\nI tried lot of things, but I can&#39;t understand what&#39;s wrong.\r\nWhat can I do to test further?","link":"https://stackoverflow.com/questions/77564079/jpype-dbapi2-cant-understand-this-classnotfoundexception-error","title":"jpype dbapi2 : can&#39;t understand this ClassNotFoundException error","body":"<p>[edit] my question has been closed for duplicate, but none of the answers I see relates to python or jpype, so I think that my question is legitimate</p>\n<p>I can't use java -classpath because I don't run java directly (launched from jpype)\nI can't use the argument -cp, nor my  Class-Path entry in MANIFEST.MF because I don't run java directly (launched from jpype)\nAnyway, as I showed in my example, the path of the jar file is recognized by  jpype, because  class_path = jpype.getClassPath(True)\nprint(&quot;Class Path &quot; + class_path) gives Class Path C:\\Users...\\jt400-20.0.6.jar\n[/edit]</p>\n<p>I want to use run SQL on an IBM i file from <strong>python</strong>, jdbc with <strong>jpype</strong>.\nI downloaded and installed in my folder IBM's jar (jt400-20.0.6.jar)\nThen I ran this simple test</p>\n<pre class=\"lang-py prettyprint-override\"><code>import os\nimport jpype\nimport jpype.dbapi2\n\ndriver_file_path = os.path.join(os.path.dirname(__file__), &quot;jt400-20.0.6.jar&quot;)\n\njpype.startJVM()\nprint('startJVM effectué')\n\njpype.addClassPath(driver_file_path)\nclass_path = jpype.getClassPath(True)\nprint(&quot;Class Path &quot; + class_path)\n\njpype.java.lang.System.out.println(&quot;hello world&quot;)\n\nconnection_string = 'jdbc:as400://MACHINE'\n\ntry:\n    cnx = jpype.dbapi2.connect(connection_string, driver= &quot;com.ibm.as400.access.AS400JDBCDriver&quot;,\n                     driver_args={\n                            &quot;user&quot;: 'UTIL',\n                            &quot;password&quot;: 'MOTPASSE',\n                            &quot;extended metadata&quot;: &quot;true&quot;,\n                        }\n                    )\nexcept jpype.dbapi2.Error as err:\n    print(&quot;Erreur&quot; + err)\n</code></pre>\n<p>The driver exists at the driver_file_path that is printed\nThere's an AS400JDBCDriver.class in com\\ibm\\as400\\access in the jar file (I opened the file with  7 zip)\nWhen running, I have</p>\n<pre><code>startJVM effectué\nClass Path C:\\Users...\\jt400-20.0.6.jar\nhello world\n</code></pre>\n<p>So the path should have been added to the jvm, and java is working...\nBut I have also</p>\n<pre><code>Traceback (most recent call last):\n  File &quot;org.jpype.JPypeContext.java&quot;, line -1, in org.jpype.JPypeContext.callMethod\nException: Java Exception\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File &quot;C:\\...\\Test_jpype_question.py&quot;, line 37, in &lt;module&gt;\n    cnx = jpype.dbapi2.connect(connection_string, driver= &quot;com.ibm.as400.access.AS400JDBCDriver&quot;,\n  File &quot;C:\\...\\jpype\\dbapi2.py&quot;, line 404, in connect\n    _jpype.JClass('java.lang.Class').forName(driver).newInstance()\njava.lang.java.lang.ClassNotFoundException: java.lang.ClassNotFoundException: com.ibm.as400.access.AS400JDBCDriver`\n</code></pre>\n<p>I tried lot of things, but I can't understand what's wrong.\nWhat can I do to test further?</p>\n"},{"tags":["java","sockets","synchronization","threadpool","objectoutputstream"],"comments":[{"score":0,"post_type":"question","creation_date":1701264000,"post_id":77570738,"comment_id":136753785,"body_markdown":"Are you sure the recipient is reading the data? The sender might be blocked waiting for space to become available if the socket output buffer is full because the socket input buffer on the other side is full (e.g. because the recipient is not reading the data). Have you dumped the stacktraces of all threads to see where it is actually stuck? As an aside, I personally would never use `ObjectInputStream`/`ObjectOutputStream` for this.","link":"https://stackoverflow.com/questions/77570738/objectoutputstream-stops-working-without-error-message#comment136753785_77570738","body":"Are you sure the recipient is reading the data? The sender might be blocked waiting for space to become available if the socket output buffer is full because the socket input buffer on the other side is full (e.g. because the recipient is not reading the data). Have you dumped the stacktraces of all threads to see where it is actually stuck? As an aside, I personally would never use <code>ObjectInputStream</code>/<code>ObjectOutputStream</code> for this."}],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1701762165,"post_id":77601630,"comment_id":136812622,"body_markdown":"So you wrote `write(imageBytes)` on the sender side with `readObject()` on the receiver side and it worked? The code you posted suggests that you used `readObject()` on the receiver side, and as far as I know `write` with `readObject` are not compatible, this is why I am asking.","link":"https://stackoverflow.com/questions/77570738/objectoutputstream-stops-working-without-error-message/77601630#comment136812622_77601630","body":"So you wrote <code>write(imageBytes)</code> on the sender side with <code>readObject()</code> on the receiver side and it worked? The code you posted suggests that you used <code>readObject()</code> on the receiver side, and as far as I know <code>write</code> with <code>readObject</code> are not compatible, this is why I am asking."}],"comment_count":1,"score":0,"last_activity_date":1701712754,"creation_date":1701712754,"answer_id":77601630,"question_id":77570738,"body_markdown":"I wrote clientObjectOutputStream.write(imageBytes); instead of clientObjectOutputStream.writeObject(imageBytes);\r\n\r\nafter using writeObject it worked perfectly fine.","link":"https://stackoverflow.com/questions/77570738/objectoutputstream-stops-working-without-error-message/77601630#77601630","title":"ObjectOutputStream stops working without error message","body":"<p>I wrote clientObjectOutputStream.write(imageBytes); instead of clientObjectOutputStream.writeObject(imageBytes);</p>\n<p>after using writeObject it worked perfectly fine.</p>\n"}],"comment_count":1,"is_answered":true,"view_count":39,"answer_count":1,"score":0,"last_activity_date":1701712754,"creation_date":1701257182,"last_edit_date":1701263773,"question_id":77570738,"body_markdown":"I am currently working on a video transmission program involving a client sender, a server receiver, and multiple client receivers. The sender sends video frames every 75ms to the server, which then broadcasts these frames to a group of client receivers.\r\n\r\nThe issue I am encountering is that after approximately 4 or 5 iterations, the server stops broadcasting frames to the clients, even though it continues to receive frames from the sender without any errors. Any help or suggestion would be much appreciated. \r\n\r\nThis is the sender code:\r\n\r\n```\r\npublic void sendImageToServer(BufferedImage screenshot) {\r\n\ttry {\r\n\t\tByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();\r\n\t\tImageIO.write(screenshot, &quot;jpeg&quot;, byteArrayOutputStream);\t        \r\n\t\tbyte[] imageBytes = byteArrayOutputStream.toByteArray();\r\n\r\n\t\tobjectOutputVideoStream.writeObject(imageBytes);\r\n\t\tobjectOutputVideoStream.flush();\r\n\t\tSystem.out.println(&quot;Frame sent&quot;);\r\n\t} catch (IOException e) {\r\n\t\te.printStackTrace();\r\n\t}\r\n}\r\n```\r\n\r\nThis is the server code: \r\n\r\n```\r\nprivate ExecutorService pool = Executors.newCachedThreadPool();\r\n\r\n\tpublic void receiveAndBroadcastVideo(Socket socket, int roomId) {\r\n\t\ttry {\r\n\t\t\tInputStream inputStream = socket.getInputStream();\r\n\t\t\tObjectInputStream objectInputStream = new ObjectInputStream(inputStream);\r\n\t\t\twhile (true) {\r\n\t\t\t\tbyte[] imageBytes = (byte[]) objectInputStream.readObject();\r\n\t\t\t\tSystem.out.println(&quot;Frame ricevuto&quot;);\r\n\t\t\t\tList&lt;UserWithSocket&gt; roomClients = videoChatRoomClients.get(roomId);\r\n\t\t\t\tfor (UserWithSocket client : roomClients) {\r\n\t\t\t\t\tif(client.getUserSocket()!=socket) {\r\n\t\t\t\t\t\tpool.submit(() -&gt; {\r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\tObjectOutputStream clientObjectOutputStream = client.getClientObjectOutputStream();\r\n\t\t\t\t\t\t\t\tsynchronized (clientObjectOutputStream) {\r\n\t\t\t\t\t\t\t\t\tclientObjectOutputStream.write(imageBytes);\r\n\t\t\t\t\t\t\t\t\tclientObjectOutputStream.flush();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tSystem.out.println(&quot;Frame Broadcasted&quot;);\r\n\t\t\t\t\t\t\t} catch (Exception e) {\r\n\t\t\t\t\t\t\t\te.printStackTrace();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (Exception e) {\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\t}\r\n```\r\n\r\nAnd this is where I create the ObjectOutputStream:\r\n\r\n```\r\npublic class UserWithSocket {\r\n\r\n\tprivate int id;\r\n\tprivate Socket userSocket;\r\n\tprivate ObjectOutputStream clientObjectOutputStream;\r\n\r\n\tpublic UserWithSocket(int id, Socket userSocket) {\r\n\t\tsuper();\r\n\t\tthis.id = id;\r\n\t\tthis.userSocket = userSocket;\r\n\t}\r\n\r\n\tpublic int getId() {\r\n\t\treturn id;\r\n\t}\r\n\r\n\tpublic void setId(int id) {\r\n\t\tthis.id = id;\r\n\t}\r\n\r\n\tpublic Socket getUserSocket() {\r\n\t\treturn userSocket;\r\n\t}\r\n\r\n\tpublic void setUserSocket(Socket userSocket) {\r\n\t\tthis.userSocket = userSocket;\r\n\t}\r\n\r\n\tpublic void createStream() {\r\n\t\ttry {\r\n\t\t\tOutputStream outputStream = userSocket.getOutputStream();\r\n\t\t\tclientObjectOutputStream = new ObjectOutputStream(outputStream);\r\n\t\t} catch (Exception e) {\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic ObjectOutputStream getClientObjectOutputStream() {\r\n\t\treturn clientObjectOutputStream;\r\n\t}\r\n\r\n\tpublic void setClientObjectOutputStream(ObjectOutputStream clientObjectOutputStream) {\r\n\t\tthis.clientObjectOutputStream = clientObjectOutputStream;\r\n\t}\r\n\t\r\n\t\r\n}\r\n```\r\n\r\nSince I&#39;m not receiving any kind of error it might be a deadlock situation, I just know that after 4 or 5 iterations this part of the code won&#39;t run:\r\n```\r\nsynchronized (clientObjectOutputStream) {\r\n\tclientObjectOutputStream.write(imageBytes);\r\n\tclientObjectOutputStream.flush();\r\n}\r\n```","link":"https://stackoverflow.com/questions/77570738/objectoutputstream-stops-working-without-error-message","title":"ObjectOutputStream stops working without error message","body":"<p>I am currently working on a video transmission program involving a client sender, a server receiver, and multiple client receivers. The sender sends video frames every 75ms to the server, which then broadcasts these frames to a group of client receivers.</p>\n<p>The issue I am encountering is that after approximately 4 or 5 iterations, the server stops broadcasting frames to the clients, even though it continues to receive frames from the sender without any errors. Any help or suggestion would be much appreciated.</p>\n<p>This is the sender code:</p>\n<pre><code>public void sendImageToServer(BufferedImage screenshot) {\n    try {\n        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();\n        ImageIO.write(screenshot, &quot;jpeg&quot;, byteArrayOutputStream);           \n        byte[] imageBytes = byteArrayOutputStream.toByteArray();\n\n        objectOutputVideoStream.writeObject(imageBytes);\n        objectOutputVideoStream.flush();\n        System.out.println(&quot;Frame sent&quot;);\n    } catch (IOException e) {\n        e.printStackTrace();\n    }\n}\n</code></pre>\n<p>This is the server code:</p>\n<pre><code>private ExecutorService pool = Executors.newCachedThreadPool();\n\n    public void receiveAndBroadcastVideo(Socket socket, int roomId) {\n        try {\n            InputStream inputStream = socket.getInputStream();\n            ObjectInputStream objectInputStream = new ObjectInputStream(inputStream);\n            while (true) {\n                byte[] imageBytes = (byte[]) objectInputStream.readObject();\n                System.out.println(&quot;Frame ricevuto&quot;);\n                List&lt;UserWithSocket&gt; roomClients = videoChatRoomClients.get(roomId);\n                for (UserWithSocket client : roomClients) {\n                    if(client.getUserSocket()!=socket) {\n                        pool.submit(() -&gt; {\n                            try {\n                                ObjectOutputStream clientObjectOutputStream = client.getClientObjectOutputStream();\n                                synchronized (clientObjectOutputStream) {\n                                    clientObjectOutputStream.write(imageBytes);\n                                    clientObjectOutputStream.flush();\n                                }\n                                System.out.println(&quot;Frame Broadcasted&quot;);\n                            } catch (Exception e) {\n                                e.printStackTrace();\n                            }\n                        });\n                    }\n                }\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n</code></pre>\n<p>And this is where I create the ObjectOutputStream:</p>\n<pre><code>public class UserWithSocket {\n\n    private int id;\n    private Socket userSocket;\n    private ObjectOutputStream clientObjectOutputStream;\n\n    public UserWithSocket(int id, Socket userSocket) {\n        super();\n        this.id = id;\n        this.userSocket = userSocket;\n    }\n\n    public int getId() {\n        return id;\n    }\n\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    public Socket getUserSocket() {\n        return userSocket;\n    }\n\n    public void setUserSocket(Socket userSocket) {\n        this.userSocket = userSocket;\n    }\n\n    public void createStream() {\n        try {\n            OutputStream outputStream = userSocket.getOutputStream();\n            clientObjectOutputStream = new ObjectOutputStream(outputStream);\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n    public ObjectOutputStream getClientObjectOutputStream() {\n        return clientObjectOutputStream;\n    }\n\n    public void setClientObjectOutputStream(ObjectOutputStream clientObjectOutputStream) {\n        this.clientObjectOutputStream = clientObjectOutputStream;\n    }\n    \n    \n}\n</code></pre>\n<p>Since I'm not receiving any kind of error it might be a deadlock situation, I just know that after 4 or 5 iterations this part of the code won't run:</p>\n<pre><code>synchronized (clientObjectOutputStream) {\n    clientObjectOutputStream.write(imageBytes);\n    clientObjectOutputStream.flush();\n}\n</code></pre>\n"},{"tags":["java","string","variables"],"comments":[{"score":4,"post_type":"question","creation_date":1701248464,"post_id":77569733,"comment_id":136750889,"body_markdown":"Short answer: you can&#39;t, at least not for local variables. It&#39;s something that people are inclined to want to do when they start programming, and there is almost never a need for this. Check [this related question](https://stackoverflow.com/questions/6729605/assigning-variables-with-dynamic-names-in-java) for context. If you want to store key/value pairs, use a `HashMap`. By the way, `String x=&#39;abc&#39;;` is not valid Java.","link":"https://stackoverflow.com/questions/77569733/how-to-display-variable-name-dynamic-in-java#comment136750889_77569733","body":"Short answer: you can&#39;t, at least not for local variables. It&#39;s something that people are inclined to want to do when they start programming, and there is almost never a need for this. Check <a href=\"https://stackoverflow.com/questions/6729605/assigning-variables-with-dynamic-names-in-java\">this related question</a> for context. If you want to store key/value pairs, use a <code>HashMap</code>. By the way, <code>String x=&#39;abc&#39;;</code> is not valid Java."},{"score":1,"post_type":"question","creation_date":1701249351,"post_id":77569733,"comment_id":136751052,"body_markdown":"I know i just wrote a dummy example for the sake of the question but thank u for ur clarification","link":"https://stackoverflow.com/questions/77569733/how-to-display-variable-name-dynamic-in-java#comment136751052_77569733","body":"I know i just wrote a dummy example for the sake of the question but thank u for ur clarification"}],"answers":[{"comments":[{"score":1,"post_type":"answer","creation_date":1701248995,"post_id":77569792,"comment_id":136750992,"body_markdown":"ok i thought there&#39;s a way for that thank u for the clarification","link":"https://stackoverflow.com/questions/77569733/how-to-display-variable-name-dynamic-in-java/77569792#comment136750992_77569792","body":"ok i thought there&#39;s a way for that thank u for the clarification"}],"comment_count":1,"score":2,"last_activity_date":1701700360,"last_edit_date":1701700360,"creation_date":1701248761,"answer_id":77569792,"question_id":77569733,"body_markdown":"You can&#39;t. When you compile a java program in java bytecode, the information about variable names are not included.\r\n\r\nFor example:\r\nFile `Main.java`\r\n```java\r\npublic class Main\r\n{\r\n\tpublic static void main(String[] args) {\r\n\t\tString x = &quot;abc&quot;;\r\n\t\tSystem.out.println(x);\r\n\t}\r\n}\r\n```\r\n\r\ncompiled in `Main.class` (there are many more &quot;characters&quot; you cannot see):\r\n```lang-none\r\n&#202;&#254;&#186;&#190;   = \r\n      java/lang/Object &lt;init&gt; ()V  abc\t \r\n   \r\n  java/lang/System out Ljava/io/PrintStream;\r\n      java/io/PrintStream println (Ljava/lang/String;)V  Main Code LineNumberTable main ([Ljava/lang/String;)V \r\nSourceFile \tMain.java !                    *&#183; &#177;            \t       +     L&#178; \t+&#182; &#177;              \r\n       \r\n```\r\n\r\nIf you try to use a decompiler to decompile the bytecode, that&#39;s what you&#39;d get:\r\n```java\r\nimport java.io.PrintStream;\r\n\r\npublic class Main\r\n{\r\n\tpublic static void main(String[] paramArrayOfString)\r\n\t{\r\n\t\tString str = &quot;abc&quot;;\r\n\t\tSystem.out.println(str);\r\n\t}\r\n}\r\n```\r\nAs you can see, there is no information about any variable names.\r\n\r\nThe simplest reason behind this is that this information is *completely useless to the runtime*, it is only useful to programmers when they&#39;re writing code, to give a meaning of what they&#39;re coding and keep track of the business logic.","link":"https://stackoverflow.com/questions/77569733/how-to-display-variable-name-dynamic-in-java/77569792#77569792","title":"how to display variable name dynamic in java","body":"<p>You can't. When you compile a java program in java bytecode, the information about variable names are not included.</p>\n<p>For example:\nFile <code>Main.java</code></p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Main\n{\n    public static void main(String[] args) {\n        String x = &quot;abc&quot;;\n        System.out.println(x);\n    }\n}\n</code></pre>\n<p>compiled in <code>Main.class</code> (there are many more &quot;characters&quot; you cannot see):</p>\n<pre class=\"lang-none prettyprint-override\"><code>Êþº¾   = \n      java/lang/Object &lt;init&gt; ()V  abc   \n   \n  java/lang/System out Ljava/io/PrintStream;\n      java/io/PrintStream println (Ljava/lang/String;)V  Main Code LineNumberTable main ([Ljava/lang/String;)V \nSourceFile  Main.java !                    *· ±                    +     L²     +¶ ±              \n       \n</code></pre>\n<p>If you try to use a decompiler to decompile the bytecode, that's what you'd get:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.io.PrintStream;\n\npublic class Main\n{\n    public static void main(String[] paramArrayOfString)\n    {\n        String str = &quot;abc&quot;;\n        System.out.println(str);\n    }\n}\n</code></pre>\n<p>As you can see, there is no information about any variable names.</p>\n<p>The simplest reason behind this is that this information is <em>completely useless to the runtime</em>, it is only useful to programmers when they're writing code, to give a meaning of what they're coding and keep track of the business logic.</p>\n"}],"comment_count":2,"is_answered":true,"view_count":56,"answer_count":1,"score":0,"last_activity_date":1701700360,"creation_date":1701248060,"question_id":77569733,"body_markdown":"i want to display only the variable name not the value\r\nlet&#39;s say\r\n```\r\nString x=&#39;abc&#39;;\r\n```\r\ni want my output to be ```x``` not```abc```\r\ndon&#39;t want to create a code like this\r\n```\r\nSystem.out.println(&#39;x&#39;)\r\n```\r\ni want dynamicaly save the variable name in another variable and display it\r\nlike if there&#39;s a built in function to do this like for example i know this function doesn&#39;t exist but lets say it exists\r\n```\r\nSystem.out.println(x.getVariableName()) //output x\r\n```\r\ni want a something like that","link":"https://stackoverflow.com/questions/77569733/how-to-display-variable-name-dynamic-in-java","title":"how to display variable name dynamic in java","body":"<p>i want to display only the variable name not the value\nlet's say</p>\n<pre><code>String x='abc';\n</code></pre>\n<p>i want my output to be <code>x</code> not<code>abc</code>\ndon't want to create a code like this</p>\n<pre><code>System.out.println('x')\n</code></pre>\n<p>i want dynamicaly save the variable name in another variable and display it\nlike if there's a built in function to do this like for example i know this function doesn't exist but lets say it exists</p>\n<pre><code>System.out.println(x.getVariableName()) //output x\n</code></pre>\n<p>i want a something like that</p>\n"},{"tags":["java","jaxb","cxf-xjc-plugin"],"comment_count":0,"is_answered":false,"view_count":83,"answer_count":0,"score":0,"last_activity_date":1701700337,"creation_date":1686058960,"question_id":76415336,"body_markdown":"cxf-xjc-plugin isn&#39;t working as expected. \r\n\r\nI am getting the following issue after a clean install in maven (java11)\r\n\r\n&gt; vendor extension bindings (jaxb:extensionBindingPrefixes) are not\r\n&gt; allowed in the strict mode. Use -extension\r\n\r\nWhat is the error cause ? \r\n\r\n\r\nhere the plugin conifugration :\r\n\r\n      &lt;plugin&gt;\r\n                    &lt;groupId&gt;org.apache.cxf&lt;/groupId&gt;\r\n                    &lt;artifactId&gt;cxf-xjc-plugin&lt;/artifactId&gt;\r\n                    &lt;version&gt;3.3.0&lt;/version&gt;\r\n                    &lt;executions&gt;\r\n                        &lt;execution&gt;\r\n                            &lt;id&gt;xjc&lt;/id&gt;\r\n                            &lt;phase&gt;generate-sources&lt;/phase&gt;\r\n                            &lt;goals&gt;\r\n                                &lt;goal&gt;xsdtojava&lt;/goal&gt;\r\n                            &lt;/goals&gt;\r\n                            &lt;configuration&gt;\r\n                                &lt;xsdOptions&gt;\r\n                                    &lt;xsdOption&gt;\r\n                                        &lt;xsd&gt;src/main/resources/xsd/Content.xsd&lt;/xsd&gt;\r\n                                            &lt;bindingFile&gt;src/main/xjb/rules.xml&lt;/bindingFile&gt;\r\n                                        &lt;catalog&gt;src/main/resources/xsd/catalog.cat&lt;/catalog&gt;\r\n                                    &lt;/xsdOption&gt;\r\n                                    &lt;xsdOption&gt;\r\n                                        &lt;xsd&gt;src/main/resources/xsd/e-BoxDefinitionType.xsd&lt;/xsd&gt;\r\n                                        &lt;bindingFile&gt;src/main/xjb/rules.xml&lt;/bindingFile&gt;\r\n                                        &lt;catalog&gt;src/main/resources/xsd/catalog.cat&lt;/catalog&gt;\r\n                                    &lt;/xsdOption&gt;\r\n                                &lt;/xsdOptions&gt;\r\n                            &lt;/configuration&gt;\r\n                        &lt;/execution&gt;\r\n                    &lt;/executions&gt;\r\n                &lt;/plugin&gt;\r\n\r\n\r\nHere my rules : \r\n\r\n\r\n","link":"https://stackoverflow.com/questions/76415336/jaxbextensionbindingprefixes-is-not-working-for-cxf-xjc-plugin","title":"jaxb:extensionBindingPrefixes is not working for cxf-xjc-plugin?","body":"<p>cxf-xjc-plugin isn't working as expected.</p>\n<p>I am getting the following issue after a clean install in maven (java11)</p>\n<blockquote>\n<p>vendor extension bindings (jaxb:extensionBindingPrefixes) are not\nallowed in the strict mode. Use -extension</p>\n</blockquote>\n<p>What is the error cause ?</p>\n<p>here the plugin conifugration :</p>\n<pre><code>  &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.cxf&lt;/groupId&gt;\n                &lt;artifactId&gt;cxf-xjc-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.3.0&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;id&gt;xjc&lt;/id&gt;\n                        &lt;phase&gt;generate-sources&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;xsdtojava&lt;/goal&gt;\n                        &lt;/goals&gt;\n                        &lt;configuration&gt;\n                            &lt;xsdOptions&gt;\n                                &lt;xsdOption&gt;\n                                    &lt;xsd&gt;src/main/resources/xsd/Content.xsd&lt;/xsd&gt;\n                                        &lt;bindingFile&gt;src/main/xjb/rules.xml&lt;/bindingFile&gt;\n                                    &lt;catalog&gt;src/main/resources/xsd/catalog.cat&lt;/catalog&gt;\n                                &lt;/xsdOption&gt;\n                                &lt;xsdOption&gt;\n                                    &lt;xsd&gt;src/main/resources/xsd/e-BoxDefinitionType.xsd&lt;/xsd&gt;\n                                    &lt;bindingFile&gt;src/main/xjb/rules.xml&lt;/bindingFile&gt;\n                                    &lt;catalog&gt;src/main/resources/xsd/catalog.cat&lt;/catalog&gt;\n                                &lt;/xsdOption&gt;\n                            &lt;/xsdOptions&gt;\n                        &lt;/configuration&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n</code></pre>\n<p>Here my rules :</p>\n"},{"tags":["java","intellij-idea","javafx","controlsfx"],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1694357039,"post_id":77076574,"comment_id":135877666,"body_markdown":"Thanks for ur answer. After I replace the vm options with this --add-exports=javafx.base/com.sun.javafx.event=All-UNNAMED. I able to run the program, it does not have any run time error. But the TextFields.bindAutoCompletion() is not working.","link":"https://stackoverflow.com/questions/77076526/run-time-error-of-controls-fx-warning-unknown-module-org-controlsfx-controls/77076574#comment135877666_77076574","body":"Thanks for ur answer. After I replace the vm options with this --add-exports=javafx.base/com.sun.javafx.event=All-UNNAMED. I able to run the program, it does not have any run time error. But the TextFields.bindAutoCompletion() is not working."},{"score":0,"post_type":"answer","creation_date":1694404769,"post_id":77076574,"comment_id":135881750,"body_markdown":"Well as noted in the answer: “ However, this might not work if org.controlsfx.controls does not support being put on the class path.”  So try making your app modular (adding a module-info) instead, as also noted in the answer.  There is documentation on the controlsfx site about [using it in a modular environment](https://github.com/controlsfx/controlsfx/wiki/Using-ControlsFX-with-JDK-9-and-above).","link":"https://stackoverflow.com/questions/77076526/run-time-error-of-controls-fx-warning-unknown-module-org-controlsfx-controls/77076574#comment135881750_77076574","body":"Well as noted in the answer: “ However, this might not work if org.controlsfx.controls does not support being put on the class path.”  So try making your app modular (adding a module-info) instead, as also noted in the answer.  There is documentation on the controlsfx site about <a href=\"https://github.com/controlsfx/controlsfx/wiki/Using-ControlsFX-with-JDK-9-and-above\" rel=\"nofollow noreferrer\">using it in a modular environment</a>."}],"comment_count":2,"score":3,"last_activity_date":1694375841,"last_edit_date":1694375841,"creation_date":1694356769,"answer_id":77076574,"question_id":77076526,"body_markdown":"It looks like `org.controlsfx.controls` is being put onto the class path instead of the module path by IntelliJ:\r\n\r\n    class org.controlsfx.control.textfield.AutoCompletionBinding (in unnamed module @0x6bbb636e)\r\n\r\n(The unnamed modules means the class path).\r\n\r\nIntelliJ puts dependencies on the class or module path depending on whether the project itself is modular. So, in order to have IJ put `org.controlsfx.controls` on the module path, you have to modularise the project by adding a `module-info.java` file.\r\n\r\n(see also: https://stackoverflow.com/questions/65267831)\r\n\r\n---\r\n\r\nIf you don&#39;t want to modularise your project, alternatively you could try using:\r\n\r\n    --add-exports=javafx.base/com.sun.javafx.event=All-UNNAMED\r\n\r\nWhich exports the package to the class path instead (unnamed module). However, this might not work if `org.controlsfx.controls` does not support being put on the class path.\r\n\r\n","link":"https://stackoverflow.com/questions/77076526/run-time-error-of-controls-fx-warning-unknown-module-org-controlsfx-controls/77076574#77076574","title":"Run time error of controls-fx, WARNING: Unknown module: org.controlsfx.controls specified to --add-exports","body":"<p>It looks like <code>org.controlsfx.controls</code> is being put onto the class path instead of the module path by IntelliJ:</p>\n<pre><code>class org.controlsfx.control.textfield.AutoCompletionBinding (in unnamed module @0x6bbb636e)\n</code></pre>\n<p>(The unnamed modules means the class path).</p>\n<p>IntelliJ puts dependencies on the class or module path depending on whether the project itself is modular. So, in order to have IJ put <code>org.controlsfx.controls</code> on the module path, you have to modularise the project by adding a <code>module-info.java</code> file.</p>\n<p>(see also: <a href=\"https://stackoverflow.com/questions/65267831\">IntelliJ: Put some dependencies on the module path in non-modular application</a>)</p>\n<hr />\n<p>If you don't want to modularise your project, alternatively you could try using:</p>\n<pre><code>--add-exports=javafx.base/com.sun.javafx.event=All-UNNAMED\n</code></pre>\n<p>Which exports the package to the class path instead (unnamed module). However, this might not work if <code>org.controlsfx.controls</code> does not support being put on the class path.</p>\n"}],"comment_count":0,"is_answered":true,"view_count":110,"answer_count":1,"score":0,"last_activity_date":1701699988,"creation_date":1694355962,"last_edit_date":1701699988,"question_id":77076526,"body_markdown":"I could include the controlsfx into my project in IntelliJ but I can&#39;t run the program. \r\nI also already try the other solution: adding this into VM options\r\n\r\n    --add-exports=javafx.base/com.sun.javafx.event=org.controlsfx.controls\r\n\r\nWhen I run the program, it has run time error:\r\n\r\n        WARNING: Unknown module: org.controlsfx.controls specified to --add-exports\r\n        Caused by: java.lang.reflect.InvocationTargetException\r\n        \tat java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:119)\r\n        \tat java.base/java.lang.reflect.Method.invoke(Method.java:578)\r\n        \tat com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)\r\n        \tat java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)\r\n        \tat java.base/java.lang.reflect.Method.invoke(Method.java:578)\r\n        \tat javafx.base@20.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)\r\n        \tat javafx.fxml@20.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)\r\n        \tat javafx.fxml@20.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1853)\r\n        \t... 33 more\r\n        Caused by: java.lang.IllegalAccessError: class org.controlsfx.control.textfield.AutoCompletionBinding (in unnamed module @0x6bbb636e) cannot access class com.sun.javafx.event.EventHandlerManager (in module javafx.base) because module javafx.base does not export com.sun.javafx.event to unnamed module @0x6bbb636e\r\n        \tat org.controlsfx.control.textfield.AutoCompletionBinding.&lt;init&gt;(AutoCompletionBinding.java:538)\r\n        \tat impl.org.controlsfx.autocompletion.AutoCompletionTextFieldBinding.&lt;init&gt;(AutoCompletionTextFieldBinding.java:107)\r\n        \tat impl.org.controlsfx.autocompletion.AutoCompletionTextFieldBinding.&lt;init&gt;(AutoCompletionTextFieldBinding.java:92)\r\n        \tat org.controlsfx.control.textfield.TextFields.bindAutoCompletion(TextFields.java:188)\r\n        \tat org.controlsfx.control.textfield.TextFields.bindAutoCompletion(TextFields.java:182)\r\n        \tat Controller.HomeSubScene.SearchBookingController.setUp(SearchBookingController.java:44)\r\n        \tat Controller.HomeCustController.showScene(HomeCustController.java:162)\r\n        \tat Controller.HomeCustController.showManageBookingScene(HomeCustController.java:134)\r\n        \tat java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)\r\n        \t... 40 more\r\n    \r\nI hope I could use the controls fx in my project.","link":"https://stackoverflow.com/questions/77076526/run-time-error-of-controls-fx-warning-unknown-module-org-controlsfx-controls","title":"Run time error of controls-fx, WARNING: Unknown module: org.controlsfx.controls specified to --add-exports","body":"<p>I could include the controlsfx into my project in IntelliJ but I can't run the program.\nI also already try the other solution: adding this into VM options</p>\n<pre><code>--add-exports=javafx.base/com.sun.javafx.event=org.controlsfx.controls\n</code></pre>\n<p>When I run the program, it has run time error:</p>\n<pre><code>    WARNING: Unknown module: org.controlsfx.controls specified to --add-exports\n    Caused by: java.lang.reflect.InvocationTargetException\n        at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:119)\n        at java.base/java.lang.reflect.Method.invoke(Method.java:578)\n        at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)\n        at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)\n        at java.base/java.lang.reflect.Method.invoke(Method.java:578)\n        at javafx.base@20.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)\n        at javafx.fxml@20.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)\n        at javafx.fxml@20.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1853)\n        ... 33 more\n    Caused by: java.lang.IllegalAccessError: class org.controlsfx.control.textfield.AutoCompletionBinding (in unnamed module @0x6bbb636e) cannot access class com.sun.javafx.event.EventHandlerManager (in module javafx.base) because module javafx.base does not export com.sun.javafx.event to unnamed module @0x6bbb636e\n        at org.controlsfx.control.textfield.AutoCompletionBinding.&lt;init&gt;(AutoCompletionBinding.java:538)\n        at impl.org.controlsfx.autocompletion.AutoCompletionTextFieldBinding.&lt;init&gt;(AutoCompletionTextFieldBinding.java:107)\n        at impl.org.controlsfx.autocompletion.AutoCompletionTextFieldBinding.&lt;init&gt;(AutoCompletionTextFieldBinding.java:92)\n        at org.controlsfx.control.textfield.TextFields.bindAutoCompletion(TextFields.java:188)\n        at org.controlsfx.control.textfield.TextFields.bindAutoCompletion(TextFields.java:182)\n        at Controller.HomeSubScene.SearchBookingController.setUp(SearchBookingController.java:44)\n        at Controller.HomeCustController.showScene(HomeCustController.java:162)\n        at Controller.HomeCustController.showManageBookingScene(HomeCustController.java:134)\n        at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)\n        ... 40 more\n</code></pre>\n<p>I hope I could use the controls fx in my project.</p>\n"},{"tags":["java","android","service","android-broadcast"],"answers":[{"comment_count":0,"score":1,"last_activity_date":1701698671,"creation_date":1701698671,"answer_id":77600042,"question_id":76583558,"body_markdown":"You are checking if your `Service` is running, and of course it is, so this method will ralways eturn `true`. Using `getRunningTasks()` is not intended for this purpose and probably won&#39;t be reliable, especially with newer Android versions.\r\n\r\nWhat you should do is to store the current &quot;charging&quot; state in shared preferences. Whenever your `BroadcastReceiver` is triggered, compare the new &quot;charging&quot; state to the state you have stored in shared preferences. If they are different and the new state is &quot;CHARGING&quot;, then you can launch your app.","link":"https://stackoverflow.com/questions/76583558/how-to-check-if-the-app-is-running-in-background-or-foreground/77600042#77600042","title":"How to check if the app is running in background or foreground","body":"<p>You are checking if your <code>Service</code> is running, and of course it is, so this method will ralways eturn <code>true</code>. Using <code>getRunningTasks()</code> is not intended for this purpose and probably won't be reliable, especially with newer Android versions.</p>\n<p>What you should do is to store the current &quot;charging&quot; state in shared preferences. Whenever your <code>BroadcastReceiver</code> is triggered, compare the new &quot;charging&quot; state to the state you have stored in shared preferences. If they are different and the new state is &quot;CHARGING&quot;, then you can launch your app.</p>\n"}],"comment_count":0,"is_answered":true,"view_count":28,"answer_count":1,"score":0,"last_activity_date":1701698671,"creation_date":1688061717,"question_id":76583558,"body_markdown":"I have a `Service` that always running in the background even if the app is completely closed. In this service, I have a `BroadcastReceiver` that let me know if the device is charging or not :\r\n\r\n      @Override\r\n        public void onBatteryStatusChanged(BatteryUtils.Status status) {\r\n            if (status.getStatus() == BatteryUtils.BatteryStatus.CHARGING) {\r\n                 if(!AppUtils.isAppRunning(getPackageName()))\r\n                       LogUtils.dTag(Constants.TAG, &quot;APP SHOULD LAUNCH NOW&quot;);\r\n            }\r\n        }\r\n\r\n    public static boolean isAppRunning(final String pkgName) {\r\n        ActivityManager am = (ActivityManager) Utils.getApp().getSystemService(Context.ACTIVITY_SERVICE);\r\n        if (am != null) {\r\n            List&lt;ActivityManager.RunningTaskInfo&gt; taskInfo = am.getRunningTasks(Integer.MAX_VALUE);\r\n            if (taskInfo != null &amp;&amp; taskInfo.size() &gt; 0) {\r\n                for (ActivityManager.RunningTaskInfo aInfo : taskInfo) {\r\n                    if (aInfo.baseActivity != null) {\r\n                        if (pkgName.equals(aInfo.baseActivity.getPackageName())) {\r\n                            return true;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            List&lt;ActivityManager.RunningServiceInfo&gt; serviceInfo = am.getRunningServices(Integer.MAX_VALUE);\r\n            if (serviceInfo != null &amp;&amp; serviceInfo.size() &gt; 0) {\r\n                for (ActivityManager.RunningServiceInfo aInfo : serviceInfo) {\r\n                    if (pkgName.equals(aInfo.service.getPackageName())) {\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n**My Goal :**\r\n\r\nIs launching the app once the charger is plugged in, but only if it hasn&#39;t already been launched.\r\n\r\n**My Issue :** \r\n\r\nWhen I check whether the app is running or not, it always returns `TRUE`, even when the app is closed. This behavior occurs because the service is running in the background, leading to the entire app being considered as running.\r\n","link":"https://stackoverflow.com/questions/76583558/how-to-check-if-the-app-is-running-in-background-or-foreground","title":"How to check if the app is running in background or foreground","body":"<p>I have a <code>Service</code> that always running in the background even if the app is completely closed. In this service, I have a <code>BroadcastReceiver</code> that let me know if the device is charging or not :</p>\n<pre><code>  @Override\n    public void onBatteryStatusChanged(BatteryUtils.Status status) {\n        if (status.getStatus() == BatteryUtils.BatteryStatus.CHARGING) {\n             if(!AppUtils.isAppRunning(getPackageName()))\n                   LogUtils.dTag(Constants.TAG, &quot;APP SHOULD LAUNCH NOW&quot;);\n        }\n    }\n\npublic static boolean isAppRunning(final String pkgName) {\n    ActivityManager am = (ActivityManager) Utils.getApp().getSystemService(Context.ACTIVITY_SERVICE);\n    if (am != null) {\n        List&lt;ActivityManager.RunningTaskInfo&gt; taskInfo = am.getRunningTasks(Integer.MAX_VALUE);\n        if (taskInfo != null &amp;&amp; taskInfo.size() &gt; 0) {\n            for (ActivityManager.RunningTaskInfo aInfo : taskInfo) {\n                if (aInfo.baseActivity != null) {\n                    if (pkgName.equals(aInfo.baseActivity.getPackageName())) {\n                        return true;\n                    }\n                }\n            }\n        }\n        List&lt;ActivityManager.RunningServiceInfo&gt; serviceInfo = am.getRunningServices(Integer.MAX_VALUE);\n        if (serviceInfo != null &amp;&amp; serviceInfo.size() &gt; 0) {\n            for (ActivityManager.RunningServiceInfo aInfo : serviceInfo) {\n                if (pkgName.equals(aInfo.service.getPackageName())) {\n                    return true;\n                }\n            }\n        }\n    }\n    return false;\n}\n</code></pre>\n<p><strong>My Goal :</strong></p>\n<p>Is launching the app once the charger is plugged in, but only if it hasn't already been launched.</p>\n<p><strong>My Issue :</strong></p>\n<p>When I check whether the app is running or not, it always returns <code>TRUE</code>, even when the app is closed. This behavior occurs because the service is running in the background, leading to the entire app being considered as running.</p>\n"},{"tags":["java","rdf","rml-rdf"],"comment_count":0,"is_answered":false,"view_count":33,"answer_count":0,"score":2,"last_activity_date":1701696065,"creation_date":1701275195,"last_edit_date":1701696065,"question_id":77572932,"body_markdown":"When using [Carml](https://github.com/carml/carml), I can define a namespace prefix in the [RML](https://rml.io/specs/rml/) file with:\r\n\r\n    carml:declaresNamespace [\r\n          carml:namespacePrefix &quot;tei&quot;;\r\n          carml:namespaceName &quot;http://www.tei-c.org/ns/1.0&quot;;\r\n    ];\r\n\r\nReading the [RmlMapper](https://github.com/RMLio/rmlmapper-java) Github issues it seems that there is no equivalent (yet) in RmlMapper.\r\n\r\nHow to set a namespace prefix programmatically with RmlMapper?\r\n\r\n**Note:**\r\n\r\nIn [XMLRecordFactory](https://github.com/RMLio/rmlmapper-java/blob/master/src/main/java/be/ugent/rml/records/XMLRecordFactory.java), we see:           \r\n\r\n    // Extract and register existing source namespaces into the XPath compiler\r\n    SaxNamespaceResolver.registerNamespaces(compiler, document);\r\n\r\nAnd indeed, if I change my source XML from:\r\n\r\n    &lt;TEI xmlns=&quot;http://www.tei-c.org/ns/1.0&quot; xml:id=&quot;article_001&quot;&gt;\r\n\r\nto\r\n\r\n    &lt;TEI xmlns=&quot;http://www.tei-c.org/ns/1.0&quot; xmlns:tei=&quot;http://www.tei-c.org/ns/1.0&quot; xml:id=&quot;article_001&quot;&gt;\r\n\r\nThe namespace prefix is correctly defined for XPath. But I don&#39;t want to change all XML source files.","link":"https://stackoverflow.com/questions/77572932/how-to-set-a-namespace-prefix-programmatically-with-rmlmapper","title":"How to set a namespace prefix programmatically with RmlMapper?","body":"<p>When using <a href=\"https://github.com/carml/carml\" rel=\"nofollow noreferrer\">Carml</a>, I can define a namespace prefix in the <a href=\"https://rml.io/specs/rml/\" rel=\"nofollow noreferrer\">RML</a> file with:</p>\n<pre><code>carml:declaresNamespace [\n      carml:namespacePrefix &quot;tei&quot;;\n      carml:namespaceName &quot;http://www.tei-c.org/ns/1.0&quot;;\n];\n</code></pre>\n<p>Reading the <a href=\"https://github.com/RMLio/rmlmapper-java\" rel=\"nofollow noreferrer\">RmlMapper</a> Github issues it seems that there is no equivalent (yet) in RmlMapper.</p>\n<p>How to set a namespace prefix programmatically with RmlMapper?</p>\n<p><strong>Note:</strong></p>\n<p>In <a href=\"https://github.com/RMLio/rmlmapper-java/blob/master/src/main/java/be/ugent/rml/records/XMLRecordFactory.java\" rel=\"nofollow noreferrer\">XMLRecordFactory</a>, we see:</p>\n<pre><code>// Extract and register existing source namespaces into the XPath compiler\nSaxNamespaceResolver.registerNamespaces(compiler, document);\n</code></pre>\n<p>And indeed, if I change my source XML from:</p>\n<pre><code>&lt;TEI xmlns=&quot;http://www.tei-c.org/ns/1.0&quot; xml:id=&quot;article_001&quot;&gt;\n</code></pre>\n<p>to</p>\n<pre><code>&lt;TEI xmlns=&quot;http://www.tei-c.org/ns/1.0&quot; xmlns:tei=&quot;http://www.tei-c.org/ns/1.0&quot; xml:id=&quot;article_001&quot;&gt;\n</code></pre>\n<p>The namespace prefix is correctly defined for XPath. But I don't want to change all XML source files.</p>\n"},{"tags":["java","httpclient","apache-httpclient-5.x"],"answers":[{"comment_count":0,"score":0,"last_activity_date":1701693888,"creation_date":1701693888,"answer_id":77599543,"question_id":77227198,"body_markdown":"The `HttpRequestRetryHandler` and `ServiceUnavailableRetryStrategy` got [merged][1] into the [HttpRequestRetryStrategy][2].\r\n\r\nSo your new implementation would be:\r\n\r\n    .setRetryStrategy(new HttpRequestRetryStrategy() {\r\n        @Override\r\n        public boolean retryRequest(HttpRequest request, IOException exception, int execCount, HttpContext context) {\r\n            // code block\r\n        }\r\n\r\n        @Override\r\n        public boolean retryRequest(HttpResponse response, int execCount, HttpContext context) {\r\n            // code block\r\n        }\r\n\r\n        @Override\r\n        public TimeValue getRetryInterval(HttpResponse response, int execCount, HttpContext context) {\r\n            // code block\r\n        }\r\n    });\r\n\r\n\r\n  [1]: https://stackoverflow.com/a/24230642/2049986\r\n  [2]: https://hc.apache.org/httpcomponents-client-5.1.x/current/httpclient5/apidocs/org/apache/hc/client5/http/HttpRequestRetryStrategy.html","link":"https://stackoverflow.com/questions/77227198/how-to-implement-httprequestretryhandler-and-serviceunavailableretrystrategy-in/77599543#77599543","title":"How to implement HttpRequestRetryHandler and ServiceUnavailableRetryStrategy in apache httpclient5","body":"<p>The <code>HttpRequestRetryHandler</code> and <code>ServiceUnavailableRetryStrategy</code> got <a href=\"https://stackoverflow.com/a/24230642/2049986\">merged</a> into the <a href=\"https://hc.apache.org/httpcomponents-client-5.1.x/current/httpclient5/apidocs/org/apache/hc/client5/http/HttpRequestRetryStrategy.html\" rel=\"nofollow noreferrer\">HttpRequestRetryStrategy</a>.</p>\n<p>So your new implementation would be:</p>\n<pre><code>.setRetryStrategy(new HttpRequestRetryStrategy() {\n    @Override\n    public boolean retryRequest(HttpRequest request, IOException exception, int execCount, HttpContext context) {\n        // code block\n    }\n\n    @Override\n    public boolean retryRequest(HttpResponse response, int execCount, HttpContext context) {\n        // code block\n    }\n\n    @Override\n    public TimeValue getRetryInterval(HttpResponse response, int execCount, HttpContext context) {\n        // code block\n    }\n});\n</code></pre>\n"}],"comment_count":0,"is_answered":false,"view_count":65,"answer_count":1,"score":0,"last_activity_date":1701693888,"creation_date":1696400430,"last_edit_date":1701692110,"question_id":77227198,"body_markdown":"I am updating the project to use httpclient5, I would like to know what is the relevant class to use for ```HttpRequestRetryHandler``` and ```ServiceUnavailableRetryStrategy```\r\n\r\nThe code snippet we have is as below\r\n\r\n```\r\nimport org.apache.http.client.HttpRequestRetryHandler;\r\nimport org.apache.http.client.ServiceUnavailableRetryStrategy;\r\n```\r\n\r\n\r\n```\r\n.setRetryHandler(new HttpRequestRetryHandler() {\r\n  @Override\r\n  public boolean retryRequest(IOException exp, int count, HttpContext context) {\r\n    // code block\r\n  }\r\n)\r\n.setServiceUnavailableRetryStrategy(new ServiceUnavailableRetryStrategy() {\r\n  @Override\r\n  public boolean retryRequest(HttpResponse res, int count, HttpContext context) {\r\n    // code block\r\n  }\r\n)\r\n```\r\n\r\nCould someone help and explain what is the new class in httpclient5 and how this code block can be rewritten?\r\n\r\n","link":"https://stackoverflow.com/questions/77227198/how-to-implement-httprequestretryhandler-and-serviceunavailableretrystrategy-in","title":"How to implement HttpRequestRetryHandler and ServiceUnavailableRetryStrategy in apache httpclient5","body":"<p>I am updating the project to use httpclient5, I would like to know what is the relevant class to use for <code>HttpRequestRetryHandler</code> and <code>ServiceUnavailableRetryStrategy</code></p>\n<p>The code snippet we have is as below</p>\n<pre><code>import org.apache.http.client.HttpRequestRetryHandler;\nimport org.apache.http.client.ServiceUnavailableRetryStrategy;\n</code></pre>\n<pre><code>.setRetryHandler(new HttpRequestRetryHandler() {\n  @Override\n  public boolean retryRequest(IOException exp, int count, HttpContext context) {\n    // code block\n  }\n)\n.setServiceUnavailableRetryStrategy(new ServiceUnavailableRetryStrategy() {\n  @Override\n  public boolean retryRequest(HttpResponse res, int count, HttpContext context) {\n    // code block\n  }\n)\n</code></pre>\n<p>Could someone help and explain what is the new class in httpclient5 and how this code block can be rewritten?</p>\n"},{"tags":["java","spring-boot","spring-security","httpclient"],"comments":[{"score":0,"post_type":"question","creation_date":1689158947,"post_id":76660268,"comment_id":135172924,"body_markdown":"It seems to be part of the `PoolingHttpClientConnectionManagerBuilder`, in other words, you need to configure a different connection manager than the one you&#39;re using right now. To be clear: this is a quick guess based on looking at the Javadoc of HttpClient 5.2.","link":"https://stackoverflow.com/questions/76660268/how-to-use-setmaxconnperroute-and-setmaxconntotal-with-httpclient5#comment135172924_76660268","body":"It seems to be part of the <code>PoolingHttpClientConnectionManagerBuilder</code>, in other words, you need to configure a different connection manager than the one you&#39;re using right now. To be clear: this is a quick guess based on looking at the Javadoc of HttpClient 5.2."},{"score":0,"post_type":"question","creation_date":1689228315,"post_id":76660268,"comment_id":135184098,"body_markdown":"Thanks @MarkRotteveel, yes it&#39;s part of PoolingHttpClientConnectionManagerBuilder","link":"https://stackoverflow.com/questions/76660268/how-to-use-setmaxconnperroute-and-setmaxconntotal-with-httpclient5#comment135184098_76660268","body":"Thanks @MarkRotteveel, yes it&#39;s part of PoolingHttpClientConnectionManagerBuilder"},{"score":0,"post_type":"question","creation_date":1693489587,"post_id":76660268,"comment_id":135770227,"body_markdown":"Did you change the implementation to fix this issue?  HttpClientBuilder to PoolingHttpClientConnectionManagerBuilder\ncannot find symbol symbol:   method setMaxConnTotal(int)\nError:   location: class org.apache.hc.client5.http.impl.classic.HttpClientBuilder","link":"https://stackoverflow.com/questions/76660268/how-to-use-setmaxconnperroute-and-setmaxconntotal-with-httpclient5#comment135770227_76660268","body":"Did you change the implementation to fix this issue?  HttpClientBuilder to PoolingHttpClientConnectionManagerBuilder cannot find symbol symbol:   method setMaxConnTotal(int) Error:   location: class org.apache.hc.client5.http.impl.classic.HttpClientBuilder"},{"score":0,"post_type":"question","creation_date":1693577067,"post_id":76660268,"comment_id":135783518,"body_markdown":"Yes PoolingHttpClientConnectionManagerBuilder can be used","link":"https://stackoverflow.com/questions/76660268/how-to-use-setmaxconnperroute-and-setmaxconntotal-with-httpclient5#comment135783518_76660268","body":"Yes PoolingHttpClientConnectionManagerBuilder can be used"},{"score":1,"post_type":"question","creation_date":1701096432,"post_id":76660268,"comment_id":136729195,"body_markdown":"@PankajNargesh do you think it would be more beneficial for others if you would provide the answer below and mark it as accepted?","link":"https://stackoverflow.com/questions/76660268/how-to-use-setmaxconnperroute-and-setmaxconntotal-with-httpclient5#comment136729195_76660268","body":"@PankajNargesh do you think it would be more beneficial for others if you would provide the answer below and mark it as accepted?"}],"answers":[{"comment_count":0,"score":0,"last_activity_date":1701691201,"creation_date":1701691201,"answer_id":77599269,"question_id":76660268,"body_markdown":"As said in the comments, use the PoolingHttpClientConnectionManagerBuilder:\r\n\r\n     var connectionManager = PoolingHttpClientConnectionManagerBuilder.create()\r\n         .setMaxConnPerRoute(50)\r\n         .setMaxConnTotal(200)\r\n         .setConnectionConfig(/* add connectionConfig */)\r\n         .build();\r\n\r\n     var client = HttpClients.custom()\r\n         .disableAutomaticRetries()\r\n         .setDefaultRequestConfig(/* add requestConfig */)\r\n         .build();","link":"https://stackoverflow.com/questions/76660268/how-to-use-setmaxconnperroute-and-setmaxconntotal-with-httpclient5/77599269#77599269","title":"how to use setMaxConnPerRoute and setMaxConnTotal with httpclient5?","body":"<p>As said in the comments, use the PoolingHttpClientConnectionManagerBuilder:</p>\n<pre><code> var connectionManager = PoolingHttpClientConnectionManagerBuilder.create()\n     .setMaxConnPerRoute(50)\n     .setMaxConnTotal(200)\n     .setConnectionConfig(/* add connectionConfig */)\n     .build();\n\n var client = HttpClients.custom()\n     .disableAutomaticRetries()\n     .setDefaultRequestConfig(/* add requestConfig */)\n     .build();\n</code></pre>\n"}],"comment_count":5,"is_answered":false,"view_count":681,"answer_count":1,"score":2,"last_activity_date":1701691201,"creation_date":1689066102,"last_edit_date":1689067390,"question_id":76660268,"body_markdown":"setMaxConnPerRoute() and setMaxConnTotal() are not available with HttpClientBuilder for httpclient5\r\nmigrating httpclient 4.5 to 5.2 for spring boot 3 compatibility.\r\nBelow is the reference code: \r\n\r\n    BasicHttpClientConnectionManager cm = new BasicHttpClientConnectionManager();\r\n        cm.setConnectionConfig(connConfig);\r\n    \r\n        final CloseableHttpClient client = HttpClientBuilder\r\n                .create().disableAutomaticRetries()\r\n                .setDefaultRequestConfig(RequestConfig.custom()\r\n                    .setConnectionRequestTimeout(Timeout.ofMilliseconds(30000))\r\n                    .build())\r\n                .setConnectionManager(cm)\r\n                .setMaxConnPerRoute(50)\r\n                .setMaxConnTotal(200)\r\n                .build();","link":"https://stackoverflow.com/questions/76660268/how-to-use-setmaxconnperroute-and-setmaxconntotal-with-httpclient5","title":"how to use setMaxConnPerRoute and setMaxConnTotal with httpclient5?","body":"<p>setMaxConnPerRoute() and setMaxConnTotal() are not available with HttpClientBuilder for httpclient5\nmigrating httpclient 4.5 to 5.2 for spring boot 3 compatibility.\nBelow is the reference code:</p>\n<pre><code>BasicHttpClientConnectionManager cm = new BasicHttpClientConnectionManager();\n    cm.setConnectionConfig(connConfig);\n\n    final CloseableHttpClient client = HttpClientBuilder\n            .create().disableAutomaticRetries()\n            .setDefaultRequestConfig(RequestConfig.custom()\n                .setConnectionRequestTimeout(Timeout.ofMilliseconds(30000))\n                .build())\n            .setConnectionManager(cm)\n            .setMaxConnPerRoute(50)\n            .setMaxConnTotal(200)\n            .build();\n</code></pre>\n"},{"tags":["java","spring","spring-boot","java-8"],"comments":[{"score":0,"post_type":"question","creation_date":1701168710,"post_id":77563135,"comment_id":136739209,"body_markdown":"Don&#39;t call block in a reactive stack. You don&#39;t pass the pageable object you pass request parameters like page, size etc.","link":"https://stackoverflow.com/questions/77563135/spring-boot-webclient-how-to-pass-parameter-in-webclient-get-call-and-how-to-ge#comment136739209_77563135","body":"Don&#39;t call block in a reactive stack. You don&#39;t pass the pageable object you pass request parameters like page, size etc."},{"score":0,"post_type":"question","creation_date":1701186936,"post_id":77563135,"comment_id":136742724,"body_markdown":"Thanks Deinum for your reply.Can you give small example of what you said it would be really helpful for me to understand this","link":"https://stackoverflow.com/questions/77563135/spring-boot-webclient-how-to-pass-parameter-in-webclient-get-call-and-how-to-ge#comment136742724_77563135","body":"Thanks Deinum for your reply.Can you give small example of what you said it would be really helpful for me to understand this"},{"score":0,"post_type":"question","creation_date":1701352667,"post_id":77563135,"comment_id":136766876,"body_markdown":"For passing request parameters you may construct the URI string with request params (`/demo?start=0&amp;max=10`) or use a `UriBuilder` instead: `webClieng.get().uri(uriBuilder -&gt; uriBuilder.path(&quot;/demo&quot;).queryParam(&quot;start&quot;, 0).queryparam(&quot;max&quot;, 10).build())....`","link":"https://stackoverflow.com/questions/77563135/spring-boot-webclient-how-to-pass-parameter-in-webclient-get-call-and-how-to-ge#comment136766876_77563135","body":"For passing request parameters you may construct the URI string with request params (<code>&#47;demo?start=0&amp;max=10</code>) or use a <code>UriBuilder</code> instead: <code>webClieng.get().uri(uriBuilder -&gt; uriBuilder.path(&quot;&#47;demo&quot;).queryParam(&quot;start&quot;, 0).queryparam(&quot;max&quot;, 10).build())....</code>"},{"score":0,"post_type":"question","creation_date":1701760368,"post_id":77563135,"comment_id":136812358,"body_markdown":"Thanks  Farhan Nasim, it really solved my issue","link":"https://stackoverflow.com/questions/77563135/spring-boot-webclient-how-to-pass-parameter-in-webclient-get-call-and-how-to-ge#comment136812358_77563135","body":"Thanks  Farhan Nasim, it really solved my issue"}],"comment_count":4,"is_answered":false,"view_count":50,"answer_count":0,"score":0,"last_activity_date":1701690318,"creation_date":1701167582,"last_edit_date":1701690318,"question_id":77563135,"body_markdown":"`I need to call an API through webclient.[Spring Boot]\r\n\r\nExample Rest controller API looks like ---\r\n\r\n\r\n\r\n\r\n`\r\n\r\n    @Getmapping(&quot;/demo&quot;)\r\n    \r\n    \r\n    public page&lt;Object&gt; find(Pageable pageable)\r\n    {\r\n         return repository.findall(pageable);\r\n    }\r\n\r\n\r\n\r\n\r\nWeb client call issues I&#39;m Facing. how to pass Pageable object argument in webclient and how to get the page return type object in webclient calling method.\r\n\r\nCode i tried :\r\n\r\n\r\n\r\n`webClient.get()\r\n         .uri(&quot;/demo&quot;)\r\n         .bodytomono(Page.class)\r\n         .block();`\r\n\r\n\r\n\r\nBut the above block throwing exception., My issue is like  how to pass pageable object argument through webclient and how to get the return type of page object in webclient.\r\n\r\nI&#39;m new to webclient can anyone please help on my issue.`","link":"https://stackoverflow.com/questions/77563135/spring-boot-webclient-how-to-pass-parameter-in-webclient-get-call-and-how-to-ge","title":"Spring Boot WebClient- How to pass parameter in webclient Get call and how to get Page Object in return type","body":"<p>`I need to call an API through webclient.[Spring Boot]</p>\n<p>Example Rest controller API looks like ---</p>\n<p>`</p>\n<pre><code>@Getmapping(&quot;/demo&quot;)\n\n\npublic page&lt;Object&gt; find(Pageable pageable)\n{\n     return repository.findall(pageable);\n}\n</code></pre>\n<p>Web client call issues I'm Facing. how to pass Pageable object argument in webclient and how to get the page return type object in webclient calling method.</p>\n<p>Code i tried :</p>\n<p><code>webClient.get() .uri(&quot;/demo&quot;) .bodytomono(Page.class) .block();</code></p>\n<p>But the above block throwing exception., My issue is like  how to pass pageable object argument through webclient and how to get the return type of page object in webclient.</p>\n<p>I'm new to webclient can anyone please help on my issue.`</p>\n"},{"tags":["java","android","admob","gdprconsentform"],"answers":[{"comment_count":0,"score":-2,"last_activity_date":1701689281,"creation_date":1701689281,"answer_id":77599057,"question_id":76401642,"body_markdown":"This answer may no longer be relevant to you, but it may be useful to someone else.\r\n\r\nGoogle has a repository on Github with examples of Mobile Ads SDK integration, and you can simply take the ready-made code from there and modify it to suit your needs.\r\n\r\nGoogle Mobile Ads SDK for Android: https://github.com/googleads/googleads-mobile-android-examples/tree/main","link":"https://stackoverflow.com/questions/76401642/is-this-a-good-ump-implementation/77599057#77599057","title":"Is this a good UMP implementation?","body":"<p>This answer may no longer be relevant to you, but it may be useful to someone else.</p>\n<p>Google has a repository on Github with examples of Mobile Ads SDK integration, and you can simply take the ready-made code from there and modify it to suit your needs.</p>\n<p>Google Mobile Ads SDK for Android: <a href=\"https://github.com/googleads/googleads-mobile-android-examples/tree/main\" rel=\"nofollow noreferrer\">https://github.com/googleads/googleads-mobile-android-examples/tree/main</a></p>\n"}],"comment_count":0,"is_answered":false,"view_count":226,"answer_count":1,"score":0,"last_activity_date":1701689281,"creation_date":1685899988,"question_id":76401642,"body_markdown":"I am implementing UMP sdk in my app and it is working apparently, but I want to ensure that this is the correct way of implementing it:\r\n\r\nHere is my code:\r\n\r\n    public class MainActivity extends AppCompatActivity {\r\n      private ConsentInformation consentInformation;\r\n      private ConsentForm consentForm;\r\n    \r\n      @Override\r\n      protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_main);\r\n    \r\n        consent();\r\n       }\r\n    \r\n        public void consent() {\r\n            ConsentRequestParameters params = new ConsentRequestParameters\r\n                    .Builder()\r\n                    .setTagForUnderAgeOfConsent(false)\r\n                    .build();\r\n    \r\n            consentInformation = UserMessagingPlatform.getConsentInformation(this);\r\n            consentInformation.requestConsentInfoUpdate(this,\r\n                    params,\r\n                    new ConsentInformation.OnConsentInfoUpdateSuccessListener() {\r\n                        @Override\r\n                        public void onConsentInfoUpdateSuccess() {\r\n                            // The consent information state was updated.\r\n                            // You are now ready to check if a form is available.\r\n                            if (consentInformation.isConsentFormAvailable()) {\r\n                                loadForm();\r\n                            }\r\n                        }\r\n                    },\r\n                    new ConsentInformation.OnConsentInfoUpdateFailureListener() {\r\n                        @Override\r\n                        public void onConsentInfoUpdateFailure(FormError formError) {\r\n                            // Handle the error.\r\n                        }\r\n                    });\r\n    \r\n        }\r\n    \r\n        public void loadForm() {\r\n            // Loads a consent form. Must be called on the main thread.\r\n            UserMessagingPlatform.loadConsentForm(\r\n                    this,\r\n                    new UserMessagingPlatform.OnConsentFormLoadSuccessListener() {\r\n                        @Override\r\n                        public void onConsentFormLoadSuccess(ConsentForm consentForm) {\r\n                            MainActivity.this.consentForm = consentForm;\r\n                            if (consentInformation.getConsentStatus() == ConsentInformation.ConsentStatus.REQUIRED) {\r\n                                consentForm.show(\r\n                                        MainActivity.this,\r\n                                        new ConsentForm.OnConsentFormDismissedListener() {\r\n                                            @Override\r\n                                            public void onConsentFormDismissed(FormError formError) {\r\n                                                if (consentInformation.getConsentStatus() == ConsentInformation.ConsentStatus.OBTAINED) {\r\n                                              MobileAds.initialize(this, initializationStatus -&gt; {\r\n            });\r\n                                                }\r\n    \r\n                                                // Handle dismissal by reloading form.\r\n                                                loadForm();\r\n                                            }\r\n                                        });\r\n                            }\r\n                        }\r\n                    },\r\n                    new UserMessagingPlatform.OnConsentFormLoadFailureListener() {\r\n                        @Override\r\n                        public void onConsentFormLoadFailure(FormError formError) {\r\n                            loadForm();\r\n                        }\r\n                    }\r\n            );\r\n        }\r\n\r\n\r\nI have three questions:\r\n\r\n1- Is my implementation looking good?\r\n\r\n2- Is it a good way to MobileAds.initialize() when ConsentStatus is ConsentStatus.OBTAINED as I have done?\r\n\r\n3- I don&#39;t have to do anything more, right? I mean when the user accepts or declines the Form, google will automatically personalize ads without my need of managing that, right? I mean, I don&#39;t have to code the personalization part, right?\r\n\r\n","link":"https://stackoverflow.com/questions/76401642/is-this-a-good-ump-implementation","title":"Is this a good UMP implementation?","body":"<p>I am implementing UMP sdk in my app and it is working apparently, but I want to ensure that this is the correct way of implementing it:</p>\n<p>Here is my code:</p>\n<pre><code>public class MainActivity extends AppCompatActivity {\n  private ConsentInformation consentInformation;\n  private ConsentForm consentForm;\n\n  @Override\n  protected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.activity_main);\n\n    consent();\n   }\n\n    public void consent() {\n        ConsentRequestParameters params = new ConsentRequestParameters\n                .Builder()\n                .setTagForUnderAgeOfConsent(false)\n                .build();\n\n        consentInformation = UserMessagingPlatform.getConsentInformation(this);\n        consentInformation.requestConsentInfoUpdate(this,\n                params,\n                new ConsentInformation.OnConsentInfoUpdateSuccessListener() {\n                    @Override\n                    public void onConsentInfoUpdateSuccess() {\n                        // The consent information state was updated.\n                        // You are now ready to check if a form is available.\n                        if (consentInformation.isConsentFormAvailable()) {\n                            loadForm();\n                        }\n                    }\n                },\n                new ConsentInformation.OnConsentInfoUpdateFailureListener() {\n                    @Override\n                    public void onConsentInfoUpdateFailure(FormError formError) {\n                        // Handle the error.\n                    }\n                });\n\n    }\n\n    public void loadForm() {\n        // Loads a consent form. Must be called on the main thread.\n        UserMessagingPlatform.loadConsentForm(\n                this,\n                new UserMessagingPlatform.OnConsentFormLoadSuccessListener() {\n                    @Override\n                    public void onConsentFormLoadSuccess(ConsentForm consentForm) {\n                        MainActivity.this.consentForm = consentForm;\n                        if (consentInformation.getConsentStatus() == ConsentInformation.ConsentStatus.REQUIRED) {\n                            consentForm.show(\n                                    MainActivity.this,\n                                    new ConsentForm.OnConsentFormDismissedListener() {\n                                        @Override\n                                        public void onConsentFormDismissed(FormError formError) {\n                                            if (consentInformation.getConsentStatus() == ConsentInformation.ConsentStatus.OBTAINED) {\n                                          MobileAds.initialize(this, initializationStatus -&gt; {\n        });\n                                            }\n\n                                            // Handle dismissal by reloading form.\n                                            loadForm();\n                                        }\n                                    });\n                        }\n                    }\n                },\n                new UserMessagingPlatform.OnConsentFormLoadFailureListener() {\n                    @Override\n                    public void onConsentFormLoadFailure(FormError formError) {\n                        loadForm();\n                    }\n                }\n        );\n    }\n</code></pre>\n<p>I have three questions:</p>\n<p>1- Is my implementation looking good?</p>\n<p>2- Is it a good way to MobileAds.initialize() when ConsentStatus is ConsentStatus.OBTAINED as I have done?</p>\n<p>3- I don't have to do anything more, right? I mean when the user accepts or declines the Form, google will automatically personalize ads without my need of managing that, right? I mean, I don't have to code the personalization part, right?</p>\n"},{"tags":["java","spring-boot","azure-application-insights","javaagents","graalvm-native-image"],"comments":[{"score":0,"post_type":"question","creation_date":1678715575,"post_id":75721649,"comment_id":133582171,"body_markdown":"Maybe https://github.com/oracle/graal/issues/5912 helps to shed a bit of light on the situation. _Disclaimer: I am not a GraalVM user and found this question due to the &#39;javaagents&#39; tag only._","link":"https://stackoverflow.com/questions/75721649/how-to-use-java-agent-with-native-compiled-spring-boot-application#comment133582171_75721649","body":"Maybe <a href=\"https://github.com/oracle/graal/issues/5912\" rel=\"nofollow noreferrer\">github.com/oracle/graal/issues/5912</a> helps to shed a bit of light on the situation. <i>Disclaimer: I am not a GraalVM user and found this question due to the &#39;javaagents&#39; tag only.</i>"}],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1678713149,"post_id":75722092,"comment_id":133581359,"body_markdown":"Thanks a lot for your answer Stephen. Unfortunately, it is using the same mechanism to &quot;enable it programatically&quot;. I uses ByteBuddy to attach a JAR (even if stated &quot;programmatically&quot;) to the JVM (which is obviously not present)\n\n`ByteBuddyAgent.attach(javaagentFile, getPid());`","link":"https://stackoverflow.com/questions/75721649/how-to-use-java-agent-with-native-compiled-spring-boot-application/75722092#comment133581359_75722092","body":"Thanks a lot for your answer Stephen. Unfortunately, it is using the same mechanism to &quot;enable it programatically&quot;. I uses ByteBuddy to attach a JAR (even if stated &quot;programmatically&quot;) to the JVM (which is obviously not present)  <code>ByteBuddyAgent.attach(javaagentFile, getPid());</code>"},{"score":0,"post_type":"answer","creation_date":1689408082,"post_id":75722092,"comment_id":135211746,"body_markdown":"@RolfNyffenegger\n\ndid you solve the issue with graalVM and opentelemetry-javaagent. \n\ni am able to run from locally but i coulnt&#39; able to generate native image. i am getting errors like below \n\n\n[ERROR] Failed to execute goal org.springframework.boot:spring-boot-maven-plugin:3.1.1:process-aot (process-aot) on project MongoDbService: Unable to compile generated source\n[ERROR] cannot find symbol\n[ERROR]:   class OpenTelemetryMeterRegistryAutoConfiguration\nio.opentelemetry.javaagent.instrumentation.spring.actuator.v2_0.OpenTelemetryMeterRegistryAutoConfiguration__BeanDefinitions","link":"https://stackoverflow.com/questions/75721649/how-to-use-java-agent-with-native-compiled-spring-boot-application/75722092#comment135211746_75722092","body":"@RolfNyffenegger  did you solve the issue with graalVM and opentelemetry-javaagent.   i am able to run from locally but i coulnt&#39; able to generate native image. i am getting errors like below    [ERROR] Failed to execute goal org.springframework.boot:spring-boot-maven-plugin:3.1.1:proc&zwnj;&#8203;ess-aot (process-aot) on project MongoDbService: Unable to compile generated source [ERROR] cannot find symbol [ERROR]:   class OpenTelemetryMeterRegistryAutoConfiguration io.opentelemetry.javaagent.instrumentation.spring.actuator.v&zwnj;&#8203;2_0.OpenTelemetryMet&zwnj;&#8203;erRegistryAutoConfig&zwnj;&#8203;uration__BeanDefinit&zwnj;&#8203;ions"}],"comment_count":2,"score":1,"last_activity_date":1686230601,"last_edit_date":1686230601,"creation_date":1678711897,"answer_id":75722092,"question_id":75721649,"body_markdown":"I couldn&#39;t find anything in the GraalVM documentation for native images that talks about attaching runtime agents to native apps.  This suggests that it is not supported.  \r\n\r\nI then searched for &quot;application insights graalvm native image&quot; and found this on the Application Insights issue tracker:\r\n\r\nhttps://github.com/microsoft/ApplicationInsights-Java/issues/1266\r\n\r\n&gt; We are currently using a custom implementation of the OpenTracing SPI to send our tracing data to Application Insights (the implementation is based on the Application Insights SDK 2.6.1) from a Quarkus application. Our plan is to move to OpenTelemetry as soon as it is supported by Quarkus.\r\n\r\n&gt; Since Quarkus also supports native image generation (using GraalVM) **auto-instrumentation using a Java agent won&#39;t be possible** and a &quot;deep integration&quot; with Quarkus will be required. I would like to know if use cases like this one are on the radar and if builds (i.e. Maven artifacts) will be provided, which cater for this use case. I imagine there would be a build which provides an exporter only.\r\n\r\nThe highlighted phrase aligns with what I deduced from the (lack of) documentation.   And it is further confirmed by the response to this GraalVM issue: https://github.com/oracle/graal/issues/5912\r\n\r\nYou said:\r\n\r\n&gt; Use the OpenTelemetry library [...]. For me it still seems to use a kind of a javaagent jar to work properly.\r\n\r\nThe alternative would be to include the OpenTelemetry JAR in your SpringBoot application and [enable it programatically][1] rather than via a javaagent.  It would be converted to native code by the GraalVM native image builder.\r\n\r\n\r\n  [1]: https://learn.microsoft.com/en-us/azure/azure-monitor/app/java-spring-boot#enabling-programmatically","link":"https://stackoverflow.com/questions/75721649/how-to-use-java-agent-with-native-compiled-spring-boot-application/75722092#75722092","title":"How to use Java agent with native compiled spring boot application","body":"<p>I couldn't find anything in the GraalVM documentation for native images that talks about attaching runtime agents to native apps.  This suggests that it is not supported.</p>\n<p>I then searched for &quot;application insights graalvm native image&quot; and found this on the Application Insights issue tracker:</p>\n<p><a href=\"https://github.com/microsoft/ApplicationInsights-Java/issues/1266\" rel=\"nofollow noreferrer\">https://github.com/microsoft/ApplicationInsights-Java/issues/1266</a></p>\n<blockquote>\n<p>We are currently using a custom implementation of the OpenTracing SPI to send our tracing data to Application Insights (the implementation is based on the Application Insights SDK 2.6.1) from a Quarkus application. Our plan is to move to OpenTelemetry as soon as it is supported by Quarkus.</p>\n</blockquote>\n<blockquote>\n<p>Since Quarkus also supports native image generation (using GraalVM) <strong>auto-instrumentation using a Java agent won't be possible</strong> and a &quot;deep integration&quot; with Quarkus will be required. I would like to know if use cases like this one are on the radar and if builds (i.e. Maven artifacts) will be provided, which cater for this use case. I imagine there would be a build which provides an exporter only.</p>\n</blockquote>\n<p>The highlighted phrase aligns with what I deduced from the (lack of) documentation.   And it is further confirmed by the response to this GraalVM issue: <a href=\"https://github.com/oracle/graal/issues/5912\" rel=\"nofollow noreferrer\">https://github.com/oracle/graal/issues/5912</a></p>\n<p>You said:</p>\n<blockquote>\n<p>Use the OpenTelemetry library [...]. For me it still seems to use a kind of a javaagent jar to work properly.</p>\n</blockquote>\n<p>The alternative would be to include the OpenTelemetry JAR in your SpringBoot application and <a href=\"https://learn.microsoft.com/en-us/azure/azure-monitor/app/java-spring-boot#enabling-programmatically\" rel=\"nofollow noreferrer\">enable it programatically</a> rather than via a javaagent.  It would be converted to native code by the GraalVM native image builder.</p>\n"},{"comment_count":0,"score":1,"last_activity_date":1701686604,"last_edit_date":1701686604,"creation_date":1701386616,"answer_id":77582213,"question_id":75721649,"body_markdown":"As specified on [this Microsoft documentation page](https://learn.microsoft.com/en-us/azure/azure-monitor/app/java-spring-boot), the alternative is to use [the Azure distribution of the OpenTelemetry Spring Boot starter](https://aka.ms/AzMonSpringNative) to monitor Spring Boot native image applications on Azure.","link":"https://stackoverflow.com/questions/75721649/how-to-use-java-agent-with-native-compiled-spring-boot-application/77582213#77582213","title":"How to use Java agent with native compiled spring boot application","body":"<p>As specified on <a href=\"https://learn.microsoft.com/en-us/azure/azure-monitor/app/java-spring-boot\" rel=\"nofollow noreferrer\">this Microsoft documentation page</a>, the alternative is to use <a href=\"https://aka.ms/AzMonSpringNative\" rel=\"nofollow noreferrer\">the Azure distribution of the OpenTelemetry Spring Boot starter</a> to monitor Spring Boot native image applications on Azure.</p>\n"}],"comment_count":1,"is_answered":true,"view_count":1181,"answer_count":2,"score":8,"last_activity_date":1701686604,"creation_date":1678709140,"question_id":75721649,"body_markdown":"Together with our SpringBoot (3.0.3) application we are using Application Insights (Azure) for monitoring. \r\n\r\nCurrently we are trying to compile the application natively with the GraalVM. That works quite well and gives us a lot of benefits (startup time and memory consumption). The only thing that does not yet work is Application Insights which is started as a Java agent. I found almost no useful information about the whole topic and asked myself if we are trying to do something that is currently not supported at all.\r\n\r\nHere&#39;s what we&#39;ve tried so far:\r\n\r\n- Use parameters of the `nativeCompile` Gradle task to specify an additional jvmArgs (as mentioned here: https://github.com/oracle/graal/issues/1065). Although the build works fine, it just don&#39;t includes (or starts?) the agent with application startup.\r\n[![gradle task configuration](https://i.stack.imgur.com/L04TU.png)](https://i.stack.imgur.com/L04TU.png)\r\n- Start the Application Insights agent from within the code as described here: https://learn.microsoft.com/en-us/azure/azure-monitor/app/java-spring-boot#enabling-programmatically\r\nUnfortunately that did not work either, because it tries to load a JAR file during startup, which is (I think) not possible for a native compiled application (no JVM).\r\n- Use OpenTelemetry library as described here: https://learn.microsoft.com/en-us/azure/azure-monitor/app/opentelemetry-enable?tabs=java\r\nFor me it still seems to use a kind of a javaagent jar to work properly.\r\n\r\nIs there a solution to add javaagents also in native compiled builds, or are there any alternatives to send monitoring data from a SpringBoot application to ApplicationInsights?","link":"https://stackoverflow.com/questions/75721649/how-to-use-java-agent-with-native-compiled-spring-boot-application","title":"How to use Java agent with native compiled spring boot application","body":"<p>Together with our SpringBoot (3.0.3) application we are using Application Insights (Azure) for monitoring.</p>\n<p>Currently we are trying to compile the application natively with the GraalVM. That works quite well and gives us a lot of benefits (startup time and memory consumption). The only thing that does not yet work is Application Insights which is started as a Java agent. I found almost no useful information about the whole topic and asked myself if we are trying to do something that is currently not supported at all.</p>\n<p>Here's what we've tried so far:</p>\n<ul>\n<li>Use parameters of the <code>nativeCompile</code> Gradle task to specify an additional jvmArgs (as mentioned here: <a href=\"https://github.com/oracle/graal/issues/1065\" rel=\"noreferrer\">https://github.com/oracle/graal/issues/1065</a>). Although the build works fine, it just don't includes (or starts?) the agent with application startup.\n<a href=\"https://i.stack.imgur.com/L04TU.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/L04TU.png\" alt=\"gradle task configuration\" /></a></li>\n<li>Start the Application Insights agent from within the code as described here: <a href=\"https://learn.microsoft.com/en-us/azure/azure-monitor/app/java-spring-boot#enabling-programmatically\" rel=\"noreferrer\">https://learn.microsoft.com/en-us/azure/azure-monitor/app/java-spring-boot#enabling-programmatically</a>\nUnfortunately that did not work either, because it tries to load a JAR file during startup, which is (I think) not possible for a native compiled application (no JVM).</li>\n<li>Use OpenTelemetry library as described here: <a href=\"https://learn.microsoft.com/en-us/azure/azure-monitor/app/opentelemetry-enable?tabs=java\" rel=\"noreferrer\">https://learn.microsoft.com/en-us/azure/azure-monitor/app/opentelemetry-enable?tabs=java</a>\nFor me it still seems to use a kind of a javaagent jar to work properly.</li>\n</ul>\n<p>Is there a solution to add javaagents also in native compiled builds, or are there any alternatives to send monitoring data from a SpringBoot application to ApplicationInsights?</p>\n"},{"tags":["javascript","java","http","cookies","cors"],"comments":[{"score":2,"post_type":"question","creation_date":1700485636,"post_id":77515837,"comment_id":136656634,"body_markdown":"Was that first request, the POST, also made with `withCredentials` set to true?","link":"https://stackoverflow.com/questions/77515837/browser-doesnt-send-cookie-when-set-trough-cors-request#comment136656634_77515837","body":"Was that first request, the POST, also made with <code>withCredentials</code> set to true?"},{"score":1,"post_type":"question","creation_date":1700486110,"post_id":77515837,"comment_id":136656722,"body_markdown":"if your server is sitting behind a reverse proxy like nginx, based on the inital server response (in your case 400), some headers might be stripped off. Nginx has some additinal config keyword &#39;always&#39; like in here: https://gist.github.com/Stanback/7145487","link":"https://stackoverflow.com/questions/77515837/browser-doesnt-send-cookie-when-set-trough-cors-request#comment136656722_77515837","body":"if your server is sitting behind a reverse proxy like nginx, based on the inital server response (in your case 400), some headers might be stripped off. Nginx has some additinal config keyword &#39;always&#39; like in here: <a href=\"https://gist.github.com/Stanback/7145487\" rel=\"nofollow noreferrer\">gist.github.com/Stanback/7145487</a>"},{"score":0,"post_type":"question","creation_date":1700489529,"post_id":77515837,"comment_id":136657353,"body_markdown":"@CBroe no, the first request is sent without &quot;withCredentials=true&quot;, is this required ?","link":"https://stackoverflow.com/questions/77515837/browser-doesnt-send-cookie-when-set-trough-cors-request#comment136657353_77515837","body":"@CBroe no, the first request is sent without &quot;withCredentials=true&quot;, is this required ?"},{"score":2,"post_type":"question","creation_date":1700490774,"post_id":77515837,"comment_id":136657598,"body_markdown":"Yes. https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/withCredentials: _&quot;In addition, this flag is also used to indicate when cookies are **to be ignored in the response**. The default is false. XMLHttpRequest responses from a different domain cannot set cookie values for their own domain unless withCredentials is set to true before making the request.&quot;_","link":"https://stackoverflow.com/questions/77515837/browser-doesnt-send-cookie-when-set-trough-cors-request#comment136657598_77515837","body":"Yes. <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/withCredentials\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/&hellip;</a>: <i>&quot;In addition, this flag is also used to indicate when cookies are <b>to be ignored in the response</b>. The default is false. XMLHttpRequest responses from a different domain cannot set cookie values for their own domain unless withCredentials is set to true before making the request.&quot;</i>"}],"answers":[{"comment_count":0,"score":0,"last_activity_date":1701682196,"creation_date":1701682196,"answer_id":77598371,"question_id":77515837,"body_markdown":"Credits to @CBroe\r\n\r\nThe correct solution was, to use ```withCredentials=true``` with the initial request, that will lead to the response setting the Cookie!","link":"https://stackoverflow.com/questions/77515837/browser-doesnt-send-cookie-when-set-trough-cors-request/77598371#77598371","title":"Browser doesn&#39;t send Cookie when set trough cors-request","body":"<p>Credits to @CBroe</p>\n<p>The correct solution was, to use <code>withCredentials=true</code> with the initial request, that will lead to the response setting the Cookie!</p>\n"}],"comment_count":4,"is_answered":true,"view_count":46,"answer_count":1,"score":-1,"last_activity_date":1701682196,"creation_date":1700482451,"last_edit_date":1700484296,"question_id":77515837,"body_markdown":"i struggle with a Cookie that is set trough a CORS request.\r\nSubsequentially the browser won&#39;t send the cookie.\r\n\r\nI tried:\r\n- adjusting cors-headers\r\n- sending allowCredentials client-side\r\n- SameSite=None flag\r\n\r\n\r\nThe Application (Browser) runs on the main domain (dev.mydomain.com/myApp)\r\n\r\nand sent&#39;s a request (via a integrated WebComponent) to another domain (second.mydomain.com), that set&#39;s the cookie.\r\n\r\n`POST https://second.mydomain.com/verifyToken =&gt; 200`\r\n\r\nIt responds:\r\n\r\n```\r\nVary: Origin\r\nVary: Access-Control-Request-Method\r\nVary: Access-Control-Request-Headers\r\nAccess-Control-Allow-Origin: https://dev.mydomain.com\r\nAccess-Control-Expose-Headers: Authorization\r\nAccess-Control-Allow-Credentials: true\r\nAuthorization: Bearer eyJra...\r\nSet-Cookie: refreshToken=eyJra...; Path=/refresh; Secure; HttpOnly; SameSite=None\r\n```\r\n\r\nThe Request that should contain the cookie looks like this:\r\n\r\n```\r\nGET https://second.mydomain.com/refresh =&gt; 400\r\n\r\nGET /refresh HTTP/1.1\r\n\r\nAccept: application/json, text/plain, */*\r\nAccept-Encoding: gzip, deflate, br\r\nAccept-Language: de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7\r\nConnection: keep-alive\r\nDNT: 1\r\nHost: second.mydomain.com\r\nOrigin: https://dev.mydomain.com\r\nReferer: https://dev.mydomain.com/\r\n```\r\n\r\nThe Response-Headers:\r\n\r\n```\r\nHTTP/1.1 400\r\nDate: Mon, 20 Nov 2023 12:05:41 GMT\r\nContent-Length: 0\r\nConnection: keep-alive\r\nVary: Origin\r\nVary: Access-Control-Request-Method\r\nVary: Access-Control-Request-Headers\r\nAccess-Control-Allow-Origin: https://dev.mydomain.com\r\nAccess-Control-Expose-Headers: Authorization\r\nAccess-Control-Allow-Credentials: true\r\nX-Content-Type-Options: nosniff\r\n```\r\n\r\n\r\nCan anyone give me a hint, why the cookie is not attached?\r\n\r\nI also tried setting the Domain= Attribute in the cookie. But the default behaviour should pick the request-url as domain (in this case: second.mydomain.com)\r\n\r\nThe request is sent via axios rest-client\r\n\r\n```\r\n axios.get(refreshPath, {withCredentials: true});\r\n\r\n``` \r\nI would really appreciate any hints.\r\n\r\n\r\nBest Regards\r\nAlex\r\n","link":"https://stackoverflow.com/questions/77515837/browser-doesnt-send-cookie-when-set-trough-cors-request","title":"Browser doesn&#39;t send Cookie when set trough cors-request","body":"<p>i struggle with a Cookie that is set trough a CORS request.\nSubsequentially the browser won't send the cookie.</p>\n<p>I tried:</p>\n<ul>\n<li>adjusting cors-headers</li>\n<li>sending allowCredentials client-side</li>\n<li>SameSite=None flag</li>\n</ul>\n<p>The Application (Browser) runs on the main domain (dev.mydomain.com/myApp)</p>\n<p>and sent's a request (via a integrated WebComponent) to another domain (second.mydomain.com), that set's the cookie.</p>\n<p><code>POST https://second.mydomain.com/verifyToken =&gt; 200</code></p>\n<p>It responds:</p>\n<pre><code>Vary: Origin\nVary: Access-Control-Request-Method\nVary: Access-Control-Request-Headers\nAccess-Control-Allow-Origin: https://dev.mydomain.com\nAccess-Control-Expose-Headers: Authorization\nAccess-Control-Allow-Credentials: true\nAuthorization: Bearer eyJra...\nSet-Cookie: refreshToken=eyJra...; Path=/refresh; Secure; HttpOnly; SameSite=None\n</code></pre>\n<p>The Request that should contain the cookie looks like this:</p>\n<pre><code>GET https://second.mydomain.com/refresh =&gt; 400\n\nGET /refresh HTTP/1.1\n\nAccept: application/json, text/plain, */*\nAccept-Encoding: gzip, deflate, br\nAccept-Language: de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7\nConnection: keep-alive\nDNT: 1\nHost: second.mydomain.com\nOrigin: https://dev.mydomain.com\nReferer: https://dev.mydomain.com/\n</code></pre>\n<p>The Response-Headers:</p>\n<pre><code>HTTP/1.1 400\nDate: Mon, 20 Nov 2023 12:05:41 GMT\nContent-Length: 0\nConnection: keep-alive\nVary: Origin\nVary: Access-Control-Request-Method\nVary: Access-Control-Request-Headers\nAccess-Control-Allow-Origin: https://dev.mydomain.com\nAccess-Control-Expose-Headers: Authorization\nAccess-Control-Allow-Credentials: true\nX-Content-Type-Options: nosniff\n</code></pre>\n<p>Can anyone give me a hint, why the cookie is not attached?</p>\n<p>I also tried setting the Domain= Attribute in the cookie. But the default behaviour should pick the request-url as domain (in this case: second.mydomain.com)</p>\n<p>The request is sent via axios rest-client</p>\n<pre><code> axios.get(refreshPath, {withCredentials: true});\n\n</code></pre>\n<p>I would really appreciate any hints.</p>\n<p>Best Regards\nAlex</p>\n"},{"tags":["java","xsd","xml-parsing","jaxb","maven-jaxb2-plugin"],"comments":[{"score":0,"post_type":"question","creation_date":1684542609,"post_id":76293003,"comment_id":134537269,"body_markdown":"_&quot;jaxb adds this import to the class: `import java.util.List&lt;String&gt;;`&quot;_ - Generating invalid Java code would indicate a bug, no?  You might want to check the bug database to see if this issue is listed?","link":"https://stackoverflow.com/questions/76293003/how-to-add-custom-string-to-liststring-jaxb-xml-adapter-to-an-xsd-generated-cl#comment134537269_76293003","body":"<i>&quot;jaxb adds this import to the class: <code>import java.util.List&lt;String&gt;;</code>&quot;</i> - Generating invalid Java code would indicate a bug, no?  You might want to check the bug database to see if this issue is listed?"},{"score":0,"post_type":"question","creation_date":1684636309,"post_id":76293003,"comment_id":134545364,"body_markdown":"What is the delimiter of the list supposed to be?","link":"https://stackoverflow.com/questions/76293003/how-to-add-custom-string-to-liststring-jaxb-xml-adapter-to-an-xsd-generated-cl#comment134545364_76293003","body":"What is the delimiter of the list supposed to be?"},{"score":0,"post_type":"question","creation_date":1684763909,"post_id":76293003,"comment_id":134560228,"body_markdown":"@FLUXparticle comma (&quot;,&quot;) delimited.","link":"https://stackoverflow.com/questions/76293003/how-to-add-custom-string-to-liststring-jaxb-xml-adapter-to-an-xsd-generated-cl#comment134560228_76293003","body":"@FLUXparticle comma (&quot;,&quot;) delimited."},{"score":0,"post_type":"question","creation_date":1684774389,"post_id":76293003,"comment_id":134562688,"body_markdown":"Then I would say it is not possible to describe such a format in XML schema. At least not in a way that the list is handled automatically. In XML Schema a list is always divided by spaces.","link":"https://stackoverflow.com/questions/76293003/how-to-add-custom-string-to-liststring-jaxb-xml-adapter-to-an-xsd-generated-cl#comment134562688_76293003","body":"Then I would say it is not possible to describe such a format in XML schema. At least not in a way that the list is handled automatically. In XML Schema a list is always divided by spaces."},{"score":0,"post_type":"question","creation_date":1701644240,"post_id":76293003,"comment_id":136798258,"body_markdown":"Hello there : this is due to this issue in jaxb-ri : https://github.com/eclipse-ee4j/jaxb-ri/issues/737. Good news is I found a way to fix it. Will provide PR for this and update my below answer with this reference.","link":"https://stackoverflow.com/questions/76293003/how-to-add-custom-string-to-liststring-jaxb-xml-adapter-to-an-xsd-generated-cl#comment136798258_76293003","body":"Hello there : this is due to this issue in jaxb-ri : <a href=\"https://github.com/eclipse-ee4j/jaxb-ri/issues/737\" rel=\"nofollow noreferrer\">github.com/eclipse-ee4j/jaxb-ri/issues/737</a>. Good news is I found a way to fix it. Will provide PR for this and update my below answer with this reference."},{"score":0,"post_type":"question","creation_date":1701681254,"post_id":76293003,"comment_id":136801345,"body_markdown":"PR provided : https://github.com/eclipse-ee4j/jaxb-ri/pull/1781","link":"https://stackoverflow.com/questions/76293003/how-to-add-custom-string-to-liststring-jaxb-xml-adapter-to-an-xsd-generated-cl#comment136801345_76293003","body":"PR provided : <a href=\"https://github.com/eclipse-ee4j/jaxb-ri/pull/1781\" rel=\"nofollow noreferrer\">github.com/eclipse-ee4j/jaxb-ri/pull/1781</a>"}],"answers":[{"comment_count":0,"score":0,"last_activity_date":1701681226,"last_edit_date":1701681226,"creation_date":1699887195,"answer_id":77474776,"question_id":76293003,"body_markdown":"**New solution**\r\n\r\n*See initial answer first before new solution is released*\r\n\r\nNew solution waiting in PR provided in JAXB-RI : https://github.com/eclipse-ee4j/jaxb-ri/pull/1781\r\n\r\nIt&#39;ll fix the generic not handled in parsing the expected `xjc:javaType name` tag : expecting `java.util.List&amp;lt;java.lang.String&amp;gt;` will now generate the good imports tags and good java type for the property.\r\n\r\n\r\n**Initial answer**\r\n\r\nDon&#39;t know if you found any solution to your problem but maybe this could work :\r\n\r\n* Create a new Java Class that extends the `LinkedList&lt;String&gt;` class to mask generics from\r\n\r\n```java\r\npublic class ListString extends LinkedList&lt;String&gt; {\r\n\r\n}\r\n```\r\n\r\n* Create the Adapter (inspired by the class you used)\r\n\r\n```java\r\npublic class CommaDelimitedStringAdapter extends\r\n    XmlAdapter&lt;String, ListString&gt; {\r\n\r\n\t@Override\r\n\tpublic String marshal(ListString value) throws Exception {\r\n\t\tif (value == null) {\r\n\t\t\treturn null;\r\n\t\t} else {\r\n\t\t\treturn StringUtils.join(value.iterator(), &quot;, &quot;);\r\n\t\t}\r\n\t}\r\n\r\n\t@Override\r\n\tpublic ListString unmarshal(String text) throws Exception {\r\n\r\n\t\tif (text == null) {\r\n\t\t\treturn null;\r\n\t\t} else\r\n\r\n\t\t{\r\n\t\t\tfinal ListString value = new ListString();\r\n\t\t\tfinal String[] items = StringUtils.split(text, &#39;,&#39;);\r\n\t\t\tfor (String item : items) {\r\n\t\t\t\tfinal String trimmedItem = item.trim();\r\n\t\t\t\tif (!StringUtils.isEmpty(trimmedItem)) {\r\n\t\t\t\t\tvalue.add(trimmedItem);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn value;\r\n\t\t}\r\n\t}\r\n}\r\n```\r\n\r\n* Adapt your binding file to use this `xjc:javaType name=&quot;fully.qualified.package.ListString&quot;` using your new adapter you created\r\n\r\nThis will generate the following attribute :\r\n\r\n```java\r\n    @XmlAttribute(name = &quot;subRatings&quot;)\r\n    @XmlJavaTypeAdapter(CommaDelimitedStringAdapter.class)\r\n    protected ListString subRatings;\r\n```\r\n\r\nUnmarshalling is OK [see here][1], and you&#39;re still able to navigate through the List items without any cast.\r\n\r\nThe only cons I found is that you have to choose the implementation of `List` you&#39;re using (I choose `LinkedList` since this is the one used in `unmarshalling` method of the adapter but it will work with any other type).\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/PRY9d.png","link":"https://stackoverflow.com/questions/76293003/how-to-add-custom-string-to-liststring-jaxb-xml-adapter-to-an-xsd-generated-cl/77474776#77474776","title":"How to add custom String to List&lt;String&gt; jaxb xml adapter to an xsd generated class attribute","body":"<p><strong>New solution</strong></p>\n<p><em>See initial answer first before new solution is released</em></p>\n<p>New solution waiting in PR provided in JAXB-RI : <a href=\"https://github.com/eclipse-ee4j/jaxb-ri/pull/1781\" rel=\"nofollow noreferrer\">https://github.com/eclipse-ee4j/jaxb-ri/pull/1781</a></p>\n<p>It'll fix the generic not handled in parsing the expected <code>xjc:javaType name</code> tag : expecting <code>java.util.List&amp;lt;java.lang.String&amp;gt;</code> will now generate the good imports tags and good java type for the property.</p>\n<p><strong>Initial answer</strong></p>\n<p>Don't know if you found any solution to your problem but maybe this could work :</p>\n<ul>\n<li>Create a new Java Class that extends the <code>LinkedList&lt;String&gt;</code> class to mask generics from</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>public class ListString extends LinkedList&lt;String&gt; {\n\n}\n</code></pre>\n<ul>\n<li>Create the Adapter (inspired by the class you used)</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>public class CommaDelimitedStringAdapter extends\n    XmlAdapter&lt;String, ListString&gt; {\n\n    @Override\n    public String marshal(ListString value) throws Exception {\n        if (value == null) {\n            return null;\n        } else {\n            return StringUtils.join(value.iterator(), &quot;, &quot;);\n        }\n    }\n\n    @Override\n    public ListString unmarshal(String text) throws Exception {\n\n        if (text == null) {\n            return null;\n        } else\n\n        {\n            final ListString value = new ListString();\n            final String[] items = StringUtils.split(text, ',');\n            for (String item : items) {\n                final String trimmedItem = item.trim();\n                if (!StringUtils.isEmpty(trimmedItem)) {\n                    value.add(trimmedItem);\n                }\n            }\n            return value;\n        }\n    }\n}\n</code></pre>\n<ul>\n<li>Adapt your binding file to use this <code>xjc:javaType name=&quot;fully.qualified.package.ListString&quot;</code> using your new adapter you created</li>\n</ul>\n<p>This will generate the following attribute :</p>\n<pre class=\"lang-java prettyprint-override\"><code>    @XmlAttribute(name = &quot;subRatings&quot;)\n    @XmlJavaTypeAdapter(CommaDelimitedStringAdapter.class)\n    protected ListString subRatings;\n</code></pre>\n<p>Unmarshalling is OK <a href=\"https://i.stack.imgur.com/PRY9d.png\" rel=\"nofollow noreferrer\">see here</a>, and you're still able to navigate through the List items without any cast.</p>\n<p>The only cons I found is that you have to choose the implementation of <code>List</code> you're using (I choose <code>LinkedList</code> since this is the one used in <code>unmarshalling</code> method of the adapter but it will work with any other type).</p>\n"}],"comment_count":6,"is_answered":false,"view_count":104,"answer_count":1,"score":2,"last_activity_date":1701681226,"creation_date":1684539874,"last_edit_date":1684763785,"question_id":76293003,"body_markdown":"We have been using jaxb for a long time to unmarshal XML into POJOs that we can use within our system. However, only recently I found an issue with how jaxb is parsing the xml provided data and I would like to override that behavior by implementing a custom XmlAdapter and forcing jaxb to use it.\r\n\r\n\r\nLet&#39;s say we have a complex field definition like the below in our xsd:\r\n```\r\n&lt;xs:complexType name=&quot;ratingType&quot;&gt;\r\n    &lt;xs:simpleContent&gt;\r\n      &lt;xs:extension base=&quot;xs:string&quot;&gt;\r\n        &lt;xs:attribute name=&quot;scheme&quot; use=&quot;required&quot; type=&quot;xs:NMTOKEN&quot;/&gt;\r\n        &lt;xs:attribute name=&quot;subRatings&quot; use=&quot;optional&quot;&gt;\r\n          &lt;xs:simpleType&gt;\r\n            &lt;xs:list itemType=&#39;xs:string&#39;/&gt;\r\n          &lt;/xs:simpleType&gt;\r\n        &lt;/xs:attribute&gt;\r\n      &lt;/xs:extension&gt;\r\n    &lt;/xs:simpleContent&gt;\r\n  &lt;/xs:complexType&gt;\r\n```\r\n\r\nWithout making any changes, jaxb creates the following java class attribute:\r\n```\r\n@XmlAttribute(name = &quot;subRatings&quot;)\r\nprotected List&lt;String&gt;subRatings;\r\n```\r\n\r\nThis has been generally ok, however, due to new client requirements the data we get on this field will change.\r\n\r\nCurrent use case:\r\n`&lt;rating scheme=&quot;urn:ncs&quot; subRatings=&quot;Violence&quot;&gt;MA15+&lt;/rating&gt;`\r\nThis turns into subRatings=[&quot;Violence&quot;], which is great.\r\n\r\nNew use case:\r\n`&lt;rating scheme=&quot;urn:ncs&quot; subRatings=&quot;Coarse Language&quot;&gt;MA15+&lt;/rating&gt;`\r\nThis, however, turns into subRatings=[&quot;Coarse&quot;, &quot;Language&quot;], which is not right and causes issues downstream as that is not a recognized subRating. I expect it to be subRatings=[&quot;Coarse Language&quot;] instead. \r\n\r\nI have tried a few things, but so far the one that gets me closest to what I want is using jaxb bindings like the below:\r\n```\r\n&lt;jxb:bindings schemaLocation=&quot;media.xsd&quot; node=&quot;//xs:complexType[@name=&#39;ratingType&#39;]&quot;&gt;\r\n        &lt;jxb:bindings node=&quot;.//xs:attribute[@name=&#39;subRatings&#39;]&quot;&gt;\r\n            &lt;jxb:property&gt;\r\n                &lt;jxb:baseType&gt;\r\n                    &lt;xjc:javaType name=&quot;java.util.List&amp;lt;String&amp;gt;&quot; adapter=&quot;org.jvnet.jaxb2_commons.xml.bind.annotation.adapters.CommaDelimitedStringAdapter&quot;/&gt;\r\n                &lt;/jxb:baseType&gt;\r\n            &lt;/jxb:property&gt;\r\n        &lt;/jxb:bindings&gt;\r\n    &lt;/jxb:bindings&gt;\r\n```\r\n\r\nThe generated class has the following attribute definition:\r\n```\r\n@XmlAttribute(name = &quot;subRatings&quot;)\r\n    @XmlJavaTypeAdapter(CommaDelimitedStringAdapter.class)\r\n    protected List&lt;String&gt;subRatings;\r\n```\r\nAll good so far. However, for some reason, jaxb adds this import to the class: `import java.util.List&lt;String&gt;;` which causes it to not compile. \r\n\r\nOther thing that I tried was removing the specific type in the javaType name definition, like `java.util.List` but that causes jaxb to create the field with a raw type like `protected List subRatings;` and that&#39;s not only ugly but it causes issues downstream as now anyone using this class needs to cast the subrating object making the code smelly. Any ideas how to overcome this? Keep in mind that I cannot modify the generated classes as they are built at compile time.\r\n","link":"https://stackoverflow.com/questions/76293003/how-to-add-custom-string-to-liststring-jaxb-xml-adapter-to-an-xsd-generated-cl","title":"How to add custom String to List&lt;String&gt; jaxb xml adapter to an xsd generated class attribute","body":"<p>We have been using jaxb for a long time to unmarshal XML into POJOs that we can use within our system. However, only recently I found an issue with how jaxb is parsing the xml provided data and I would like to override that behavior by implementing a custom XmlAdapter and forcing jaxb to use it.</p>\n<p>Let's say we have a complex field definition like the below in our xsd:</p>\n<pre><code>&lt;xs:complexType name=&quot;ratingType&quot;&gt;\n    &lt;xs:simpleContent&gt;\n      &lt;xs:extension base=&quot;xs:string&quot;&gt;\n        &lt;xs:attribute name=&quot;scheme&quot; use=&quot;required&quot; type=&quot;xs:NMTOKEN&quot;/&gt;\n        &lt;xs:attribute name=&quot;subRatings&quot; use=&quot;optional&quot;&gt;\n          &lt;xs:simpleType&gt;\n            &lt;xs:list itemType='xs:string'/&gt;\n          &lt;/xs:simpleType&gt;\n        &lt;/xs:attribute&gt;\n      &lt;/xs:extension&gt;\n    &lt;/xs:simpleContent&gt;\n  &lt;/xs:complexType&gt;\n</code></pre>\n<p>Without making any changes, jaxb creates the following java class attribute:</p>\n<pre><code>@XmlAttribute(name = &quot;subRatings&quot;)\nprotected List&lt;String&gt;subRatings;\n</code></pre>\n<p>This has been generally ok, however, due to new client requirements the data we get on this field will change.</p>\n<p>Current use case:\n<code>&lt;rating scheme=&quot;urn:ncs&quot; subRatings=&quot;Violence&quot;&gt;MA15+&lt;/rating&gt;</code>\nThis turns into subRatings=[&quot;Violence&quot;], which is great.</p>\n<p>New use case:\n<code>&lt;rating scheme=&quot;urn:ncs&quot; subRatings=&quot;Coarse Language&quot;&gt;MA15+&lt;/rating&gt;</code>\nThis, however, turns into subRatings=[&quot;Coarse&quot;, &quot;Language&quot;], which is not right and causes issues downstream as that is not a recognized subRating. I expect it to be subRatings=[&quot;Coarse Language&quot;] instead.</p>\n<p>I have tried a few things, but so far the one that gets me closest to what I want is using jaxb bindings like the below:</p>\n<pre><code>&lt;jxb:bindings schemaLocation=&quot;media.xsd&quot; node=&quot;//xs:complexType[@name='ratingType']&quot;&gt;\n        &lt;jxb:bindings node=&quot;.//xs:attribute[@name='subRatings']&quot;&gt;\n            &lt;jxb:property&gt;\n                &lt;jxb:baseType&gt;\n                    &lt;xjc:javaType name=&quot;java.util.List&amp;lt;String&amp;gt;&quot; adapter=&quot;org.jvnet.jaxb2_commons.xml.bind.annotation.adapters.CommaDelimitedStringAdapter&quot;/&gt;\n                &lt;/jxb:baseType&gt;\n            &lt;/jxb:property&gt;\n        &lt;/jxb:bindings&gt;\n    &lt;/jxb:bindings&gt;\n</code></pre>\n<p>The generated class has the following attribute definition:</p>\n<pre><code>@XmlAttribute(name = &quot;subRatings&quot;)\n    @XmlJavaTypeAdapter(CommaDelimitedStringAdapter.class)\n    protected List&lt;String&gt;subRatings;\n</code></pre>\n<p>All good so far. However, for some reason, jaxb adds this import to the class: <code>import java.util.List&lt;String&gt;;</code> which causes it to not compile.</p>\n<p>Other thing that I tried was removing the specific type in the javaType name definition, like <code>java.util.List</code> but that causes jaxb to create the field with a raw type like <code>protected List subRatings;</code> and that's not only ugly but it causes issues downstream as now anyone using this class needs to cast the subrating object making the code smelly. Any ideas how to overcome this? Keep in mind that I cannot modify the generated classes as they are built at compile time.</p>\n"},{"tags":["java","serialization","hazelcast"],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1701500616,"post_id":77583407,"comment_id":136785950,"body_markdown":"Thank you for detailed answer, but I know about this. I use custom compact serializers, because I have some classes, also third party, for them zero-config can&#39;t work. So my question is, how to deliver my custom compact serializers also to server side?","link":"https://stackoverflow.com/questions/77578522/deploy-compactserializer-to-hazelcast-member/77583407#comment136785950_77583407","body":"Thank you for detailed answer, but I know about this. I use custom compact serializers, because I have some classes, also third party, for them zero-config can&#39;t work. So my question is, how to deliver my custom compact serializers also to server side?"}],"comment_count":1,"score":0,"last_activity_date":1701412879,"creation_date":1701412879,"answer_id":77583407,"question_id":77578522,"body_markdown":"Compact serializer can be used in two ways.\r\n\r\n1. [With an explicit CompactSerializer][1] \r\n2. [With Zero-Configuration][2] \r\n\r\n\r\n  [1]: https://docs.hazelcast.com/hazelcast/5.3/serialization/compact-serialization#implementing-compactserializer\r\n  [2]: https://docs.hazelcast.com/hazelcast/5.3/serialization/compact-serialization\r\n\r\nI am going to show you Zero Configuration, since your are using User Code Deployment (UCD).   \r\nAssume that you have class as below. This class does **not** implement a **serialization** mechanism.\r\n```java\r\npublic class MyWorker {\r\n  String name;\r\n  \r\n  public MyWorker(String name) {\r\n    this.name = name;\r\n  }\r\n\r\n  public void setName(String name) {\r\n    this.name = name;\r\n  }\r\n\r\n  @Override\r\n  public String toString() {\r\n    return &quot;MyWorker{&quot; +\r\n      &quot;name=&#39;&quot; + name + &#39;\\&#39;&#39; +\r\n      &#39;}&#39;;\r\n  }\r\n}\r\n```\r\nAlso we have a EntryProcessor as below. **EntryProcessor** implements **Serializable**. So **MyWorkerEntryProcessor** is also serializable. I am returning **null** because I don&#39;t need updated map result on the client side.\r\n```java\r\npublic class MyWorkerEntryProcessor implements EntryProcessor&lt;Integer, MyWorker, MyWorker&gt; {\r\n  @Override\r\n  public MyWorker process(Map.Entry&lt;Integer, MyWorker&gt; entry) {\r\n    MyWorker newWorker = new MyWorker(&quot;new-worker1&quot;);\r\n    entry.setValue(newWorker);\r\n    return null;\r\n  }\r\n}\r\n```\r\nStart the server as below. **UCD** must be **enabled** on server side\r\n```java\r\n public static void main(String[] args) {\r\n  Config config = new Config();\r\n  UserCodeDeploymentConfig ucdConfig = config.getUserCodeDeploymentConfig();\r\n  ucdConfig.setEnabled(true);\r\n\r\n  HazelcastInstance hazelcastInstance = Hazelcast.newHazelcastInstance(config);\r\n}\r\n```\r\nLet&#39;s have these helper methods on the client side.\r\n```java\r\nprivate static HazelcastInstance getHazelcastClientInstance() {\r\n  ClientConfig clientConfig = new ClientConfig();\r\n\r\n  // UCD\r\n  ClientUserCodeDeploymentConfig ucdConfig = clientConfig.getUserCodeDeploymentConfig();\r\n  ucdConfig.setEnabled(true);\r\n  ucdConfig.addClass(MyWorker.class);\r\n  ucdConfig.addClass(MyWorkerEntryProcessor.class);\r\n\r\n  return HazelcastClient.newHazelcastClient(clientConfig);\r\n}\r\n\r\nprivate static void populateMap(HazelcastInstance hazelcastClientInstance) {\r\n  IMap&lt;Integer, MyWorker&gt; myWorkerMap = hazelcastClientInstance.getMap(MAP_NAME);\r\n  myWorkerMap.put(KEY, new MyWorker(&quot;worker1&quot;));\r\n}\r\n\r\nprivate static void updateWorker(HazelcastInstance hazelcastClientInstance) {\r\n  IMap&lt;Integer, MyWorker&gt; myWorkerMap = hazelcastClientInstance.getMap(MAP_NAME);\r\n  MyWorkerEntryProcessor entryProcessor = new MyWorkerEntryProcessor();\r\n  myWorkerMap.executeOnEntries(entryProcessor);\r\n}\r\n\r\nprivate static void printWorker(HazelcastInstance hazelcastClientInstance) {\r\n  IMap&lt;Integer, MyWorker&gt; myWorkerMap = hazelcastClientInstance.getMap(MAP_NAME);\r\n\r\n  MyWorker worker = myWorkerMap.get(KEY);\r\n  LOGGER.info(&quot;New Worker : {}&quot;, worker);\r\n}\r\n```\r\nLet&#39;s call them from client main\r\n```java\r\npublic static void main(String[] args) throws Exception {\r\n  // Start client\r\n  HazelcastInstance hazelcastClientInstance = getHazelcastClientInstance();\r\n\r\n  // Do test\r\n  populateMap(hazelcastClientInstance);\r\n  updateWorker(hazelcastClientInstance);\r\n  printWorker(hazelcastClientInstance);\r\n\r\n  // Shut down HZ clien\r\n  hazelcastClientInstance.shutdown();\r\n}\r\n```\r\nSo with zero config compact serialization I don&#39;t need to do anything. From the documentation you can see this sentence\r\n\r\n&gt; Compact serialization can also be used without registering a serializer in the member or client configuration.\r\n\r\nHZ automatically creates a serializer for me. There are some constraints though. From the documentation again. So your class can have only certain member field types\r\n\r\n&gt; Currently, Hazelcast supports extracting schemas out of classes that have the field types shown above and some others, for user convenience.\r\n\r\nFor the explicit serialization case that I mentioned in the beginning, you need **register** a serializer to member, **not** deploy it. You can find examples in the documentation  \r\n\r\nI hope this helps\r\n","link":"https://stackoverflow.com/questions/77578522/deploy-compactserializer-to-hazelcast-member/77583407#77583407","title":"Deploy compactSerializer to hazelcast member","body":"<p>Compact serializer can be used in two ways.</p>\n<ol>\n<li><a href=\"https://docs.hazelcast.com/hazelcast/5.3/serialization/compact-serialization#implementing-compactserializer\" rel=\"nofollow noreferrer\">With an explicit CompactSerializer</a></li>\n<li><a href=\"https://docs.hazelcast.com/hazelcast/5.3/serialization/compact-serialization\" rel=\"nofollow noreferrer\">With Zero-Configuration</a></li>\n</ol>\n<p>I am going to show you Zero Configuration, since your are using User Code Deployment (UCD).<br />\nAssume that you have class as below. This class does <strong>not</strong> implement a <strong>serialization</strong> mechanism.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class MyWorker {\n  String name;\n  \n  public MyWorker(String name) {\n    this.name = name;\n  }\n\n  public void setName(String name) {\n    this.name = name;\n  }\n\n  @Override\n  public String toString() {\n    return &quot;MyWorker{&quot; +\n      &quot;name='&quot; + name + '\\'' +\n      '}';\n  }\n}\n</code></pre>\n<p>Also we have a EntryProcessor as below. <strong>EntryProcessor</strong> implements <strong>Serializable</strong>. So <strong>MyWorkerEntryProcessor</strong> is also serializable. I am returning <strong>null</strong> because I don't need updated map result on the client side.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class MyWorkerEntryProcessor implements EntryProcessor&lt;Integer, MyWorker, MyWorker&gt; {\n  @Override\n  public MyWorker process(Map.Entry&lt;Integer, MyWorker&gt; entry) {\n    MyWorker newWorker = new MyWorker(&quot;new-worker1&quot;);\n    entry.setValue(newWorker);\n    return null;\n  }\n}\n</code></pre>\n<p>Start the server as below. <strong>UCD</strong> must be <strong>enabled</strong> on server side</p>\n<pre class=\"lang-java prettyprint-override\"><code> public static void main(String[] args) {\n  Config config = new Config();\n  UserCodeDeploymentConfig ucdConfig = config.getUserCodeDeploymentConfig();\n  ucdConfig.setEnabled(true);\n\n  HazelcastInstance hazelcastInstance = Hazelcast.newHazelcastInstance(config);\n}\n</code></pre>\n<p>Let's have these helper methods on the client side.</p>\n<pre class=\"lang-java prettyprint-override\"><code>private static HazelcastInstance getHazelcastClientInstance() {\n  ClientConfig clientConfig = new ClientConfig();\n\n  // UCD\n  ClientUserCodeDeploymentConfig ucdConfig = clientConfig.getUserCodeDeploymentConfig();\n  ucdConfig.setEnabled(true);\n  ucdConfig.addClass(MyWorker.class);\n  ucdConfig.addClass(MyWorkerEntryProcessor.class);\n\n  return HazelcastClient.newHazelcastClient(clientConfig);\n}\n\nprivate static void populateMap(HazelcastInstance hazelcastClientInstance) {\n  IMap&lt;Integer, MyWorker&gt; myWorkerMap = hazelcastClientInstance.getMap(MAP_NAME);\n  myWorkerMap.put(KEY, new MyWorker(&quot;worker1&quot;));\n}\n\nprivate static void updateWorker(HazelcastInstance hazelcastClientInstance) {\n  IMap&lt;Integer, MyWorker&gt; myWorkerMap = hazelcastClientInstance.getMap(MAP_NAME);\n  MyWorkerEntryProcessor entryProcessor = new MyWorkerEntryProcessor();\n  myWorkerMap.executeOnEntries(entryProcessor);\n}\n\nprivate static void printWorker(HazelcastInstance hazelcastClientInstance) {\n  IMap&lt;Integer, MyWorker&gt; myWorkerMap = hazelcastClientInstance.getMap(MAP_NAME);\n\n  MyWorker worker = myWorkerMap.get(KEY);\n  LOGGER.info(&quot;New Worker : {}&quot;, worker);\n}\n</code></pre>\n<p>Let's call them from client main</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static void main(String[] args) throws Exception {\n  // Start client\n  HazelcastInstance hazelcastClientInstance = getHazelcastClientInstance();\n\n  // Do test\n  populateMap(hazelcastClientInstance);\n  updateWorker(hazelcastClientInstance);\n  printWorker(hazelcastClientInstance);\n\n  // Shut down HZ clien\n  hazelcastClientInstance.shutdown();\n}\n</code></pre>\n<p>So with zero config compact serialization I don't need to do anything. From the documentation you can see this sentence</p>\n<blockquote>\n<p>Compact serialization can also be used without registering a serializer in the member or client configuration.</p>\n</blockquote>\n<p>HZ automatically creates a serializer for me. There are some constraints though. From the documentation again. So your class can have only certain member field types</p>\n<blockquote>\n<p>Currently, Hazelcast supports extracting schemas out of classes that have the field types shown above and some others, for user convenience.</p>\n</blockquote>\n<p>For the explicit serialization case that I mentioned in the beginning, you need <strong>register</strong> a serializer to member, <strong>not</strong> deploy it. You can find examples in the documentation</p>\n<p>I hope this helps</p>\n"},{"comments":[{"score":0,"post_type":"answer","creation_date":1701763428,"post_id":77597865,"comment_id":136812793,"body_markdown":"Are you sure that MyWorkerSerializer also will be deployed and registered on server side?","link":"https://stackoverflow.com/questions/77578522/deploy-compactserializer-to-hazelcast-member/77597865#comment136812793_77597865","body":"Are you sure that MyWorkerSerializer also will be deployed and registered on server side?"},{"score":0,"post_type":"answer","creation_date":1701857384,"post_id":77597865,"comment_id":136826006,"body_markdown":"A serializer converts data to a byte array, allowing it to be transferred between clients and members. Therefore, you need a serializer on the client side. If your members also access data, you need to register the same serializer on the member side. You can achieve this using the provided code example, simply replacing &quot;ClientConfig&quot; with &quot;Config&quot; class. So MyWorkerSerializer  will not be deployed to server side in the provided example","link":"https://stackoverflow.com/questions/77578522/deploy-compactserializer-to-hazelcast-member/77597865#comment136826006_77597865","body":"A serializer converts data to a byte array, allowing it to be transferred between clients and members. Therefore, you need a serializer on the client side. If your members also access data, you need to register the same serializer on the member side. You can achieve this using the provided code example, simply replacing &quot;ClientConfig&quot; with &quot;Config&quot; class. So MyWorkerSerializer  will not be deployed to server side in the provided example"},{"score":0,"post_type":"answer","creation_date":1701938336,"post_id":77597865,"comment_id":136837450,"body_markdown":"So the answer to your question is, when you add a serializer from the client the Schema of the serializer is distributed to cluster members, not the serializer itself. Then the cluster members can create their own local serializers from the schema. I hope this helps","link":"https://stackoverflow.com/questions/77578522/deploy-compactserializer-to-hazelcast-member/77597865#comment136837450_77597865","body":"So the answer to your question is, when you add a serializer from the client the Schema of the serializer is distributed to cluster members, not the serializer itself. Then the cluster members can create their own local serializers from the schema. I hope this helps"}],"comment_count":3,"score":0,"last_activity_date":1701675912,"creation_date":1701675912,"answer_id":77597865,"question_id":77578522,"body_markdown":"This answer is for registering custom compact serializer from the client side.\r\nOn the client side have this class. This time I have used lombok to make to make the code shorter.\r\n\r\n```java\r\nimport lombok.Getter;\r\nimport lombok.RequiredArgsConstructor;\r\nimport lombok.ToString;\r\n\r\n@Getter\r\n@RequiredArgsConstructor\r\n@ToString\r\npublic class MyWorker {\r\n  private final String name;\r\n}\r\n```\r\nHave a serializer on the client side\r\n```java\r\npublic class MyWorkerSerializer implements CompactSerializer&lt;MyWorker&gt; {\r\n  @Override\r\n  public MyWorker read(CompactReader compactReader) {\r\n    String name = compactReader.readString(&quot;name&quot;);\r\n    return new MyWorker(name);\r\n  }\r\n\r\n  @Override\r\n  public void write(CompactWriter compactWriter, MyWorker myWorker) {\r\n    compactWriter.writeString(&quot;name&quot;, myWorker.getName());\r\n  }\r\n\r\n  @Override\r\n  public String getTypeName() {\r\n    return &quot;myworker&quot;;\r\n  }\r\n\r\n  @Override\r\n  public Class&lt;MyWorker&gt; getCompactClass() {\r\n    return MyWorker.class;\r\n  }\r\n}\r\n```\r\nThen start the client as below. The serializer is **added** to SerializationConfig\r\n```java\r\n ClientConfig clientConfig = new ClientConfig();\r\n\r\n// UCD\r\nClientUserCodeDeploymentConfig ucdConfig = clientConfig.getUserCodeDeploymentConfig();\r\nucdConfig.setEnabled(true);\r\nucdConfig.addClass(MyWorker.class);\r\nucdConfig.addClass(MyWorkerEntryProcessor.class);\r\n\r\nclientConfig.getSerializationConfig()\r\n  .getCompactSerializationConfig()\r\n  .addSerializer(new MyWorkerSerializer());\r\n\r\nHazelcastInstance hazelcastClientInstance =  \r\n HazelcastClient.newHazelcastClient(clientConfig);\r\n```\r\nThen use populateMap(),updateWorker(),printWorker() on the first answer","link":"https://stackoverflow.com/questions/77578522/deploy-compactserializer-to-hazelcast-member/77597865#77597865","title":"Deploy compactSerializer to hazelcast member","body":"<p>This answer is for registering custom compact serializer from the client side.\nOn the client side have this class. This time I have used lombok to make to make the code shorter.</p>\n<pre class=\"lang-java prettyprint-override\"><code>import lombok.Getter;\nimport lombok.RequiredArgsConstructor;\nimport lombok.ToString;\n\n@Getter\n@RequiredArgsConstructor\n@ToString\npublic class MyWorker {\n  private final String name;\n}\n</code></pre>\n<p>Have a serializer on the client side</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class MyWorkerSerializer implements CompactSerializer&lt;MyWorker&gt; {\n  @Override\n  public MyWorker read(CompactReader compactReader) {\n    String name = compactReader.readString(&quot;name&quot;);\n    return new MyWorker(name);\n  }\n\n  @Override\n  public void write(CompactWriter compactWriter, MyWorker myWorker) {\n    compactWriter.writeString(&quot;name&quot;, myWorker.getName());\n  }\n\n  @Override\n  public String getTypeName() {\n    return &quot;myworker&quot;;\n  }\n\n  @Override\n  public Class&lt;MyWorker&gt; getCompactClass() {\n    return MyWorker.class;\n  }\n}\n</code></pre>\n<p>Then start the client as below. The serializer is <strong>added</strong> to SerializationConfig</p>\n<pre class=\"lang-java prettyprint-override\"><code> ClientConfig clientConfig = new ClientConfig();\n\n// UCD\nClientUserCodeDeploymentConfig ucdConfig = clientConfig.getUserCodeDeploymentConfig();\nucdConfig.setEnabled(true);\nucdConfig.addClass(MyWorker.class);\nucdConfig.addClass(MyWorkerEntryProcessor.class);\n\nclientConfig.getSerializationConfig()\n  .getCompactSerializationConfig()\n  .addSerializer(new MyWorkerSerializer());\n\nHazelcastInstance hazelcastClientInstance =  \n HazelcastClient.newHazelcastClient(clientConfig);\n</code></pre>\n<p>Then use populateMap(),updateWorker(),printWorker() on the first answer</p>\n"}],"comment_count":0,"is_answered":false,"view_count":37,"answer_count":2,"score":0,"last_activity_date":1701675912,"creation_date":1701348114,"question_id":77578522,"body_markdown":"I enabled user code deployment in hazelcast to use entry processors.\r\nThe entry processor and my entity classes are deployed to hazelcast, but the compact serializer is not deployed, so in the member side I get exception on serialization of my entity. How to deploy my compactSerializer from client side to hazelcast member and register it?","link":"https://stackoverflow.com/questions/77578522/deploy-compactserializer-to-hazelcast-member","title":"Deploy compactSerializer to hazelcast member","body":"<p>I enabled user code deployment in hazelcast to use entry processors.\nThe entry processor and my entity classes are deployed to hazelcast, but the compact serializer is not deployed, so in the member side I get exception on serialization of my entity. How to deploy my compactSerializer from client side to hazelcast member and register it?</p>\n"},{"tags":["java","spring-boot","spring-security","spring-boot-3"],"comments":[{"score":0,"post_type":"question","creation_date":1693308218,"post_id":76987080,"comment_id":135740559,"body_markdown":"please show us your error in the webbrowser console and a screenshot of your response with headers in the browser.","link":"https://stackoverflow.com/questions/76987080/cors-in-spring-security-spring-boot-3#comment135740559_76987080","body":"please show us your error in the webbrowser console and a screenshot of your response with headers in the browser."},{"score":0,"post_type":"question","creation_date":1694039781,"post_id":76987080,"comment_id":135840580,"body_markdown":"Have you resolved this yet. The 1 answer is not a good answer, especially when you have lots of Controllers &gt; 60.","link":"https://stackoverflow.com/questions/76987080/cors-in-spring-security-spring-boot-3#comment135840580_76987080","body":"Have you resolved this yet. The 1 answer is not a good answer, especially when you have lots of Controllers &gt; 60."}],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1693221261,"post_id":76987324,"comment_id":135727037,"body_markdown":"My application is open for everyone to use (it&#39;s an application for training purposes) so I do not know the origins of the user as they might use postman or other tools. Wildcards do not seem to work (When allowCredentials is true, allowedOrigins cannot contain the special value &quot;*&quot;)","link":"https://stackoverflow.com/questions/76987080/cors-in-spring-security-spring-boot-3/76987324#comment135727037_76987324","body":"My application is open for everyone to use (it&#39;s an application for training purposes) so I do not know the origins of the user as they might use postman or other tools. Wildcards do not seem to work (When allowCredentials is true, allowedOrigins cannot contain the special value &quot;*&quot;)"},{"score":0,"post_type":"answer","creation_date":1693222298,"post_id":76987324,"comment_id":135727254,"body_markdown":"I did try it though with defined origin, but to no luck :(","link":"https://stackoverflow.com/questions/76987080/cors-in-spring-security-spring-boot-3/76987324#comment135727254_76987324","body":"I did try it though with defined origin, but to no luck :("}],"comment_count":2,"score":0,"last_activity_date":1693190599,"last_edit_date":1693190599,"creation_date":1693142717,"answer_id":76987324,"question_id":76987080,"body_markdown":"I had the same problem and was ultimately unable to solve it with httpSecurity.config\r\n\r\nI wound up taking `.cors()` out entirely, and put a `@CrossOrigin` annotation\r\non each controller class, e.g.\r\n\r\n    @CrossOrigin(origins = &quot;http://myurl&quot;, allowCredentials = &quot;true&quot;)\r\n\r\n\r\nNote that I&#39;m specifying an explicit URL here.\r\nI&#39;m not sure whether or not wildcards will work.","link":"https://stackoverflow.com/questions/76987080/cors-in-spring-security-spring-boot-3/76987324#76987324","title":"CORS in Spring Security (Spring Boot 3)","body":"<p>I had the same problem and was ultimately unable to solve it with httpSecurity.config</p>\n<p>I wound up taking <code>.cors()</code> out entirely, and put a <code>@CrossOrigin</code> annotation\non each controller class, e.g.</p>\n<pre><code>@CrossOrigin(origins = &quot;http://myurl&quot;, allowCredentials = &quot;true&quot;)\n</code></pre>\n<p>Note that I'm specifying an explicit URL here.\nI'm not sure whether or not wildcards will work.</p>\n"},{"comment_count":0,"score":0,"last_activity_date":1696843109,"creation_date":1696843109,"answer_id":77257605,"question_id":76987080,"body_markdown":"i tried configuring CORS the same way you did, using `http.cors(Customizer.withDefaults())` and `http.cors(c -&gt; c.configurationSource(corsConfigurationSource())` but both did not work. \r\n\r\nhowever, this works for me\r\n\r\n    http.cors(cors -&gt; cors.configurationSource(request -&gt; {\r\n            CorsConfiguration configuration = new CorsConfiguration();\r\n            configuration.setAllowedOrigins(Arrays.asList(&quot;*&quot;));\r\n            configuration.setAllowedMethods(Arrays.asList(&quot;*&quot;));\r\n            configuration.setAllowedHeaders(Arrays.asList(&quot;*&quot;));\r\n            return configuration;\r\n        }));","link":"https://stackoverflow.com/questions/76987080/cors-in-spring-security-spring-boot-3/77257605#77257605","title":"CORS in Spring Security (Spring Boot 3)","body":"<p>i tried configuring CORS the same way you did, using <code>http.cors(Customizer.withDefaults())</code> and <code>http.cors(c -&gt; c.configurationSource(corsConfigurationSource())</code> but both did not work.</p>\n<p>however, this works for me</p>\n<pre><code>http.cors(cors -&gt; cors.configurationSource(request -&gt; {\n        CorsConfiguration configuration = new CorsConfiguration();\n        configuration.setAllowedOrigins(Arrays.asList(&quot;*&quot;));\n        configuration.setAllowedMethods(Arrays.asList(&quot;*&quot;));\n        configuration.setAllowedHeaders(Arrays.asList(&quot;*&quot;));\n        return configuration;\n    }));\n</code></pre>\n"},{"comment_count":0,"score":-1,"last_activity_date":1701675875,"creation_date":1701675875,"answer_id":77597862,"question_id":76987080,"body_markdown":"OPTIONS method should be allowed explicitly.\r\nTry adding in `.authorizeHttpRequests`:\r\n\r\n    .requestMatchers(\r\n            AntPathRequestMatcher.antMatcher(HttpMethod.OPTIONS, &quot;/comments/**&quot;),\r\n            AntPathRequestMatcher.antMatcher(HttpMethod.OPTIONS, &quot;/requests/admin/**&quot;)\r\n    ).permitAll()","link":"https://stackoverflow.com/questions/76987080/cors-in-spring-security-spring-boot-3/77597862#77597862","title":"CORS in Spring Security (Spring Boot 3)","body":"<p>OPTIONS method should be allowed explicitly.\nTry adding in <code>.authorizeHttpRequests</code>:</p>\n<pre><code>.requestMatchers(\n        AntPathRequestMatcher.antMatcher(HttpMethod.OPTIONS, &quot;/comments/**&quot;),\n        AntPathRequestMatcher.antMatcher(HttpMethod.OPTIONS, &quot;/requests/admin/**&quot;)\n).permitAll()\n</code></pre>\n"}],"comment_count":2,"is_answered":false,"view_count":748,"answer_count":3,"score":1,"last_activity_date":1701675875,"creation_date":1693138749,"last_edit_date":1693139246,"question_id":76987080,"body_markdown":"I am currently struggling with Spring Security in my Spring Boot 3 applications. It was working in Spring Boot 2 but not since I tried to upgrade to version 3.\r\n\r\nMy authentication seems to work properly and the stuff that needs to be authenticated works. However when I do a preflight (OPTIONS) check it still returns me a 401 error.\r\n\r\n\r\nMy WebSecurityConfig:\r\n\r\n    @Configuration\r\n    @EnableWebSecurity\r\n    @EnableMethodSecurity(prePostEnabled = true)\r\n    public class WebSecurityConfig {\r\n    \r\n    @Bean\r\n        public SecurityFilterChain configure(HttpSecurity httpSecurity) throws Exception {\r\n            httpSecurity\r\n                    .cors(Customizer.withDefaults())\r\n                    .csrf(c -&gt; c.disable())\r\n                    .authorizeHttpRequests(requests -&gt; requests\r\n                            .requestMatchers(\r\n                                AntPathRequestMatcher.antMatcher(&quot;/comments/**&quot;), \r\n                                AntPathRequestMatcher.antMatcher(&quot;/requests/admin/**&quot;)\r\n                            ).authenticated()\r\n                            .anyRequest().permitAll())\r\n                    .authenticationProvider(authenticationProvider())\r\n                    .exceptionHandling(r -&gt; r.authenticationEntryPoint(jwtAuthenticationEntryPoint))\r\n                    .sessionManagement(r -&gt; r.sessionCreationPolicy(SessionCreationPolicy.STATELESS))\r\n                    // Add a filter to validate the tokens with every request\r\n                    .addFilterBefore(jwtRequestFilter, UsernamePasswordAuthenticationFilter.class)\r\n                    ;\r\n            return httpSecurity.build();\r\n        }\r\n    }\r\n\r\n\r\nI tried using a CorsConfigurationSource bean, but with no luck \r\n\r\n    @Bean\r\n    public CorsConfigurationSource corsConfigurationSource() {\r\n        CorsConfiguration corsConfig = new CorsConfiguration();\r\n        corsConfig.applyPermitDefaultValues();\r\n        corsConfig.setAllowCredentials(true);\r\n        corsConfig.addAllowedMethod(&quot;GET&quot;);\r\n        corsConfig.addAllowedMethod(&quot;PATCH&quot;);\r\n        corsConfig.addAllowedMethod(&quot;POST&quot;);\r\n        corsConfig.addAllowedMethod(&quot;OPTIONS&quot;);\r\n        corsConfig.setAllowedOrigins(Arrays.asList(&quot;*&quot;));\r\n        corsConfig.setAllowedHeaders(Arrays.asList(&quot;*&quot;));\r\n\r\n        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\r\n        source.registerCorsConfiguration(&quot;/**&quot;, corsConfig);\r\n        return source;\r\n    }\r\nAnd changed the `.cors(Customizer.withDefaults())` to `.cors(c -&gt; c.configurationSource(corsConfigurationSource())))` in the SecutiryFilterChain.\r\n\r\n\r\nA lot of links on the internet provide help on the issue but for SB2 instead of 3. ","link":"https://stackoverflow.com/questions/76987080/cors-in-spring-security-spring-boot-3","title":"CORS in Spring Security (Spring Boot 3)","body":"<p>I am currently struggling with Spring Security in my Spring Boot 3 applications. It was working in Spring Boot 2 but not since I tried to upgrade to version 3.</p>\n<p>My authentication seems to work properly and the stuff that needs to be authenticated works. However when I do a preflight (OPTIONS) check it still returns me a 401 error.</p>\n<p>My WebSecurityConfig:</p>\n<pre><code>@Configuration\n@EnableWebSecurity\n@EnableMethodSecurity(prePostEnabled = true)\npublic class WebSecurityConfig {\n\n@Bean\n    public SecurityFilterChain configure(HttpSecurity httpSecurity) throws Exception {\n        httpSecurity\n                .cors(Customizer.withDefaults())\n                .csrf(c -&gt; c.disable())\n                .authorizeHttpRequests(requests -&gt; requests\n                        .requestMatchers(\n                            AntPathRequestMatcher.antMatcher(&quot;/comments/**&quot;), \n                            AntPathRequestMatcher.antMatcher(&quot;/requests/admin/**&quot;)\n                        ).authenticated()\n                        .anyRequest().permitAll())\n                .authenticationProvider(authenticationProvider())\n                .exceptionHandling(r -&gt; r.authenticationEntryPoint(jwtAuthenticationEntryPoint))\n                .sessionManagement(r -&gt; r.sessionCreationPolicy(SessionCreationPolicy.STATELESS))\n                // Add a filter to validate the tokens with every request\n                .addFilterBefore(jwtRequestFilter, UsernamePasswordAuthenticationFilter.class)\n                ;\n        return httpSecurity.build();\n    }\n}\n</code></pre>\n<p>I tried using a CorsConfigurationSource bean, but with no luck</p>\n<pre><code>@Bean\npublic CorsConfigurationSource corsConfigurationSource() {\n    CorsConfiguration corsConfig = new CorsConfiguration();\n    corsConfig.applyPermitDefaultValues();\n    corsConfig.setAllowCredentials(true);\n    corsConfig.addAllowedMethod(&quot;GET&quot;);\n    corsConfig.addAllowedMethod(&quot;PATCH&quot;);\n    corsConfig.addAllowedMethod(&quot;POST&quot;);\n    corsConfig.addAllowedMethod(&quot;OPTIONS&quot;);\n    corsConfig.setAllowedOrigins(Arrays.asList(&quot;*&quot;));\n    corsConfig.setAllowedHeaders(Arrays.asList(&quot;*&quot;));\n\n    UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n    source.registerCorsConfiguration(&quot;/**&quot;, corsConfig);\n    return source;\n}\n</code></pre>\n<p>And changed the <code>.cors(Customizer.withDefaults())</code> to <code>.cors(c -&gt; c.configurationSource(corsConfigurationSource())))</code> in the SecutiryFilterChain.</p>\n<p>A lot of links on the internet provide help on the issue but for SB2 instead of 3.</p>\n"},{"tags":["java","android","kotlin","crash","leakcanary"],"answers":[{"comments":[{"score":1,"post_type":"answer","creation_date":1701427454,"post_id":77573439,"comment_id":136776994,"body_markdown":"Thank you @gabe-sechan. I have updated my question to give more context.","link":"https://stackoverflow.com/questions/77573384/im-getting-a-native-crash-in-my-application-this-crash-is-frequent-in-the-rele/77573439#comment136776994_77573439","body":"Thank you @gabe-sechan. I have updated my question to give more context."},{"score":1,"post_type":"answer","creation_date":1701443747,"post_id":77573439,"comment_id":136779955,"body_markdown":"@newbie_coder. Your problem isn&#39;t a leak.  A leak will never cause any crash other than OutOfMemoryException.  Your problem is heap corruption.  That&#39;s actually pretty much impossible to get unless you&#39;re passing data to native C code and misusing it there.","link":"https://stackoverflow.com/questions/77573384/im-getting-a-native-crash-in-my-application-this-crash-is-frequent-in-the-rele/77573439#comment136779955_77573439","body":"@newbie_coder. Your problem isn&#39;t a leak.  A leak will never cause any crash other than OutOfMemoryException.  Your problem is heap corruption.  That&#39;s actually pretty much impossible to get unless you&#39;re passing data to native C code and misusing it there."}],"comment_count":2,"score":1,"last_activity_date":1701280060,"creation_date":1701280060,"answer_id":77573439,"question_id":77573384,"body_markdown":"&gt; com.myapp.chat.InboxActivity instance ​     Leaking: YES\r\n&gt; (ObjectWatcher was watching this because com.myapp.\r\n\r\nInboxActivity is leaking.  Insufficient data to tell why it&#39;s leaking from what you posted, I would look for what references to it are outstanding.","link":"https://stackoverflow.com/questions/77573384/im-getting-a-native-crash-in-my-application-this-crash-is-frequent-in-the-rele/77573439#77573439","title":"I&#39;m getting a native crash in my application. This crash is frequent in the release build and has never occurred in debug","body":"<blockquote>\n<p>com.myapp.chat.InboxActivity instance ​     Leaking: YES\n(ObjectWatcher was watching this because com.myapp.</p>\n</blockquote>\n<p>InboxActivity is leaking.  Insufficient data to tell why it's leaking from what you posted, I would look for what references to it are outstanding.</p>\n"},{"comments":[{"score":1,"post_type":"answer","creation_date":1701427140,"post_id":77575617,"comment_id":136776951,"body_markdown":"Thank you so much @Pierre-Yves Ricau . I have updated my question to give more context. Would appreciate any help.","link":"https://stackoverflow.com/questions/77573384/im-getting-a-native-crash-in-my-application-this-crash-is-frequent-in-the-rele/77575617#comment136776951_77575617","body":"Thank you so much @Pierre-Yves Ricau . I have updated my question to give more context. Would appreciate any help."},{"score":0,"post_type":"answer","creation_date":1702101389,"post_id":77575617,"comment_id":136858652,"body_markdown":"When using stack overflow you should not change your question, but instead accept valid answers then create a post with a new question.","link":"https://stackoverflow.com/questions/77573384/im-getting-a-native-crash-in-my-application-this-crash-is-frequent-in-the-rele/77575617#comment136858652_77575617","body":"When using stack overflow you should not change your question, but instead accept valid answers then create a post with a new question."}],"comment_count":2,"score":1,"last_activity_date":1701313055,"creation_date":1701313055,"answer_id":77575617,"question_id":77573384,"body_markdown":"- `InboxActivity` received the `Activity.onDestroy()` callback, it should be garbage collected but cannot be because it is held in memory (&quot;leaking&quot;).\r\n- It is held in memory by `android.app.LoaderApk.mReceivers`. `LoaderApk` is an internal class of the Android framework. It keeps the list of broadcast receivers currently registered in an `ArrayMap` in `mReceivers`\r\n\r\nThis means `InboxActivity` implements `BroadcastReceiver`, and somewhere in the code you&#39;re doing `Context.registerReceiver(inboxActivity)` but forgetting to do `Context.unregisterReceiver(inboxActivity)` when the activity is destroyed. That&#39;s what you need to fix to make the leak go away.","link":"https://stackoverflow.com/questions/77573384/im-getting-a-native-crash-in-my-application-this-crash-is-frequent-in-the-rele/77575617#77575617","title":"I&#39;m getting a native crash in my application. This crash is frequent in the release build and has never occurred in debug","body":"<ul>\n<li><code>InboxActivity</code> received the <code>Activity.onDestroy()</code> callback, it should be garbage collected but cannot be because it is held in memory (&quot;leaking&quot;).</li>\n<li>It is held in memory by <code>android.app.LoaderApk.mReceivers</code>. <code>LoaderApk</code> is an internal class of the Android framework. It keeps the list of broadcast receivers currently registered in an <code>ArrayMap</code> in <code>mReceivers</code></li>\n</ul>\n<p>This means <code>InboxActivity</code> implements <code>BroadcastReceiver</code>, and somewhere in the code you're doing <code>Context.registerReceiver(inboxActivity)</code> but forgetting to do <code>Context.unregisterReceiver(inboxActivity)</code> when the activity is destroyed. That's what you need to fix to make the leak go away.</p>\n"}],"comment_count":0,"is_answered":true,"view_count":73,"answer_count":2,"score":1,"last_activity_date":1701667963,"creation_date":1701279401,"last_edit_date":1701667963,"question_id":77573384,"body_markdown":"I tried looking into the systrace in Perfetto UI but just couldn&#39;t figure out the reason for crash. The logs for the crashes showed multiple calls related to the G.C so suspected it to be a memory leak and used LeakCanary to look for memory leaks. I&#39;m fixing the memory leaks one by one. Just wanted to know if I&#39;m heading in the right direction or not. \r\n\r\nThis is the crash that I&#39;m getting \r\n```\r\n755 31581 31581 F DEBUG   : *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***\r\n12-01 12:25:34.755 31581 31581 F DEBUG   : Build fingerprint: &#39;motorola/corfur_g/corfur:12/S2RUBS32.51-15-9-11/dd8d5-e81484:user/release-keys&#39;\r\n12-01 12:25:34.755 31581 31581 F DEBUG   : Revision: &#39;pvt&#39;\r\n12-01 12:25:34.755 31581 31581 F DEBUG   : ABI: &#39;arm64&#39;\r\n12-01 12:25:34.755 31581 31581 F DEBUG   : Timestamp: 2023-12-01 12:25:33.994708494+0530\r\n12-01 12:25:34.755 31581 31581 F DEBUG   : Process uptime: 0s\r\n12-01 12:25:34.755 31581 31581 F DEBUG   : Cmdline: in.myapp.qa\r\n12-01 12:25:34.755 31581 31581 F DEBUG   : pid: 28827, tid: 28836, name: HeapTaskDaemon  &gt;&gt;&gt; in.myapp.qa &lt;&lt;&lt;\r\n12-01 12:25:34.755 31581 31581 F DEBUG   : uid: 11318\r\n12-01 12:25:34.755 31581 31581 F DEBUG   : signal 6 (SIGABRT), code -1 (SI_QUEUE), fault addr --------\r\n12-01 12:25:34.755 31581 31581 F DEBUG   : Abort message: &#39;klass pointer for ref: 0x13708ed0 found to be null.&#39;\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :     x0  0000000000000000  x1  00000000000070a4  x2  0000000000000006  x3  00000076aeb800b0\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :     x4  35312f6036772f1f  x5  35312f6036772f1f  x6  35312f6036772f1f  x7  7f7f7f7f7f7f7f7f\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :     x8  00000000000000f0  x9  a219e6e01d251e00  x10 0000000000000000  x11 ffffff80fffffbdf\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :     x12 0000000000000001  x13 000000000000074a  x14 00000076aeb7eeb0  x15 0000000034155555\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :     x16 00000079d1400060  x17 00000079d13dc4b0  x18 0000007654b9a000  x19 000000000000709b\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :     x20 00000000000070a4  x21 00000000ffffffff  x22 000000000000000b  x23 00000076be2a3fbe\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :     x24 000000000000000b  x25 0000000000000002  x26 0000000000000001  x27 00000076bee16000\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :     x28 b4000076e116c3e0  x29 00000076aeb80130\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :     lr  00000079d138c8b0  sp  00000076aeb80090  pc  00000079d138c8dc  pst 0000000000001000\r\n12-01 12:25:34.755 31581 31581 F DEBUG   : backtrace:\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #00 pc 00000000000518dc  /apex/com.android.runtime/lib64/bionic/libc.so (abort+168) (BuildId: 37a328c30fb8c595fc3ebc7c80be6ac1)\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #01 pc 00000000007716f0  /apex/com.android.art/lib64/libart.so (art::Runtime::Abort(char const*)+904) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #02 pc 00000000000357d0  /apex/com.google.mainline.primary.libs@341050000/lib64/libbase.so/75d3253827fcfd7a8d7b02ad45991611ec4ca424c0278e13e8acfad4d14e597a3ecff6c0caa2b785c73838528ee6e9c2b313240ff895f50ee39b1d7bc10f390a/libbase.so (android::base::SetAborter(std::__1::function&lt;void (char const*)&gt;&amp;&amp;)::$_0::__invoke(char const*)+80) (BuildId: 6f67f69ff36b970d0b831cfdab3b578d)\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #03 pc 0000000000034d58  /apex/com.google.mainline.primary.libs@341050000/lib64/libbase.so/75d3253827fcfd7a8d7b02ad45991611ec4ca424c0278e13e8acfad4d14e597a3ecff6c0caa2b785c73838528ee6e9c2b313240ff895f50ee39b1d7bc10f390a/libbase.so (android::base::LogMessage::~LogMessage()+352) (BuildId: 6f67f69ff36b970d0b831cfdab3b578d)\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #04 pc 0000000000207734  /apex/com.android.art/lib64/libart.so (art::gc::Verification::LogHeapCorruption(art::ObjPtr&lt;art::mirror::Object&gt;, art::MemberOffset, art::mirror::Object*, bool) const+2016) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #05 pc 00000000002aa950  /apex/com.android.art/lib64/libart.so (void art::mirror::Object::VisitReferences&lt;true, (art::VerifyObjectFlags)0, (art::ReadBarrierOption)1, art::gc::collector::ConcurrentCopying::ComputeLiveBytesAndMarkRefFieldsVisitor&lt;true&gt;, art::gc::collector::ConcurrentCopying::ComputeLiveBytesAndMarkRefFieldsVisitor&lt;true&gt; &gt;(art::gc::collector::ConcurrentCopying::ComputeLiveBytesAndMarkRefFieldsVisitor&lt;true&gt; const&amp;, art::gc::collector::ConcurrentCopying::ComputeLiveBytesAndMarkRefFieldsVisitor&lt;true&gt; const&amp;)+2240) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #06 pc 00000000002a9f9c  /apex/com.android.art/lib64/libart.so (art::gc::collector::ConcurrentCopying::ProcessMarkStackForMarkingAndComputeLiveBytes()+1820) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #07 pc 00000000002a67e0  /apex/com.android.art/lib64/libart.so (art::gc::collector::ConcurrentCopying::MarkingPhase()+1188) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #08 pc 00000000002a13d0  /apex/com.android.art/lib64/libart.so (art::gc::collector::ConcurrentCopying::RunPhases()+184) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #09 pc 00000000003a6a10  /apex/com.android.art/lib64/libart.so (art::gc::collector::GarbageCollector::Run(art::gc::GcCause, bool)+312) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #10 pc 00000000003a2ea0  /apex/com.android.art/lib64/libart.so (art::gc::Heap::CollectGarbageInternal(art::gc::collector::GcType, art::gc::GcCause, bool, unsigned int)+548) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #11 pc 00000000003a2748  /apex/com.android.art/lib64/libart.so (art::gc::Heap::ConcurrentGC(art::Thread*, art::gc::GcCause, bool, unsigned int)+188) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #12 pc 00000000003a25cc  /apex/com.android.art/lib64/libart.so (art::gc::Heap::ConcurrentGCTask::Run(art::Thread*)+72) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #13 pc 00000000003a06d0  /apex/com.android.art/lib64/libart.so (art::gc::TaskProcessor::RunAllTasks(art::Thread*)+72) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #14 pc 000000000034aa30  /apex/com.android.art/lib64/libart.so (art_quick_generic_jni_trampoline+144) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #15 pc 0000000000333fa4  /apex/com.android.art/lib64/libart.so (art_quick_invoke_stub+612) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #16 pc 0000000000511078  /apex/com.android.art/lib64/libart.so (bool art::interpreter::DoCall&lt;false&gt;(art::ArtMethod*, art::Thread*, art::ShadowFrame&amp;, art::Instruction const*, unsigned short, bool, art::JValue*)+1976) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #17 pc 000000000049e100  /apex/com.android.art/lib64/libart.so (void art::interpreter::ExecuteSwitchImplCpp&lt;false&gt;(art::interpreter::SwitchImplContext*)+960) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #18 pc 000000000034d1d8  /apex/com.android.art/lib64/libart.so (ExecuteSwitchImplAsm+8) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #19 pc 000000000002bad0  /apex/com.android.art/javalib/core-libart.jar (java.lang.Daemons$HeapTaskDaemon.runInternal+0)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #20 pc 0000000000378bb0  /apex/com.android.art/lib64/libart.so (art::interpreter::Execute(art::Thread*, art::CodeItemDataAccessor const&amp;, art::ShadowFrame&amp;, art::JValue, bool, bool) (.__uniq.112435418011751916792819755956732575238.llvm.11907307138045539842)+232) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #21 pc 0000000000511d44  /apex/com.android.art/lib64/libart.so (bool art::interpreter::DoCall&lt;false&gt;(art::ArtMethod*, art::Thread*, art::ShadowFrame&amp;, art::Instruction const*, unsigned short, bool, art::JValue*)+5252) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #22 pc 000000000049e100  /apex/com.android.art/lib64/libart.so (void art::interpreter::ExecuteSwitchImplCpp&lt;false&gt;(art::interpreter::SwitchImplContext*)+960) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #23 pc 000000000034d1d8  /apex/com.android.art/lib64/libart.so (ExecuteSwitchImplAsm+8) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #24 pc 000000000002adfc  /apex/com.android.art/javalib/core-libart.jar (java.lang.Daemons$Daemon.run+0)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #25 pc 0000000000378bb0  /apex/com.android.art/lib64/libart.so (art::interpreter::Execute(art::Thread*, art::CodeItemDataAccessor const&amp;, art::ShadowFrame&amp;, art::JValue, bool, bool) (.__uniq.112435418011751916792819755956732575238.llvm.11907307138045539842)+232) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #26 pc 0000000000511d44  /apex/com.android.art/lib64/libart.so (bool art::interpreter::DoCall&lt;false&gt;(art::ArtMethod*, art::Thread*, art::ShadowFrame&amp;, art::Instruction const*, unsigned short, bool, art::JValue*)+5252) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #27 pc 000000000049efac  /apex/com.android.art/lib64/libart.so (void art::interpreter::ExecuteSwitchImplCpp&lt;false&gt;(art::interpreter::SwitchImplContext*)+4716) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #28 pc 000000000034d1d8  /apex/com.android.art/lib64/libart.so (ExecuteSwitchImplAsm+8) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #29 pc 000000000010eaf0  /apex/com.android.art/javalib/core-oj.jar (java.lang.Thread.run+0)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #30 pc 0000000000378bb0  /apex/com.android.art/lib64/libart.so (art::interpreter::Execute(art::Thread*, art::CodeItemDataAccessor const&amp;, art::ShadowFrame&amp;, art::JValue, bool, bool) (.__uniq.112435418011751916792819755956732575238.llvm.11907307138045539842)+232) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #31 pc 00000000003784a8  /apex/com.android.art/lib64/libart.so (artQuickToInterpreterBridge+964) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #32 pc 000000000034ab68  /apex/com.android.art/lib64/libart.so (art_quick_to_interpreter_bridge+88) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #33 pc 0000000000333fa4  /apex/com.android.art/lib64/libart.so (art_quick_invoke_stub+612) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #34 pc 000000000023e4d4  /apex/com.android.art/lib64/libart.so (art::ArtMethod::Invoke(art::Thread*, unsigned int*, unsigned int, art::JValue*, char const*)+144) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #35 pc 0000000000539a3c  /apex/com.android.art/lib64/libart.so (art::Thread::CreateCallback(void*)+1600) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #36 pc 00000000000b6974  /apex/com.android.runtime/lib64/bionic/libc.so (__pthread_start(void*)+264) (BuildId: 37a328c30fb8c595fc3ebc7c80be6ac1)\r\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #37 pc 0000000000053210  /apex/com.android.runtime/lib64/bionic/libc.so (__start_thread+68) (BuildId: 37a328c30fb8c595fc3ebc7c80be6ac1)\r\n```","link":"https://stackoverflow.com/questions/77573384/im-getting-a-native-crash-in-my-application-this-crash-is-frequent-in-the-rele","title":"I&#39;m getting a native crash in my application. This crash is frequent in the release build and has never occurred in debug","body":"<p>I tried looking into the systrace in Perfetto UI but just couldn't figure out the reason for crash. The logs for the crashes showed multiple calls related to the G.C so suspected it to be a memory leak and used LeakCanary to look for memory leaks. I'm fixing the memory leaks one by one. Just wanted to know if I'm heading in the right direction or not.</p>\n<p>This is the crash that I'm getting</p>\n<pre><code>755 31581 31581 F DEBUG   : *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***\n12-01 12:25:34.755 31581 31581 F DEBUG   : Build fingerprint: 'motorola/corfur_g/corfur:12/S2RUBS32.51-15-9-11/dd8d5-e81484:user/release-keys'\n12-01 12:25:34.755 31581 31581 F DEBUG   : Revision: 'pvt'\n12-01 12:25:34.755 31581 31581 F DEBUG   : ABI: 'arm64'\n12-01 12:25:34.755 31581 31581 F DEBUG   : Timestamp: 2023-12-01 12:25:33.994708494+0530\n12-01 12:25:34.755 31581 31581 F DEBUG   : Process uptime: 0s\n12-01 12:25:34.755 31581 31581 F DEBUG   : Cmdline: in.myapp.qa\n12-01 12:25:34.755 31581 31581 F DEBUG   : pid: 28827, tid: 28836, name: HeapTaskDaemon  &gt;&gt;&gt; in.myapp.qa &lt;&lt;&lt;\n12-01 12:25:34.755 31581 31581 F DEBUG   : uid: 11318\n12-01 12:25:34.755 31581 31581 F DEBUG   : signal 6 (SIGABRT), code -1 (SI_QUEUE), fault addr --------\n12-01 12:25:34.755 31581 31581 F DEBUG   : Abort message: 'klass pointer for ref: 0x13708ed0 found to be null.'\n12-01 12:25:34.755 31581 31581 F DEBUG   :     x0  0000000000000000  x1  00000000000070a4  x2  0000000000000006  x3  00000076aeb800b0\n12-01 12:25:34.755 31581 31581 F DEBUG   :     x4  35312f6036772f1f  x5  35312f6036772f1f  x6  35312f6036772f1f  x7  7f7f7f7f7f7f7f7f\n12-01 12:25:34.755 31581 31581 F DEBUG   :     x8  00000000000000f0  x9  a219e6e01d251e00  x10 0000000000000000  x11 ffffff80fffffbdf\n12-01 12:25:34.755 31581 31581 F DEBUG   :     x12 0000000000000001  x13 000000000000074a  x14 00000076aeb7eeb0  x15 0000000034155555\n12-01 12:25:34.755 31581 31581 F DEBUG   :     x16 00000079d1400060  x17 00000079d13dc4b0  x18 0000007654b9a000  x19 000000000000709b\n12-01 12:25:34.755 31581 31581 F DEBUG   :     x20 00000000000070a4  x21 00000000ffffffff  x22 000000000000000b  x23 00000076be2a3fbe\n12-01 12:25:34.755 31581 31581 F DEBUG   :     x24 000000000000000b  x25 0000000000000002  x26 0000000000000001  x27 00000076bee16000\n12-01 12:25:34.755 31581 31581 F DEBUG   :     x28 b4000076e116c3e0  x29 00000076aeb80130\n12-01 12:25:34.755 31581 31581 F DEBUG   :     lr  00000079d138c8b0  sp  00000076aeb80090  pc  00000079d138c8dc  pst 0000000000001000\n12-01 12:25:34.755 31581 31581 F DEBUG   : backtrace:\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #00 pc 00000000000518dc  /apex/com.android.runtime/lib64/bionic/libc.so (abort+168) (BuildId: 37a328c30fb8c595fc3ebc7c80be6ac1)\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #01 pc 00000000007716f0  /apex/com.android.art/lib64/libart.so (art::Runtime::Abort(char const*)+904) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #02 pc 00000000000357d0  /apex/com.google.mainline.primary.libs@341050000/lib64/libbase.so/75d3253827fcfd7a8d7b02ad45991611ec4ca424c0278e13e8acfad4d14e597a3ecff6c0caa2b785c73838528ee6e9c2b313240ff895f50ee39b1d7bc10f390a/libbase.so (android::base::SetAborter(std::__1::function&lt;void (char const*)&gt;&amp;&amp;)::$_0::__invoke(char const*)+80) (BuildId: 6f67f69ff36b970d0b831cfdab3b578d)\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #03 pc 0000000000034d58  /apex/com.google.mainline.primary.libs@341050000/lib64/libbase.so/75d3253827fcfd7a8d7b02ad45991611ec4ca424c0278e13e8acfad4d14e597a3ecff6c0caa2b785c73838528ee6e9c2b313240ff895f50ee39b1d7bc10f390a/libbase.so (android::base::LogMessage::~LogMessage()+352) (BuildId: 6f67f69ff36b970d0b831cfdab3b578d)\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #04 pc 0000000000207734  /apex/com.android.art/lib64/libart.so (art::gc::Verification::LogHeapCorruption(art::ObjPtr&lt;art::mirror::Object&gt;, art::MemberOffset, art::mirror::Object*, bool) const+2016) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #05 pc 00000000002aa950  /apex/com.android.art/lib64/libart.so (void art::mirror::Object::VisitReferences&lt;true, (art::VerifyObjectFlags)0, (art::ReadBarrierOption)1, art::gc::collector::ConcurrentCopying::ComputeLiveBytesAndMarkRefFieldsVisitor&lt;true&gt;, art::gc::collector::ConcurrentCopying::ComputeLiveBytesAndMarkRefFieldsVisitor&lt;true&gt; &gt;(art::gc::collector::ConcurrentCopying::ComputeLiveBytesAndMarkRefFieldsVisitor&lt;true&gt; const&amp;, art::gc::collector::ConcurrentCopying::ComputeLiveBytesAndMarkRefFieldsVisitor&lt;true&gt; const&amp;)+2240) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #06 pc 00000000002a9f9c  /apex/com.android.art/lib64/libart.so (art::gc::collector::ConcurrentCopying::ProcessMarkStackForMarkingAndComputeLiveBytes()+1820) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #07 pc 00000000002a67e0  /apex/com.android.art/lib64/libart.so (art::gc::collector::ConcurrentCopying::MarkingPhase()+1188) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #08 pc 00000000002a13d0  /apex/com.android.art/lib64/libart.so (art::gc::collector::ConcurrentCopying::RunPhases()+184) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #09 pc 00000000003a6a10  /apex/com.android.art/lib64/libart.so (art::gc::collector::GarbageCollector::Run(art::gc::GcCause, bool)+312) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #10 pc 00000000003a2ea0  /apex/com.android.art/lib64/libart.so (art::gc::Heap::CollectGarbageInternal(art::gc::collector::GcType, art::gc::GcCause, bool, unsigned int)+548) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #11 pc 00000000003a2748  /apex/com.android.art/lib64/libart.so (art::gc::Heap::ConcurrentGC(art::Thread*, art::gc::GcCause, bool, unsigned int)+188) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #12 pc 00000000003a25cc  /apex/com.android.art/lib64/libart.so (art::gc::Heap::ConcurrentGCTask::Run(art::Thread*)+72) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.755 31581 31581 F DEBUG   :       #13 pc 00000000003a06d0  /apex/com.android.art/lib64/libart.so (art::gc::TaskProcessor::RunAllTasks(art::Thread*)+72) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #14 pc 000000000034aa30  /apex/com.android.art/lib64/libart.so (art_quick_generic_jni_trampoline+144) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #15 pc 0000000000333fa4  /apex/com.android.art/lib64/libart.so (art_quick_invoke_stub+612) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #16 pc 0000000000511078  /apex/com.android.art/lib64/libart.so (bool art::interpreter::DoCall&lt;false&gt;(art::ArtMethod*, art::Thread*, art::ShadowFrame&amp;, art::Instruction const*, unsigned short, bool, art::JValue*)+1976) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #17 pc 000000000049e100  /apex/com.android.art/lib64/libart.so (void art::interpreter::ExecuteSwitchImplCpp&lt;false&gt;(art::interpreter::SwitchImplContext*)+960) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #18 pc 000000000034d1d8  /apex/com.android.art/lib64/libart.so (ExecuteSwitchImplAsm+8) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #19 pc 000000000002bad0  /apex/com.android.art/javalib/core-libart.jar (java.lang.Daemons$HeapTaskDaemon.runInternal+0)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #20 pc 0000000000378bb0  /apex/com.android.art/lib64/libart.so (art::interpreter::Execute(art::Thread*, art::CodeItemDataAccessor const&amp;, art::ShadowFrame&amp;, art::JValue, bool, bool) (.__uniq.112435418011751916792819755956732575238.llvm.11907307138045539842)+232) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #21 pc 0000000000511d44  /apex/com.android.art/lib64/libart.so (bool art::interpreter::DoCall&lt;false&gt;(art::ArtMethod*, art::Thread*, art::ShadowFrame&amp;, art::Instruction const*, unsigned short, bool, art::JValue*)+5252) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #22 pc 000000000049e100  /apex/com.android.art/lib64/libart.so (void art::interpreter::ExecuteSwitchImplCpp&lt;false&gt;(art::interpreter::SwitchImplContext*)+960) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #23 pc 000000000034d1d8  /apex/com.android.art/lib64/libart.so (ExecuteSwitchImplAsm+8) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #24 pc 000000000002adfc  /apex/com.android.art/javalib/core-libart.jar (java.lang.Daemons$Daemon.run+0)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #25 pc 0000000000378bb0  /apex/com.android.art/lib64/libart.so (art::interpreter::Execute(art::Thread*, art::CodeItemDataAccessor const&amp;, art::ShadowFrame&amp;, art::JValue, bool, bool) (.__uniq.112435418011751916792819755956732575238.llvm.11907307138045539842)+232) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #26 pc 0000000000511d44  /apex/com.android.art/lib64/libart.so (bool art::interpreter::DoCall&lt;false&gt;(art::ArtMethod*, art::Thread*, art::ShadowFrame&amp;, art::Instruction const*, unsigned short, bool, art::JValue*)+5252) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #27 pc 000000000049efac  /apex/com.android.art/lib64/libart.so (void art::interpreter::ExecuteSwitchImplCpp&lt;false&gt;(art::interpreter::SwitchImplContext*)+4716) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #28 pc 000000000034d1d8  /apex/com.android.art/lib64/libart.so (ExecuteSwitchImplAsm+8) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #29 pc 000000000010eaf0  /apex/com.android.art/javalib/core-oj.jar (java.lang.Thread.run+0)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #30 pc 0000000000378bb0  /apex/com.android.art/lib64/libart.so (art::interpreter::Execute(art::Thread*, art::CodeItemDataAccessor const&amp;, art::ShadowFrame&amp;, art::JValue, bool, bool) (.__uniq.112435418011751916792819755956732575238.llvm.11907307138045539842)+232) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #31 pc 00000000003784a8  /apex/com.android.art/lib64/libart.so (artQuickToInterpreterBridge+964) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #32 pc 000000000034ab68  /apex/com.android.art/lib64/libart.so (art_quick_to_interpreter_bridge+88) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #33 pc 0000000000333fa4  /apex/com.android.art/lib64/libart.so (art_quick_invoke_stub+612) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #34 pc 000000000023e4d4  /apex/com.android.art/lib64/libart.so (art::ArtMethod::Invoke(art::Thread*, unsigned int*, unsigned int, art::JValue*, char const*)+144) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #35 pc 0000000000539a3c  /apex/com.android.art/lib64/libart.so (art::Thread::CreateCallback(void*)+1600) (BuildId: 4cfdaa9e5146c43e20ae36ee1caf9b7f)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #36 pc 00000000000b6974  /apex/com.android.runtime/lib64/bionic/libc.so (__pthread_start(void*)+264) (BuildId: 37a328c30fb8c595fc3ebc7c80be6ac1)\n12-01 12:25:34.756 31581 31581 F DEBUG   :       #37 pc 0000000000053210  /apex/com.android.runtime/lib64/bionic/libc.so (__start_thread+68) (BuildId: 37a328c30fb8c595fc3ebc7c80be6ac1)\n</code></pre>\n"},{"tags":["java","keycloak","openid-connect","keycloak-services","keycloak-spi"],"answers":[{"comment_count":0,"score":0,"last_activity_date":1701650364,"last_edit_date":1701650364,"creation_date":1701363165,"answer_id":77580248,"question_id":77273165,"body_markdown":"I&#39;m using Keycloak 22.0.5\r\n\r\nI needed to set these properties - I did this on the Keycloak start command line:\r\n```\r\n--spi-login-provider=&lt;the string returned by getId() in my factory class&gt;\r\n--spi-login-&lt;the string returned by getId() in my factory class&gt;-enabled=true\r\n```\r\nWhere my factory class extends FreeMarkerLoginFormsProviderFactory\r\n\r\nI did not use Freemarker for the string returned by `getId();` I used my own ID.\r\n\r\nI made the ID like the class name for my class that extends `FreeMarkerLoginFormsProvider`\r\n\r\nFor example, if my custom classes were named:\r\n\r\n```\r\n public class MyGoodClass extends FreeMarkerLoginFormsProvider { ... }\r\n\r\n public class MyGoodClassFactory extends FreeMarkerLoginFormsProviderFactory { ... }\r\n```\r\nI made my `getId()` method in `MyGoodClassFactory` return my-good-class:\r\n\r\n    @Override\r\n    public String getId() {\r\n        return &quot;my-good-class&quot;;\r\n    }\r\n\r\nSo then the property settings would be:\r\n\r\n```\r\n  --spi-login-provider=my-good-class\r\n\r\n  --spi-login-my-good-class-enabled=true\r\n```\r\nAlso, remember to create the file in {top level of `extension}/src/main/resources/META-INF/services/org.keycloak.forms.login.LoginFormsProviderFactory` and it should contain this one line (based on above example):\r\n```\r\norg.xgs.keycloak.forms.login.MyGoodClassFactory\r\n```\r\n\r\nHope this helps.","link":"https://stackoverflow.com/questions/77273165/keycloak-custom-login-provider-not-getting-invoked-with-version-19/77580248#77580248","title":"keycloak Custom Login provider not getting invoked with version 19","body":"<p>I'm using Keycloak 22.0.5</p>\n<p>I needed to set these properties - I did this on the Keycloak start command line:</p>\n<pre><code>--spi-login-provider=&lt;the string returned by getId() in my factory class&gt;\n--spi-login-&lt;the string returned by getId() in my factory class&gt;-enabled=true\n</code></pre>\n<p>Where my factory class extends FreeMarkerLoginFormsProviderFactory</p>\n<p>I did not use Freemarker for the string returned by <code>getId();</code> I used my own ID.</p>\n<p>I made the ID like the class name for my class that extends <code>FreeMarkerLoginFormsProvider</code></p>\n<p>For example, if my custom classes were named:</p>\n<pre><code> public class MyGoodClass extends FreeMarkerLoginFormsProvider { ... }\n\n public class MyGoodClassFactory extends FreeMarkerLoginFormsProviderFactory { ... }\n</code></pre>\n<p>I made my <code>getId()</code> method in <code>MyGoodClassFactory</code> return my-good-class:</p>\n<pre><code>@Override\npublic String getId() {\n    return &quot;my-good-class&quot;;\n}\n</code></pre>\n<p>So then the property settings would be:</p>\n<pre><code>  --spi-login-provider=my-good-class\n\n  --spi-login-my-good-class-enabled=true\n</code></pre>\n<p>Also, remember to create the file in {top level of <code>extension}/src/main/resources/META-INF/services/org.keycloak.forms.login.LoginFormsProviderFactory</code> and it should contain this one line (based on above example):</p>\n<pre><code>org.xgs.keycloak.forms.login.MyGoodClassFactory\n</code></pre>\n<p>Hope this helps.</p>\n"}],"comment_count":0,"is_answered":false,"view_count":88,"answer_count":1,"score":0,"last_activity_date":1701650364,"creation_date":1697028148,"last_edit_date":1697032566,"question_id":77273165,"body_markdown":"We were using Custom Login provider with keycloak 18 version and everything works fine.\r\n\r\nBut when we upgrade to keycloak version 19, Custom Login Provider is not getting invoked.\r\n\r\nIn the below example we can see that CustomProviderFactory create method should be invoked, it works well with keycloak 18 version, but its not working with keycloak 19 version. All the jboss deployment.xml are in place.\r\n \r\n\r\nEx\r\n```\r\npublic class CustomProviderFactory extends FreeMarkerLoginFormsProviderFactory {\r\nprivate FreeMarkerUtil freeMarker;\r\n\r\n    @Override\r\n    public LoginFormsProvider create(KeycloakSession session) {\r\n        return new CustomLoginFormsProvider(session, freeMarker);\r\n    }\r\n\r\n    @Override\r\n    public void init(Config.Scope config) {\r\n        freeMarker = new FreeMarkerUtil();\r\n    }\r\n\r\n    @Override\r\n    public void close() {\r\n        freeMarker = null;\r\n    }\r\n\r\n    @Override\r\n    public String getId() {\r\n        return &quot;freemarker&quot;;\r\n    }\r\n\r\n}\r\n\r\npublic class CustomLoginFormsProvider extends FreeMarkerLoginFormsProvider {\r\n\r\n   \r\n    public LoginFormsProvider(KeycloakSession session, FreeMarkerUtil freeMarker) {\r\n        super(session, freeMarker);\r\n    }\r\n\r\n    @Override\r\n    protected void createCommonAttributes(Theme theme, Locale locale, Properties messagesBundle, UriBuilder baseUriBuilder, LoginFormsPages page) {\r\n        super.createCommonAttributes(theme, locale, messagesBundle, baseUriBuilder, page);\r\n        \r\n    }\r\n\r\n}\r\n```","link":"https://stackoverflow.com/questions/77273165/keycloak-custom-login-provider-not-getting-invoked-with-version-19","title":"keycloak Custom Login provider not getting invoked with version 19","body":"<p>We were using Custom Login provider with keycloak 18 version and everything works fine.</p>\n<p>But when we upgrade to keycloak version 19, Custom Login Provider is not getting invoked.</p>\n<p>In the below example we can see that CustomProviderFactory create method should be invoked, it works well with keycloak 18 version, but its not working with keycloak 19 version. All the jboss deployment.xml are in place.</p>\n<p>Ex</p>\n<pre><code>public class CustomProviderFactory extends FreeMarkerLoginFormsProviderFactory {\nprivate FreeMarkerUtil freeMarker;\n\n    @Override\n    public LoginFormsProvider create(KeycloakSession session) {\n        return new CustomLoginFormsProvider(session, freeMarker);\n    }\n\n    @Override\n    public void init(Config.Scope config) {\n        freeMarker = new FreeMarkerUtil();\n    }\n\n    @Override\n    public void close() {\n        freeMarker = null;\n    }\n\n    @Override\n    public String getId() {\n        return &quot;freemarker&quot;;\n    }\n\n}\n\npublic class CustomLoginFormsProvider extends FreeMarkerLoginFormsProvider {\n\n   \n    public LoginFormsProvider(KeycloakSession session, FreeMarkerUtil freeMarker) {\n        super(session, freeMarker);\n    }\n\n    @Override\n    protected void createCommonAttributes(Theme theme, Locale locale, Properties messagesBundle, UriBuilder baseUriBuilder, LoginFormsPages page) {\n        super.createCommonAttributes(theme, locale, messagesBundle, baseUriBuilder, page);\n        \n    }\n\n}\n</code></pre>\n"},{"tags":["java","classloader","guice","james"],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1692748037,"post_id":76944786,"comment_id":135665973,"body_markdown":"Thank you! This gives me a starting point. I will look into extending their classloader and see if there&#39;s a way to tell the James server to use my custom class instead. The only hard part is I can&#39;t find anywhere in the documentation that would indicate this as supported out of the box. :(","link":"https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje/76944786#comment135665973_76944786","body":"Thank you! This gives me a starting point. I will look into extending their classloader and see if there&#39;s a way to tell the James server to use my custom class instead. The only hard part is I can&#39;t find anywhere in the documentation that would indicate this as supported out of the box. :("},{"score":0,"post_type":"answer","creation_date":1692748438,"post_id":76944786,"comment_id":135666005,"body_markdown":"I think you&#39;re right that the only solution would be to compile a custom version of James with the modified loader. It doesn&#39;t look like there&#39;s any simple way to swap in my own implementation. That&#39;s frustrating. I was so close to having the perfect little embedded mail server application.","link":"https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje/76944786#comment135666005_76944786","body":"I think you&#39;re right that the only solution would be to compile a custom version of James with the modified loader. It doesn&#39;t look like there&#39;s any simple way to swap in my own implementation. That&#39;s frustrating. I was so close to having the perfect little embedded mail server application."},{"score":0,"post_type":"answer","creation_date":1692782841,"post_id":76944786,"comment_id":135670096,"body_markdown":"@TheFunk I understand your frustration. It might be possible to use reflection to access and modify the `ExtendedClassLoader` instance within James after it has been instantiated. That is a very hacky approach and is likely to be fragile, but in certain cases, it might be an option.","link":"https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje/76944786#comment135670096_76944786","body":"@TheFunk I understand your frustration. It might be possible to use reflection to access and modify the <code>ExtendedClassLoader</code> instance within James after it has been instantiated. That is a very hacky approach and is likely to be fragile, but in certain cases, it might be an option."},{"score":0,"post_type":"answer","creation_date":1692782855,"post_id":76944786,"comment_id":135670099,"body_markdown":"@TheFunk Or, if you can isolate your custom hooks into a separate module within your project, you might be able to package that module as a separate jar and place it in the expected `extensions-jars/` directory. You could still depend on that jar within your main project, so the classes would be available both to James and to your application code.","link":"https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje/76944786#comment135670099_76944786","body":"@TheFunk Or, if you can isolate your custom hooks into a separate module within your project, you might be able to package that module as a separate jar and place it in the expected <code>extensions-jars&#47;</code> directory. You could still depend on that jar within your main project, so the classes would be available both to James and to your application code."},{"score":1,"post_type":"answer","creation_date":1692904945,"post_id":76944786,"comment_id":135691544,"body_markdown":"A `URLClassLoader` follows the standard parent delegation model. Since `getClass().getClassLoader()` is passed to the constructor as the parent loader, it will be searched for classes, even before the URLs passed to the constructor are searched. Merging `currentClasspath` with `extensionUrls` has no effect.","link":"https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje/76944786#comment135691544_76944786","body":"A <code>URLClassLoader</code> follows the standard parent delegation model. Since <code>getClass().getClassLoader()</code> is passed to the constructor as the parent loader, it will be searched for classes, even before the URLs passed to the constructor are searched. Merging <code>currentClasspath</code> with <code>extensionUrls</code> has no effect."},{"score":0,"post_type":"answer","creation_date":1692905897,"post_id":76944786,"comment_id":135691721,"body_markdown":"@Holger I see... would a potential workaround be to build the custom hooks as a separate jar and place that jar in the `extensions-jars/` directory as per James&#39;s expected configuration? You could then also include that jar as a dependency in your Maven project, ensuring that the classes are available both to James (through the `ExtendedClassLoader`) and to the rest of your application code.","link":"https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje/76944786#comment135691721_76944786","body":"@Holger I see... would a potential workaround be to build the custom hooks as a separate jar and place that jar in the <code>extensions-jars&#47;</code> directory as per James&#39;s expected configuration? You could then also include that jar as a dependency in your Maven project, ensuring that the classes are available both to James (through the <code>ExtendedClassLoader</code>) and to the rest of your application code."},{"score":1,"post_type":"answer","creation_date":1692906532,"post_id":76944786,"comment_id":135691823,"body_markdown":"I’m not sure what problem this approach was supposed to solve. As said, a class loader set up this way *will* find the classes of the parent loader. So while the linked documentation says that the intended deployment of custom hooks are `jar` files inside the `conf/lib` directory, it doesn’t mean that custom hooks implemented in the parent loader wouldn’t work (If they don’t, we need more information about this environment).","link":"https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje/76944786#comment135691823_76944786","body":"I’m not sure what problem this approach was supposed to solve. As said, a class loader set up this way <i>will</i> find the classes of the parent loader. So while the linked documentation says that the intended deployment of custom hooks are <code>jar</code> files inside the <code>conf&#47;lib</code> directory, it doesn’t mean that custom hooks implemented in the parent loader wouldn’t work (If they don’t, we need more information about this environment)."},{"score":0,"post_type":"answer","creation_date":1692906938,"post_id":76944786,"comment_id":135691910,"body_markdown":"@Holger OK. I will wait for the OP&#39;s feedback, then I realize I did mention `URLClassLoader` in a 2008(!) answer &quot;[How do you change the CLASSPATH within Java?](https://stackoverflow.com/a/252967/6309)&quot;.","link":"https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje/76944786#comment135691910_76944786","body":"@Holger OK. I will wait for the OP&#39;s feedback, then I realize I did mention <code>URLClassLoader</code> in a 2008(!) answer &quot;<a href=\"https://stackoverflow.com/a/252967/6309\">How do you change the CLASSPATH within Java?</a>&quot;."},{"score":0,"post_type":"answer","creation_date":1692917067,"post_id":76944786,"comment_id":135693466,"body_markdown":"@Holger I get a class not found error when referencing classes in the XML config from the parent project, however the default James hooks work as expected. I realized my working directory for the server is configured as my resources folder. I&#39;m wondering if maybe that&#39;s wrong.  The project itself is a typical maven project.","link":"https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje/76944786#comment135693466_76944786","body":"@Holger I get a class not found error when referencing classes in the XML config from the parent project, however the default James hooks work as expected. I realized my working directory for the server is configured as my resources folder. I&#39;m wondering if maybe that&#39;s wrong.  The project itself is a typical maven project."},{"score":0,"post_type":"answer","creation_date":1692917341,"post_id":76944786,"comment_id":135693500,"body_markdown":"@VonC I could add the hooks into their own JAR but that would require a bit of doing. If I can&#39;t get the James server to find my classes that might be the best option.","link":"https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje/76944786#comment135693500_76944786","body":"@VonC I could add the hooks into their own JAR but that would require a bit of doing. If I can&#39;t get the James server to find my classes that might be the best option."},{"score":0,"post_type":"answer","creation_date":1692956232,"post_id":76944786,"comment_id":135698227,"body_markdown":"@TheFunk OK, let me know how it goes for you.","link":"https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje/76944786#comment135698227_76944786","body":"@TheFunk OK, let me know how it goes for you."},{"score":0,"post_type":"answer","creation_date":1701622084,"post_id":76944786,"comment_id":136795996,"body_markdown":"@VonC sorry for the long delay in response but I just wanted to let you all know I moved the code into JAR files and put them in the extension-jars directory, and now the embedded James instance is able to see them.\n\nI was never able to get James to see the classes when they were in the parent project. The parent project was a simple Quarkus application following, almost to the letter, the docs for configuring embedded Apache James with everything configured to be &quot;in memory&quot;. https://james.apache.org/howTo/custom-james-assembly.html","link":"https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje/76944786#comment136795996_76944786","body":"@VonC sorry for the long delay in response but I just wanted to let you all know I moved the code into JAR files and put them in the extension-jars directory, and now the embedded James instance is able to see them.  I was never able to get James to see the classes when they were in the parent project. The parent project was a simple Quarkus application following, almost to the letter, the docs for configuring embedded Apache James with everything configured to be &quot;in memory&quot;. <a href=\"https://james.apache.org/howTo/custom-james-assembly.html\" rel=\"nofollow noreferrer\">james.apache.org/howTo/custom-james-assembly.html</a>"},{"score":0,"post_type":"answer","creation_date":1701622168,"post_id":76944786,"comment_id":136796007,"body_markdown":"@Holger you had been asking for more details as well....","link":"https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje/76944786#comment136796007_76944786","body":"@Holger you had been asking for more details as well...."},{"score":1,"post_type":"answer","creation_date":1701640306,"post_id":76944786,"comment_id":136797883,"body_markdown":"@TheFunk Thank you for the feedback. I have included your conclusion in the answer for more visibility.","link":"https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje/76944786#comment136797883_76944786","body":"@TheFunk Thank you for the feedback. I have included your conclusion in the answer for more visibility."}],"comment_count":14,"score":2,"last_activity_date":1701640286,"last_edit_date":1701640286,"creation_date":1692616602,"answer_id":76944786,"question_id":76925861,"body_markdown":"&gt; Is there a way to modify the classloader so that I can use hooks that exist in the same jar where James is going to exist?\r\n\r\n&quot;modify the classloader&quot;? ... not without re-compiling the [`apache/james-project`](https://github.com/apache/james-project) itself, I would presume.\r\n\r\n[Apache James](https://james.apache.org/) likely uses a dedicated component for classloading, which could be based on Java&#39;s [URLClassLoader](https://docs.oracle.com/javase%2F9%2Fdocs%2Fapi%2F%2F/java/net/URLClassLoader.html) or a similar class.  \r\nI can see [`org.apache.james.utils.ExtendedClassLoader `](https://github.com/apache/james-project/blob/38ed64d6fc68b4e076d421c459b9217c28001d71/server/container/guice/utils/src/main/java/org/apache/james/utils/ExtendedClassLoader.java#L44)\r\n\r\nYou would need to modify it to check the current application classpath (where your Quarkus app and embedded James reside) in addition to or instead of the `conf/lib` directory.  \r\nThen, after making the changes, you will need to recompile James and integrate the custom version with your Quarkus application.\r\n\r\nThe XML configurations you have for server implementations will not need to change because of these modifications. The XML file merely instructs James on what class to instantiate and possibly initialize. By modifying the classloading behavior, you are just changing where James looks for these classes. The XML stays the same because it references classes by their fully qualified names, not their locations.\r\n\r\nI initially propose an updated code for `ExtendedClassLoader`, but, as noted by [Holger](https://stackoverflow.com/users/2711488/holger) in [the comments](https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje/76944786?noredirect=1#comment135691544_76944786):\r\n\r\n&gt; A `URLClassLoader` follows the standard parent delegation model.  Since `getClass().getClassLoader()` is passed to the constructor as the parent loader, it will be searched for classes, even before the URLs passed to the constructor are searched.  \r\n&gt; Merging `currentClasspath` with `extensionUrls` has no effect.\r\n\r\n```java\r\npackage org.apache.james.utils;\r\n\r\n// ... [other imports]\r\n\r\npublic class ExtendedClassLoader {\r\n\r\n    private static final Logger LOGGER = LoggerFactory.getLogger(ExtendedClassLoader.class);\r\n\r\n    public static final String EXTENSIONS_JARS_FOLDER_NAME = &quot;extensions-jars/&quot;;\r\n\r\n    private final URLClassLoader urlClassLoader;\r\n\r\n    @Inject\r\n    public ExtendedClassLoader(FileSystem fileSystem) {\r\n        URL[] extensionUrls = retrieveExtensionsUrls(fileSystem);\r\n        URL[] currentClasspath = ((URLClassLoader) getClass().getClassLoader()).getURLs();\r\n\r\n        URL[] combinedUrls = Stream.concat(\r\n            Stream.of(extensionUrls),\r\n            Stream.of(currentClasspath)\r\n        ).distinct().toArray(URL[]::new);\r\n\r\n        this.urlClassLoader = new URLClassLoader(combinedUrls, getClass().getClassLoader());\r\n    }\r\n\r\n    private URL[] retrieveExtensionsUrls(FileSystem fileSystem) {\r\n        try {\r\n            File file = fileSystem.getFile(&quot;file://&quot; + EXTENSIONS_JARS_FOLDER_NAME);\r\n            return recursiveExpand(file)\r\n                .toArray(URL[]::new);\r\n        } catch (IOException e) {\r\n            LOGGER.info(&quot;No &quot; + EXTENSIONS_JARS_FOLDER_NAME + &quot; folder.&quot;);\r\n            return new URL[]{};\r\n        }\r\n    }\r\n\r\n    private Stream&lt;URL&gt; recursiveExpand(File file) {\r\n        return StreamUtils.ofNullable(file.listFiles())\r\n            .flatMap(Throwing.function(this::expandFile).sneakyThrow());\r\n    }\r\n\r\n    private Stream&lt;URL&gt; expandFile(File file) throws MalformedURLException {\r\n        if (file.isDirectory()) {\r\n            return recursiveExpand(file);\r\n        }\r\n        LOGGER.info(&quot;Loading custom classpath resource {}&quot;, file.getAbsolutePath());\r\n        return Stream.of(file.toURI().toURL());\r\n    }\r\n\r\n    @SuppressWarnings(&quot;unchecked&quot;)\r\n    public &lt;T&gt; Class&lt;T&gt; locateClass(FullyQualifiedClassName className) throws ClassNotFoundException {\r\n        return (Class&lt;T&gt;) urlClassLoader.loadClass(className.getName());\r\n    }\r\n}\r\n```\r\n\r\nIn the constructor `ExtendedClassLoader(FileSystem fileSystem)`, you can retrieve the URLs from the `extensions-jars/` folder (just like the original code). And the URLs from the current application&#39;s classpath. The combined URLs are ensured to be unique to avoid duplication.   \r\nThese combined URLs are then fed into the `URLClassLoader` so that, when James tries to load a class, it will look in both the provided extension URLs and the current application&#39;s classpath.\r\n\r\nBy making these changes, James will first look for hooks in the `extensions-jars/` folder (if provided) and then in the current application&#39;s classpath. That means if you have packaged James and your custom hooks into the same jar (or same classpath), it should be able to find and load them without issues.\r\n\r\nSee also &quot;[URLClassLoader can&#39;t find class thats in different directory](https://stackoverflow.com/q/49899468/6309)&quot;.\r\n\r\n---\r\n\r\n&gt;  I moved the code into JAR files and put them in the extension-jars directory, and now the embedded James instance can see them.  \r\nI was never able to get James to see the classes when they were in the parent project. \r\n&gt;\r\n&gt; The parent project was a simple Quarkus application following, almost to the letter, the [docs for configuring embedded Apache James](https://james.apache.org/howTo/custom-james-assembly.html) with everything configured to be &quot;in memory&quot;. \r\n\r\nTrue: the `extension-jars` directory is the default location where Apache James looks for additional modules and extensions.  \r\nInstead of modifying the classloader, which would require a deep understanding of both the James server internals and Java&#39;s classloading mechanisms, placing the hooks in the `extension-jars` directory is a simpler solution.\r\n\r\nThe OP&#39;s project is a [Quarkus](https://quarkus.io/) application, which may have its [own classloading behaviors and constraints](https://quarkus.io/guides/class-loading-reference). Quarkus is designed for containerization and microservice architectures, so its classloading might be optimized for these environments, potentially complicating direct integration with embedded applications like Apache James.","link":"https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje/76944786#76944786","title":"Modify embedded Apache James Classloader to allow for custom hooks in same project","body":"<blockquote>\n<p>Is there a way to modify the classloader so that I can use hooks that exist in the same jar where James is going to exist?</p>\n</blockquote>\n<p>&quot;modify the classloader&quot;? ... not without re-compiling the <a href=\"https://github.com/apache/james-project\" rel=\"nofollow noreferrer\"><code>apache/james-project</code></a> itself, I would presume.</p>\n<p><a href=\"https://james.apache.org/\" rel=\"nofollow noreferrer\">Apache James</a> likely uses a dedicated component for classloading, which could be based on Java's <a href=\"https://docs.oracle.com/javase%2F9%2Fdocs%2Fapi%2F%2F/java/net/URLClassLoader.html\" rel=\"nofollow noreferrer\">URLClassLoader</a> or a similar class.<br />\nI can see <a href=\"https://github.com/apache/james-project/blob/38ed64d6fc68b4e076d421c459b9217c28001d71/server/container/guice/utils/src/main/java/org/apache/james/utils/ExtendedClassLoader.java#L44\" rel=\"nofollow noreferrer\"><code>org.apache.james.utils.ExtendedClassLoader </code></a></p>\n<p>You would need to modify it to check the current application classpath (where your Quarkus app and embedded James reside) in addition to or instead of the <code>conf/lib</code> directory.<br />\nThen, after making the changes, you will need to recompile James and integrate the custom version with your Quarkus application.</p>\n<p>The XML configurations you have for server implementations will not need to change because of these modifications. The XML file merely instructs James on what class to instantiate and possibly initialize. By modifying the classloading behavior, you are just changing where James looks for these classes. The XML stays the same because it references classes by their fully qualified names, not their locations.</p>\n<p>I initially propose an updated code for <code>ExtendedClassLoader</code>, but, as noted by <a href=\"https://stackoverflow.com/users/2711488/holger\">Holger</a> in <a href=\"https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje/76944786?noredirect=1#comment135691544_76944786\">the comments</a>:</p>\n<blockquote>\n<p>A <code>URLClassLoader</code> follows the standard parent delegation model.  Since <code>getClass().getClassLoader()</code> is passed to the constructor as the parent loader, it will be searched for classes, even before the URLs passed to the constructor are searched.<br />\nMerging <code>currentClasspath</code> with <code>extensionUrls</code> has no effect.</p>\n</blockquote>\n<pre class=\"lang-java prettyprint-override\"><code>package org.apache.james.utils;\n\n// ... [other imports]\n\npublic class ExtendedClassLoader {\n\n    private static final Logger LOGGER = LoggerFactory.getLogger(ExtendedClassLoader.class);\n\n    public static final String EXTENSIONS_JARS_FOLDER_NAME = &quot;extensions-jars/&quot;;\n\n    private final URLClassLoader urlClassLoader;\n\n    @Inject\n    public ExtendedClassLoader(FileSystem fileSystem) {\n        URL[] extensionUrls = retrieveExtensionsUrls(fileSystem);\n        URL[] currentClasspath = ((URLClassLoader) getClass().getClassLoader()).getURLs();\n\n        URL[] combinedUrls = Stream.concat(\n            Stream.of(extensionUrls),\n            Stream.of(currentClasspath)\n        ).distinct().toArray(URL[]::new);\n\n        this.urlClassLoader = new URLClassLoader(combinedUrls, getClass().getClassLoader());\n    }\n\n    private URL[] retrieveExtensionsUrls(FileSystem fileSystem) {\n        try {\n            File file = fileSystem.getFile(&quot;file://&quot; + EXTENSIONS_JARS_FOLDER_NAME);\n            return recursiveExpand(file)\n                .toArray(URL[]::new);\n        } catch (IOException e) {\n            LOGGER.info(&quot;No &quot; + EXTENSIONS_JARS_FOLDER_NAME + &quot; folder.&quot;);\n            return new URL[]{};\n        }\n    }\n\n    private Stream&lt;URL&gt; recursiveExpand(File file) {\n        return StreamUtils.ofNullable(file.listFiles())\n            .flatMap(Throwing.function(this::expandFile).sneakyThrow());\n    }\n\n    private Stream&lt;URL&gt; expandFile(File file) throws MalformedURLException {\n        if (file.isDirectory()) {\n            return recursiveExpand(file);\n        }\n        LOGGER.info(&quot;Loading custom classpath resource {}&quot;, file.getAbsolutePath());\n        return Stream.of(file.toURI().toURL());\n    }\n\n    @SuppressWarnings(&quot;unchecked&quot;)\n    public &lt;T&gt; Class&lt;T&gt; locateClass(FullyQualifiedClassName className) throws ClassNotFoundException {\n        return (Class&lt;T&gt;) urlClassLoader.loadClass(className.getName());\n    }\n}\n</code></pre>\n<p>In the constructor <code>ExtendedClassLoader(FileSystem fileSystem)</code>, you can retrieve the URLs from the <code>extensions-jars/</code> folder (just like the original code). And the URLs from the current application's classpath. The combined URLs are ensured to be unique to avoid duplication.<br />\nThese combined URLs are then fed into the <code>URLClassLoader</code> so that, when James tries to load a class, it will look in both the provided extension URLs and the current application's classpath.</p>\n<p>By making these changes, James will first look for hooks in the <code>extensions-jars/</code> folder (if provided) and then in the current application's classpath. That means if you have packaged James and your custom hooks into the same jar (or same classpath), it should be able to find and load them without issues.</p>\n<p>See also &quot;<a href=\"https://stackoverflow.com/q/49899468/6309\">URLClassLoader can't find class thats in different directory</a>&quot;.</p>\n<hr />\n<blockquote>\n<p>I moved the code into JAR files and put them in the extension-jars directory, and now the embedded James instance can see them.<br />\nI was never able to get James to see the classes when they were in the parent project.</p>\n<p>The parent project was a simple Quarkus application following, almost to the letter, the <a href=\"https://james.apache.org/howTo/custom-james-assembly.html\" rel=\"nofollow noreferrer\">docs for configuring embedded Apache James</a> with everything configured to be &quot;in memory&quot;.</p>\n</blockquote>\n<p>True: the <code>extension-jars</code> directory is the default location where Apache James looks for additional modules and extensions.<br />\nInstead of modifying the classloader, which would require a deep understanding of both the James server internals and Java's classloading mechanisms, placing the hooks in the <code>extension-jars</code> directory is a simpler solution.</p>\n<p>The OP's project is a <a href=\"https://quarkus.io/\" rel=\"nofollow noreferrer\">Quarkus</a> application, which may have its <a href=\"https://quarkus.io/guides/class-loading-reference\" rel=\"nofollow noreferrer\">own classloading behaviors and constraints</a>. Quarkus is designed for containerization and microservice architectures, so its classloading might be optimized for these environments, potentially complicating direct integration with embedded applications like Apache James.</p>\n"}],"comment_count":0,"is_answered":true,"view_count":104,"answer_count":1,"score":4,"last_activity_date":1701640286,"creation_date":1692320249,"last_edit_date":1692917547,"question_id":76925861,"body_markdown":"I am attempting to run my own custom in-memory James assembly inside of a Quarkus web application. I&#39;ve been following along with [the example here][1] and gotten the server to run.\r\n\r\nOne of the issues I&#39;m running into is that according to the docs [I need to include custom hooks inside of a Jar file in a /conf/lib directory][2] however I wish to use classes directly from inside the same project James is embedded in. Is there a way to modify the classloader so that I can use hooks that exist in the same jar where James is going to exist?\r\n\r\n\r\nEdit: Adding handlerchain config. Sorry VonC I might have accidentally submitted this as an edit to your answer. It&#39;s been a day!\r\n\r\n```xml\r\n        &lt;handlerchain&gt;\r\n            &lt;handler class=&quot;org.apache.james.smtpserver.fastfail.ValidRcptHandler&quot;/&gt;\r\n            &lt;handler class=&quot;org.apache.james.smtpserver.CoreCmdHandlerLoader&quot;/&gt;\r\n            &lt;handler class=&quot;tech.gmork.oxprox.control.hooks.CustomAuthHook&quot;/&gt;\r\n            &lt;handler class=&quot;tech.gmork.oxprox.control.hooks.CustomMessageHook&quot;/&gt;\r\n        &lt;/handlerchain&gt;\r\n```\r\n\r\n  [1]: https://james.apache.org/howTo/custom-james-assembly.html\r\n  [2]: https://james.apache.org/server/dev-extend-smtp-hook.html","link":"https://stackoverflow.com/questions/76925861/modify-embedded-apache-james-classloader-to-allow-for-custom-hooks-in-same-proje","title":"Modify embedded Apache James Classloader to allow for custom hooks in same project","body":"<p>I am attempting to run my own custom in-memory James assembly inside of a Quarkus web application. I've been following along with <a href=\"https://james.apache.org/howTo/custom-james-assembly.html\" rel=\"nofollow noreferrer\">the example here</a> and gotten the server to run.</p>\n<p>One of the issues I'm running into is that according to the docs <a href=\"https://james.apache.org/server/dev-extend-smtp-hook.html\" rel=\"nofollow noreferrer\">I need to include custom hooks inside of a Jar file in a /conf/lib directory</a> however I wish to use classes directly from inside the same project James is embedded in. Is there a way to modify the classloader so that I can use hooks that exist in the same jar where James is going to exist?</p>\n<p>Edit: Adding handlerchain config. Sorry VonC I might have accidentally submitted this as an edit to your answer. It's been a day!</p>\n<pre class=\"lang-xml prettyprint-override\"><code>        &lt;handlerchain&gt;\n            &lt;handler class=&quot;org.apache.james.smtpserver.fastfail.ValidRcptHandler&quot;/&gt;\n            &lt;handler class=&quot;org.apache.james.smtpserver.CoreCmdHandlerLoader&quot;/&gt;\n            &lt;handler class=&quot;tech.gmork.oxprox.control.hooks.CustomAuthHook&quot;/&gt;\n            &lt;handler class=&quot;tech.gmork.oxprox.control.hooks.CustomMessageHook&quot;/&gt;\n        &lt;/handlerchain&gt;\n</code></pre>\n"},{"tags":["java","spring","spring-boot"],"answers":[{"comment_count":0,"score":0,"last_activity_date":1701175729,"creation_date":1701175729,"answer_id":77564023,"question_id":77563612,"body_markdown":"The error basically suggest that you don&#39;t have the right version of the **JDK** installed or you might be using a JRE (Java Runtime Environment which comes normally bundeled by default). If that&#39;s the case you should get the proper JDK (Java Development Kit) and update your runtime environment in VSCode.","link":"https://stackoverflow.com/questions/77563612/java-spring-boot-release-is-not-in-the-system-error/77564023#77564023","title":"Java Spring Boot &quot;release is not in the system&quot; Error","body":"<p>The error basically suggest that you don't have the right version of the <strong>JDK</strong> installed or you might be using a JRE (Java Runtime Environment which comes normally bundeled by default). If that's the case you should get the proper JDK (Java Development Kit) and update your runtime environment in VSCode.</p>\n"},{"comment_count":0,"score":0,"last_activity_date":1701635961,"creation_date":1701635961,"answer_id":77596096,"question_id":77563612,"body_markdown":"For me the jre change to correct one(one I specified in https://start.spring.io/) in window-&gt;preferences-&gt;Java-&gt;InstalledJREs resolved the problem. It is not enough that you have installed the correct JRE/JDK- you have to use correct one in the Eclipse.","link":"https://stackoverflow.com/questions/77563612/java-spring-boot-release-is-not-in-the-system-error/77596096#77596096","title":"Java Spring Boot &quot;release is not in the system&quot; Error","body":"<p>For me the jre change to correct one(one I specified in <a href=\"https://start.spring.io/\" rel=\"nofollow noreferrer\">https://start.spring.io/</a>) in window-&gt;preferences-&gt;Java-&gt;InstalledJREs resolved the problem. It is not enough that you have installed the correct JRE/JDK- you have to use correct one in the Eclipse.</p>\n"}],"comment_count":0,"is_answered":true,"view_count":197,"answer_count":2,"score":0,"last_activity_date":1701635961,"creation_date":1701172036,"question_id":77563612,"body_markdown":"I created a project with spring initialzr and used the java 21 version. But I get this error when I run vscode without doing anything on it, how can I solve it.\r\n\r\nThe project was not built due to &quot;release 20 is not found in the system&quot;. Fix the problem, then try refreshing this project and building it since it may be inconsistent\r\n\r\nI tried to create new project and ı got this error again and again. I am waiting to get help.","link":"https://stackoverflow.com/questions/77563612/java-spring-boot-release-is-not-in-the-system-error","title":"Java Spring Boot &quot;release is not in the system&quot; Error","body":"<p>I created a project with spring initialzr and used the java 21 version. But I get this error when I run vscode without doing anything on it, how can I solve it.</p>\n<p>The project was not built due to &quot;release 20 is not found in the system&quot;. Fix the problem, then try refreshing this project and building it since it may be inconsistent</p>\n<p>I tried to create new project and ı got this error again and again. I am waiting to get help.</p>\n"},{"tags":["java","android","image-processing","object-detection","yolo"],"comment_count":0,"is_answered":false,"view_count":140,"answer_count":0,"score":0,"last_activity_date":1701634470,"creation_date":1698391584,"last_edit_date":1701634470,"question_id":77372206,"body_markdown":" I used two yolov5 models. My first model detects the tray. In my second model, it finds food types.\r\n\r\nThe size of the first model was 416, then I cropped it. I sent it to the second model. The size of my second model is 224. my question: There is a shift in the second model.\r\n\r\nI think, The reason for the shift problem is crop . It detective the food in the cropped image. Draws the result for the original image. It should change according to the center of the tray.  I understand the problem, but I didn&#39;t understand how to change it.\r\n[![Table][1]][1]\r\nI created a table in debug mode. I wrote the values.\r\nDo I need to increase xPos and yPos values when drawing? There are only location values in the MultiBoxerTracker file. bottom, left right, top. I&#39;m so confused.\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/QYFz9.jpg\r\n\r\n\r\n\r\n    Yolov5Classifier2.java coordinate part\r\n        public ArrayList&lt;Recognition&gt; recognizeImage2(Bitmap bitmap) {\r\n      final float xPos = out[0][i][0];\r\n                    final float yPos = out[0][i][1];\r\n    \r\n                    final float w = out[0][i][2];\r\n                    final float h = out[0][i][3];\r\n                    Log.d(&quot;secondyolov5&quot;,\r\n                            Float.toString(xPos) + &#39;,&#39; + yPos + &#39;,&#39; + w + &#39;,&#39; + h);\r\n                    final RectF rect =\r\n                            new RectF( Math.max(0, xPos - w / 2),\r\n                                    Math.max(0, yPos - h / 2),\r\n                                    Math.min(bitmap.getWidth() - 1, xPos + w / 2),\r\n                                    Math.min(bitmap.getHeight() - 1, yPos + h / 2));\r\n    \r\n    \r\n    \r\n    \r\n                    detections.add(new Recognition(&quot;&quot; + offset, labels.get(detectedClass),\r\n    \r\n    \r\n                            confidenceInClass, rect, detectedClass));}\r\n\r\nMultiTracker2.java part of draw\r\n\r\n      public synchronized void draw(final Canvas canvas,float kayabi,float kayabla ) {\r\n        \r\n        final boolean rotated = sensorOrientation % 180 == 90;\r\n        final float multiplier =\r\n                Math.min(\r\n                        canvas.getHeight() / (float) (rotated ? frameWidth : frameHeight),\r\n                        canvas.getWidth() / (float) (rotated ? frameHeight : frameWidth));\r\n        frameToCanvasMatrix =\r\n                ImageUtils.getTransformationMatrix(\r\n                        frameWidth,\r\n                        frameHeight,\r\n                        (int) (multiplier * (rotated ? frameHeight : frameWidth)),\r\n                        (int) (multiplier * (rotated ? frameWidth : frameHeight)),\r\n                        sensorOrientation,\r\n                        false);\r\n        for (final TrackedRecognition recognition : trackedObjects) {\r\n    \r\n          final RectF trackedPos = new RectF(recognition.location);\r\n    \r\n    \r\n    \r\n    \r\n          getFrameToCanvasMatrix().mapRect(trackedPos);\r\n    \r\n    \r\n    \r\n          boxPaint.setColor(recognition.color);\r\n    \r\n          float cornerSize = Math.min(trackedPos.width(), trackedPos.height()) / 8.0f;\r\n    \r\n          canvas.drawRoundRect(trackedPos, cornerSize, cornerSize, boxPaint);\r\n    \r\n    \r\n          final String labelString =\r\n                  !TextUtils.isEmpty(recognition.title)\r\n                          ? String.format(&quot;%s %.2f&quot;, recognition.title, (100 * recognition.detectionConfidence))\r\n                          : String.format(&quot;%.2f&quot;, (100 * recognition.detectionConfidence));\r\n          //            borderedText.drawText(canvas, trackedPos.left + cornerSize, trackedPos.top,\r\n          // labelString);\r\n          borderedText.drawText(\r\n                  canvas, trackedPos.left + cornerSize, trackedPos.top, labelString + &quot;%&quot;, boxPaint);\r\n        }\r\n      }\r\n\r\n","link":"https://stackoverflow.com/questions/77372206/object-detective-shift-issue-on-andro%c4%b0d","title":"OBJECT DETECTIVE SHIFT ISSUE On ANDROİD","body":"<p>I used two yolov5 models. My first model detects the tray. In my second model, it finds food types.</p>\n<p>The size of the first model was 416, then I cropped it. I sent it to the second model. The size of my second model is 224. my question: There is a shift in the second model.</p>\n<p>I think, The reason for the shift problem is crop . It detective the food in the cropped image. Draws the result for the original image. It should change according to the center of the tray.  I understand the problem, but I didn't understand how to change it.\n<a href=\"https://i.stack.imgur.com/QYFz9.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QYFz9.jpg\" alt=\"Table\" /></a>\nI created a table in debug mode. I wrote the values.\nDo I need to increase xPos and yPos values when drawing? There are only location values in the MultiBoxerTracker file. bottom, left right, top. I'm so confused.</p>\n<pre><code>Yolov5Classifier2.java coordinate part\n    public ArrayList&lt;Recognition&gt; recognizeImage2(Bitmap bitmap) {\n  final float xPos = out[0][i][0];\n                final float yPos = out[0][i][1];\n\n                final float w = out[0][i][2];\n                final float h = out[0][i][3];\n                Log.d(&quot;secondyolov5&quot;,\n                        Float.toString(xPos) + ',' + yPos + ',' + w + ',' + h);\n                final RectF rect =\n                        new RectF( Math.max(0, xPos - w / 2),\n                                Math.max(0, yPos - h / 2),\n                                Math.min(bitmap.getWidth() - 1, xPos + w / 2),\n                                Math.min(bitmap.getHeight() - 1, yPos + h / 2));\n\n\n\n\n                detections.add(new Recognition(&quot;&quot; + offset, labels.get(detectedClass),\n\n\n                        confidenceInClass, rect, detectedClass));}\n</code></pre>\n<p>MultiTracker2.java part of draw</p>\n<pre><code>  public synchronized void draw(final Canvas canvas,float kayabi,float kayabla ) {\n    \n    final boolean rotated = sensorOrientation % 180 == 90;\n    final float multiplier =\n            Math.min(\n                    canvas.getHeight() / (float) (rotated ? frameWidth : frameHeight),\n                    canvas.getWidth() / (float) (rotated ? frameHeight : frameWidth));\n    frameToCanvasMatrix =\n            ImageUtils.getTransformationMatrix(\n                    frameWidth,\n                    frameHeight,\n                    (int) (multiplier * (rotated ? frameHeight : frameWidth)),\n                    (int) (multiplier * (rotated ? frameWidth : frameHeight)),\n                    sensorOrientation,\n                    false);\n    for (final TrackedRecognition recognition : trackedObjects) {\n\n      final RectF trackedPos = new RectF(recognition.location);\n\n\n\n\n      getFrameToCanvasMatrix().mapRect(trackedPos);\n\n\n\n      boxPaint.setColor(recognition.color);\n\n      float cornerSize = Math.min(trackedPos.width(), trackedPos.height()) / 8.0f;\n\n      canvas.drawRoundRect(trackedPos, cornerSize, cornerSize, boxPaint);\n\n\n      final String labelString =\n              !TextUtils.isEmpty(recognition.title)\n                      ? String.format(&quot;%s %.2f&quot;, recognition.title, (100 * recognition.detectionConfidence))\n                      : String.format(&quot;%.2f&quot;, (100 * recognition.detectionConfidence));\n      //            borderedText.drawText(canvas, trackedPos.left + cornerSize, trackedPos.top,\n      // labelString);\n      borderedText.drawText(\n              canvas, trackedPos.left + cornerSize, trackedPos.top, labelString + &quot;%&quot;, boxPaint);\n    }\n  }\n</code></pre>\n"},{"tags":["java","spring","asynchronous","spring-webflux"],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1700216004,"post_id":77500675,"comment_id":136629687,"body_markdown":"This does not address the issue that 202 not posted before processing and I am still gettting timeout error.","link":"https://stackoverflow.com/questions/77500130/how-to-resolve-getting-timeout-java-lang-illegalstateexception-timeout-on-block/77500675#comment136629687_77500675","body":"This does not address the issue that 202 not posted before processing and I am still gettting timeout error."},{"score":0,"post_type":"answer","creation_date":1700234794,"post_id":77500675,"comment_id":136633036,"body_markdown":"You&#39;re right, you probably need to decouple the return value from the async processing. Because your method returns a `Mono`, the HTTP response is sent when the mono completes. Try returning `void` instead, and let the mono do its work in the background.","link":"https://stackoverflow.com/questions/77500130/how-to-resolve-getting-timeout-java-lang-illegalstateexception-timeout-on-block/77500675#comment136633036_77500675","body":"You&#39;re right, you probably need to decouple the return value from the async processing. Because your method returns a <code>Mono</code>, the HTTP response is sent when the mono completes. Try returning <code>void</code> instead, and let the mono do its work in the background."}],"comment_count":2,"score":0,"last_activity_date":1700214439,"creation_date":1700214439,"answer_id":77500675,"question_id":77500130,"body_markdown":"Just because you use `fromCallable` doesn&#39;t mean that `Callable` gets executed asynchronously. Use `fromFuture` instead:\r\n\r\n```\r\nreturn Mono.fromFuture(CompletableFuture.runAsyc(() -&gt; sendBatchRequest(request)))\r\n        .subscribeOn(Schedulers.boundedElastic());\r\n```\r\nYou can provide an `Executor` (or `ExecutorService`) to `runAsync` instead of using a common fork-join pool if needed.","link":"https://stackoverflow.com/questions/77500130/how-to-resolve-getting-timeout-java-lang-illegalstateexception-timeout-on-block/77500675#77500675","title":"How to resolve getting Timeout java.lang.IllegalStateException: Timeout on blocking read for 5000000000 NANOSECONDS","body":"<p>Just because you use <code>fromCallable</code> doesn't mean that <code>Callable</code> gets executed asynchronously. Use <code>fromFuture</code> instead:</p>\n<pre><code>return Mono.fromFuture(CompletableFuture.runAsyc(() -&gt; sendBatchRequest(request)))\n        .subscribeOn(Schedulers.boundedElastic());\n</code></pre>\n<p>You can provide an <code>Executor</code> (or <code>ExecutorService</code>) to <code>runAsync</code> instead of using a common fork-join pool if needed.</p>\n"},{"comment_count":0,"score":0,"last_activity_date":1701633592,"creation_date":1701633592,"answer_id":77595964,"question_id":77500130,"body_markdown":"To address the issue of the HTTP 202, modify your method to return `void` and let the asynchronous processing happen in the background.","link":"https://stackoverflow.com/questions/77500130/how-to-resolve-getting-timeout-java-lang-illegalstateexception-timeout-on-block/77595964#77595964","title":"How to resolve getting Timeout java.lang.IllegalStateException: Timeout on blocking read for 5000000000 NANOSECONDS","body":"<p>To address the issue of the HTTP 202, modify your method to return <code>void</code> and let the asynchronous processing happen in the background.</p>\n"}],"comment_count":0,"is_answered":false,"view_count":68,"answer_count":2,"score":-1,"last_activity_date":1701633592,"creation_date":1700208529,"question_id":77500130,"body_markdown":"I want to write a async api that return 202 Accepted after getting a request. Then after that it should send n Post request per second for halt-time seconds. This is my attempt at the problem.\r\n\r\n    @PostMapping(value = &quot;/stress&quot;)\r\n    @ResponseStatus(HttpStatus.ACCEPTED)\r\n    private Mono&lt;?&gt; stressPostLog(@RequestBody StressTest request) throws InterruptedException {\r\n        return Mono.fromCallable(() -&gt; {\r\n                sendBatchRequest(request);\r\n                return null;\r\n        }).subscribeOn(Schedulers.boundedElastic());\r\n        \r\n    }\r\n\r\n    private void sendBatchRequest(StressTest requestParams) throws InterruptedException {\r\n        successfulRequest.set(0);\r\n\r\n        long haltTimeMillis = requestParams.getHalt_time() * 1000;\r\n        log.info(&quot;Halt Time Millis = &quot; + haltTimeMillis );\r\n        Integer count = 0;\r\n\r\n        long initTime = System.currentTimeMillis();\r\n        long currTime;\r\n        do {\r\n            Thread.sleep(1000); //! Sleep time is subjected to system\r\n            for(int i = 0; i &lt; requestParams.getRequest_per_second(); i++)\r\n            {\r\n                AuditSchema request = AuditSchema.generateRandomValue(requestParams.getRequest_size());\r\n                Mono&lt;?&gt; response = postAndIncrement(request);\r\n                response.publishOn(Schedulers.boundedElastic()).subscribe();\r\n                count++;\r\n            }\r\n            currTime = System.currentTimeMillis();\r\n            log.info(&quot;Time duration = &quot; + ( currTime - initTime));\r\n        }while((currTime - initTime) &lt; haltTimeMillis);\r\n\r\n        log.info(&quot;Request Send = {} and Response Succeed = {}&quot;, count, successfulRequest);\r\n    }\r\n\r\n    private Mono&lt;?&gt; postAndIncrement(AuditSchema request) {\r\n        return this.client.post()\r\n                .uri(&quot;v1/log&quot;)\r\n                .body(BodyInserters.fromValue(request))\r\n                .accept(MediaType.APPLICATION_JSON)\r\n                .exchangeToMono(clientResponse -&gt; {\r\n                    log.info(&quot;Request suceeded {}&quot;, clientResponse.statusCode());\r\n                    successfulRequest.getAndIncrement();\r\n                    return Mono.empty();\r\n                });\r\n    }\r\n\r\nhowever the calls are not executed async and after 5s it gets terminated by error\r\n\r\n    java.lang.IllegalStateException: Timeout on blocking read for 5000000000 NANOSECONDS\r\n\r\nHow to write this using spring webflux.\r\n\r\n\r\n\r\n","link":"https://stackoverflow.com/questions/77500130/how-to-resolve-getting-timeout-java-lang-illegalstateexception-timeout-on-block","title":"How to resolve getting Timeout java.lang.IllegalStateException: Timeout on blocking read for 5000000000 NANOSECONDS","body":"<p>I want to write a async api that return 202 Accepted after getting a request. Then after that it should send n Post request per second for halt-time seconds. This is my attempt at the problem.</p>\n<pre><code>@PostMapping(value = &quot;/stress&quot;)\n@ResponseStatus(HttpStatus.ACCEPTED)\nprivate Mono&lt;?&gt; stressPostLog(@RequestBody StressTest request) throws InterruptedException {\n    return Mono.fromCallable(() -&gt; {\n            sendBatchRequest(request);\n            return null;\n    }).subscribeOn(Schedulers.boundedElastic());\n    \n}\n\nprivate void sendBatchRequest(StressTest requestParams) throws InterruptedException {\n    successfulRequest.set(0);\n\n    long haltTimeMillis = requestParams.getHalt_time() * 1000;\n    log.info(&quot;Halt Time Millis = &quot; + haltTimeMillis );\n    Integer count = 0;\n\n    long initTime = System.currentTimeMillis();\n    long currTime;\n    do {\n        Thread.sleep(1000); //! Sleep time is subjected to system\n        for(int i = 0; i &lt; requestParams.getRequest_per_second(); i++)\n        {\n            AuditSchema request = AuditSchema.generateRandomValue(requestParams.getRequest_size());\n            Mono&lt;?&gt; response = postAndIncrement(request);\n            response.publishOn(Schedulers.boundedElastic()).subscribe();\n            count++;\n        }\n        currTime = System.currentTimeMillis();\n        log.info(&quot;Time duration = &quot; + ( currTime - initTime));\n    }while((currTime - initTime) &lt; haltTimeMillis);\n\n    log.info(&quot;Request Send = {} and Response Succeed = {}&quot;, count, successfulRequest);\n}\n\nprivate Mono&lt;?&gt; postAndIncrement(AuditSchema request) {\n    return this.client.post()\n            .uri(&quot;v1/log&quot;)\n            .body(BodyInserters.fromValue(request))\n            .accept(MediaType.APPLICATION_JSON)\n            .exchangeToMono(clientResponse -&gt; {\n                log.info(&quot;Request suceeded {}&quot;, clientResponse.statusCode());\n                successfulRequest.getAndIncrement();\n                return Mono.empty();\n            });\n}\n</code></pre>\n<p>however the calls are not executed async and after 5s it gets terminated by error</p>\n<pre><code>java.lang.IllegalStateException: Timeout on blocking read for 5000000000 NANOSECONDS\n</code></pre>\n<p>How to write this using spring webflux.</p>\n"},{"tags":["java","spring-boot","swagger","openapi"],"comments":[{"score":1,"post_type":"question","creation_date":1701417516,"post_id":77582180,"comment_id":136775444,"body_markdown":"The model parameter in the controller method needs to be annotated with `@Valid` so that the `@javax.annotation.Nonnull` is validated, or maybe you&#39;re using Spring Boot 3, which only supports `@jakarta.annotation.Nonnull` instead.","link":"https://stackoverflow.com/questions/77582180/how-to-reject-null-values-in-swagger#comment136775444_77582180","body":"The model parameter in the controller method needs to be annotated with <code>@Valid</code> so that the <code>@javax.annotation.Nonnull</code> is validated, or maybe you&#39;re using Spring Boot 3, which only supports <code>@jakarta.annotation.Nonnull</code> instead."},{"score":0,"post_type":"question","creation_date":1701464478,"post_id":77582180,"comment_id":136783306,"body_markdown":"Annotated request body with `@javax.validation.Valid` as suggested. This was in addition to having the controller class annotated with `@org.springframework.validation.annotation.Validated` already. It made no difference; still let the null values for colour pass through. We are using Spring Boot 2.7.12","link":"https://stackoverflow.com/questions/77582180/how-to-reject-null-values-in-swagger#comment136783306_77582180","body":"Annotated request body with <code>@javax.validation.Valid</code> as suggested. This was in addition to having the controller class annotated with <code>@org.springframework.validation.annotation.Validated</code> already. It made no difference; still let the null values for colour pass through. We are using Spring Boot 2.7.12"},{"score":0,"post_type":"question","creation_date":1701511233,"post_id":77582180,"comment_id":136786718,"body_markdown":"Then please edit your question and include the controller.","link":"https://stackoverflow.com/questions/77582180/how-to-reject-null-values-in-swagger#comment136786718_77582180","body":"Then please edit your question and include the controller."}],"comment_count":3,"is_answered":false,"view_count":48,"answer_count":0,"score":0,"last_activity_date":1701631688,"creation_date":1701385957,"last_edit_date":1701631688,"question_id":77582180,"body_markdown":"We are implementing an application which exposes an API that has the interface described by an `api.swagger.yaml` file. We build our application with Gradle and part of the build process we parse the `api.swagger.yaml` file and generate the classes modelling the request response classes. For this we use the `org.openapitools:openapi-generator-gradle-plugin:6.6.0` Gradle plugin. The Gradle task that does this is configured like below:\r\n\r\n```groovy\r\n//https://github.com/OpenAPITools/openapi-generator/tree/master/modules/openapi-generator-gradle-plugin\r\ntask buildApiModel(type: org.openapitools.generator.gradle.plugin.tasks.GenerateTask) {\r\n    generatorName = &quot;java&quot;\r\n    library = &quot;webclient&quot;\r\n    inputSpec = &quot;$rootDir/src/main/resources/swagger/v3/api.swagger.yaml&quot;.toString()\r\n    outputDir = &quot;$buildDir/myapp-generated-api/&quot;.toString()\r\n    modelPackage = &quot;com.my.comp.myapp.api.dto&quot;\r\n    generateModelTests = false\r\n    generateApiTests = false\r\n    skipValidateSpec = true\r\n    configOptions = [\r\n            java11                        : &quot;true&quot;,\r\n            dateLibrary                   : &quot;java11&quot;,\r\n            interfaceOnly                 : &quot;true&quot;,\r\n            additionalModelTypeAnnotations: &quot;@lombok.experimental.SuperBuilder @lombok.AllArgsConstructor @JsonInclude(JsonInclude.Include.NON_NULL)&quot;\r\n    ]\r\n```\r\n\r\nIn our Swagger we define the request which is a complex structure with some embedded structures, say one of them is called `trafficMap` which in turn has a property called `semaphore` which in turn has a **required** property called `colour` which colour property can only have three values: `green`, `yellow` and `red`. It is a requirement that colour property is always passed and cannot be null. In our Swagger file this will look like this:\r\n\r\n```yaml\r\ntrafficMap:\r\n  title: ...\r\n  description: ...\r\n  type: object\r\n  properties:\r\n    semaphore:\r\n      description: ...\r\n      type: object\r\n      properties:\r\n        colour:\r\n          description: ...\r\n          type: string\r\n          enum:\r\n            - GREEN\r\n            - YELLOW\r\n            - RED\r\n      required:\r\n        - colour\r\n```\r\n\r\nWith the above, the generated Semaphore class will have these annotations regarding the colour property:\r\n\r\n```java\r\npublic class Semaphore {\r\n    public enum ColourEnum {\r\n        GREEN(&quot;GREN&quot;),\r\n        YELLOW(&quot;YELLOW&quot;),\r\n        RED(&quot;RED&quot;);\r\n\r\n        private String value;\r\n        \r\n        ColourEnum(String value) {\r\n            this.value = value;\r\n        }\r\n        \r\n        @JsonValue\r\n        public String getValue() {\r\n            return value;\r\n        }\r\n        \r\n        @JsonCreator\r\n        public static ColourEnum fromValue(String value) {\r\n            for (ColourEnum b : ColourEnum.values()) {\r\n                if (b.value.equals(value)) {\r\n                   return b;\r\n                }\r\n            }\r\n            throw new IllegalArgumentException(&quot;Unexpected value &#39;&quot; + value + &quot;&#39;&quot;);\r\n        }\r\n              \r\n     public Semaphore() {\r\n     }\r\n     \r\n     public Semaphore colour(ColourEnum colour) {\r\n        this.colour = colour;\r\n        return this;\r\n     }\r\n     \r\n     @javax.annotation.Nonnull\r\n     @JsonProperty(JSON_PROPERTY_COLOUR)\r\n     @JsonInclude(value = JsonInclude.Include.ALWAYS)\r\n     public ColourEnum getColour() {\r\n         return colour;\r\n     }\r\n\r\n     @JsonProperty(JSON_PROPERTY_COLOUR)\r\n     @JsonInclude(value = JsonInclude.Include.ALWAYS)\r\n     public void setColour(ColourEnum colour) {\r\n         this.colour = colour;\r\n     }\r\n     // ... The rest of the generated Semaphore class\r\n}\r\n```\r\n\r\nWhen sending the request and setting the colour property to `BLUE` the request gets rejected as it should with a message `Invalid semaphore.colour` in the response body.\r\n\r\nHowever, if we pass a null value for colour or we miss the colour entirely from the request, we don&#39;t get a rejection and the request hits the controller instead. We would like the generated code to do this validation for us as opposed to implementing extra validation on the service side.\r\n\r\nWe thought the reason for this behaviour was the this annotation in the generated code: `@JsonInclude(value = JsonInclude.Include.ALWAYS)` which from JsonInclude documentation could cause accepting any value including null.\r\n\r\n```java\r\npublic enum Include\r\n{\r\n    /**\r\n     * Value that indicates that property is to be always included,\r\n     * independent of value of the property.\r\n     */\r\n    ALWAYS,\r\n\r\n    /**\r\n     * Value that indicates that only properties with non-null\r\n     * values are to be included.\r\n     */\r\n    NON_NULL,\r\n```\r\n \r\nSo the natural thing that came to our mind was to try to replace the `JsonInclude.Include.ALWAYS` with `JsonInclude.Include.NON_NULL`. To do this we added these two `x` attributes in the `api.swagger.yaml` for the `colour` property \r\n\r\n```yaml\r\ncolour:\r\n  description: ...\r\n  type: string\r\n  x-setter-annotation: &quot;@JsonInclude(JsonInclude.Include.NON_NULL)&quot;\r\n  x-field-extra-annotation: &quot;@JsonInclude(JsonInclude.Include.NON_NULL)&quot;\r\n  enum:\r\n  ....\r\n```\r\n\r\nThe only difference in the generated code that we noticed was that `Colour` field of the `Semaphore` class was now annotated with `NON_NULL` but the getter and setter methods still had the `ALWAYS` JsonInclude and the app still does not reject the null values for colour.\r\n\r\n```java\r\n@JsonInclude(JsonInclude.Include.NON_NULL)\r\nprivate ColourEnum colour;\r\n```\r\n\r\n```java\r\n@RestController\r\n@RequestMapping(value = &quot;/v3/some&quot;)\r\n@Validated\r\npublic void StuffController {\r\n    @PostMapping(value = &quot;/stuff&quot;, consumes = APPLICATION_JSON_VALUE, produces = APPLICATION_JSON_VALUE)\r\n    public ResponseEntity&lt;CreateStuffResponse&gt; createStuff(\r\n        @RequestBody @Valid Payee request, @RequestHeader HttpHeaders httpHeaders) throws Exception {\r\n    ...\r\n    }\r\n}\r\n```\r\n\r\nHow can we configure our swagger to generate code that would reject the request if a null value is passed for colour?","link":"https://stackoverflow.com/questions/77582180/how-to-reject-null-values-in-swagger","title":"How to reject null values in Swagger","body":"<p>We are implementing an application which exposes an API that has the interface described by an <code>api.swagger.yaml</code> file. We build our application with Gradle and part of the build process we parse the <code>api.swagger.yaml</code> file and generate the classes modelling the request response classes. For this we use the <code>org.openapitools:openapi-generator-gradle-plugin:6.6.0</code> Gradle plugin. The Gradle task that does this is configured like below:</p>\n<pre><code>//https://github.com/OpenAPITools/openapi-generator/tree/master/modules/openapi-generator-gradle-plugin\ntask buildApiModel(type: org.openapitools.generator.gradle.plugin.tasks.GenerateTask) {\n    generatorName = &quot;java&quot;\n    library = &quot;webclient&quot;\n    inputSpec = &quot;$rootDir/src/main/resources/swagger/v3/api.swagger.yaml&quot;.toString()\n    outputDir = &quot;$buildDir/myapp-generated-api/&quot;.toString()\n    modelPackage = &quot;com.my.comp.myapp.api.dto&quot;\n    generateModelTests = false\n    generateApiTests = false\n    skipValidateSpec = true\n    configOptions = [\n            java11                        : &quot;true&quot;,\n            dateLibrary                   : &quot;java11&quot;,\n            interfaceOnly                 : &quot;true&quot;,\n            additionalModelTypeAnnotations: &quot;@lombok.experimental.SuperBuilder @lombok.AllArgsConstructor @JsonInclude(JsonInclude.Include.NON_NULL)&quot;\n    ]\n</code></pre>\n<p>In our Swagger we define the request which is a complex structure with some embedded structures, say one of them is called <code>trafficMap</code> which in turn has a property called <code>semaphore</code> which in turn has a <strong>required</strong> property called <code>colour</code> which colour property can only have three values: <code>green</code>, <code>yellow</code> and <code>red</code>. It is a requirement that colour property is always passed and cannot be null. In our Swagger file this will look like this:</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>trafficMap:\n  title: ...\n  description: ...\n  type: object\n  properties:\n    semaphore:\n      description: ...\n      type: object\n      properties:\n        colour:\n          description: ...\n          type: string\n          enum:\n            - GREEN\n            - YELLOW\n            - RED\n      required:\n        - colour\n</code></pre>\n<p>With the above, the generated Semaphore class will have these annotations regarding the colour property:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Semaphore {\n    public enum ColourEnum {\n        GREEN(&quot;GREN&quot;),\n        YELLOW(&quot;YELLOW&quot;),\n        RED(&quot;RED&quot;);\n\n        private String value;\n        \n        ColourEnum(String value) {\n            this.value = value;\n        }\n        \n        @JsonValue\n        public String getValue() {\n            return value;\n        }\n        \n        @JsonCreator\n        public static ColourEnum fromValue(String value) {\n            for (ColourEnum b : ColourEnum.values()) {\n                if (b.value.equals(value)) {\n                   return b;\n                }\n            }\n            throw new IllegalArgumentException(&quot;Unexpected value '&quot; + value + &quot;'&quot;);\n        }\n              \n     public Semaphore() {\n     }\n     \n     public Semaphore colour(ColourEnum colour) {\n        this.colour = colour;\n        return this;\n     }\n     \n     @javax.annotation.Nonnull\n     @JsonProperty(JSON_PROPERTY_COLOUR)\n     @JsonInclude(value = JsonInclude.Include.ALWAYS)\n     public ColourEnum getColour() {\n         return colour;\n     }\n\n     @JsonProperty(JSON_PROPERTY_COLOUR)\n     @JsonInclude(value = JsonInclude.Include.ALWAYS)\n     public void setColour(ColourEnum colour) {\n         this.colour = colour;\n     }\n     // ... The rest of the generated Semaphore class\n}\n</code></pre>\n<p>When sending the request and setting the colour property to <code>BLUE</code> the request gets rejected as it should with a message <code>Invalid semaphore.colour</code> in the response body.</p>\n<p>However, if we pass a null value for colour or we miss the colour entirely from the request, we don't get a rejection and the request hits the controller instead. We would like the generated code to do this validation for us as opposed to implementing extra validation on the service side.</p>\n<p>We thought the reason for this behaviour was the this annotation in the generated code: <code>@JsonInclude(value = JsonInclude.Include.ALWAYS)</code> which from JsonInclude documentation could cause accepting any value including null.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public enum Include\n{\n    /**\n     * Value that indicates that property is to be always included,\n     * independent of value of the property.\n     */\n    ALWAYS,\n\n    /**\n     * Value that indicates that only properties with non-null\n     * values are to be included.\n     */\n    NON_NULL,\n</code></pre>\n<p>So the natural thing that came to our mind was to try to replace the <code>JsonInclude.Include.ALWAYS</code> with <code>JsonInclude.Include.NON_NULL</code>. To do this we added these two <code>x</code> attributes in the <code>api.swagger.yaml</code> for the <code>colour</code> property</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>colour:\n  description: ...\n  type: string\n  x-setter-annotation: &quot;@JsonInclude(JsonInclude.Include.NON_NULL)&quot;\n  x-field-extra-annotation: &quot;@JsonInclude(JsonInclude.Include.NON_NULL)&quot;\n  enum:\n  ....\n</code></pre>\n<p>The only difference in the generated code that we noticed was that <code>Colour</code> field of the <code>Semaphore</code> class was now annotated with <code>NON_NULL</code> but the getter and setter methods still had the <code>ALWAYS</code> JsonInclude and the app still does not reject the null values for colour.</p>\n<pre class=\"lang-java prettyprint-override\"><code>@JsonInclude(JsonInclude.Include.NON_NULL)\nprivate ColourEnum colour;\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>@RestController\n@RequestMapping(value = &quot;/v3/some&quot;)\n@Validated\npublic void StuffController {\n    @PostMapping(value = &quot;/stuff&quot;, consumes = APPLICATION_JSON_VALUE, produces = APPLICATION_JSON_VALUE)\n    public ResponseEntity&lt;CreateStuffResponse&gt; createStuff(\n        @RequestBody @Valid Payee request, @RequestHeader HttpHeaders httpHeaders) throws Exception {\n    ...\n    }\n}\n</code></pre>\n<p>How can we configure our swagger to generate code that would reject the request if a null value is passed for colour?</p>\n"},{"tags":["java","spring-boot","multithreading","rest"],"comments":[{"score":1,"post_type":"question","creation_date":1701093895,"post_id":77557399,"comment_id":136728622,"body_markdown":"As the background thread progresses, it will need to occasionally update a thread safe variable that is accessible externally from the thread.  The simplest approach would be for the Map to include the variable (such as an `AtomicInteger`) as part of the Map value.  The variable is injected into  `SimpleTask`, and the variable is updated on each iteration of the loop.  A request to get the task progress returns the variable value.","link":"https://stackoverflow.com/questions/77557399/how-to-send-a-dynamic-response-from-a-taskexecutor-with-a-rest-api-in-a-spring-b#comment136728622_77557399","body":"As the background thread progresses, it will need to occasionally update a thread safe variable that is accessible externally from the thread.  The simplest approach would be for the Map to include the variable (such as an <code>AtomicInteger</code>) as part of the Map value.  The variable is injected into  <code>SimpleTask</code>, and the variable is updated on each iteration of the loop.  A request to get the task progress returns the variable value."},{"score":0,"post_type":"question","creation_date":1701095164,"post_id":77557399,"comment_id":136728887,"body_markdown":"@AndrewS So, instead of `Map&lt;String, Future&lt;?&gt;&gt;` to have `Map&lt;String, AtomicInteger&gt;`, right? But I need to keep the future because I need to have the option to cancel a task and I do that based on the future.","link":"https://stackoverflow.com/questions/77557399/how-to-send-a-dynamic-response-from-a-taskexecutor-with-a-rest-api-in-a-spring-b#comment136728887_77557399","body":"@AndrewS So, instead of <code>Map&lt;String, Future&lt;?&gt;&gt;</code> to have <code>Map&lt;String, AtomicInteger&gt;</code>, right? But I need to keep the future because I need to have the option to cancel a task and I do that based on the future."},{"score":1,"post_type":"question","creation_date":1701097332,"post_id":77557399,"comment_id":136729380,"body_markdown":"The Map value could be a composite that holds the `Future` and the `AomticInteger`.","link":"https://stackoverflow.com/questions/77557399/how-to-send-a-dynamic-response-from-a-taskexecutor-with-a-rest-api-in-a-spring-b#comment136729380_77557399","body":"The Map value could be a composite that holds the <code>Future</code> and the <code>AomticInteger</code>."},{"score":0,"post_type":"question","creation_date":1701098767,"post_id":77557399,"comment_id":136729753,"body_markdown":"Can I do that with only one request /execute to execute the task and get the progress or should I have 2 API, /execute to execute the task, and another one /get-progress to show the progress at a specific time?","link":"https://stackoverflow.com/questions/77557399/how-to-send-a-dynamic-response-from-a-taskexecutor-with-a-rest-api-in-a-spring-b#comment136729753_77557399","body":"Can I do that with only one request /execute to execute the task and get the progress or should I have 2 API, /execute to execute the task, and another one /get-progress to show the progress at a specific time?"},{"score":1,"post_type":"question","creation_date":1701099324,"post_id":77557399,"comment_id":136729897,"body_markdown":"Separate requests - one to start the long running task (which returns the task ID), and another to get the progress (or result when ready) based on the task ID.  The client periodically make a REST call (polling) to get the progress.  The question was about RESTful, but alternatively, the service could publish a message with the progress/result, and the client subscribes to the message (pub/sub).","link":"https://stackoverflow.com/questions/77557399/how-to-send-a-dynamic-response-from-a-taskexecutor-with-a-rest-api-in-a-spring-b#comment136729897_77557399","body":"Separate requests - one to start the long running task (which returns the task ID), and another to get the progress (or result when ready) based on the task ID.  The client periodically make a REST call (polling) to get the progress.  The question was about RESTful, but alternatively, the service could publish a message with the progress/result, and the client subscribes to the message (pub/sub)."}],"comment_count":5,"is_answered":false,"view_count":43,"answer_count":0,"score":0,"last_activity_date":1701617876,"creation_date":1701092850,"last_edit_date":1701617876,"question_id":77557399,"body_markdown":"I want to create a REST API in a Spring Boot project. The business logic is very simple like a counter that need to increase at every 10 seconds until it hits 5 minutes. This will be the task for a TaskExecutor. Until now everything is ok, but I need to show this progress to the client. So the REST API should send this progress as a response. \r\n\r\nI will do something like that:\r\n\r\n\r\nSo the client should receive 10 seconds, 20 seconds, ... until 5 minutes. But how can I send this dynamic response with a REST API? Can I do that on the /execute REST API that execute the task and get that progress or should I have 2 REST API, one /execute and another /get-progress? Thank you!\r\n\r\n\r\n","link":"https://stackoverflow.com/questions/77557399/how-to-send-a-dynamic-response-from-a-taskexecutor-with-a-rest-api-in-a-spring-b","title":"How to send a dynamic response from a TaskExecutor with a REST API in a Spring Boot project?","body":"<p>I want to create a REST API in a Spring Boot project. The business logic is very simple like a counter that need to increase at every 10 seconds until it hits 5 minutes. This will be the task for a TaskExecutor. Until now everything is ok, but I need to show this progress to the client. So the REST API should send this progress as a response.</p>\n<p>I will do something like that:</p>\n<p>So the client should receive 10 seconds, 20 seconds, ... until 5 minutes. But how can I send this dynamic response with a REST API? Can I do that on the /execute REST API that execute the task and get that progress or should I have 2 REST API, one /execute and another /get-progress? Thank you!</p>\n"},{"tags":["java","spring-boot","azure","azure-sql-database","jdbctemplate"],"comments":[{"score":0,"post_type":"question","creation_date":1699785161,"post_id":77468561,"comment_id":136572684,"body_markdown":"I&#39;d say that `tcp:` in your host name should be removed.","link":"https://stackoverflow.com/questions/77468561/connect-spring-boot-jdbctemplate-to-azure-sql-issues-with-connection-string-and#comment136572684_77468561","body":"I&#39;d say that <code>tcp:</code> in your host name should be removed."},{"score":1,"post_type":"question","creation_date":1699785365,"post_id":77468561,"comment_id":136572702,"body_markdown":"I read https://learn.microsoft.com/en-us/azure/azure-sql/database/connect-query-java?view=azuresql","link":"https://stackoverflow.com/questions/77468561/connect-spring-boot-jdbctemplate-to-azure-sql-issues-with-connection-string-and#comment136572702_77468561","body":"I read <a href=\"https://learn.microsoft.com/en-us/azure/azure-sql/database/connect-query-java?view=azuresql\" rel=\"nofollow noreferrer\">learn.microsoft.com/en-us/azure/azure-sql/database/&hellip;</a>"},{"score":0,"post_type":"question","creation_date":1699785527,"post_id":77468561,"comment_id":136572716,"body_markdown":"It gives the start of the JDBC URL as `jdbc:sqlserver://$AZ_DATABASE_NAME.database.windows.net:1433;` so it&#39;s clear that there&#39;s no `tcp:` in it.","link":"https://stackoverflow.com/questions/77468561/connect-spring-boot-jdbctemplate-to-azure-sql-issues-with-connection-string-and#comment136572716_77468561","body":"It gives the start of the JDBC URL as <code>jdbc:sqlserver:&#47;&#47;$AZ_DATABASE_NAME.database.windows.net:1433&zwnj;&#8203;;</code> so it&#39;s clear that there&#39;s no <code>tcp:</code> in it."},{"score":0,"post_type":"question","creation_date":1700179854,"post_id":77468561,"comment_id":136626116,"body_markdown":"@tgdavies feel free to write answer, and I can send points, thanks –","link":"https://stackoverflow.com/questions/77468561/connect-spring-boot-jdbctemplate-to-azure-sql-issues-with-connection-string-and#comment136626116_77468561","body":"@tgdavies feel free to write answer, and I can send points, thanks –"}],"answers":[{"comment_count":0,"score":1,"last_activity_date":1701426434,"last_edit_date":1701426434,"creation_date":1701412891,"answer_id":77583408,"question_id":77468561,"body_markdown":"\r\n\r\n&gt; The TCP/IP connection to the host tcp:food-server.database.windows.net, port 1433 has failed. Error: &quot;tcp:food-server.database.windows.net. Verify the connection properties. Make sure that an instance of SQL Server is running on the host and accepting TCP/IP connections at the port. Make sure that TCP connections to the port are not blocked by a firewall.&quot;\r\n\r\nAs @tgdavies commented, the URL you have provided is not in the correct format, which may be the reason you are getting this error. &quot;**tcp: in your host name should be removed**&quot; in your URL.You can provide the URL in the following format:\r\n\r\n```java\r\nspring.datasource.url= jdbc:sqlserver://&lt;serverName&gt;.database.windows.net,1433;encrypt=true;trustServerCertificate=true;databaseName=&lt;databaseName&gt;\r\n```\r\nBy doing this, you should be able to connect to the database successfully. For more information, you can refer to the [MS Document](https://learn.microsoft.com/en-us/azure/azure-sql/database/connect-query-java?view=azuresql#prepare-a-configuration-file-to-connect-to-azure-sql-database) on how to prepare a configuration file to connect to Azure SQL database.","link":"https://stackoverflow.com/questions/77468561/connect-spring-boot-jdbctemplate-to-azure-sql-issues-with-connection-string-and/77583408#77583408","title":"Connect Spring Boot JDBCTemplate to Azure SQL, Issues with Connection String and TCP/IP","body":"<blockquote>\n<p>The TCP/IP connection to the host tcp:food-server.database.windows.net, port 1433 has failed. Error: &quot;tcp:food-server.database.windows.net. Verify the connection properties. Make sure that an instance of SQL Server is running on the host and accepting TCP/IP connections at the port. Make sure that TCP connections to the port are not blocked by a firewall.&quot;</p>\n</blockquote>\n<p>As @tgdavies commented, the URL you have provided is not in the correct format, which may be the reason you are getting this error. &quot;<strong>tcp: in your host name should be removed</strong>&quot; in your URL.You can provide the URL in the following format:</p>\n<pre class=\"lang-java prettyprint-override\"><code>spring.datasource.url= jdbc:sqlserver://&lt;serverName&gt;.database.windows.net,1433;encrypt=true;trustServerCertificate=true;databaseName=&lt;databaseName&gt;\n</code></pre>\n<p>By doing this, you should be able to connect to the database successfully. For more information, you can refer to the <a href=\"https://learn.microsoft.com/en-us/azure/azure-sql/database/connect-query-java?view=azuresql#prepare-a-configuration-file-to-connect-to-azure-sql-database\" rel=\"nofollow noreferrer\">MS Document</a> on how to prepare a configuration file to connect to Azure SQL database.</p>\n"}],"comment_count":4,"is_answered":true,"view_count":81,"answer_count":1,"score":1,"last_activity_date":1701611946,"creation_date":1699784860,"last_edit_date":1701611946,"question_id":77468561,"body_markdown":"I cannot seem to connect my Java Spring Boot Project to Azure SQL with JDBCTemplate. I keep getting errors, both through Autowired, with connection string, and Option 2) Setting Data Source manually. How can I resolve this issue?\r\nHowever, both options work with localhost sql database on my computer.\r\n\r\n&gt; Error: The TCP/IP connection to the host\r\n&gt; tcp:food-server.database.windows.net, port 1433 has failed.\r\n&gt; Error: &quot;tcp:food-server.database.windows.net. Verify the\r\n&gt; connection properties. Make sure that an instance of SQL Server is\r\n&gt; running on the host and accepting TCP/IP connections at the port. Make\r\n&gt; sure that TCP connections to the port are not blocked by a firewall.&quot;\r\n\r\nOption 1) `@Autowired` with connectionString in application.properties file, not working\r\n\r\n    spring.datasource.url= jdbc:sqlserver://tcp:food-server.database.windows.net,1433;encrypt=true;trustServerCertificate=true;databaseName=Test\r\n    spring.datasource.username=sauser\r\n    spring.datasource.password=password12345*\r\n\r\nOption 2) Configuration Beans with DataSource, currently not working either\r\n\r\n    @Configuration\r\n    public class ServerConfiguration {\r\n     \r\n        @Bean\r\n        public DataSource getDataSource() {\r\n            SQLServerDataSource ds = new SQLServerDataSource();\r\n            ds.setUser(&quot;sauser&quot;);\r\n            ds.setPassword(&quot;password12345*&quot;);\r\n            ds.setServerName(&quot;tcp:food-server.database.windows.net&quot;);\r\n            ds.setPortNumber(1433);\r\n            ds.setTrustServerCertificate(true);\r\n            ds.setDatabaseName(&quot;test&quot;);\r\n            return ds;\r\n        }\r\n    \r\n        @Bean\r\n        public NamedParameterJdbcTemplate namedParameterJdbcTemplate() {\r\n            return new NamedParameterJdbcTemplate(getDataSource());\r\n        }\r\n\r\n**Azure IP Security Settings:**\r\n\r\nI also made sure to allow my IP Address in Azure SQL Portal, database, Set Firewall\r\n\r\nhttps://learn.microsoft.com/en-us/azure/azure-sql/database/firewall-create-server-level-portal-quickstart?view=azuresql\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/vhocU.png","link":"https://stackoverflow.com/questions/77468561/connect-spring-boot-jdbctemplate-to-azure-sql-issues-with-connection-string-and","title":"Connect Spring Boot JDBCTemplate to Azure SQL, Issues with Connection String and TCP/IP","body":"<p>I cannot seem to connect my Java Spring Boot Project to Azure SQL with JDBCTemplate. I keep getting errors, both through Autowired, with connection string, and Option 2) Setting Data Source manually. How can I resolve this issue?\nHowever, both options work with localhost sql database on my computer.</p>\n<blockquote>\n<p>Error: The TCP/IP connection to the host\ntcp:food-server.database.windows.net, port 1433 has failed.\nError: &quot;tcp:food-server.database.windows.net. Verify the\nconnection properties. Make sure that an instance of SQL Server is\nrunning on the host and accepting TCP/IP connections at the port. Make\nsure that TCP connections to the port are not blocked by a firewall.&quot;</p>\n</blockquote>\n<p>Option 1) <code>@Autowired</code> with connectionString in application.properties file, not working</p>\n<pre><code>spring.datasource.url= jdbc:sqlserver://tcp:food-server.database.windows.net,1433;encrypt=true;trustServerCertificate=true;databaseName=Test\nspring.datasource.username=sauser\nspring.datasource.password=password12345*\n</code></pre>\n<p>Option 2) Configuration Beans with DataSource, currently not working either</p>\n<pre><code>@Configuration\npublic class ServerConfiguration {\n \n    @Bean\n    public DataSource getDataSource() {\n        SQLServerDataSource ds = new SQLServerDataSource();\n        ds.setUser(&quot;sauser&quot;);\n        ds.setPassword(&quot;password12345*&quot;);\n        ds.setServerName(&quot;tcp:food-server.database.windows.net&quot;);\n        ds.setPortNumber(1433);\n        ds.setTrustServerCertificate(true);\n        ds.setDatabaseName(&quot;test&quot;);\n        return ds;\n    }\n\n    @Bean\n    public NamedParameterJdbcTemplate namedParameterJdbcTemplate() {\n        return new NamedParameterJdbcTemplate(getDataSource());\n    }\n</code></pre>\n<p><strong>Azure IP Security Settings:</strong></p>\n<p>I also made sure to allow my IP Address in Azure SQL Portal, database, Set Firewall</p>\n<p><a href=\"https://learn.microsoft.com/en-us/azure/azure-sql/database/firewall-create-server-level-portal-quickstart?view=azuresql\" rel=\"nofollow noreferrer\">https://learn.microsoft.com/en-us/azure/azure-sql/database/firewall-create-server-level-portal-quickstart?view=azuresql</a></p>\n<p><a href=\"https://i.stack.imgur.com/vhocU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vhocU.png\" alt=\"enter image description here\" /></a></p>\n"},{"tags":["java"],"comments":[{"score":2,"post_type":"question","creation_date":1701329196,"post_id":77576564,"comment_id":136762731,"body_markdown":"Well, your `indices` array contains the value 10, and your arrays don&#39;t have such index. Hence the exception.","link":"https://stackoverflow.com/questions/77576564/array-index-out-of-bound-with-sort-comparator#comment136762731_77576564","body":"Well, your <code>indices</code> array contains the value 10, and your arrays don&#39;t have such index. Hence the exception."},{"score":0,"post_type":"question","creation_date":1701330215,"post_id":77576564,"comment_id":136762855,"body_markdown":"Thanks @Eran, unfortunately I am not allowed to change the values array since it is automatically provided by other class. Do you have any further suggestion.","link":"https://stackoverflow.com/questions/77576564/array-index-out-of-bound-with-sort-comparator#comment136762855_77576564","body":"Thanks @Eran, unfortunately I am not allowed to change the values array since it is automatically provided by other class. Do you have any further suggestion."},{"score":2,"post_type":"question","creation_date":1701330469,"post_id":77576564,"comment_id":136762888,"body_markdown":"I&#39;m not sure what you are trying to do, but if the `indices` array should contain array indices, perhaps you should initialize it with `indices[i] = values[i]-1;`. This way you are not changing the values array.","link":"https://stackoverflow.com/questions/77576564/array-index-out-of-bound-with-sort-comparator#comment136762888_77576564","body":"I&#39;m not sure what you are trying to do, but if the <code>indices</code> array should contain array indices, perhaps you should initialize it with <code>indices[i] = values[i]-1;</code>. This way you are not changing the values array."},{"score":0,"post_type":"question","creation_date":1701332591,"post_id":77576564,"comment_id":136763200,"body_markdown":"Thank you again @Eran. I am actually trying to sort the values array based on keys. I tried to store in indices[i]=i (same as values[i]-1) but that resulted in the null pointer exception. Also, I was not sure if by storing each indices[i]= i instead of values[i], will i be doing wrong sorting.","link":"https://stackoverflow.com/questions/77576564/array-index-out-of-bound-with-sort-comparator#comment136763200_77576564","body":"Thank you again @Eran. I am actually trying to sort the values array based on keys. I tried to store in indices[i]=i (same as values[i]-1) but that resulted in the null pointer exception. Also, I was not sure if by storing each indices[i]= i instead of values[i], will i be doing wrong sorting."},{"score":1,"post_type":"question","creation_date":1701332767,"post_id":77576564,"comment_id":136763218,"body_markdown":"What is the expected sorted array given the input arrays in your example?","link":"https://stackoverflow.com/questions/77576564/array-index-out-of-bound-with-sort-comparator#comment136763218_77576564","body":"What is the expected sorted array given the input arrays in your example?"},{"score":0,"post_type":"question","creation_date":1701333577,"post_id":77576564,"comment_id":136763319,"body_markdown":"thank you @Eran. For the given example, it should be {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}","link":"https://stackoverflow.com/questions/77576564/array-index-out-of-bound-with-sort-comparator#comment136763319_77576564","body":"thank you @Eran. For the given example, it should be {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}"},{"score":1,"post_type":"question","creation_date":1701334394,"post_id":77576564,"comment_id":136763440,"body_markdown":"So the sort should do nothing in your example? It&#39;s hard to understand the desired logic in this case.","link":"https://stackoverflow.com/questions/77576564/array-index-out-of-bound-with-sort-comparator#comment136763440_77576564","body":"So the sort should do nothing in your example? It&#39;s hard to understand the desired logic in this case."},{"score":0,"post_type":"question","creation_date":1701335882,"post_id":77576564,"comment_id":136763704,"body_markdown":"thank you @Eran, i will try once again and if I find solution will post it here. have a nice day!","link":"https://stackoverflow.com/questions/77576564/array-index-out-of-bound-with-sort-comparator#comment136763704_77576564","body":"thank you @Eran, i will try once again and if I find solution will post it here. have a nice day!"}],"comment_count":8,"is_answered":false,"view_count":46,"answer_count":0,"score":-1,"last_activity_date":1701611847,"creation_date":1701328916,"last_edit_date":1701611847,"question_id":77576564,"body_markdown":"I would truly appreciate any help in solving following exception. In particular, I keep running into array index out of bound exception at index 10. The `values` and `keys1` and `keys2` arrays cannot be changed as they are provided by another program.\r\n\r\nThis is my `IntegerComparator` class:\r\n```java\r\nimport java.util.Arrays;\r\nimport java.util.Comparator;\r\n\r\nclass IntegerComparator implements Comparator&lt;Integer&gt; {\r\n    private int[] keys1;\r\n    private int[] keys2;\r\n\r\n    public IntegerComparator(int[] keys1, int[] keys2) {\r\n        this.keys1 = keys1;\r\n        this.keys2 = keys2;\r\n    }\r\n\r\n    @Override\r\n    public int compare(Integer index1, Integer index2) {\r\n        if (keys2 == null) {\r\n            return keys1[index1] - keys1[index2];\r\n        } else {\r\n            if (keys1[index1] == keys1[index2]) {\r\n                return keys2[index1] - keys2[index2];\r\n            } else {\r\n                return keys1[index1] - keys1[index2];\r\n            }\r\n        }\r\n    }\r\n}\r\n```\r\nFollowing is `main` method with the values it failed. I even tried to store in indices index rather than `values[i]` but that led to null pointer exception.\r\n```java\r\npublic class Main {\r\n    public static void main(String[] args) {\r\n        // Given values, keys1, and keys2 arrays\r\n        int[] values = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};\r\n        int[] key1 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0};\r\n        int[] key2 = {0, 0, 1, 3, 4, 5, 6, 8, 9, 10};\r\n\r\n        // Create an array of indices\r\n        Integer[] indices = new Integer[values.length];\r\n        for (int i = 0; i &lt; indices.length; i++) {\r\n            indices[i] = values[i];\r\n        }\r\n\r\n        // Sort the indices array based on the custom comparator\r\n        Arrays.sort(indices, new IntegerComparator(key1, key2));\r\n    }\r\n}\r\n```\r\nI want to sort values based on comparing keys. As Eran has pointed out in comment, it is due to accessing key at index 10 (value[9]=10). But I would appreciate suggestion on solving it.","link":"https://stackoverflow.com/questions/77576564/array-index-out-of-bound-with-sort-comparator","title":"Array index out of bound with sort comparator","body":"<p>I would truly appreciate any help in solving following exception. In particular, I keep running into array index out of bound exception at index 10. The <code>values</code> and <code>keys1</code> and <code>keys2</code> arrays cannot be changed as they are provided by another program.</p>\n<p>This is my <code>IntegerComparator</code> class:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.util.Arrays;\nimport java.util.Comparator;\n\nclass IntegerComparator implements Comparator&lt;Integer&gt; {\n    private int[] keys1;\n    private int[] keys2;\n\n    public IntegerComparator(int[] keys1, int[] keys2) {\n        this.keys1 = keys1;\n        this.keys2 = keys2;\n    }\n\n    @Override\n    public int compare(Integer index1, Integer index2) {\n        if (keys2 == null) {\n            return keys1[index1] - keys1[index2];\n        } else {\n            if (keys1[index1] == keys1[index2]) {\n                return keys2[index1] - keys2[index2];\n            } else {\n                return keys1[index1] - keys1[index2];\n            }\n        }\n    }\n}\n</code></pre>\n<p>Following is <code>main</code> method with the values it failed. I even tried to store in indices index rather than <code>values[i]</code> but that led to null pointer exception.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Main {\n    public static void main(String[] args) {\n        // Given values, keys1, and keys2 arrays\n        int[] values = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};\n        int[] key1 = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0};\n        int[] key2 = {0, 0, 1, 3, 4, 5, 6, 8, 9, 10};\n\n        // Create an array of indices\n        Integer[] indices = new Integer[values.length];\n        for (int i = 0; i &lt; indices.length; i++) {\n            indices[i] = values[i];\n        }\n\n        // Sort the indices array based on the custom comparator\n        Arrays.sort(indices, new IntegerComparator(key1, key2));\n    }\n}\n</code></pre>\n<p>I want to sort values based on comparing keys. As Eran has pointed out in comment, it is due to accessing key at index 10 (value[9]=10). But I would appreciate suggestion on solving it.</p>\n"},{"tags":["java","multithreading","substring","bufferedreader","randomaccessfile"],"comments":[{"score":3,"post_type":"question","creation_date":1698877864,"post_id":77405970,"comment_id":136462044,"body_markdown":"When you say &quot;String&quot;, do you mean line?","link":"https://stackoverflow.com/questions/77405970/how-to-find-certain-lines-in-file-using-java#comment136462044_77405970","body":"When you say &quot;String&quot;, do you mean line?"},{"score":1,"post_type":"question","creation_date":1698879282,"post_id":77405970,"comment_id":136462197,"body_markdown":"By &quot;divided&quot; do you mean the string you&#39;re searching for can span multiple lines?","link":"https://stackoverflow.com/questions/77405970/how-to-find-certain-lines-in-file-using-java#comment136462197_77405970","body":"By &quot;divided&quot; do you mean the string you&#39;re searching for can span multiple lines?"},{"score":0,"post_type":"question","creation_date":1698879494,"post_id":77405970,"comment_id":136462213,"body_markdown":"@shmosel, by saying &quot;String&quot; I wanted to mean a line, which contains a certain substring","link":"https://stackoverflow.com/questions/77405970/how-to-find-certain-lines-in-file-using-java#comment136462213_77405970","body":"@shmosel, by saying &quot;String&quot; I wanted to mean a line, which contains a certain substring"},{"score":1,"post_type":"question","creation_date":1698879906,"post_id":77405970,"comment_id":136462258,"body_markdown":"@DavidConrad Not exactly. I wanted to divide file in parts or &#39;blocks&#39; of 2Mb size for multithreading. Using `RandomAccessFile` we move around the file with FilePointer, which stores information on current position in file in terms of bytes. Thus I can&#39;t be sure if the string which contains a substring is all in one &#39;block&#39;.","link":"https://stackoverflow.com/questions/77405970/how-to-find-certain-lines-in-file-using-java#comment136462258_77405970","body":"@DavidConrad Not exactly. I wanted to divide file in parts or &#39;blocks&#39; of 2Mb size for multithreading. Using <code>RandomAccessFile</code> we move around the file with FilePointer, which stores information on current position in file in terms of bytes. Thus I can&#39;t be sure if the string which contains a substring is all in one &#39;block&#39;."}],"answers":[{"comments":[{"score":0,"post_type":"answer","creation_date":1698984572,"post_id":77406266,"comment_id":136476629,"body_markdown":"Thanks for your answer. Your ideas are really great. I had to say it&#39;s homework and I have to use threads. Still I don&#39;t know how to find a beginning of line, which contains a keyword and lines before and after it. Processing all the file in one thread is definitely the easiest way to find all occurrences and lines before/after, but this way doesn&#39;t include threading which must process data simultaneously...","link":"https://stackoverflow.com/questions/77405970/how-to-find-certain-lines-in-file-using-java/77406266#comment136476629_77406266","body":"Thanks for your answer. Your ideas are really great. I had to say it&#39;s homework and I have to use threads. Still I don&#39;t know how to find a beginning of line, which contains a keyword and lines before and after it. Processing all the file in one thread is definitely the easiest way to find all occurrences and lines before/after, but this way doesn&#39;t include threading which must process data simultaneously..."}],"comment_count":1,"score":1,"last_activity_date":1698883817,"creation_date":1698883817,"answer_id":77406266,"question_id":77405970,"body_markdown":"You seem to be asking for notes and hints about how to solve this problem.\r\n\r\n1. Note that files are bytes, but text search implies charset encoding.\r\n\r\nThat means &#39;I will just chunk up the file in 2MB chunks&#39; could mean a chunk can start in the middle of a character (charset encodings like UTF-8 can take more than 1 byte to store a character) which complicates matters. One solution is to take your &#39;needle&#39; (the string you are searching for), turn that into bytes (e.g. `needle.getBytes(StandardCharsets.UTF_8)`), and search for _those_.\r\n\r\n2. There are 2 ways to solve the &#39;what if the haystack contains the needle, but my chunking process chunks halfway through a needle?&#39; issue.\r\n\r\n## Overlap\r\n\r\nIf &#39;needle&#39; is small, you can overlap. Say you have a 9MB file, you want to chunk in 2MB blocks, and needle is 50 bytes long. The overlap solution dictates that you extend the endpoint of every chunk 49 bytes (1 less than the size of needle). So, the first chunk isn&#39;t precisely 0-2097151 (2MB worth). It&#39;s 49 more than that - it goes from 0 to 2097200. And the second chunk _does_ start at 2097151 (there is 49 overlap). This way it&#39;s still not possible for both chunks to report the needle, but you are guaranteed that if there is a needle right at that boundary, one of em will. This becomes unwieldy if the needle is very large.\r\n\r\n## Half-match passing\r\n\r\nA solution that can deal with large needles is to pass boundary half matches to a collector.\r\n\r\nGenerally in such multithread jobs you use the map-reduce concept:\r\n\r\n1. you map some input into chunks.\r\n2. Each chunk is independent (to calculate the result for a chunk, you just need the data in it; you do not need to know about any data from beyond the chunk).\r\n3. A number of working threads pull &#39;chunk jobs&#39; (a simple descriptor describing the chunk to work on) off the pipe and map them to a muuuch smaller, simpler result value.\r\n4. A final thread gathers all results and reduces them. Optimally, this is streaming (any 2+ chunks can be reduced to a single one), but it&#39;s generally fine if this process cannot reduce until all chunk results are in. It&#39;s fine if the reducer needs, for example, the results of contiguous chunks to do its job.\r\n\r\nThis model means you can half-match. The thread that processes a single, say, 2 MB chunk of data turns that into a result. A result consists of any number of &#39;found it!&#39; entries, and they come in 3 flavours:\r\n\r\n* Found a needle at X. (In the chunk, the entire needle is present starting at bytepos X and ending at bytepos X+needlesize).\r\n* Found a needle-suffix of length Y (The chunk _starts with_ a bunch of bytes that overlap with _the end_ of the needle. For example, the needle is `Hello, World!` and this chunk starts with `orld!`. That does not mean a needle is actually found, but it is part of what this chunk processor must report to the reducer.\r\n* Same, but on the other side: Found a needle-prefix of length Y (the chunk ends in `Hello, Wor`).\r\n\r\nThe reducer can line up reports of needle-prefixes and needle-suffixes (e.g. for `Hello, World!`, which is 13 long, if chunk 14 reports &#39;needle-prefix = 8&#39; and chunk 15 reports &#39;needle-suffix=5`, there&#39;s a needle in the file at chunk15start minus 8.\r\n\r\nThe nananananaba issue (which is what Boyer Moore tries to solve) must also be applied here! If needle is &#39;nananaba&#39; and one chunk ends in &#39;nanana&#39; and the next chunk starts with &#39;nanaba&#39;, then there is a needle there, but it doesn&#39;t start at the first chunk&#39;s &#39;nanana&#39;. It starts 4 characters later.\r\n\r\nThis model is called map-reduce:\r\n\r\nEach chunk processor _maps_ the input data onto an intermediate result value. Generally results are vastly smaller than inputs.\r\n\r\nA single reducer (sometimes running on its own dedicated thread, but it can simply be done by a worker thread in between doing a _mapping_ operation) will take multiple _mappings_ (these result values) and reduce them down to a single result value. Keep going until there&#39;s only one such result value left, from which it should be trivial to produce the required answer. The job of squashing 2+ _mappings_ down to a single one is called _reducing_.\r\n\r\nHence, map-reduce. You can read on e.g. wikipedia for more details if you are intrigued.\r\n\r\n3. __This is probably pointless__\r\n\r\nIt depends on lots of factors, but on many, many systems, using multiple threads to do extremely basic processing (and this is extremely basic, even Boyer-Moore is) on files read from disk __is pointless__ - the disk is the bottleneck, not the CPU. For example, trivially, on spinning disks (which, admittedly, are kinda old news now), __this will be significantly slower__, because to provide data to all the 20 or whatnot threads all asking for data, the disk needs to spin and spin, giving each thread data from separate slices of the disk. The disk is __entirely__ the bottleneck so the only job is to ensure the disk can provide the bytes as efficiently as possible. Which is, for a contiguous file (one where all bytes are layered one after another), is best done by having __one thread read the bytes from start to finish in one go__.\r\n\r\nAt the other extreme, some sort of fast-NVMe multi-raid getup means contiguous access has no bearing on performance, and the CPU is probably the bottleneck and not the raid setup, so there multi-core _would_ help.\r\n\r\nI&#39;d bet on multicore making things, if anything, slower. Processing 20GB worth of data off a middling speed disk is going to take a few seconds. Throwing threads at the problem isn&#39;t going to change this.\r\n\r\n4. How to determine chunk size?\r\n\r\nIt mostly doesn&#39;t matter. But, fire up the right number of threads.\r\n\r\nGenerally you know how many threads you want (usually about 2x the amount of CPU cores you have, but, really, &#39;CPU cores amount of threads&#39; is all you need). Thus, you can figure out chunk size by taking total file size and dividing by that. However, it really doesn&#39;t matter. __Assuming a disk that does not care whatsoever about how you pull bytes off of it__ (highly unlikely, see the previous point!) -  If you have a 10TB file and go with a chunk size of, say, 512MB, that means 2048 chunks. It&#39;s rather unlikely your CPU has 2048 cores. It doesn&#39;t matter though: If it has 20 cores, have 20 threads running, and each thread will just process a 500MB chunk, then move on to another chunk to work on, it&#39;s not going to have a meaningful effect on how fast this process is going to go. As long as the chunk sizes aren&#39;t extremist (a chunk size of, say, 20 bytes, that&#39;s going to be a problem), and all the cores will generally be busy (trivial case: If 10 chunks total and 20 cores, that&#39;d be bad, you want at least 20 jobs. Preferably more like 200 so things can balance out if some chunks end up getting processed much faster than other ones) - you&#39;ll be fine.\r\n\r\nThe fork/join framework is designed for this stuff, you might want to look into it.\r\n","link":"https://stackoverflow.com/questions/77405970/how-to-find-certain-lines-in-file-using-java/77406266#77406266","title":"How to find certain lines in file using Java","body":"<p>You seem to be asking for notes and hints about how to solve this problem.</p>\n<ol>\n<li>Note that files are bytes, but text search implies charset encoding.</li>\n</ol>\n<p>That means 'I will just chunk up the file in 2MB chunks' could mean a chunk can start in the middle of a character (charset encodings like UTF-8 can take more than 1 byte to store a character) which complicates matters. One solution is to take your 'needle' (the string you are searching for), turn that into bytes (e.g. <code>needle.getBytes(StandardCharsets.UTF_8)</code>), and search for <em>those</em>.</p>\n<ol start=\"2\">\n<li>There are 2 ways to solve the 'what if the haystack contains the needle, but my chunking process chunks halfway through a needle?' issue.</li>\n</ol>\n<h2>Overlap</h2>\n<p>If 'needle' is small, you can overlap. Say you have a 9MB file, you want to chunk in 2MB blocks, and needle is 50 bytes long. The overlap solution dictates that you extend the endpoint of every chunk 49 bytes (1 less than the size of needle). So, the first chunk isn't precisely 0-2097151 (2MB worth). It's 49 more than that - it goes from 0 to 2097200. And the second chunk <em>does</em> start at 2097151 (there is 49 overlap). This way it's still not possible for both chunks to report the needle, but you are guaranteed that if there is a needle right at that boundary, one of em will. This becomes unwieldy if the needle is very large.</p>\n<h2>Half-match passing</h2>\n<p>A solution that can deal with large needles is to pass boundary half matches to a collector.</p>\n<p>Generally in such multithread jobs you use the map-reduce concept:</p>\n<ol>\n<li>you map some input into chunks.</li>\n<li>Each chunk is independent (to calculate the result for a chunk, you just need the data in it; you do not need to know about any data from beyond the chunk).</li>\n<li>A number of working threads pull 'chunk jobs' (a simple descriptor describing the chunk to work on) off the pipe and map them to a muuuch smaller, simpler result value.</li>\n<li>A final thread gathers all results and reduces them. Optimally, this is streaming (any 2+ chunks can be reduced to a single one), but it's generally fine if this process cannot reduce until all chunk results are in. It's fine if the reducer needs, for example, the results of contiguous chunks to do its job.</li>\n</ol>\n<p>This model means you can half-match. The thread that processes a single, say, 2 MB chunk of data turns that into a result. A result consists of any number of 'found it!' entries, and they come in 3 flavours:</p>\n<ul>\n<li>Found a needle at X. (In the chunk, the entire needle is present starting at bytepos X and ending at bytepos X+needlesize).</li>\n<li>Found a needle-suffix of length Y (The chunk <em>starts with</em> a bunch of bytes that overlap with <em>the end</em> of the needle. For example, the needle is <code>Hello, World!</code> and this chunk starts with <code>orld!</code>. That does not mean a needle is actually found, but it is part of what this chunk processor must report to the reducer.</li>\n<li>Same, but on the other side: Found a needle-prefix of length Y (the chunk ends in <code>Hello, Wor</code>).</li>\n</ul>\n<p>The reducer can line up reports of needle-prefixes and needle-suffixes (e.g. for <code>Hello, World!</code>, which is 13 long, if chunk 14 reports 'needle-prefix = 8' and chunk 15 reports 'needle-suffix=5`, there's a needle in the file at chunk15start minus 8.</p>\n<p>The nananananaba issue (which is what Boyer Moore tries to solve) must also be applied here! If needle is 'nananaba' and one chunk ends in 'nanana' and the next chunk starts with 'nanaba', then there is a needle there, but it doesn't start at the first chunk's 'nanana'. It starts 4 characters later.</p>\n<p>This model is called map-reduce:</p>\n<p>Each chunk processor <em>maps</em> the input data onto an intermediate result value. Generally results are vastly smaller than inputs.</p>\n<p>A single reducer (sometimes running on its own dedicated thread, but it can simply be done by a worker thread in between doing a <em>mapping</em> operation) will take multiple <em>mappings</em> (these result values) and reduce them down to a single result value. Keep going until there's only one such result value left, from which it should be trivial to produce the required answer. The job of squashing 2+ <em>mappings</em> down to a single one is called <em>reducing</em>.</p>\n<p>Hence, map-reduce. You can read on e.g. wikipedia for more details if you are intrigued.</p>\n<ol start=\"3\">\n<li><strong>This is probably pointless</strong></li>\n</ol>\n<p>It depends on lots of factors, but on many, many systems, using multiple threads to do extremely basic processing (and this is extremely basic, even Boyer-Moore is) on files read from disk <strong>is pointless</strong> - the disk is the bottleneck, not the CPU. For example, trivially, on spinning disks (which, admittedly, are kinda old news now), <strong>this will be significantly slower</strong>, because to provide data to all the 20 or whatnot threads all asking for data, the disk needs to spin and spin, giving each thread data from separate slices of the disk. The disk is <strong>entirely</strong> the bottleneck so the only job is to ensure the disk can provide the bytes as efficiently as possible. Which is, for a contiguous file (one where all bytes are layered one after another), is best done by having <strong>one thread read the bytes from start to finish in one go</strong>.</p>\n<p>At the other extreme, some sort of fast-NVMe multi-raid getup means contiguous access has no bearing on performance, and the CPU is probably the bottleneck and not the raid setup, so there multi-core <em>would</em> help.</p>\n<p>I'd bet on multicore making things, if anything, slower. Processing 20GB worth of data off a middling speed disk is going to take a few seconds. Throwing threads at the problem isn't going to change this.</p>\n<ol start=\"4\">\n<li>How to determine chunk size?</li>\n</ol>\n<p>It mostly doesn't matter. But, fire up the right number of threads.</p>\n<p>Generally you know how many threads you want (usually about 2x the amount of CPU cores you have, but, really, 'CPU cores amount of threads' is all you need). Thus, you can figure out chunk size by taking total file size and dividing by that. However, it really doesn't matter. <strong>Assuming a disk that does not care whatsoever about how you pull bytes off of it</strong> (highly unlikely, see the previous point!) -  If you have a 10TB file and go with a chunk size of, say, 512MB, that means 2048 chunks. It's rather unlikely your CPU has 2048 cores. It doesn't matter though: If it has 20 cores, have 20 threads running, and each thread will just process a 500MB chunk, then move on to another chunk to work on, it's not going to have a meaningful effect on how fast this process is going to go. As long as the chunk sizes aren't extremist (a chunk size of, say, 20 bytes, that's going to be a problem), and all the cores will generally be busy (trivial case: If 10 chunks total and 20 cores, that'd be bad, you want at least 20 jobs. Preferably more like 200 so things can balance out if some chunks end up getting processed much faster than other ones) - you'll be fine.</p>\n<p>The fork/join framework is designed for this stuff, you might want to look into it.</p>\n"},{"comment_count":0,"score":0,"last_activity_date":1699011612,"creation_date":1699011612,"answer_id":77416390,"question_id":77405970,"body_markdown":"1. it&#39;s true that some UTF-8 characters consist of 2 and more bytes, as [the answer above](https://stackoverflow.com/a/77406266) mentions, but it&#39;s possible that for your particular task the texts will only contain ASCII characters (which are always 1 byte). So I would recommend you to ask about that specifically, because you might save yourself from dealing with multi-byte characters.\r\n2. using `RandomAccessFile` is great. For example, after finding your line you can get the line before it by reading the file in the backwards direction until the newline symbol.\r\n3. regarding &quot;divided strings&quot;: if the text at the end of your 2MB part corresponds to the beginning of the line you search, then you can just continue reading the file beyond this 2MB part - it&#39;s a `RandomAccessFile` after all.","link":"https://stackoverflow.com/questions/77405970/how-to-find-certain-lines-in-file-using-java/77416390#77416390","title":"How to find certain lines in file using Java","body":"<ol>\n<li>it's true that some UTF-8 characters consist of 2 and more bytes, as <a href=\"https://stackoverflow.com/a/77406266\">the answer above</a> mentions, but it's possible that for your particular task the texts will only contain ASCII characters (which are always 1 byte). So I would recommend you to ask about that specifically, because you might save yourself from dealing with multi-byte characters.</li>\n<li>using <code>RandomAccessFile</code> is great. For example, after finding your line you can get the line before it by reading the file in the backwards direction until the newline symbol.</li>\n<li>regarding &quot;divided strings&quot;: if the text at the end of your 2MB part corresponds to the beginning of the line you search, then you can just continue reading the file beyond this 2MB part - it's a <code>RandomAccessFile</code> after all.</li>\n</ol>\n"},{"comment_count":0,"score":0,"last_activity_date":1701611672,"creation_date":1701611672,"answer_id":77594582,"question_id":77405970,"body_markdown":"You are correct with the idea that you can divide the String into substrings and search for matches via threads. You are also correct that a match may start in one of the chunks and end at the next chunk. So, it seems that in your case the solution is to:\r\n\r\n- if it&#39;s not the first thread\r\n    - get the `bigS.substring(0, s.length() - 1)` of your current chunk, let&#39;s call it `start`\r\n    - search for matches of `s` in `end + start` where `end` is the substring of your previous `String` at its very end of `s.length() - 1` size\r\n- search for matches of `s` normally\r\n- if it&#39;s the last thread\r\n    - save `bigS.substring(bigS.length() - s.length() + 1) as `end` so the next chunk will know about this\r\n\r\nNow, since you have to work with threads, the algorithm above cannot be implemented sequentially, so we modify the idea to divide the `String` to chunks like suggested, each chunk will be worked by a thread (careful with the number of threads though) and each thread will save the matches of its chunk, but also return its `start` and `end` as values (see https://stackoverflow.com/questions/9148899/returning-value-from-thread).\r\n\r\nThis way when you iterate your threads and `join()` them sequentially, you will always be able to glue together `previousEnd + start` and then override `previousEnd` with the `end` your current thread returned to find between-chunk matches.","link":"https://stackoverflow.com/questions/77405970/how-to-find-certain-lines-in-file-using-java/77594582#77594582","title":"How to find certain lines in file using Java","body":"<p>You are correct with the idea that you can divide the String into substrings and search for matches via threads. You are also correct that a match may start in one of the chunks and end at the next chunk. So, it seems that in your case the solution is to:</p>\n<ul>\n<li>if it's not the first thread\n<ul>\n<li>get the <code>bigS.substring(0, s.length() - 1)</code> of your current chunk, let's call it <code>start</code></li>\n<li>search for matches of <code>s</code> in <code>end + start</code> where <code>end</code> is the substring of your previous <code>String</code> at its very end of <code>s.length() - 1</code> size</li>\n</ul>\n</li>\n<li>search for matches of <code>s</code> normally</li>\n<li>if it's the last thread\n<ul>\n<li>save <code>bigS.substring(bigS.length() - s.length() + 1) as </code>end` so the next chunk will know about this</li>\n</ul>\n</li>\n</ul>\n<p>Now, since you have to work with threads, the algorithm above cannot be implemented sequentially, so we modify the idea to divide the <code>String</code> to chunks like suggested, each chunk will be worked by a thread (careful with the number of threads though) and each thread will save the matches of its chunk, but also return its <code>start</code> and <code>end</code> as values (see <a href=\"https://stackoverflow.com/questions/9148899/returning-value-from-thread\">Returning value from Thread</a>).</p>\n<p>This way when you iterate your threads and <code>join()</code> them sequentially, you will always be able to glue together <code>previousEnd + start</code> and then override <code>previousEnd</code> with the <code>end</code> your current thread returned to find between-chunk matches.</p>\n"}],"comment_count":4,"is_answered":true,"view_count":63,"answer_count":3,"score":1,"last_activity_date":1701611672,"creation_date":1698877737,"question_id":77405970,"body_markdown":"The main goal of my program is to find all occurrences of a certain substring in file and provide an opportunity to not only get the &quot;String&quot; the certain substring is, but also get strings before and after it. \\\r\nMy main problem is that a file may be really big (Gb or more) and contain only one line. Besides, I *must use multithreading* to do this task. \r\n\r\nSo far I want to divide a file in overlapping parts of 2Mb or more using `RandomAccessFile` (method `readFully`) and let the threads search for a substring using Boyer Moore Algorithm. Thus, I probably could find the offset of the substring beginning. \r\n- I want to use overlapping parts, because part of substring may be in one part of file, and another in the second one\r\n- 2 Mb is just a min number, the length of parts should probably depend on file length in bytes\r\n\r\nHowever, I don&#39;t have an idea on how to get a &quot;String&quot; containing substring and strings before and after. Because:\r\n- a &quot;String&quot; may be divided\r\n- the strings before/after the &quot;String&quot; may be in another part or there may be no strings above/below, if the &quot;String&quot; is the first/last in file\r\n\r\nMay be I should somehow use `RandomAccessFile` and `BufferedReader` together?\r\n","link":"https://stackoverflow.com/questions/77405970/how-to-find-certain-lines-in-file-using-java","title":"How to find certain lines in file using Java","body":"<p>The main goal of my program is to find all occurrences of a certain substring in file and provide an opportunity to not only get the &quot;String&quot; the certain substring is, but also get strings before and after it. <br />\nMy main problem is that a file may be really big (Gb or more) and contain only one line. Besides, I <em>must use multithreading</em> to do this task.</p>\n<p>So far I want to divide a file in overlapping parts of 2Mb or more using <code>RandomAccessFile</code> (method <code>readFully</code>) and let the threads search for a substring using Boyer Moore Algorithm. Thus, I probably could find the offset of the substring beginning.</p>\n<ul>\n<li>I want to use overlapping parts, because part of substring may be in one part of file, and another in the second one</li>\n<li>2 Mb is just a min number, the length of parts should probably depend on file length in bytes</li>\n</ul>\n<p>However, I don't have an idea on how to get a &quot;String&quot; containing substring and strings before and after. Because:</p>\n<ul>\n<li>a &quot;String&quot; may be divided</li>\n<li>the strings before/after the &quot;String&quot; may be in another part or there may be no strings above/below, if the &quot;String&quot; is the first/last in file</li>\n</ul>\n<p>May be I should somehow use <code>RandomAccessFile</code> and <code>BufferedReader</code> together?</p>\n"},{"tags":["java","jvm"],"comments":[{"score":0,"post_type":"question","creation_date":1691319919,"post_id":76845491,"comment_id":135473087,"body_markdown":"Are you talking about the `.class` file or the `java.lang.Class` object?","link":"https://stackoverflow.com/questions/76845491/how-is-literal-class-object-created-in-java#comment135473087_76845491","body":"Are you talking about the <code>.class</code> file or the <code>java.lang.Class</code> object?"},{"score":0,"post_type":"question","creation_date":1691325698,"post_id":76845491,"comment_id":135473677,"body_markdown":"I mean the java.lang.Class object","link":"https://stackoverflow.com/questions/76845491/how-is-literal-class-object-created-in-java#comment135473677_76845491","body":"I mean the java.lang.Class object"}],"answers":[{"comment_count":0,"score":3,"last_activity_date":1691323161,"last_edit_date":1691323161,"creation_date":1691320199,"answer_id":76845606,"question_id":76845491,"body_markdown":"Assuming you are talking about the `java.lang.Class` object, that is actually created in native code and _not_ using the `new` operator.\r\n\r\n## Let&#39;s check\r\nIf we take a look at the `ClassLoader` implementation, it uses the `defineClass` methods for creating `Class` instances which delegate that to [`defineClass1` and `defineClass2`](https://github.com/openjdk/jdk/blob/90d795abf10bf8b8b53079c1afd19fee7b4cb6cf/src/java.base/share/classes/java/lang/ClassLoader.java#L1123-L1128).\r\nThese methods are `native` and therefore implemented in native (non-Java) code.\r\n\r\n### The native code\r\n\r\nThis happens in [`ClassLoader.c`](https://github.com/openjdk/jdk/blob/90d795abf10bf8b8b53079c1afd19fee7b4cb6cf/src/java.base/share/native/libjava/ClassLoader.c#L72-L151) which then redirects to `JVM_DefineClassWithSource` in `jvm.cpp` which then calls [`jvm_define_class_common`](https://github.com/openjdk/jdk/blob/90d795abf10bf8b8b53079c1afd19fee7b4cb6cf/src/hotspot/share/prims/jvm.cpp#L867-L906).  \r\nThis refers to a [`make_local` function](https://github.com/openjdk/jdk/blob/90d795abf10bf8b8b53079c1afd19fee7b4cb6cf/src/hotspot/share/runtime/jniHandles.cpp#L58-L72) which in tern refers to [`JNIHandleBlock::allocate_handle`](https://github.com/openjdk/jdk/blob/90d795abf10bf8b8b53079c1afd19fee7b4cb6cf/src/hotspot/share/runtime/jniHandles.cpp#L424-L487) which seems to be used for allocations **on the Java Heap**.\r\n\r\n## there&#39;s a constructor\r\n`java.lang.Class` actually [has a private constructor](https://github.com/openjdk/jdk/blob/90d795abf10bf8b8b53079c1afd19fee7b4cb6cf/src/java.base/share/classes/java/lang/Class.java#L241-L251). However, that is not used and only exists to trick the JIT and prevent developers to create `Class` instances:\r\n&gt; This constructor is not used and prevents the default constructor being generated.\r\n\r\nand\r\n&gt; ```\r\n&gt; // Initialize final field for classLoader.  The initialization value of non-null\r\n&gt; // prevents future JIT optimizations from assuming this final field is null.\r\n&gt; ```\r\n\r\nSince the constructor is never used, it cannot be created using the `new` keyword.\r\n\r\n## Conclusion\r\n\r\nWith Hotspot, the instance creation currently happens in native code. Even though it isn&#39;t using the `new` keyword, it is still allocated on the Java Heap.\r\n\r\nHowever, this part is JVM specific and can be different in other JVMs (e.g. OpenJ9).","link":"https://stackoverflow.com/questions/76845491/how-is-literal-class-object-created-in-java/76845606#76845606","title":"how is literal .class object created in Java?","body":"<p>Assuming you are talking about the <code>java.lang.Class</code> object, that is actually created in native code and <em>not</em> using the <code>new</code> operator.</p>\n<h2>Let's check</h2>\n<p>If we take a look at the <code>ClassLoader</code> implementation, it uses the <code>defineClass</code> methods for creating <code>Class</code> instances which delegate that to <a href=\"https://github.com/openjdk/jdk/blob/90d795abf10bf8b8b53079c1afd19fee7b4cb6cf/src/java.base/share/classes/java/lang/ClassLoader.java#L1123-L1128\" rel=\"nofollow noreferrer\"><code>defineClass1</code> and <code>defineClass2</code></a>.\nThese methods are <code>native</code> and therefore implemented in native (non-Java) code.</p>\n<h3>The native code</h3>\n<p>This happens in <a href=\"https://github.com/openjdk/jdk/blob/90d795abf10bf8b8b53079c1afd19fee7b4cb6cf/src/java.base/share/native/libjava/ClassLoader.c#L72-L151\" rel=\"nofollow noreferrer\"><code>ClassLoader.c</code></a> which then redirects to <code>JVM_DefineClassWithSource</code> in <code>jvm.cpp</code> which then calls <a href=\"https://github.com/openjdk/jdk/blob/90d795abf10bf8b8b53079c1afd19fee7b4cb6cf/src/hotspot/share/prims/jvm.cpp#L867-L906\" rel=\"nofollow noreferrer\"><code>jvm_define_class_common</code></a>.<br />\nThis refers to a <a href=\"https://github.com/openjdk/jdk/blob/90d795abf10bf8b8b53079c1afd19fee7b4cb6cf/src/hotspot/share/runtime/jniHandles.cpp#L58-L72\" rel=\"nofollow noreferrer\"><code>make_local</code> function</a> which in tern refers to <a href=\"https://github.com/openjdk/jdk/blob/90d795abf10bf8b8b53079c1afd19fee7b4cb6cf/src/hotspot/share/runtime/jniHandles.cpp#L424-L487\" rel=\"nofollow noreferrer\"><code>JNIHandleBlock::allocate_handle</code></a> which seems to be used for allocations <strong>on the Java Heap</strong>.</p>\n<h2>there's a constructor</h2>\n<p><code>java.lang.Class</code> actually <a href=\"https://github.com/openjdk/jdk/blob/90d795abf10bf8b8b53079c1afd19fee7b4cb6cf/src/java.base/share/classes/java/lang/Class.java#L241-L251\" rel=\"nofollow noreferrer\">has a private constructor</a>. However, that is not used and only exists to trick the JIT and prevent developers to create <code>Class</code> instances:</p>\n<blockquote>\n<p>This constructor is not used and prevents the default constructor being generated.</p>\n</blockquote>\n<p>and</p>\n<blockquote>\n<pre><code>// Initialize final field for classLoader.  The initialization value of non-null\n// prevents future JIT optimizations from assuming this final field is null.\n</code></pre>\n</blockquote>\n<p>Since the constructor is never used, it cannot be created using the <code>new</code> keyword.</p>\n<h2>Conclusion</h2>\n<p>With Hotspot, the instance creation currently happens in native code. Even though it isn't using the <code>new</code> keyword, it is still allocated on the Java Heap.</p>\n<p>However, this part is JVM specific and can be different in other JVMs (e.g. OpenJ9).</p>\n"},{"comment_count":0,"score":3,"last_activity_date":1691326357,"last_edit_date":1691326357,"creation_date":1691320335,"answer_id":76845613,"question_id":76845491,"body_markdown":"&gt; As we know when a java class `X` is loaded by class loader, a literal object `X.class` will be created. \r\n\r\nThat is roughly correct, but your terminology is incorrect.  What is created is a `Class` object not a (class) &quot;literal object&quot;.  A literal is something in your Java source code.  It *denotes* an object at runtime, but it is not the object.\r\n\r\n&gt; How is this object (i.e. X.class) created? \r\n\r\nThe Java runtime creates it.  When the class loader loads the class, it loads and records various class-related information (descriptors, bytecode blocks, and so on) in *meta-space*.  A `Class` object is also created to act as the runtime representation for the class which is visible to programs.\r\n\r\nThe mechanisms for loading classes, representing their metadata and creating the `Class` object are all implementation specific.  You don&#39;t need to know the details ... and they *may* vary between different Java versions.  \r\n\r\n&gt; Is it created by &quot;new&quot; operator? \r\n\r\nIf you are referring to the Java `new` keyword, then No.  The creation will (typically) be done in native code.\r\n\r\n&gt; Is it created on heap memory or not?\r\n\r\nThat is implementation specific, but for current implementations the answer is yes.  For example, in Java 17 the `java.lang.Class` object is a heap object that is a &quot;java proxy&quot; for a native code descriptor called a `Klass`.\r\n\r\nBut &gt;you&lt; don&#39;t need to know this kind of detail. Even JNA / JNI programmers do not need to know how a `jclass` is implemented.  The only people who need to know this are those who write and maintain the JVM codebase.  (And if you are simply asking out of curiosity, I strongly recommend that you do your own research; i.e. by reading the OpenJDK source code.)","link":"https://stackoverflow.com/questions/76845491/how-is-literal-class-object-created-in-java/76845613#76845613","title":"how is literal .class object created in Java?","body":"<blockquote>\n<p>As we know when a java class <code>X</code> is loaded by class loader, a literal object <code>X.class</code> will be created.</p>\n</blockquote>\n<p>That is roughly correct, but your terminology is incorrect.  What is created is a <code>Class</code> object not a (class) &quot;literal object&quot;.  A literal is something in your Java source code.  It <em>denotes</em> an object at runtime, but it is not the object.</p>\n<blockquote>\n<p>How is this object (i.e. X.class) created?</p>\n</blockquote>\n<p>The Java runtime creates it.  When the class loader loads the class, it loads and records various class-related information (descriptors, bytecode blocks, and so on) in <em>meta-space</em>.  A <code>Class</code> object is also created to act as the runtime representation for the class which is visible to programs.</p>\n<p>The mechanisms for loading classes, representing their metadata and creating the <code>Class</code> object are all implementation specific.  You don't need to know the details ... and they <em>may</em> vary between different Java versions.</p>\n<blockquote>\n<p>Is it created by &quot;new&quot; operator?</p>\n</blockquote>\n<p>If you are referring to the Java <code>new</code> keyword, then No.  The creation will (typically) be done in native code.</p>\n<blockquote>\n<p>Is it created on heap memory or not?</p>\n</blockquote>\n<p>That is implementation specific, but for current implementations the answer is yes.  For example, in Java 17 the <code>java.lang.Class</code> object is a heap object that is a &quot;java proxy&quot; for a native code descriptor called a <code>Klass</code>.</p>\n<p>But &gt;you&lt; don't need to know this kind of detail. Even JNA / JNI programmers do not need to know how a <code>jclass</code> is implemented.  The only people who need to know this are those who write and maintain the JVM codebase.  (And if you are simply asking out of curiosity, I strongly recommend that you do your own research; i.e. by reading the OpenJDK source code.)</p>\n"}],"comment_count":2,"is_answered":true,"view_count":65,"answer_count":2,"score":0,"last_activity_date":1701606763,"creation_date":1691318542,"last_edit_date":1701606763,"question_id":76845491,"body_markdown":"As we know when a java class X is loaded by class loader, a literal object X.class will be created. How is this object (i.e. X.class) created? created by &quot;new&quot; operator? Is it created on JVM **heap** memory or **method area** memory?\r\n\r\nI tried to understand literal object X.class and it&#39;s relationship to class loader, but got confused","link":"https://stackoverflow.com/questions/76845491/how-is-literal-class-object-created-in-java","title":"how is literal .class object created in Java?","body":"<p>As we know when a java class X is loaded by class loader, a literal object X.class will be created. How is this object (i.e. X.class) created? created by &quot;new&quot; operator? Is it created on JVM <strong>heap</strong> memory or <strong>method area</strong> memory?</p>\n<p>I tried to understand literal object X.class and it's relationship to class loader, but got confused</p>\n"},{"tags":["java","reflection"],"answers":[{"comment_count":0,"score":1,"last_activity_date":1701249024,"creation_date":1701249024,"answer_id":77569816,"question_id":77567881,"body_markdown":"Unfortunately, Java Annotation processing [cannot be used to modify existing code](https://www.baeldung.com/java-annotation-processing-builder), only to generate new one. The `Log4j2` annotation you reference belongs to Lombok and that is a [different kind of beast than just an annotation processor](https://stackoverflow.com/questions/6107197/how-does-lombok-work).\r\n\r\nIt depends on what you need in particular, but in general, you can:\r\n- Use a bytecode generator like [ByteBuddy](https://bytebuddy.net/#/) to generate code at runtime (in short, extend your `TestClass` and override the method in question with custom behavior)\r\n- Use [AspectJ](https://eclipse.dev/aspectj/) to modify code at build time (e.g., declare a new field this way)\r\n\r\nI am sure there are other options, but as I said, those depend on you particular use case.","link":"https://stackoverflow.com/questions/77567881/adding-my-static-variable-in-java-annotated-class/77569816#77569816","title":"Adding my static variable in java annotated class","body":"<p>Unfortunately, Java Annotation processing <a href=\"https://www.baeldung.com/java-annotation-processing-builder\" rel=\"nofollow noreferrer\">cannot be used to modify existing code</a>, only to generate new one. The <code>Log4j2</code> annotation you reference belongs to Lombok and that is a <a href=\"https://stackoverflow.com/questions/6107197/how-does-lombok-work\">different kind of beast than just an annotation processor</a>.</p>\n<p>It depends on what you need in particular, but in general, you can:</p>\n<ul>\n<li>Use a bytecode generator like <a href=\"https://bytebuddy.net/#/\" rel=\"nofollow noreferrer\">ByteBuddy</a> to generate code at runtime (in short, extend your <code>TestClass</code> and override the method in question with custom behavior)</li>\n<li>Use <a href=\"https://eclipse.dev/aspectj/\" rel=\"nofollow noreferrer\">AspectJ</a> to modify code at build time (e.g., declare a new field this way)</li>\n</ul>\n<p>I am sure there are other options, but as I said, those depend on you particular use case.</p>\n"}],"comment_count":0,"is_answered":true,"view_count":72,"answer_count":1,"score":0,"last_activity_date":1701598549,"creation_date":1701216904,"last_edit_date":1701598549,"question_id":77567881,"body_markdown":"How i can to add my static variable to class, like in `Log4j2`?\r\n\r\nFor example:\r\n```java\r\nimport lombok.extern.log4j.Log4j2;\r\n\r\n@Log4j2\r\npublic class TestClass {\r\n    public void test() {\r\n        log.info(&quot;test&quot;);\r\n    }\r\n}\r\n```\r\nand generated source class looks like:\r\n```java\r\npublic class TestClass {\r\n    @Generated\r\n    private static final Logger log = LogManager.getLogger(TestClass.class);\r\n    \r\n    public void test() {\r\n        log.info(&quot;test&quot;);\r\n    }\r\n}\r\n```\r\n\r\n\r\nI created the class that extends `javax.annotation.processing.AbstractProcessor` and try to modify the original class by adding some static string, but I don&#39;t know how to do it right :/\r\n\r\n```java\r\n@SupportedAnnotationTypes(&quot;TestAnnotation&quot;)\r\n@SupportedSourceVersion(SourceVersion.RELEASE_17)\r\npublic class TestProcessor extends AbstractProcessor {\r\n\r\n    @Override\r\n    public boolean process(Set&lt;? extends TypeElement&gt; annotations, RoundEnvironment roundEnv) {\r\n        for (Element element : roundEnv.getElementsAnnotatedWith(TestAnnotation.class)) {\r\n            if (element.getKind().isClass()) {\r\n                // ???\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n}\r\n```\r\nI want something like:\r\n```java\r\n@TestAnnotation\r\npublic class TestClass {\r\n    public void test() {\r\n        System.out.println(testString); // testString is inserted by TestProcessor \r\n    }\r\n}\r\n```","link":"https://stackoverflow.com/questions/77567881/adding-my-static-variable-in-java-annotated-class","title":"Adding my static variable in java annotated class","body":"<p>How i can to add my static variable to class, like in <code>Log4j2</code>?</p>\n<p>For example:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import lombok.extern.log4j.Log4j2;\n\n@Log4j2\npublic class TestClass {\n    public void test() {\n        log.info(&quot;test&quot;);\n    }\n}\n</code></pre>\n<p>and generated source class looks like:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class TestClass {\n    @Generated\n    private static final Logger log = LogManager.getLogger(TestClass.class);\n    \n    public void test() {\n        log.info(&quot;test&quot;);\n    }\n}\n</code></pre>\n<p>I created the class that extends <code>javax.annotation.processing.AbstractProcessor</code> and try to modify the original class by adding some static string, but I don't know how to do it right :/</p>\n<pre class=\"lang-java prettyprint-override\"><code>@SupportedAnnotationTypes(&quot;TestAnnotation&quot;)\n@SupportedSourceVersion(SourceVersion.RELEASE_17)\npublic class TestProcessor extends AbstractProcessor {\n\n    @Override\n    public boolean process(Set&lt;? extends TypeElement&gt; annotations, RoundEnvironment roundEnv) {\n        for (Element element : roundEnv.getElementsAnnotatedWith(TestAnnotation.class)) {\n            if (element.getKind().isClass()) {\n                // ???\n            }\n        }\n        return true;\n    }\n}\n</code></pre>\n<p>I want something like:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@TestAnnotation\npublic class TestClass {\n    public void test() {\n        System.out.println(testString); // testString is inserted by TestProcessor \n    }\n}\n</code></pre>\n"}],"has_more":true,"quota_max":300,"quota_remaining":293}